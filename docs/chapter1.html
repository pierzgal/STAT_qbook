<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; Introduction to Data Science and Statistics – Social Data Analysis: An Introduction (Wprowadzenie do analizy danych społecznych)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./rozdzial1.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter1.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Science and Statistics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Social Data Analysis: An Introduction (Wprowadzenie do analizy danych społecznych)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Science and Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wprowadzenie do Nauki o Danych i Statystyki</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Zrozumienie Typów Danych w Naukach Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">From Sample to Population - Understanding Randomness, Sampling, and Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Od Próby do Populacji - Zrozumienie Losowości, Próbkowania i Wnioskowania</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reliability and Validity in Data Science Research</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Rzetelność i Trafność w Badaniach Nauk o Danych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Research Designs: Experimental and Non-Experimental Approaches</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Projekty Badawcze: Podejścia Eksperymentalne i Nieeksperymentalne</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fundamentals of Univariate Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Podstawy Jednowymiarowej Statystyki Opisowej</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data Visualization: with examples in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Wizualizacja Danych: z przykładami w R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction to (Discrete) Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Wprowadzenie do Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rv_pdf_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Random Variables and Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rv_pdf_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Zmienna Losowa i Rozkład Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Statistical Hypothesis Testing: A Fundamental Logic</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Wprowadzenie do Wnioskowania Statystycznego: Logika Testowania Hipotez Statystycznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#what-are-statistics-and-data-science" id="toc-what-are-statistics-and-data-science" class="nav-link active" data-scroll-target="#what-are-statistics-and-data-science"><span class="header-section-number">1.1</span> What are Statistics and Data Science?</a></li>
  <li><a href="#the-relationship-between-statistics-and-data-science" id="toc-the-relationship-between-statistics-and-data-science" class="nav-link" data-scroll-target="#the-relationship-between-statistics-and-data-science"><span class="header-section-number">1.2</span> The Relationship Between Statistics and Data Science</a></li>
  <li><a href="#basic-concepts-in-data-science-and-statistics" id="toc-basic-concepts-in-data-science-and-statistics" class="nav-link" data-scroll-target="#basic-concepts-in-data-science-and-statistics"><span class="header-section-number">1.3</span> Basic Concepts in Data Science and Statistics</a>
  <ul class="collapse">
  <li><a href="#data-and-populations" id="toc-data-and-populations" class="nav-link" data-scroll-target="#data-and-populations"><span class="header-section-number">1.3.1</span> Data and Populations</a></li>
  <li><a href="#statistical-inference-how-can-a-small-sample-represent-a-large-population" id="toc-statistical-inference-how-can-a-small-sample-represent-a-large-population" class="nav-link" data-scroll-target="#statistical-inference-how-can-a-small-sample-represent-a-large-population"><span class="header-section-number">1.3.7</span> Statistical Inference: How Can a Small Sample Represent a Large Population?</a></li>
  </ul></li>
  <li><a href="#population-parameters-and-statistical-estimation" id="toc-population-parameters-and-statistical-estimation" class="nav-link" data-scroll-target="#population-parameters-and-statistical-estimation"><span class="header-section-number">1.8</span> <strong>Population Parameters and Statistical Estimation</strong></a>
  <ul class="collapse">
  <li><a href="#population-parameters" id="toc-population-parameters" class="nav-link" data-scroll-target="#population-parameters"><span class="header-section-number">1.8.1</span> <strong>Population Parameters</strong></a></li>
  </ul></li>
  <li><a href="#statistical-estimation-concepts" id="toc-statistical-estimation-concepts" class="nav-link" data-scroll-target="#statistical-estimation-concepts"><span class="header-section-number">1.9</span> Statistical Estimation Concepts</a>
  <ul class="collapse">
  <li><a href="#population-parameters-vs.-sample-statistics" id="toc-population-parameters-vs.-sample-statistics" class="nav-link" data-scroll-target="#population-parameters-vs.-sample-statistics"><span class="header-section-number">1.9.1</span> Population Parameters vs.&nbsp;Sample Statistics</a></li>
  <li><a href="#what-is-an-estimand" id="toc-what-is-an-estimand" class="nav-link" data-scroll-target="#what-is-an-estimand"><span class="header-section-number">1.9.2</span> What is an Estimand?</a></li>
  <li><a href="#what-is-an-estimator" id="toc-what-is-an-estimator" class="nav-link" data-scroll-target="#what-is-an-estimator"><span class="header-section-number">1.9.3</span> What is an Estimator?</a></li>
  <li><a href="#what-is-an-estimate" id="toc-what-is-an-estimate" class="nav-link" data-scroll-target="#what-is-an-estimate"><span class="header-section-number">1.9.4</span> What is an Estimate?</a></li>
  <li><a href="#what-makes-a-good-estimator" id="toc-what-makes-a-good-estimator" class="nav-link" data-scroll-target="#what-makes-a-good-estimator"><span class="header-section-number">1.9.5</span> What Makes a Good Estimator?</a></li>
  <li><a href="#why-do-estimates-vary-the-sampling-distribution" id="toc-why-do-estimates-vary-the-sampling-distribution" class="nav-link" data-scroll-target="#why-do-estimates-vary-the-sampling-distribution"><span class="header-section-number">1.9.6</span> Why Do Estimates Vary? (The Sampling Distribution)</a></li>
  </ul></li>
  <li><a href="#statistical-inference-an-informal-introduction" id="toc-statistical-inference-an-informal-introduction" class="nav-link" data-scroll-target="#statistical-inference-an-informal-introduction"><span class="header-section-number">1.19</span> Statistical Inference: An Informal Introduction</a></li>
  <li><a href="#estimation" id="toc-estimation" class="nav-link" data-scroll-target="#estimation"><span class="header-section-number">1.20</span> Estimation</a></li>
  <li><a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing"><span class="header-section-number">1.21</span> Hypothesis Testing</a>
  <ul class="collapse">
  <li><a href="#example-1-testing-if-a-coin-is-biased-toward-heads" id="toc-example-1-testing-if-a-coin-is-biased-toward-heads" class="nav-link" data-scroll-target="#example-1-testing-if-a-coin-is-biased-toward-heads"><span class="header-section-number">1.21.1</span> Example 1: Testing if a Coin is Biased Toward Heads</a></li>
  <li><a href="#example-2-testing-the-effect-of-background-music-on-memory" id="toc-example-2-testing-the-effect-of-background-music-on-memory" class="nav-link" data-scroll-target="#example-2-testing-the-effect-of-background-music-on-memory"><span class="header-section-number">1.21.2</span> Example 2: Testing the Effect of Background Music on Memory</a></li>
  </ul></li>
  <li><a href="#general-steps-for-hypothesis-testing" id="toc-general-steps-for-hypothesis-testing" class="nav-link" data-scroll-target="#general-steps-for-hypothesis-testing"><span class="header-section-number">1.22</span> General Steps for Hypothesis Testing</a></li>
  <li><a href="#intuition-behind-hypothesis-testing" id="toc-intuition-behind-hypothesis-testing" class="nav-link" data-scroll-target="#intuition-behind-hypothesis-testing"><span class="header-section-number">1.23</span> Intuition Behind Hypothesis Testing</a></li>
  <li><a href="#common-mistakes-with-p-values" id="toc-common-mistakes-with-p-values" class="nav-link" data-scroll-target="#common-mistakes-with-p-values"><span class="header-section-number">1.24</span> Common Mistakes with p-values</a></li>
  <li><a href="#types-of-errors-in-hypothesis-testing" id="toc-types-of-errors-in-hypothesis-testing" class="nav-link" data-scroll-target="#types-of-errors-in-hypothesis-testing"><span class="header-section-number">1.25</span> Types of Errors in Hypothesis Testing</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways"><span class="header-section-number">1.26</span> Key Takeaways</a></li>
  <li><a href="#statistical-models" id="toc-statistical-models" class="nav-link" data-scroll-target="#statistical-models"><span class="header-section-number">1.27</span> Statistical Models</a>
  <ul class="collapse">
  <li><a href="#causal-vs.-predictive-inference" id="toc-causal-vs.-predictive-inference" class="nav-link" data-scroll-target="#causal-vs.-predictive-inference"><span class="header-section-number">1.27.1</span> Causal vs.&nbsp;Predictive Inference</a></li>
  <li><a href="#challenges-of-causal-inference" id="toc-challenges-of-causal-inference" class="nav-link" data-scroll-target="#challenges-of-causal-inference"><span class="header-section-number">1.27.2</span> Challenges of Causal Inference</a></li>
  </ul></li>
  <li><a href="#understanding-statistical-error" id="toc-understanding-statistical-error" class="nav-link" data-scroll-target="#understanding-statistical-error"><span class="header-section-number">1.28</span> Understanding Statistical Error</a></li>
  <li><a href="#types-of-statistical-errors" id="toc-types-of-statistical-errors" class="nav-link" data-scroll-target="#types-of-statistical-errors"><span class="header-section-number">1.29</span> Types of Statistical Errors</a>
  <ul class="collapse">
  <li><a href="#sampling-errors" id="toc-sampling-errors" class="nav-link" data-scroll-target="#sampling-errors"><span class="header-section-number">1.29.1</span> Sampling Errors</a></li>
  <li><a href="#measurement-errors" id="toc-measurement-errors" class="nav-link" data-scroll-target="#measurement-errors"><span class="header-section-number">1.29.2</span> Measurement Errors</a></li>
  <li><a href="#inference-errors" id="toc-inference-errors" class="nav-link" data-scroll-target="#inference-errors"><span class="header-section-number">1.29.3</span> Inference Errors</a></li>
  <li><a href="#model-specification-errors" id="toc-model-specification-errors" class="nav-link" data-scroll-target="#model-specification-errors"><span class="header-section-number">1.29.4</span> Model Specification Errors</a></li>
  <li><a href="#data-processing-and-analysis-errors" id="toc-data-processing-and-analysis-errors" class="nav-link" data-scroll-target="#data-processing-and-analysis-errors"><span class="header-section-number">1.29.5</span> Data Processing and Analysis Errors</a></li>
  <li><a href="#interpretation-and-reporting-errors" id="toc-interpretation-and-reporting-errors" class="nav-link" data-scroll-target="#interpretation-and-reporting-errors"><span class="header-section-number">1.29.6</span> Interpretation and Reporting Errors</a></li>
  </ul></li>
  <li><a href="#strategies-to-minimize-statistical-errors" id="toc-strategies-to-minimize-statistical-errors" class="nav-link" data-scroll-target="#strategies-to-minimize-statistical-errors"><span class="header-section-number">1.30</span> Strategies to Minimize Statistical Errors</a></li>
  <li><a href="#appendices-additional-topics-in-statistics-and-data-science" id="toc-appendices-additional-topics-in-statistics-and-data-science" class="nav-link" data-scroll-target="#appendices-additional-topics-in-statistics-and-data-science"><span class="header-section-number">1.31</span> Appendices: Additional Topics in Statistics and Data Science (*)</a></li>
  <li><a href="#appendix-a-r-for-social-science-data-analysis" id="toc-appendix-a-r-for-social-science-data-analysis" class="nav-link" data-scroll-target="#appendix-a-r-for-social-science-data-analysis"><span class="header-section-number">1.32</span> Appendix A: R for Social Science Data Analysis</a></li>
  <li><a href="#appendix-b-causal-inference-vs.-observational-studies" id="toc-appendix-b-causal-inference-vs.-observational-studies" class="nav-link" data-scroll-target="#appendix-b-causal-inference-vs.-observational-studies"><span class="header-section-number">1.33</span> Appendix B: Causal Inference vs.&nbsp;Observational Studies</a>
  <ul class="collapse">
  <li><a href="#causal-inference" id="toc-causal-inference" class="nav-link" data-scroll-target="#causal-inference"><span class="header-section-number">1.33.1</span> Causal Inference</a></li>
  <li><a href="#observational-studies" id="toc-observational-studies" class="nav-link" data-scroll-target="#observational-studies"><span class="header-section-number">1.33.2</span> Observational Studies</a></li>
  <li><a href="#challenges-in-establishing-causality" id="toc-challenges-in-establishing-causality" class="nav-link" data-scroll-target="#challenges-in-establishing-causality"><span class="header-section-number">1.33.3</span> Challenges in Establishing Causality</a></li>
  <li><a href="#methods-to-strengthen-causal-claims" id="toc-methods-to-strengthen-causal-claims" class="nav-link" data-scroll-target="#methods-to-strengthen-causal-claims"><span class="header-section-number">1.33.4</span> Methods to Strengthen Causal Claims</a></li>
  </ul></li>
  <li><a href="#appendix-c-understanding-spurious-correlations-confounders-and-colliders" id="toc-appendix-c-understanding-spurious-correlations-confounders-and-colliders" class="nav-link" data-scroll-target="#appendix-c-understanding-spurious-correlations-confounders-and-colliders"><span class="header-section-number">1.34</span> Appendix C: Understanding Spurious Correlations, Confounders, and Colliders</a>
  <ul class="collapse">
  <li><a href="#spurious-correlations" id="toc-spurious-correlations" class="nav-link" data-scroll-target="#spurious-correlations"><span class="header-section-number">1.34.1</span> Spurious Correlations</a></li>
  <li><a href="#confounders" id="toc-confounders" class="nav-link" data-scroll-target="#confounders"><span class="header-section-number">1.34.2</span> Confounders</a></li>
  <li><a href="#colliders" id="toc-colliders" class="nav-link" data-scroll-target="#colliders"><span class="header-section-number">1.34.3</span> Colliders</a></li>
  <li><a href="#simpsons-paradox" id="toc-simpsons-paradox" class="nav-link" data-scroll-target="#simpsons-paradox"><span class="header-section-number">1.34.4</span> Simpson’s Paradox</a></li>
  <li><a href="#directed-acyclic-graphs-dags" id="toc-directed-acyclic-graphs-dags" class="nav-link" data-scroll-target="#directed-acyclic-graphs-dags"><span class="header-section-number">1.34.5</span> Directed Acyclic Graphs (DAGs)</a></li>
  </ul></li>
  <li><a href="#appendix-d-models-in-science-from-deterministic-to-stochastic" id="toc-appendix-d-models-in-science-from-deterministic-to-stochastic" class="nav-link" data-scroll-target="#appendix-d-models-in-science-from-deterministic-to-stochastic"><span class="header-section-number">1.35</span> Appendix D: Models in Science: From Deterministic to Stochastic</a>
  <ul class="collapse">
  <li><a href="#types-of-models" id="toc-types-of-models" class="nav-link" data-scroll-target="#types-of-models"><span class="header-section-number">1.35.1</span> Types of Models</a></li>
  <li><a href="#model-error-and-bias-variance-tradeoff" id="toc-model-error-and-bias-variance-tradeoff" class="nav-link" data-scroll-target="#model-error-and-bias-variance-tradeoff"><span class="header-section-number">1.35.2</span> Model Error and Bias-Variance Tradeoff</a></li>
  </ul></li>
  <li><a href="#appendix-e-classical-vs-quantum-randomness" id="toc-appendix-e-classical-vs-quantum-randomness" class="nav-link" data-scroll-target="#appendix-e-classical-vs-quantum-randomness"><span class="header-section-number">1.36</span> Appendix E: Classical vs Quantum Randomness</a>
  <ul class="collapse">
  <li><a href="#origin-of-randomness" id="toc-origin-of-randomness" class="nav-link" data-scroll-target="#origin-of-randomness"><span class="header-section-number">1.36.1</span> Origin of Randomness</a></li>
  <li><a href="#philosophical-implications-1" id="toc-philosophical-implications-1" class="nav-link" data-scroll-target="#philosophical-implications-1"><span class="header-section-number">1.36.2</span> Philosophical Implications</a></li>
  <li><a href="#practical-implications" id="toc-practical-implications" class="nav-link" data-scroll-target="#practical-implications"><span class="header-section-number">1.36.3</span> Practical Implications</a></li>
  </ul></li>
  <li><a href="#appendix-f-ethical-considerations-in-social-science-data-analysis" id="toc-appendix-f-ethical-considerations-in-social-science-data-analysis" class="nav-link" data-scroll-target="#appendix-f-ethical-considerations-in-social-science-data-analysis"><span class="header-section-number">1.37</span> Appendix F: Ethical Considerations in Social Science Data Analysis</a>
  <ul class="collapse">
  <li><a href="#privacy-and-consent" id="toc-privacy-and-consent" class="nav-link" data-scroll-target="#privacy-and-consent"><span class="header-section-number">1.37.1</span> 1. Privacy and Consent</a></li>
  <li><a href="#data-protection" id="toc-data-protection" class="nav-link" data-scroll-target="#data-protection"><span class="header-section-number">1.37.2</span> 2. Data Protection</a></li>
  <li><a href="#bias-and-representation" id="toc-bias-and-representation" class="nav-link" data-scroll-target="#bias-and-representation"><span class="header-section-number">1.37.3</span> 3. Bias and Representation</a></li>
  <li><a href="#transparency-and-reproducibility" id="toc-transparency-and-reproducibility" class="nav-link" data-scroll-target="#transparency-and-reproducibility"><span class="header-section-number">1.37.4</span> 4. Transparency and Reproducibility</a></li>
  <li><a href="#social-impact" id="toc-social-impact" class="nav-link" data-scroll-target="#social-impact"><span class="header-section-number">1.37.5</span> 5. Social Impact</a></li>
  </ul></li>
  <li><a href="#appendix-g-introduction-to-rstudio-and-the-tidyverse" id="toc-appendix-g-introduction-to-rstudio-and-the-tidyverse" class="nav-link" data-scroll-target="#appendix-g-introduction-to-rstudio-and-the-tidyverse"><span class="header-section-number">1.38</span> Appendix G: Introduction to RStudio and the tidyverse</a>
  <ul class="collapse">
  <li><a href="#getting-started-with-rstudio" id="toc-getting-started-with-rstudio" class="nav-link" data-scroll-target="#getting-started-with-rstudio"><span class="header-section-number">1.38.1</span> Getting Started with RStudio</a></li>
  <li><a href="#the-tidyverse-ecosystem" id="toc-the-tidyverse-ecosystem" class="nav-link" data-scroll-target="#the-tidyverse-ecosystem"><span class="header-section-number">1.38.2</span> The tidyverse Ecosystem</a></li>
  <li><a href="#basic-tidyverse-workflow" id="toc-basic-tidyverse-workflow" class="nav-link" data-scroll-target="#basic-tidyverse-workflow"><span class="header-section-number">1.38.3</span> Basic tidyverse Workflow</a></li>
  <li><a href="#resources-for-learning-r" id="toc-resources-for-learning-r" class="nav-link" data-scroll-target="#resources-for-learning-r"><span class="header-section-number">1.38.4</span> Resources for Learning R</a></li>
  </ul></li>
  <li><a href="#appendix-h-supplementary-content" id="toc-appendix-h-supplementary-content" class="nav-link" data-scroll-target="#appendix-h-supplementary-content"><span class="header-section-number">1.39</span> Appendix H: Supplementary Content (*)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Science and Statistics</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="what-are-statistics-and-data-science" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="what-are-statistics-and-data-science"><span class="header-section-number">1.1</span> What are Statistics and Data Science?</h2>
<blockquote class="blockquote">
<p><strong>Important</strong></p>
<p>Statistics and data science are both the art and science of learning from data – they help us understand the world through methodical analysis of collected information.</p>
</blockquote>
<p>Statistics and data science provide essential tools for social science researchers, regardless of specialization. Whether you study political science, economics, sociology, or another social science field, these tools enable you to:</p>
<ul>
<li>Analyze social trends and behaviors</li>
<li>Measure the effects of various policies</li>
<li>Form conclusions based on empirical evidence rather than intuition</li>
</ul>
<p>Statistics provides the mathematical foundations for data analysis, including research design, information synthesis, and hypothesis testing. Data science extends these capabilities by combining statistics with programming skills and domain knowledge, enabling work with complex datasets.</p>
<p>In today’s digital era, with rapidly expanding available data, these analytical competencies have become essential for contemporary researchers and social science specialists.</p>
<blockquote class="blockquote">
<p><strong>Note</strong></p>
<p>In social sciences, data science constitutes a set of methods for solving complex research problems – combining statistical approaches, computational tools, and specialized knowledge to more effectively analyze social processes.</p>
</blockquote>
</section>
<section id="the-relationship-between-statistics-and-data-science" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="the-relationship-between-statistics-and-data-science"><span class="header-section-number">1.2</span> The Relationship Between Statistics and Data Science</h2>
<p>Rather than viewing statistics and data science as separate disciplines, it’s more helpful to see them as complementary approaches within the spectrum of data analysis methods. Data science can be understood as a contemporary extension of traditional statistics that has evolved in response to:</p>
<ul>
<li>New technological possibilities</li>
<li>The need to analyze increasingly complex social data</li>
<li>The availability of computational tools for handling large datasets</li>
</ul>
</section>
<section id="basic-concepts-in-data-science-and-statistics" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="basic-concepts-in-data-science-and-statistics"><span class="header-section-number">1.3</span> Basic Concepts in Data Science and Statistics</h2>
<section id="data-and-populations" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="data-and-populations"><span class="header-section-number">1.3.1</span> Data and Populations</h3>
<ol type="1">
<li><strong>Data</strong>: Information collected during research – this includes survey responses, experimental results, economic indicators, social media content, or any other measurable observations.</li>
</ol>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Understanding Different Types of Data Sets and Their Formats
</div>
</div>
<div class="callout-body-container callout-body">
<section id="cross-sectional-data" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="cross-sectional-data"><span class="header-section-number">1.3.2</span> Cross-sectional Data</h3>
<p>Observations collected at a single point in time across multiple entities/individuals:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Individual</th>
<th>Age</th>
<th>Income</th>
<th>Education</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>25</td>
<td>50000</td>
<td>Bachelor’s</td>
</tr>
<tr class="even">
<td>2</td>
<td>35</td>
<td>75000</td>
<td>Master’s</td>
</tr>
<tr class="odd">
<td>3</td>
<td>45</td>
<td>90000</td>
<td>PhD</td>
</tr>
</tbody>
</table>
</section>
<section id="time-series-data" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="time-series-data"><span class="header-section-number">1.3.3</span> Time Series Data</h3>
<p>Observations of a single entity tracked over multiple time points:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Year</th>
<th>GDP (in billions)</th>
<th>Unemployment Rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2018</td>
<td>20,580</td>
<td>3.9%</td>
</tr>
<tr class="even">
<td>2019</td>
<td>21,433</td>
<td>3.7%</td>
</tr>
<tr class="odd">
<td>2020</td>
<td>20,933</td>
<td>8.1%</td>
</tr>
</tbody>
</table>
</section>
<section id="panel-data-longitudinal-data" class="level3" data-number="1.3.4">
<h3 data-number="1.3.4" class="anchored" data-anchor-id="panel-data-longitudinal-data"><span class="header-section-number">1.3.4</span> Panel Data (Longitudinal Data)</h3>
<p>Observations of multiple entities tracked over time:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Country</th>
<th>Year</th>
<th>GDP per capita</th>
<th>Life Expectancy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>USA</td>
<td>2018</td>
<td>62,794</td>
<td>78.7</td>
</tr>
<tr class="even">
<td>USA</td>
<td>2019</td>
<td>65,118</td>
<td>78.8</td>
</tr>
<tr class="odd">
<td>Canada</td>
<td>2018</td>
<td>46,194</td>
<td>81.9</td>
</tr>
<tr class="even">
<td>Canada</td>
<td>2019</td>
<td>46,194</td>
<td>82.0</td>
</tr>
</tbody>
</table>
</section>
<section id="time-series-cross-sectional-tscs-data" class="level3" data-number="1.3.5">
<h3 data-number="1.3.5" class="anchored" data-anchor-id="time-series-cross-sectional-tscs-data"><span class="header-section-number">1.3.5</span> Time-series Cross-sectional (TSCS) Data</h3>
<p>A special case of panel data where:</p>
<ul>
<li>Number of time points &gt; Number of entities</li>
<li>Similar structure to panel data but with emphasis on temporal depth</li>
<li>Common in political science and economics research</li>
</ul>
</section>
<section id="data-formats" class="level3" data-number="1.3.6">
<h3 data-number="1.3.6" class="anchored" data-anchor-id="data-formats"><span class="header-section-number">1.3.6</span> Data Formats</h3>
<section id="wide-format" class="level4" data-number="1.3.6.1">
<h4 data-number="1.3.6.1" class="anchored" data-anchor-id="wide-format"><span class="header-section-number">1.3.6.1</span> Wide Format</h4>
<p>Each row represents an entity; columns represent variables/time points:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Country</th>
<th>GDP_2018</th>
<th>GDP_2019</th>
<th>LE_2018</th>
<th>LE_2019</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>USA</td>
<td>62,794</td>
<td>65,118</td>
<td>78.7</td>
<td>78.8</td>
</tr>
<tr class="even">
<td>Canada</td>
<td>46,194</td>
<td>46,194</td>
<td>81.9</td>
<td>82.0</td>
</tr>
</tbody>
</table>
</section>
<section id="long-format" class="level4" data-number="1.3.6.2">
<h4 data-number="1.3.6.2" class="anchored" data-anchor-id="long-format"><span class="header-section-number">1.3.6.2</span> Long Format</h4>
<p>Each row represents a unique entity-time-variable combination:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Country</th>
<th>Year</th>
<th>Variable</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>USA</td>
<td>2018</td>
<td>GDP per capita</td>
<td>62,794</td>
</tr>
<tr class="even">
<td>USA</td>
<td>2019</td>
<td>GDP per capita</td>
<td>65,118</td>
</tr>
<tr class="odd">
<td>USA</td>
<td>2018</td>
<td>Life Expectancy</td>
<td>78.7</td>
</tr>
<tr class="even">
<td>USA</td>
<td>2019</td>
<td>Life Expectancy</td>
<td>78.8</td>
</tr>
<tr class="odd">
<td>Canada</td>
<td>2018</td>
<td>GDP per capita</td>
<td>46,194</td>
</tr>
<tr class="even">
<td>Canada</td>
<td>2019</td>
<td>GDP per capita</td>
<td>46,194</td>
</tr>
<tr class="odd">
<td>Canada</td>
<td>2018</td>
<td>Life Expectancy</td>
<td>81.9</td>
</tr>
<tr class="even">
<td>Canada</td>
<td>2019</td>
<td>Life Expectancy</td>
<td>82.0</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> Long format is generally preferred for:</p>
<ul>
<li>Data manipulation in R and Python</li>
<li>Statistical analysis</li>
<li>Data visualization</li>
<li>Mixed-effects modeling</li>
<li>Repeated measures analyses</li>
</ul>
</section>
</section>
</div>
</div>
<ol start="2" type="1">
<li><strong>Population</strong>: The complete set of units (individuals, institutions, events) that the research concerns – the entire group about which the researcher wants to draw conclusions.
<ul>
<li><em>Example</em>: In a study of voting preferences, the population consists of all citizens eligible to vote in a given country.</li>
</ul></li>
<li><strong>Sample</strong>: A subset of the population selected for study. A <strong>representative</strong> sample reflects the key characteristics of the target population in appropriate proportions.
<ul>
<li><em>Example</em>: Instead of studying all eligible voters, researchers might analyze 1,500 randomly selected individuals, accounting for the appropriate distribution of age, gender, education, and region of residence.</li>
</ul></li>
</ol>
<p>A properly selected sample enables inference about the entire population while significantly reducing research costs and time.</p>
<ol start="4" type="1">
<li><strong>Sampling</strong>: The procedure of selecting individuals from a population for investigation. An unbiased sampling method gives every individual in the population an equal chance of selection, ensuring representative results.</li>
</ol>
<p>Essential methods of random sampling from a population:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Simple Random Sampling</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Stratified sampling</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Cluster sampling</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p><strong>Simple Random Sampling</strong>: Every individual has an equal probability of selection. The entire population is randomly sampled without any predetermined pattern.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/Simple_Random_Sampling2.svg" class="img-fluid figure-img"></p>
<figcaption>Simple Random Sampling. Retrieved from: https://app.passyourmath.com/courses/theory/116/1750/26640/en</figcaption>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p><strong>Stratified Sampling</strong>: The population is divided into distinct subgroups (strata) before random samples are drawn from each stratum proportionally.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/Stratified2.svg" class="img-fluid figure-img"></p>
<figcaption>Stratified Sampling. Retrieved from: https://app.passyourmath.com/courses/theory/116/1750/26640/en</figcaption>
</figure>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p><strong>Cluster Sampling</strong>: The population is divided into clusters, and entire clusters are randomly selected for analysis rather than individuals.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/Cluster2.svg" class="img-fluid figure-img"></p>
<figcaption>Cluster Sampling. Retrieved from: https://app.passyourmath.com/courses/theory/116/1750/26640/en</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ol start="5" type="1">
<li><strong>Statistical inference</strong>: The process of drawing conclusions about a population based on data from a sample. It involves:
<ul>
<li>Calculating estimates for population parameters</li>
<li>Assessing the reliability of these estimates</li>
<li>Testing hypotheses about population characteristics</li>
</ul></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/population_vs_sample.png" class="img-fluid figure-img"></p>
<figcaption>The process of using a sample to estimate a population parameter. In this example, a sample of 10 individuals found 6 who own an iPhone, yielding an estimated population proportion of 60%. The actual population proportion is 53.8%.</figcaption>
</figure>
</div>
</section>
<section id="statistical-inference-how-can-a-small-sample-represent-a-large-population" class="level3" data-number="1.3.7">
<h3 data-number="1.3.7" class="anchored"><span class="header-section-number">1.3.7</span> Statistical Inference: How Can a Small Sample Represent a Large Population?</h3>
<p>When pollsters survey just 1,000 voters to predict an election with 30,000,000 voters (only 0.003% of the population), it might seem puzzling. How can such a tiny fraction tell us about the whole?</p>
<p>It’s similar to tasting soup. When you cook a large pot of soup and stir it thoroughly, you don’t need to eat the entire pot to know how it tastes. A single spoonful is enough—as long as the soup is well-stirred.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Soup Analogy: A Taste of Statistics
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="stat_imgs/soup-svgrepo-com.svg" class="img-fluid" style="width:30.0%"></p>
<ul>
<li><strong>Exploratory Analysis</strong>: When you taste a spoonful of soup to assess its flavor, that’s exploratory/descriptive analysis.</li>
<li><strong>Statistical Inference</strong>: If you conclude your entire pot needs salt based on that spoonful, that’s making an inference.</li>
<li><strong>Sample vs.&nbsp;Population</strong>: Your spoonful is the sample; the entire pot is the population.</li>
<li><strong>Representative Sampling</strong>: For your inference to be valid, the spoonful you tasted needs to be representative of the entire pot.</li>
<li><strong>Well-Stirred Soup</strong>: We assume the soup is stirred well. This means any spoonful should taste similar to any other spoonful, allowing us to make reliable inferences about the whole pot from just one taste.</li>
</ul>
<section id="important" class="level3" data-number="1.3.8">
<h3 data-number="1.3.8" class="anchored" data-anchor-id="important"><span class="header-section-number">1.3.8</span> Important!</h3>
<ul>
<li><strong>Sample Size</strong>: Using a larger spoon (bigger sample) generally gives you more confidence about the entire pot’s flavor, even in a well-stirred soup.</li>
<li><strong>Variability</strong>: Despite being well-stirred, no two spoonfuls will be exactly identical - there’s always some natural variation in the distribution of ingredients.</li>
</ul>
</section>
</div>
</div>
<section id="why-random-sampling-works" class="level4" data-number="1.3.8.1">
<h4 data-number="1.3.8.1" class="anchored"><span class="header-section-number">1.3.8.1</span> Why Random Sampling Works</h4>
<p>Random sampling works because of three key principles:</p>
<ol type="1">
<li><p><strong>Equal opportunity</strong>: Every person in the population has the same chance of being selected, which prevents systematic bias.</p></li>
<li><p><strong>Representative diversity</strong>: When everyone has an equal chance, you naturally tend to get people from all different groups in roughly the same proportions as they exist in the population.</p>
<p><em>Example</em>: If 51% of voters are women, then about 51% of your random sample will likely be women (give or take some random variation).</p></li>
<li><p><strong>Law of large numbers</strong>: As your sample size (n) grows, random fluctuations become less influential and your sample statistics get closer to the true population values.</p>
<p><em>Example</em>: If you flip a fair coin 10 times, you might get 7 heads (70%). But if you flip it 1,000 times, you’re much more likely to get close to 500 heads (50%).</p></li>
</ol>
<p>Without proper random sampling, you could easily end up with a biased sample. For instance, if you only surveyed people at a shopping mall during weekday mornings, you’d miss most working people and students, giving you a skewed picture of the population.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Randomness: A Fundamental Law of Nature
</div>
</div>
<div class="callout-body-container callout-body">
<section id="the-nature-of-randomness" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="the-nature-of-randomness"><span class="header-section-number">1.4</span> The Nature of Randomness</h2>
<p>Randomness constitutes an intrinsic property of reality rather than merely reflecting limitations in our knowledge. It manifests as unpredictable patterns and probabilistic processes (stochastic processes) that permeate natural phenomena across multiple scales.</p>
</section>
<section id="manifestations-of-randomness-in-natural-systems" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="manifestations-of-randomness-in-natural-systems"><span class="header-section-number">1.5</span> Manifestations of Randomness in Natural Systems</h2>
<section id="quantum-mechanics-probabilistic-foundations-of-physical-reality" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="quantum-mechanics-probabilistic-foundations-of-physical-reality"><span class="header-section-number">1.5.1</span> <strong>Quantum Mechanics:</strong> Probabilistic Foundations of Physical Reality</h3>
<p>At subatomic scales, deterministic frameworks yield to probabilistic ones:</p>
<ul>
<li><p><strong>Heisenberg’s Uncertainty Principle:</strong> This principle establishes the impossibility of simultaneously determining paired physical properties (such as position and momentum) with arbitrary precision. The uncertainty is not due to measurement limitations but is a fundamental property of quantum systems themselves.</p>
<p><em>Example:</em> Electron positioning in atoms follows probability distributions rather than defined orbits. This quantum randomness enables nuclear fusion in stars—without it, electrons would spiral into nuclei and stars could not exist.</p></li>
<li><p><strong>Wave Function Collapse:</strong> Quantum entities exist in multiple potential states simultaneously (superposition). Upon measurement, these potentialities resolve into a single definite state following probability rules rather than causal mechanisms.</p>
<p><em>Example:</em> In the double-slit experiment, single particles pass through two slits simultaneously (as waves) but land as discrete points on a detector, with their specific landing positions being fundamentally unpredictable.</p></li>
</ul>
</section>
<section id="genetic-variation-and-evolutionary-processes" class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="genetic-variation-and-evolutionary-processes"><span class="header-section-number">1.5.2</span> <strong>Genetic Variation and Evolutionary Processes</strong></h3>
<p>Random variations in genetic information provide the raw material for natural selection:</p>
<ul>
<li><p><strong>Spontaneous Mutations:</strong> Random alterations in DNA sequences arise from molecular instabilities and thermodynamic fluctuations. These unpredictable changes generate novel traits that may influence an organism’s survival and reproduction.</p>
<p><em>Example:</em> A chance mutation in a bacteria’s DNA might confer antibiotic resistance. This random event, not a directed response to the antibiotic, enables survival when the population encounters the drug.</p></li>
<li><p><strong>Genetic Recombination:</strong> The exchange of genetic material during reproductive cell formation introduces randomized genetic combinations, creating diversity.</p>
<p><em>Example:</em> Human siblings share approximately 50% of their variable genes, yet the specific combination each receives is determined randomly during meiosis, explaining substantial differences between siblings.</p></li>
</ul>
</section>
<section id="chaos-theory-deterministic-systems-with-unpredictable-behavior" class="level3" data-number="1.5.3">
<h3 data-number="1.5.3" class="anchored" data-anchor-id="chaos-theory-deterministic-systems-with-unpredictable-behavior"><span class="header-section-number">1.5.3</span> <strong>Chaos Theory:</strong> Deterministic Systems with Unpredictable Behavior</h3>
<p>Systems governed by fixed mathematical rules can nonetheless exhibit apparent randomness:</p>
<ul>
<li><p><strong>Sensitivity to Initial Conditions:</strong> Minuscule variations in starting states amplify exponentially over time, rendering long-term predictions functionally impossible despite the system following deterministic laws.</p>
<p><em>Example:</em> Weather systems follow clear physical laws, yet a 10-day forecast remains challenging because a 0.1% measurement error today might result in predicting sunshine instead of a thunderstorm next week.</p></li>
<li><p><strong>Emergent Complexity:</strong> Simple iterative rules can generate patterns whose complexity necessitates statistical descriptions despite their deterministic origins.</p>
<p><em>Example:</em> The Mandelbrot set—an elegant mathematical pattern—derives from a simple equation (<span class="math inline">z_{n+1} = z_n^2 + c</span>), yet produces infinitely complex structures that appear random at various scales.</p></li>
</ul>
</section>
<section id="statistical-approaches-in-scientific-inquiry" class="level3" data-number="1.5.4">
<h3 data-number="1.5.4" class="anchored" data-anchor-id="statistical-approaches-in-scientific-inquiry"><span class="header-section-number">1.5.4</span> <strong>Statistical Approaches in Scientific Inquiry</strong></h3>
<p>Scientists leverage randomness to establish robust empirical frameworks:</p>
<ul>
<li><p><strong>Probabilistic Sampling Methods:</strong> Random selection procedures mitigate systematic bias and enable valid inferences about entire populations from representative subsets.</p>
<p><em>Example:</em> Political pollsters surveying 1,500 randomly selected voters can predict election outcomes for millions with approximately ±3% accuracy—a feat impossible with non-random sampling.</p></li>
<li><p><strong>Randomized Experimental Designs:</strong> The random allocation of experimental units to treatment conditions controls for interfering variables, including those not anticipated by investigators.</p>
<p><em>Example:</em> In pharmaceutical trials, patients receive either medication or placebo through randomization, ensuring that factors like age, diet, or genetic predispositions distribute evenly between groups.</p></li>
</ul>
</section>
</section>
<section id="methodological-applications-of-randomness" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="methodological-applications-of-randomness"><span class="header-section-number">1.6</span> Methodological Applications of Randomness</h2>
<section id="randomization-in-experimental-design" class="level3" data-number="1.6.1">
<h3 data-number="1.6.1" class="anchored" data-anchor-id="randomization-in-experimental-design"><span class="header-section-number">1.6.1</span> Randomization in Experimental Design</h3>
<p>The random assignment of subjects to experimental conditions serves multiple important functions:</p>
<p>✅ <strong>Mitigates selection bias:</strong> Prevents systematic distortion in how subjects are allocated to different conditions.</p>
<p>✅ <strong>Controls confounding variables:</strong> Distributes both known and unknown influencing factors equitably across experimental groups.</p>
<p>✅ <strong>Validates statistical inference:</strong> Establishes the foundation for probability calculations when testing hypotheses.</p>
<p><em>Example:</em> A researcher testing educational methods randomly assigns students to different instructional approaches. This randomization ensures that characteristics like intelligence, prior knowledge, and motivation are distributed similarly between groups, isolating the effect of the teaching method itself.</p>
</section>
<section id="probabilistic-sampling-frameworks" class="level3" data-number="1.6.2">
<h3 data-number="1.6.2" class="anchored" data-anchor-id="probabilistic-sampling-frameworks"><span class="header-section-number">1.6.2</span> Probabilistic Sampling Frameworks</h3>
<p>Random selection processes in sampling ensure representativeness and statistical validity:</p>
<p>✅ <strong>Equal selection probability:</strong> Each member of the population has the same chance of being included in the sample.</p>
<p>✅ <strong>Statistical generalizability:</strong> Allows quantification of sampling error and confidence in results.</p>
<p>✅ <strong>Unbiased estimation:</strong> Produces measurements whose average values converge to the true population values when repeated.</p>
<p><em>Example:</em> Quality control engineers randomly sample 50 units from a production line of 10,000 components. This approach provides accurate estimates of defect rates while inspecting only 0.5% of total production.</p>
</section>
</section>
<section id="philosophical-implications" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="philosophical-implications"><span class="header-section-number">1.7</span> Philosophical Implications</h2>
<p>The recognition of intrinsic randomness necessitates a shift from a completely deterministic worldview (where all events follow necessarily from prior causes) to a probabilistic understanding of reality. This transformation extends beyond scientific methodology to fundamental questions of causality, prediction, and knowledge:</p>
<ul>
<li><p><strong>Fundamental Indeterminism:</strong> Physical reality incorporates genuine unpredictability rather than merely apparent randomness due to incomplete information.</p></li>
<li><p><strong>Probabilistic Knowledge:</strong> Absolute certainty gives way to degrees of confidence and likelihood calculations as the highest attainable form of knowledge in fundamental domains.</p></li>
<li><p><strong>Probabilistic Models:</strong> Mathematical frameworks incorporating randomness often demonstrate superior predictive power and conceptual usefulness compared to purely deterministic alternatives.</p></li>
</ul>
<p><em>Example:</em> Modern computational approaches to protein folding integrate both physics-based algorithms and stochastic sampling methods. This hybrid approach—acknowledging both deterministic forces and inherent randomness—has yielded breakthroughs impossible with purely deterministic models.</p>
<p>This paradigm shift enables more sophisticated approaches to complexity, variability, and uncertainty, enhancing both theoretical understanding and practical applications across scientific disciplines.</p>
</section>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="population-parameters-and-statistical-estimation" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="population-parameters-and-statistical-estimation"><span class="header-section-number">1.8</span> <strong>Population Parameters and Statistical Estimation</strong></h2>
<section id="population-parameters" class="level3" data-number="1.8.1">
<h3 data-number="1.8.1" class="anchored" data-anchor-id="population-parameters"><span class="header-section-number">1.8.1</span> <strong>Population Parameters</strong></h3>
<p>A <strong>population parameter</strong> (<span class="math inline">\theta</span>) is a numerical value that describes a specific characteristic of an entire population. These parameters are typically unknown and are estimated using sample data.</p>
<section id="common-population-parameters" class="level4" data-number="1.8.1.1">
<h4 data-number="1.8.1.1" class="anchored" data-anchor-id="common-population-parameters"><span class="header-section-number">1.8.1.1</span> <strong>Common Population Parameters</strong></h4>
<ul>
<li><span class="math inline">\mu</span> (Population Mean): The average value of the population.<br>
</li>
<li><span class="math inline">\sigma^2</span> (Population Variance): The average squared deviation from the mean.<br>
</li>
<li><span class="math inline">\sigma</span> (Population Standard Deviation): The square root of the variance, measuring the spread of the population.<br>
</li>
<li><span class="math inline">p</span> (Population Proportion): The fraction of the population that exhibits a specific characteristic.</li>
</ul>
<p>Since studying an entire population is often impractical, we rely on samples to estimate these parameters.</p>
<hr>
</section>
</section>
</section>
<section id="statistical-estimation-concepts" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="statistical-estimation-concepts"><span class="header-section-number">1.9</span> Statistical Estimation Concepts</h2>
<section id="population-parameters-vs.-sample-statistics" class="level3" data-number="1.9.1">
<h3 data-number="1.9.1" class="anchored" data-anchor-id="population-parameters-vs.-sample-statistics"><span class="header-section-number">1.9.1</span> Population Parameters vs.&nbsp;Sample Statistics</h3>
<p>In statistics, we often want to learn about an entire <strong>population</strong>, but we usually can’t measure everyone. Instead, we take a <strong>sample</strong> and compute values from it. These sample-based values help us estimate <strong>population parameters</strong>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Key Difference:</strong><br>
- A <strong>population parameter</strong> (denoted by <span class="math inline">\theta</span>) is a fixed but unknown value that describes the entire population.<br>
- A <strong>sample statistic</strong> (denoted by <span class="math inline">\hat{\theta}</span> when used for estimation) is calculated from sample data and used to estimate the population parameter.</p>
</div>
</div>
<section id="examples-of-population-parameters-and-sample-statistics" class="level4" data-number="1.9.1.1">
<h4 data-number="1.9.1.1" class="anchored" data-anchor-id="examples-of-population-parameters-and-sample-statistics"><span class="header-section-number">1.9.1.1</span> Examples of Population Parameters and Sample Statistics</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 37%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Concept</strong></th>
<th><strong>Population Parameter (Unknown, Fixed)</strong></th>
<th><strong>Sample Statistic (Computed from Sample Data)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mean (average)</td>
<td><span class="math inline">\theta = \mu</span> (true population mean)</td>
<td><span class="math inline">\hat{\theta} = \bar{x}</span> (sample mean)</td>
</tr>
<tr class="even">
<td>Variance</td>
<td><span class="math inline">\theta = \sigma^2</span> (true population variance)</td>
<td><span class="math inline">\hat{\theta} = s^2</span> (sample variance)</td>
</tr>
<tr class="odd">
<td>Proportion</td>
<td><span class="math inline">\theta = p</span> (true proportion)</td>
<td><span class="math inline">\hat{\theta} = \hat{p}</span> (sample proportion)</td>
</tr>
</tbody>
</table>
<p>Since we <strong>cannot observe</strong> <span class="math inline">\theta</span> directly, we use a <strong>sample statistic</strong> (like <span class="math inline">\hat{\theta}</span>) to estimate it.</p>
<hr>
</section>
</section>
<section id="what-is-an-estimand" class="level3" data-number="1.9.2">
<h3 data-number="1.9.2" class="anchored" data-anchor-id="what-is-an-estimand"><span class="header-section-number">1.9.2</span> What is an Estimand?</h3>
<p>An <strong>estimand</strong> is the specific population parameter <span class="math inline">\theta</span> that we aim to estimate. It represents the unknown quantity in the population that we are trying to determine.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Example:</strong><br>
- If we want to know the <strong>average height of all adults in a country</strong>, the true population mean <strong>(</strong><span class="math inline">\theta = \mu</span>) is the <strong>estimand</strong>.<br>
- If we want to estimate the <strong>proportion of voters supporting a candidate</strong>, the true population proportion <strong>(</strong><span class="math inline">\theta = p</span>) is the <strong>estimand</strong>.</p>
</div>
</div>
<hr>
</section>
<section id="what-is-an-estimator" class="level3" data-number="1.9.3">
<h3 data-number="1.9.3" class="anchored" data-anchor-id="what-is-an-estimator"><span class="header-section-number">1.9.3</span> What is an Estimator?</h3>
<p>An <strong>estimator</strong> is a <strong>rule, formula, or function</strong> that we apply to a sample to estimate the population parameter <span class="math inline">\theta</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Key Idea:</strong><br>
- <strong>An estimator is a procedure, not a specific number!</strong><br>
- Since different samples give different results, an estimator is a <strong>random variable</strong>, meaning its value depends on the sample chosen.</p>
</div>
</div>
<section id="notation" class="level4" data-number="1.9.3.1">
<h4 data-number="1.9.3.1" class="anchored" data-anchor-id="notation"><span class="header-section-number">1.9.3.1</span> Notation</h4>
<ul>
<li><span class="math inline">\theta</span> = True population parameter (unknown)<br>
</li>
<li><span class="math inline">\hat{\theta}</span> = Estimator (a function of sample data)</li>
</ul>
</section>
<section id="common-estimators" class="level4" data-number="1.9.3.2">
<h4 data-number="1.9.3.2" class="anchored" data-anchor-id="common-estimators"><span class="header-section-number">1.9.3.2</span> Common Estimators</h4>
<ul>
<li><p><strong>Sample Mean (Estimator of</strong> <span class="math inline">\mu</span>):<br>
<span class="math display">
\hat{\theta} = \bar{x} = \frac{1}{n} \sum_{i=1}^{n} x_i
</span></p></li>
<li><p><strong>Sample Variance (Estimator of</strong> <span class="math inline">\sigma^2</span>):<br>
<span class="math display">
\hat{\theta} = s^2 = \frac{1}{n-1} \sum_{i=1}^{n} (x_i - \bar{x})^2
</span></p></li>
<li><p><strong>Sample Proportion (Estimator of</strong> <span class="math inline">p</span>):<br>
<span class="math display">
\hat{\theta} = \hat{p} = \frac{x}{n}
</span></p></li>
</ul>
<hr>
</section>
</section>
<section id="what-is-an-estimate" class="level3" data-number="1.9.4">
<h3 data-number="1.9.4" class="anchored" data-anchor-id="what-is-an-estimate"><span class="header-section-number">1.9.4</span> What is an Estimate?</h3>
<p>An <strong>estimate</strong> is the specific numerical value obtained when an estimator <span class="math inline">\hat{\theta}</span> is applied to a sample.</p>
<section id="example-estimating-the-average-height-of-adults" class="level4" data-number="1.9.4.1">
<h4 data-number="1.9.4.1" class="anchored" data-anchor-id="example-estimating-the-average-height-of-adults"><span class="header-section-number">1.9.4.1</span> Example: Estimating the Average Height of Adults</h4>
<ul>
<li><strong>Estimand</strong>: The true population mean height <strong>(</strong><span class="math inline">\theta = \mu</span>) (unknown).<br>
</li>
<li><strong>Estimator</strong>: The formula for the sample mean <span class="math inline">\hat{\theta} = \bar{x} = \frac{1}{n} \sum x_i</span>.<br>
</li>
<li><strong>Estimate</strong>: A specific number, like <strong>173.5 cm</strong>, obtained from one sample.</li>
</ul>
<hr>
</section>
</section>
<section id="what-makes-a-good-estimator" class="level3" data-number="1.9.5">
<h3 data-number="1.9.5" class="anchored" data-anchor-id="what-makes-a-good-estimator"><span class="header-section-number">1.9.5</span> What Makes a Good Estimator?</h3>
<p>When we use data to estimate something—like the average height of students in a school—we want our estimate to be as <strong>accurate and reliable</strong> as possible. A <strong>good estimator</strong> should have these four key properties:</p>
<section id="unbiasedness-no-systematic-error" class="level4" data-number="1.9.5.1">
<h4 data-number="1.9.5.1" class="anchored" data-anchor-id="unbiasedness-no-systematic-error"><span class="header-section-number">1.9.5.1</span> 1️⃣ Unbiasedness: No Systematic Error</h4>
<p>A good estimator should, on average, get the right answer! If we take many different samples and compute their estimates, the <strong>average of all these estimates</strong> should be equal to the true value we’re trying to estimate (<span class="math inline">\theta</span>).</p>
<p>Mathematically, this means:<br>
<span class="math display">
E(\hat{\theta}) = \theta
</span><br>
Here, <span class="math inline">E(\hat{\theta})</span> (called the <strong>expectation operator</strong>) represents the <strong>average value of</strong> <span class="math inline">\hat{\theta}</span> over many samples. In simple terms, if we repeated our study over and over, the long-run average of our estimates should be the true value <span class="math inline">\theta</span>. This ensures our estimator isn’t <strong>systematically too high or too low</strong>—it doesn’t have built-in bias.</p>
</section>
<section id="efficiency-as-little-variability-as-possible" class="level4" data-number="1.9.5.2">
<h4 data-number="1.9.5.2" class="anchored" data-anchor-id="efficiency-as-little-variability-as-possible"><span class="header-section-number">1.9.5.2</span> 2️⃣ Efficiency: As Little Variability as Possible</h4>
<p>Even if an estimator is unbiased, it can still be <strong>all over the place</strong>. A <strong>good</strong> estimator is one that has the least variability—it tends to give values <strong>close together</strong> rather than being spread out. The less it jumps around, the more <strong>trustworthy</strong> it is.</p>
</section>
<section id="consistency-more-data-better-accuracy" class="level4" data-number="1.9.5.3">
<h4 data-number="1.9.5.3" class="anchored" data-anchor-id="consistency-more-data-better-accuracy"><span class="header-section-number">1.9.5.3</span> 3️⃣ Consistency: More Data = Better Accuracy</h4>
<p>A <strong>consistent estimator</strong> gets closer to the true value <strong>as we collect more data</strong>. If we take a tiny sample, our estimate might be way off, but if we collect <strong>more and more data</strong>, our estimate should settle down near the true value <span class="math inline">\theta</span>.</p>
</section>
<section id="sufficiency-uses-all-the-information-in-the-data" class="level4" data-number="1.9.5.4">
<h4 data-number="1.9.5.4" class="anchored" data-anchor-id="sufficiency-uses-all-the-information-in-the-data"><span class="header-section-number">1.9.5.4</span> 4️⃣ Sufficiency: Uses All the Information in the Data</h4>
<p>A <strong>sufficient estimator</strong> makes the best possible use of the data. It doesn’t <strong>waste information</strong> or leave anything important out. If we have all the numbers from our sample, a sufficient estimator ensures we’re squeezing out every useful bit of insight.</p>
<hr>
</section>
</section>
<section id="why-do-estimates-vary-the-sampling-distribution" class="level3" data-number="1.9.6">
<h3 data-number="1.9.6" class="anchored"><span class="header-section-number">1.9.6</span> Why Do Estimates Vary? (The Sampling Distribution)</h3>
<p>If we take different samples from a population, we’ll get different estimates. To understand this variation, we look at something called the <strong>sampling distribution</strong>—which tells us how our estimates behave across many samples.</p>
<section id="key-ideas-about-sampling-distributions" class="level4" data-number="1.9.6.1">
<h4 data-number="1.9.6.1" class="anchored" data-anchor-id="key-ideas-about-sampling-distributions"><span class="header-section-number">1.9.6.1</span> Key Ideas About Sampling Distributions</h4>
<ol type="1">
<li><strong>Every sample gives a different estimate</strong>—If two people take separate surveys, they’ll probably get slightly different results.<br>
</li>
<li><strong>These differences follow a pattern</strong>—The <strong>sampling distribution</strong> describes how estimates are spread out.<br>
</li>
<li><strong>Bigger samples give more stable estimates</strong>—Larger samples tend to produce estimates that are closer to the true value.<br>
</li>
<li><strong>Understanding sampling distributions helps us measure uncertainty</strong>—That’s why we use them for confidence intervals and hypothesis tests.</li>
</ol>
</section>
<section id="example-the-sample-mean" class="level4" data-number="1.9.6.2">
<h4 data-number="1.9.6.2" class="anchored"><span class="header-section-number">1.9.6.2</span> Example: The Sample Mean</h4>
<p>Imagine we take many samples from a population and calculate the <strong>average</strong> each time. These sample means will form a <strong>sampling distribution</strong>, centered around the true population mean <span class="math inline">\mu</span>.</p>
<p>Mathematically, the sample mean is:<br>
<span class="math display">
\hat{\theta} = \bar{x} = \frac{1}{n} \sum_{i=1}^{n} x_i
</span><br>
where <span class="math inline">x_1, x_2, ..., x_n</span> are the sample values.</p>
<p>This tells us that if we keep taking samples, the <strong>average of our sample means</strong> will be close to the real population mean <span class="math inline">\mu</span>.</p>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Normal Distribution - Foundation of Probability Theory
</div>
</div>
<div class="callout-body-container callout-body">
<section id="probability-distributions" class="level2" data-number="1.10">
<h2 data-number="1.10" class="anchored" data-anchor-id="probability-distributions"><span class="header-section-number">1.10</span> Probability Distributions</h2>
<p>A probability distribution is a mathematical function that assigns probabilities to all possible outcomes of a random variable. Key types include:</p>
<ul>
<li><strong>Discrete distributions</strong>: For countable outcomes (e.g., binomial, Poisson)</li>
<li><strong>Continuous distributions</strong>: For intervals of values (e.g., normal, exponential)</li>
</ul>
</section>
<section id="the-normal-distribution-key-properties" class="level2" data-number="1.11">
<h2 data-number="1.11" class="anchored" data-anchor-id="the-normal-distribution-key-properties"><span class="header-section-number">1.11</span> The Normal Distribution: Key Properties</h2>
<p>The normal (Gaussian) distribution is characterized by perfect symmetry and described by the function:</p>
<p><span class="math display">f(x) = \frac{1}{\sigma\sqrt{2\pi}}e^{-\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^2}</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\mu</span> (mu): Mean, determining the central location</li>
<li><span class="math inline">\sigma</span> (sigma): Standard deviation, determining the spread</li>
</ul>
<p>Main characteristics:</p>
<ol type="1">
<li><strong>Symmetry</strong> around the mean</li>
<li><strong>Unimodality</strong>: Single peak coinciding with the mean and median</li>
<li><strong>Inflection points</strong> exactly at <span class="math inline">\mu \pm \sigma</span></li>
</ol>
</section>
<section id="standard-normal-distribution-and-the-empirical-rule" class="level2" data-number="1.12">
<h2 data-number="1.12" class="anchored" data-anchor-id="standard-normal-distribution-and-the-empirical-rule"><span class="header-section-number">1.12</span> Standard Normal Distribution and the Empirical Rule</h2>
<p>When standardized (<span class="math inline">Z = \frac{X-\mu}{\sigma}</span>), we obtain the standard normal (Z) distribution with <span class="math inline">\mu = 0</span> and <span class="math inline">\sigma = 1</span>.</p>
<section id="the-68-95-99.7-rule" class="level3" data-number="1.12.1">
<h3 data-number="1.12.1" class="anchored" data-anchor-id="the-68-95-99.7-rule"><span class="header-section-number">1.12.1</span> The 68-95-99.7 Rule</h3>
<ul>
<li>68.27% of data falls within <span class="math inline">\mu \pm 1\sigma</span></li>
<li>95.45% of data falls within <span class="math inline">\mu \pm 2\sigma</span></li>
<li>99.73% of data falls within <span class="math inline">\mu \pm 3\sigma</span></li>
</ul>
<p><em>Example:</em> For male heights with mean <span class="math inline">\mu = 175</span> cm and <span class="math inline">\sigma = 7</span> cm, approximately 95% of men have heights between 161 and 189 cm.</p>
</section>
<section id="the-central-limit-theorem" class="level3" data-number="1.12.2">
<h3 data-number="1.12.2" class="anchored" data-anchor-id="the-central-limit-theorem"><span class="header-section-number">1.12.2</span> The Central Limit Theorem</h3>
<p>This cornerstone of statistics states that sample means approach a normal distribution as sample size increases, regardless of the population’s original distribution.</p>
<p><em>Practical significance:</em> Even when data is not normally distributed (e.g., reaction times are typically skewed), means from multiple groups will approximate a normal distribution.</p>
</section>
</section>
<section id="practical-applications" class="level2" data-number="1.13">
<h2 data-number="1.13" class="anchored" data-anchor-id="practical-applications"><span class="header-section-number">1.13</span> Practical Applications</h2>
<ol type="1">
<li><strong>Hypothesis testing</strong>: t-tests and Z-tests</li>
<li><strong>Confidence intervals</strong>: Estimating population parameters</li>
<li><strong>Regression analysis</strong>: Modeling relationships</li>
<li><strong>Quality control</strong>: Monitoring processes</li>
</ol>
<p><em>Example:</em> Pharmaceutical researchers measuring patient improvement first verify the normality assumption of their data. Based on the results, they select either parametric tests (t-test) or non-parametric alternatives (Mann-Whitney test) to determine statistical significance.</p>
</section>
<section id="visualization" class="level2" data-number="1.14">
<h2 data-number="1.14" class="anchored" data-anchor-id="visualization"><span class="header-section-number">1.14</span> Visualization</h2>
<p>The normal distribution creates a characteristic bell curve, with most observations clustering around the mean and extreme values becoming increasingly rare:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define parameters</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span>        <span class="co"># Mean</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span>     <span class="co"># Standard deviation</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sequence of x values</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(mu <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>sigma, mu <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>sigma, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the corresponding y values (probability density)</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame for plotting</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>normal_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate regions for the empirical rule</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>sd1_min <span class="ot">&lt;-</span> mu <span class="sc">-</span> sigma</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>sd1_max <span class="ot">&lt;-</span> mu <span class="sc">+</span> sigma</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>sd2_min <span class="ot">&lt;-</span> mu <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>sigma</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>sd2_max <span class="ot">&lt;-</span> mu <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>sigma</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>sd3_min <span class="ot">&lt;-</span> mu <span class="sc">-</span> <span class="dv">3</span><span class="sc">*</span>sigma</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>sd3_max <span class="ot">&lt;-</span> mu <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>sigma</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(normal_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fill in areas for empirical rule</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> <span class="fu">subset</span>(normal_df, x <span class="sc">&gt;=</span> sd1_min <span class="sc">&amp;</span> x <span class="sc">&lt;=</span> sd1_max), </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">"darkblue"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> <span class="fu">subset</span>(normal_df, (x <span class="sc">&gt;=</span> sd2_min <span class="sc">&amp;</span> x <span class="sc">&lt;</span> sd1_min) <span class="sc">|</span> (x <span class="sc">&gt;</span> sd1_max <span class="sc">&amp;</span> x <span class="sc">&lt;=</span> sd2_max)), </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> <span class="fu">subset</span>(normal_df, (x <span class="sc">&gt;=</span> sd3_min <span class="sc">&amp;</span> x <span class="sc">&lt;</span> sd2_min) <span class="sc">|</span> (x <span class="sc">&gt;</span> sd2_max <span class="sc">&amp;</span> x <span class="sc">&lt;=</span> sd3_max)), </span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add vertical lines at standard deviations</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(sd1_min, sd1_max), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(sd2_min, sd2_max), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(sd3_min, sd3_max), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add mean line</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mu, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add annotations</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">label =</span> <span class="st">"68.27%"</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">label =</span> <span class="st">"13.59%"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">label =</span> <span class="st">"13.59%"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">2.5</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">label =</span> <span class="st">"2.14%"</span>, <span class="at">color =</span> <span class="st">"lightblue"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">label =</span> <span class="st">"2.14%"</span>, <span class="at">color =</span> <span class="st">"lightblue"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Standard Normal Distribution and the Empirical Rule"</span>,</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Illustrating the 68-95-99.7 Rule"</span>,</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Z-score (Standard Deviations from Mean)"</span>,</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probability Density"</span>) <span class="sc">+</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="philosophical-significance" class="level2" data-number="1.15">
<h2 data-number="1.15" class="anchored" data-anchor-id="philosophical-significance"><span class="header-section-number">1.15</span> Philosophical Significance</h2>
<p>The normal distribution demonstrates how randomness at the individual level can create predictable patterns at the collective level. It represents one of the most important connections between determinism and randomness in science.</p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Types of Data and Variables
</div>
</div>
<div class="callout-body-container callout-body">
<p>Data forms the empirical basis for all statistical reasoning. The nature of your data determines which analytical methods are appropriate, what conclusions can be drawn, and what limitations exist in your interpretation.</p>
<section id="data-acquisition-methods" class="level2" data-number="1.16">
<h2 data-number="1.16" class="anchored" data-anchor-id="data-acquisition-methods"><span class="header-section-number">1.16</span> Data Acquisition Methods</h2>
<ol type="1">
<li><strong>Primary Data</strong>: Collected firsthand specifically for the current research question
<ul>
<li><em>Examples</em>: Experimental measurements, surveys, interviews, observations</li>
<li><em>Strengths</em>: Direct relevance, control over collection methods, known quality parameters</li>
<li><em>Limitations</em>: Resource-intensive, potential researcher bias</li>
</ul></li>
<li><strong>Secondary Data</strong>: Obtained from pre-existing sources not specifically designed for your research
<ul>
<li><em>Examples</em>: Census data, administrative records, published research data, commercial databases</li>
<li><em>Strengths</em>: Cost-effective, often larger sample sizes, longitudinal availability</li>
<li><em>Limitations</em>: Potential relevance gaps, unknown quality issues, limited control over variables</li>
</ul></li>
</ol>
</section>
<section id="fundamental-data-structures" class="level2" data-number="1.17">
<h2 data-number="1.17" class="anchored" data-anchor-id="fundamental-data-structures"><span class="header-section-number">1.17</span> Fundamental Data Structures</h2>
<ol type="1">
<li><strong>Cross-sectional Data</strong>: Observations collected at a single point in time
<ul>
<li><em>Example</em>: Survey of 1,000 households conducted in March 2023</li>
</ul></li>
<li><strong>Time Series Data</strong>: Observations of a single entity collected over multiple time periods
<ul>
<li><em>Example</em>: Monthly unemployment rates for a country from 2000-2023</li>
</ul></li>
<li><strong>Panel/Longitudinal Data</strong>: Observations of multiple entities collected over multiple time periods
<ul>
<li><em>Example</em>: Health measurements of 500 patients tracked quarterly over five years</li>
</ul></li>
<li><strong>Hierarchical/Clustered Data</strong>: Observations organized in nested levels
<ul>
<li><em>Example</em>: Student performance within classrooms within schools within districts</li>
</ul></li>
</ol>
</section>
<section id="variable-classifications" class="level2" data-number="1.18">
<h2 data-number="1.18" class="anchored" data-anchor-id="variable-classifications"><span class="header-section-number">1.18</span> Variable Classifications</h2>
<section id="by-mathematical-properties" class="level3" data-number="1.18.1">
<h3 data-number="1.18.1" class="anchored" data-anchor-id="by-mathematical-properties"><span class="header-section-number">1.18.1</span> By Mathematical Properties</h3>
<ol type="1">
<li><p><strong>Quantitative Variables</strong>: Represent numerical quantities that can be measured</p>
<ol type="a">
<li><strong>Continuous Variables</strong>: Can take any value within a range (limited only by measurement precision)
<ul>
<li><em>Examples</em>: Height (172.68 cm), weight (68.3 kg), temperature (36.7°C), time (3.82 seconds)</li>
<li><em>Analysis methods</em>: Mean, standard deviation, histograms, t-tests, regression</li>
</ul></li>
<li><strong>Discrete Variables</strong>: Take specific, countable values, often integers
<ul>
<li><em>Examples</em>: Number of children (3), errors in a document (12), customer count (548)</li>
<li><em>Analysis methods</em>: Frequency tables, mode, Poisson regression</li>
</ul></li>
</ol></li>
<li><p><strong>Qualitative Variables</strong>: Represent categories or qualities</p>
<ol type="a">
<li><strong>Nominal Variables</strong>: Categories with no inherent order or ranking
<ul>
<li><em>Examples</em>: Blood type (A, B, AB, O), gender, country, product type</li>
<li><em>Analysis methods</em>: Frequency tables, mode, chi-square tests, categorical visualization</li>
</ul></li>
<li><strong>Ordinal Variables</strong>: Categories with a natural ordering but unknown or inconsistent intervals
<ul>
<li><em>Examples</em>: Education level (primary, secondary, undergraduate, graduate), satisfaction ratings (poor, fair, good, excellent), socioeconomic status (low, middle, high)</li>
<li><em>Analysis methods</em>: Median, percentiles, non-parametric tests, ordinal regression</li>
</ul></li>
</ol></li>
</ol>
</section>
<section id="by-measurement-scale" class="level3" data-number="1.18.2">
<h3 data-number="1.18.2" class="anchored" data-anchor-id="by-measurement-scale"><span class="header-section-number">1.18.2</span> By Measurement Scale</h3>
<ol type="1">
<li><strong>Nominal Scale</strong>: Classification without order (qualitative, categories)
<ul>
<li><em>Properties</em>: Equality/inequality can be determined</li>
<li><em>Operations</em>: Mode, frequency counts, category membership</li>
</ul></li>
<li><strong>Ordinal Scale</strong>: Classification with order but inconsistent intervals
<ul>
<li><em>Properties</em>: Greater than/less than relationships can be determined</li>
<li><em>Operations</em>: Median, percentiles, rank-order correlations</li>
</ul></li>
<li><strong>Interval Scale</strong>: Ordered with consistent intervals but no meaningful zero point
<ul>
<li><em>Examples</em>: Temperature (°C, °F), calendar dates, IQ scores</li>
<li><em>Properties</em>: Differences between values are meaningful</li>
<li><em>Operations</em>: Mean, standard deviation, addition/subtraction</li>
</ul></li>
<li><strong>Ratio Scale</strong>: Ordered with consistent intervals and a meaningful zero point
<ul>
<li><em>Examples</em>: Height, weight, income, reaction time, absolute temperature (K)</li>
<li><em>Properties</em>: Ratios between values are meaningful (10kg is twice as heavy as 5kg)</li>
<li><em>Operations</em>: All arithmetic operations, geometric mean, coefficient of variation</li>
</ul></li>
</ol>
</section>
<section id="by-role-in-analysis" class="level3" data-number="1.18.3">
<h3 data-number="1.18.3" class="anchored" data-anchor-id="by-role-in-analysis"><span class="header-section-number">1.18.3</span> By Role in Analysis</h3>
<ol type="1">
<li><strong>Independent Variables</strong> (predictors, explanatory variables): Variables manipulated or selected to examine their effect on dependent variables
<ul>
<li><em>Example</em>: Drug dosage in a clinical trial</li>
</ul></li>
<li><strong>Dependent Variables</strong> (response variables, outcomes): Variables measured to assess the effect of independent variables
<ul>
<li><em>Example</em>: Blood pressure reduction after drug administration</li>
</ul></li>
<li><strong>Confounding Variables</strong>: Uncontrolled variables that may influence the relationship between independent and dependent variables
<ul>
<li><em>Example</em>: Patient age affecting both treatment choice and recovery outcome</li>
</ul></li>
<li><strong>Control Variables</strong>: Variables held constant or adjusted for statistically
<ul>
<li><em>Example</em>: Educational background in an analysis of income determinants</li>
</ul></li>
</ol>
<p>Understanding your data’s nature ensures you select appropriate statistical methods, avoiding misleading conclusions from methodological mismatches.</p>
</section>
</section>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="statistical-inference-an-informal-introduction" class="level2" data-number="1.19">
<h2 data-number="1.19" class="anchored" data-anchor-id="statistical-inference-an-informal-introduction"><span class="header-section-number">1.19</span> Statistical Inference: An Informal Introduction</h2>
<p>Statistical inference is the process of drawing conclusions about a population based on sample data. Think of it as making educated guesses about the whole pizza after tasting just one slice. It encompasses two main areas:</p>
</section>
<section id="estimation" class="level2" data-number="1.20">
<h2 data-number="1.20" class="anchored" data-anchor-id="estimation"><span class="header-section-number">1.20</span> Estimation</h2>
<p>Estimation is the process of using sample data to estimate unknown population parameters. We distinguish:</p>
<ul>
<li><strong>Point estimation</strong>: Providing a single value as the best approximation of the parameter (like saying “I think the average height is exactly 174 cm”)</li>
<li><strong>Interval estimation</strong>: Constructing a confidence interval that indicates the range of possible parameter values consistent with our data (like saying “I’m reasonably confident the average height is between 173 cm and 175 cm”)</li>
</ul>
<p>Example of a confidence interval: “The 95% confidence interval for the average height of adults is (173 cm, 175 cm).”</p>
<p><strong>Correct interpretation of confidence interval</strong>: If we were to repeatedly take samples from the same population and construct a 95% confidence interval for each sample using the same method, about 95% of these intervals would contain the true population parameter value.</p>
<p><strong>Incorrect interpretation</strong>: “There is a 95% chance that the true mean is in the interval (173 cm, 175 cm)” – this is incorrect because the population parameter is a fixed (though unknown) value, not a random variable. It’s like saying “either the true value is in this interval or it isn’t” - the 95% refers to the method’s reliability, not the probability of containing the true value in any single interval.</p>
</section>
<section id="hypothesis-testing" class="level2" data-number="1.21">
<h2 data-number="1.21" class="anchored" data-anchor-id="hypothesis-testing"><span class="header-section-number">1.21</span> Hypothesis Testing</h2>
<p>Hypothesis testing is a way to check if a claim about a group (or population) is likely true or not. It’s like being a detective: you gather evidence (data) and decide whether the evidence supports your claim.</p>
<section id="example-1-testing-if-a-coin-is-biased-toward-heads" class="level3" data-number="1.21.1">
<h3 data-number="1.21.1" class="anchored" data-anchor-id="example-1-testing-if-a-coin-is-biased-toward-heads"><span class="header-section-number">1.21.1</span> Example 1: Testing if a Coin is Biased Toward Heads</h3>
<p>Imagine your friend has a coin that seems to land on heads more often than tails. Let’s test if this observation holds up to scrutiny.</p>
<section id="step-1-ask-the-research-question" class="level4" data-number="1.21.1.1">
<h4 data-number="1.21.1.1" class="anchored" data-anchor-id="step-1-ask-the-research-question"><span class="header-section-number">1.21.1.1</span> Step 1: Ask the Research Question</h4>
<ul>
<li><strong>Question</strong>: Is the coin biased toward heads? (Is the probability of heads greater than 0.5?)</li>
</ul>
</section>
<section id="step-2-set-up-two-hypotheses" class="level4" data-number="1.21.1.2">
<h4 data-number="1.21.1.2" class="anchored" data-anchor-id="step-2-set-up-two-hypotheses"><span class="header-section-number">1.21.1.2</span> Step 2: Set Up Two Hypotheses</h4>
<ul>
<li><strong>Null Hypothesis (H₀)</strong>: The coin is fair. (Probability of heads = 0.5)</li>
<li><strong>Alternative Hypothesis (H₁)</strong>: The coin is biased toward heads. (Probability of heads &gt; 0.5)</li>
</ul>
<p>Think of the null hypothesis as the “innocent until proven guilty” position. We assume the coin is fair unless our evidence strongly suggests otherwise.</p>
</section>
<section id="step-3-collect-data" class="level4" data-number="1.21.1.3">
<h4 data-number="1.21.1.3" class="anchored" data-anchor-id="step-3-collect-data"><span class="header-section-number">1.21.1.3</span> Step 3: Collect Data</h4>
<ul>
<li>You flip the coin 100 times and get <strong>65 heads</strong>.</li>
</ul>
</section>
<section id="step-4-analyze-the-data" class="level4" data-number="1.21.1.4">
<h4 data-number="1.21.1.4" class="anchored" data-anchor-id="step-4-analyze-the-data"><span class="header-section-number">1.21.1.4</span> Step 4: Analyze the Data</h4>
<ul>
<li>If the coin were fair, you’d expect around 50 heads in 100 flips.</li>
<li>Getting 65 heads is more than we’d expect, but is it enough to conclude the coin is biased?</li>
<li>The standard deviation (a measure of how much results typically vary) for 100 fair coin flips is 5.</li>
<li>Getting 65 heads is <strong>3 standard deviations above</strong> the expected 50 heads. This is like a basketball player who normally scores 20 points per game suddenly scoring 35 - it’s unusual!</li>
</ul>
</section>
<section id="step-5-calculate-the-p-value" class="level4" data-number="1.21.1.5">
<h4 data-number="1.21.1.5" class="anchored" data-anchor-id="step-5-calculate-the-p-value"><span class="header-section-number">1.21.1.5</span> Step 5: Calculate the p-value</h4>
<ul>
<li>The <strong>p-value</strong> is the probability of getting a result as extreme as or more extreme than what we observed (65 heads) if the coin were fair.</li>
<li>For a one-sided test (since our H₁ is “coin is biased toward heads”), this means the probability of getting 65 or more heads out of 100 flips of a fair coin.</li>
<li>In this case, the p-value is very small (approximately 0.0013), meaning it would be very rare to get this many heads by chance with a fair coin.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Formal calculation of the p-value
</div>
</div>
<div class="callout-body-container callout-body">
<p>For our coin flip example with a one-sided test:</p>
<ol type="1">
<li>Null hypothesis H₀: p = 0.5 (fair coin)</li>
<li>Alternative hypothesis H₁: p &gt; 0.5 (biased toward heads)</li>
<li>Test statistic: X = 65 heads out of n = 100 flips</li>
</ol>
<p>The p-value for a one-sided test is:</p>
<p><span class="math inline">p\text{-value} = P(X \geq 65 | n=100, p=0.5)</span></p>
<p>Using the binomial probability mass function:</p>
<p><span class="math inline">P(X = k) = {n \choose k}p^k(1-p)^{n-k}</span></p>
<p>For the observed outcome (65 heads): <span class="math inline">P(X \geq 65) = 1 - P(X \leq 64) = 1 - \sum_{k=0}^{64}{100 \choose k}(0.5)^k(0.5)^{100-k} \approx 0.0013</span></p>
<p>This p-value is well below the common significance threshold of 0.05, indicating strong evidence against the null hypothesis.</p>
</div>
</div>
</section>
<section id="step-6-make-a-decision" class="level4" data-number="1.21.1.6">
<h4 data-number="1.21.1.6" class="anchored" data-anchor-id="step-6-make-a-decision"><span class="header-section-number">1.21.1.6</span> Step 6: Make a Decision</h4>
<ul>
<li>If the p-value is small (usually less than 0.05), we <strong>reject the null hypothesis</strong>.</li>
<li>Here, the p-value (0.0013) is much smaller than 0.05, so we conclude the coin is <strong>biased toward heads</strong>.</li>
<li>This is like saying, “If the coin were fair, we’d see 65 or more heads out of 100 flips only about 0.13% of the time, which is so rare that we don’t believe this coin is fair.”</li>
</ul>
</section>
</section>
<section id="example-2-testing-the-effect-of-background-music-on-memory" class="level3" data-number="1.21.2">
<h3 data-number="1.21.2" class="anchored" data-anchor-id="example-2-testing-the-effect-of-background-music-on-memory"><span class="header-section-number">1.21.2</span> Example 2: Testing the Effect of Background Music on Memory</h3>
<p>Let’s look at another example from psychology: Does listening to classical music improve memory?</p>
<section id="step-1-research-question" class="level4" data-number="1.21.2.1">
<h4 data-number="1.21.2.1" class="anchored" data-anchor-id="step-1-research-question"><span class="header-section-number">1.21.2.1</span> Step 1: Research Question</h4>
<p>Does listening to classical music while studying improve memory recall compared to studying in silence?</p>
</section>
<section id="step-2-hypotheses" class="level4" data-number="1.21.2.2">
<h4 data-number="1.21.2.2" class="anchored" data-anchor-id="step-2-hypotheses"><span class="header-section-number">1.21.2.2</span> Step 2: Hypotheses</h4>
<ul>
<li><strong>H₀</strong>: Classical music has no effect on memory recall (average recall scores are the same).</li>
<li><strong>H₁</strong>: Classical music improves memory recall (average recall scores are higher with music).</li>
</ul>
<p>Think of this as starting with the assumption that music makes no difference (H₀), and then seeing if our data convinces us otherwise.</p>
</section>
<section id="step-3-collect-data-1" class="level4" data-number="1.21.2.3">
<h4 data-number="1.21.2.3" class="anchored" data-anchor-id="step-3-collect-data-1"><span class="header-section-number">1.21.2.3</span> Step 3: Collect Data</h4>
<p>You randomly assign 60 students to two groups:</p>
<ul>
<li>Group A (30 students): Study a list of words in silence</li>
<li>Group B (30 students): Study the same list while listening to classical music</li>
</ul>
<p>After 20 minutes, both groups take the same memory test. Group A (silence) remembers an average of 14.2 words, while Group B (music) remembers an average of 16.8 words.</p>
</section>
<section id="step-4-6-analysis-and-decision" class="level4" data-number="1.21.2.4">
<h4 data-number="1.21.2.4" class="anchored" data-anchor-id="step-4-6-analysis-and-decision"><span class="header-section-number">1.21.2.4</span> Step 4-6: Analysis and Decision</h4>
<p>After analyzing the data, you calculate a p-value of 0.02. This means if music truly had no effect, we’d see a difference this large or larger only about 2% of the time by random chance alone.</p>
<p>Since 0.02 &lt; 0.05, you reject H₀ and conclude that classical music does appear to improve memory recall.</p>
<p><strong>Important note on effect size</strong>: The difference of 2.6 words might be statistically significant but should be evaluated for practical significance. Is remembering about 3 more words meaningful in real-world contexts? This is like detecting that a new studying technique helps students remember 3 more vocabulary words - statistically detectable, but is it enough to change how we study? This highlights why we need to consider both statistical significance AND practical importance.</p>
</section>
</section>
</section>
<section id="general-steps-for-hypothesis-testing" class="level2" data-number="1.22">
<h2 data-number="1.22" class="anchored" data-anchor-id="general-steps-for-hypothesis-testing"><span class="header-section-number">1.22</span> General Steps for Hypothesis Testing</h2>
<ol type="1">
<li><strong>Formulate Hypotheses</strong>:
<ul>
<li>Null Hypothesis (H₀): The default or “no effect” claim.</li>
<li>Alternative Hypothesis (H₁): The claim you’re testing.</li>
</ul></li>
<li><strong>Choose a Significance Level (α)</strong>:
<ul>
<li>This is the threshold for deciding if the p-value is small enough to reject H₀. Common choices are 0.05 or 0.01.</li>
<li>Think of this as deciding “how sure” you need to be before making a claim - like setting the bar for “reasonable doubt” in a court case.</li>
</ul></li>
<li><strong>Collect Data</strong>:
<ul>
<li>Gather evidence from a representative sample.</li>
</ul></li>
<li><strong>Calculate the Test Statistic and p-value</strong>:
<ul>
<li>The <strong>test statistic</strong> measures how far your data is from what H₀ predicts.</li>
<li>The <strong>p-value</strong> tells you how likely it is to see your data (or something more extreme) if H₀ is true.</li>
<li>Think of the p-value as measuring how surprised you would be to see your results if the null hypothesis were true.</li>
</ul></li>
<li><strong>Make a Decision</strong>:
<ul>
<li>If p-value &lt; α, reject H₀ and accept H₁.</li>
<li>If p-value ≥ α, do not reject H₀ (but this doesn’t prove H₀ is true).</li>
</ul></li>
<li><strong>Interpret the Results in Context</strong>:
<ul>
<li>Consider both statistical significance and practical importance.</li>
<li>Ask: “Even if this effect is real, does it matter in the real world?”</li>
</ul></li>
</ol>
</section>
<section id="intuition-behind-hypothesis-testing" class="level2" data-number="1.23">
<h2 data-number="1.23" class="anchored" data-anchor-id="intuition-behind-hypothesis-testing"><span class="header-section-number">1.23</span> Intuition Behind Hypothesis Testing</h2>
<p>Think of hypothesis testing like a court trial:</p>
<ul>
<li><strong>Null Hypothesis (H₀)</strong>: The defendant is innocent.</li>
<li><strong>Alternative Hypothesis (H₁)</strong>: The defendant is guilty.</li>
<li><strong>Data</strong>: The evidence presented in court.</li>
<li><strong>p-value</strong>: How unlikely the evidence would be if the defendant were truly innocent.</li>
<li><strong>Significance Level (α)</strong>: The standard of proof needed to convict.</li>
</ul>
<p>If the evidence is very unlikely under the assumption of innocence (p-value &lt; α), we reject H₀ (convict the defendant). If not, we don’t reject H₀ (the defendant remains “not proven guilty”).</p>
</section>
<section id="common-mistakes-with-p-values" class="level2" data-number="1.24">
<h2 data-number="1.24" class="anchored" data-anchor-id="common-mistakes-with-p-values"><span class="header-section-number">1.24</span> Common Mistakes with p-values</h2>
<ol type="1">
<li><strong>The p-value is NOT the probability that H₀ is true</strong>.
<ul>
<li>It’s the probability of seeing your data (or something more extreme) <strong>if H₀ were true</strong>.</li>
<li>Think of it as the probability of drawing a winning lottery ticket (your data) IF the lottery were fair, not the probability that the lottery is fair.</li>
</ul></li>
<li><strong>The p-value is NOT the chance of making a mistake</strong>.
<ul>
<li>It doesn’t tell you the probability of being wrong when rejecting H₀.</li>
</ul></li>
<li><strong>Failing to reject H₀ does NOT prove it’s true</strong>.
<ul>
<li>It just means there’s not enough evidence to reject it (“absence of evidence is not evidence of absence”).</li>
<li>Like when a detective says “insufficient evidence” - it doesn’t mean the suspect is innocent, just that they couldn’t prove guilt.</li>
</ul></li>
<li><strong>A small p-value does NOT mean the result is important</strong>.
<ul>
<li>It only means the result is statistically significant. The effect might still be tiny in real-world terms.</li>
<li>Like detecting that one car is 0.1 mph faster than another - detectably different but practically meaningless.</li>
</ul></li>
<li><strong>p-values depend on sample size</strong>.
<ul>
<li>With very large samples, even tiny, practically meaningless differences can become statistically significant.</li>
<li>Like how a very sensitive scale can detect weight differences of 0.001g, but that doesn’t mean such differences matter for most purposes.</li>
</ul></li>
</ol>
</section>
<section id="types-of-errors-in-hypothesis-testing" class="level2" data-number="1.25">
<h2 data-number="1.25" class="anchored" data-anchor-id="types-of-errors-in-hypothesis-testing"><span class="header-section-number">1.25</span> Types of Errors in Hypothesis Testing</h2>
<ol type="1">
<li><strong>Type I Error (False Positive)</strong>:
<ul>
<li>Rejecting H₀ when it’s actually true.</li>
<li>Example: Concluding a medicine works when it actually doesn’t.</li>
<li>Probability of this error = α (the significance level).</li>
<li>Think of it as convicting an innocent person.</li>
</ul></li>
<li><strong>Type II Error (False Negative)</strong>:
<ul>
<li>Failing to reject H₀ when it’s actually false.</li>
<li>Example: Concluding a medicine doesn’t work when it actually does.</li>
<li>Probability of this error = β.</li>
<li>Think of it as letting a guilty person go free.</li>
</ul></li>
<li><strong>Power of the Test (1 - β)</strong>:
<ul>
<li>The probability of correctly rejecting H₀ when it’s false.</li>
<li>Think of it as the test’s ability to detect a real effect when one exists.</li>
<li>Like a metal detector’s ability to find actual metal objects.</li>
<li>Power increases with:
<ul>
<li>Larger sample sizes (examining more evidence)</li>
<li>Bigger effect sizes (looking for a larger metal object)</li>
<li>Higher significance levels (being less strict about what counts as “metal”)</li>
</ul></li>
</ul></li>
</ol>
<p>Consider this table showing the possible outcomes:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Reality</th>
<th>Decision: Reject H₀</th>
<th>Decision: Don’t Reject H₀</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>H₀ True</td>
<td>Type I Error (α)</td>
<td>Correct Decision</td>
</tr>
<tr class="even">
<td>H₀ False</td>
<td>Correct Decision (Power)</td>
<td>Type II Error (β)</td>
</tr>
</tbody>
</table>
</section>
<section id="key-takeaways" class="level2" data-number="1.26">
<h2 data-number="1.26" class="anchored" data-anchor-id="key-takeaways"><span class="header-section-number">1.26</span> Key Takeaways</h2>
<ul>
<li>Hypothesis testing helps you decide if your data supports a claim.</li>
<li>The p-value tells you how surprising your data is, assuming H₀ is true.</li>
<li>Always interpret p-values carefully and avoid common mistakes.</li>
<li>Remember: Statistical significance ≠ practical importance.</li>
<li>Both the significance level (α) and power (1-β) are important for reliable inference.</li>
<li>Larger sample sizes reduce both types of errors but may make trivial effects statistically significant.</li>
</ul>
<hr>
</section>
<section id="statistical-models" class="level2" data-number="1.27">
<h2 data-number="1.27" class="anchored" data-anchor-id="statistical-models"><span class="header-section-number">1.27</span> Statistical Models</h2>
<p>A <strong>statistical model</strong> is a mathematical framework that represents the relationships between variables and the structure of data. It helps describe the <strong>data-generating process (DGP)</strong> and enables us to make inferences about unknown parameters.</p>
<blockquote class="blockquote">
<p><strong>Components of a Statistical Model</strong></p>
<p>A complete statistical model consists of the following elements:</p>
<ol type="1">
<li><strong>Functional form</strong>: The mathematical structure that defines the relationship between variables (e.g., linear, quadratic, exponential).</li>
<li><strong>Variables</strong>:
<ul>
<li><strong>Dependent variable(s)</strong>: The outcome we aim to predict or explain.</li>
<li><strong>Independent/explanatory variables</strong>: The factors that may influence the dependent variable.</li>
</ul></li>
<li><strong>Parameters</strong>: Unknown quantities that we estimate from the data (e.g., regression coefficients like <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1</span>).</li>
<li><strong>Random component</strong>: The error term (<span class="math inline">\epsilon</span>) that accounts for unexplained variability in the data.</li>
<li><strong>Probability distribution assumptions</strong>: Assumptions about the distribution of the random component (e.g., normality, homoscedasticity).</li>
</ol>
</blockquote>
<p><strong>Example of a Linear Regression Model</strong>: <span class="math display">
y = \beta_0 + \beta_1x + \epsilon, \quad \text{where} \quad \epsilon \sim N(0, \sigma^2)
</span></p>
<p>In this model:</p>
<ul>
<li><span class="math inline">\beta_0</span> (intercept) and <span class="math inline">\beta_1</span> (slope) are parameters to be estimated.</li>
<li><span class="math inline">\epsilon</span> represents the random error term, capturing variability not explained by the model.</li>
<li>The error term is assumed to follow a normal distribution with a mean of 0 and variance <span class="math inline">\sigma^2</span>.</li>
</ul>
<hr>
<section id="causal-vs.-predictive-inference" class="level3" data-number="1.27.1">
<h3 data-number="1.27.1" class="anchored" data-anchor-id="causal-vs.-predictive-inference"><span class="header-section-number">1.27.1</span> Causal vs.&nbsp;Predictive Inference</h3>
<p>In statistical modelling, there are two primary goals:</p>
<ol type="1">
<li><strong>Causal Inference</strong>:
<ul>
<li><strong>Goal</strong>: Determine whether a change in variable <strong>X</strong> <em>causes</em> a change in variable <strong>Y</strong>.</li>
<li><strong>Requirements</strong>: Strong assumptions or specialized research designs (e.g., randomized controlled trials, instrumental variables).</li>
<li><strong>Application</strong>: Used to predict the effects of interventions or policy changes.</li>
<li><strong>Example</strong>: Does increasing the minimum wage (X) cause a reduction in employment (Y)?</li>
</ul></li>
<li><strong>Predictive Inference</strong>:
<ul>
<li><strong>Goal</strong>: Predict the values of <strong>Y</strong> based on <strong>X</strong>.</li>
<li><strong>Requirements</strong>: No need to assume a causal relationship between variables.</li>
<li><strong>Focus</strong>: Maximizing prediction accuracy, often using machine learning techniques.</li>
<li><strong>Example</strong>: Predicting house prices (Y) based on features like size, location, and number of bedrooms (X).</li>
</ul></li>
</ol>
<blockquote class="blockquote">
<p><strong>Warning: Correlation ≠ Causation</strong></p>
<p>A <strong>spurious relationship</strong> (or spurious correlation) occurs when two variables are statistically associated but not causally related. This can happen due to:</p>
<ol type="1">
<li><strong>Confounding</strong>: A third variable influences both X and Y.
<ul>
<li><em>Example</em>: Ice cream sales (X) and drowning incidents (Y) are correlated because both increase in summer (confounder: temperature).</li>
</ul></li>
<li><strong>Reverse Causality</strong>: Y affects X, not the other way around.
<ul>
<li><em>Example</em>: Higher crime rates (Y) lead to more police presence (X), not vice versa.</li>
</ul></li>
<li><strong>Chance</strong>: Random correlations that occur by coincidence.
<ul>
<li><em>Example</em>: A correlation between the number of pirates and global temperature (purely coincidental).</li>
</ul></li>
</ol>
</blockquote>
<hr>
</section>
<section id="challenges-of-causal-inference" class="level3" data-number="1.27.2">
<h3 data-number="1.27.2" class="anchored" data-anchor-id="challenges-of-causal-inference"><span class="header-section-number">1.27.2</span> Challenges of Causal Inference</h3>
<p>The fundamental problem of causal inference is the impossibility of observing <strong>counterfactuals</strong> (alternative scenarios). For a given unit, we can observe only one potential outcome.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/meme_horse.svg" class="img-fluid figure-img"></p>
<figcaption>The fundamental problem of causal inference: We can think of causal inference as a PREDICTION problem. How can we predict the counterfactual given that we never observe it?</figcaption>
</figure>
</div>
<p>Example:</p>
<ul>
<li>We observe a person who completed college and earns $8,000 per month</li>
<li>We cannot observe how much the same person would earn if they had not completed college</li>
</ul>
<p>Causal methods attempt to solve this problem through, e.g.:</p>
<ol type="1">
<li>Randomized experiments</li>
<li>Instrumental variables</li>
<li>Matching methods</li>
<li>Regression discontinuity analysis</li>
<li>Difference-in-differences</li>
</ol>
<p>Common problems in causal inference:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/IMG_4337.jpg" class="img-fluid figure-img"></p>
<figcaption>Confounding bias: drinking the night before is a common cause of sleeping with shoes on and waking up with a headache</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/ff13-23.png" class="img-fluid figure-img"></p>
<figcaption>Reverse causality</figcaption>
</figure>
</div>
<hr>
</section>
</section>
<section id="understanding-statistical-error" class="level2" data-number="1.28">
<h2 data-number="1.28" class="anchored" data-anchor-id="understanding-statistical-error"><span class="header-section-number">1.28</span> Understanding Statistical Error</h2>
<p>When using a sample to infer information about a population, statistical errors inevitably arise:</p>
<blockquote class="blockquote">
<p><strong>Statistical error</strong> is the difference between a sample estimate and the true population value.</p>
</blockquote>
<p>These errors can affect research validity and reliability. Understanding them is crucial for designing robust studies, analyzing data accurately, and drawing valid conclusions.</p>
</section>
<section id="types-of-statistical-errors" class="level2" data-number="1.29">
<h2 data-number="1.29" class="anchored" data-anchor-id="types-of-statistical-errors"><span class="header-section-number">1.29</span> Types of Statistical Errors</h2>
<section id="sampling-errors" class="level3" data-number="1.29.1">
<h3 data-number="1.29.1" class="anchored" data-anchor-id="sampling-errors"><span class="header-section-number">1.29.1</span> Sampling Errors</h3>
<section id="random-sampling-errors" class="level4" data-number="1.29.1.1">
<h4 data-number="1.29.1.1" class="anchored" data-anchor-id="random-sampling-errors"><span class="header-section-number">1.29.1.1</span> Random Sampling Errors</h4>
<ul>
<li><strong>Definition</strong>: Natural variability in sample estimates due to random selection.</li>
<li><strong>Example</strong>: The average height of 30 randomly selected university students fluctuates across different samples.</li>
<li><strong>Properties</strong>:
<ul>
<li>Unavoidable but manageable</li>
<li>Decrease with larger sample sizes</li>
<li>Quantified using the margin of error</li>
<li>Follow predictable statistical patterns</li>
</ul></li>
</ul>
</section>
<section id="systematic-sampling-errors-bias" class="level4" data-number="1.29.1.2">
<h4 data-number="1.29.1.2" class="anchored" data-anchor-id="systematic-sampling-errors-bias"><span class="header-section-number">1.29.1.2</span> Systematic Sampling Errors (Bias)</h4>
<ul>
<li><strong>Selection bias</strong>: Sample does not represent the target population.
<ul>
<li><em>Example</em>: A phone survey reaches only landline users, excluding cell phone users.</li>
</ul></li>
<li><strong>Undercoverage</strong>: Systematic exclusion of groups.
<ul>
<li><em>Example</em>: A campus survey conducted during daytime misses evening students.</li>
</ul></li>
<li><strong>Self-selection bias</strong>: Results skewed by participant choice.
<ul>
<li><em>Example</em>: Customer satisfaction surveys filled out mainly by those with strong opinions.</li>
</ul></li>
<li><strong>Non-response bias</strong>: Certain groups are less likely to respond.
<ul>
<li><em>Example</em>: Busy individuals skipping surveys, leading to overrepresentation of those with more free time.</li>
</ul></li>
</ul>
</section>
</section>
<section id="measurement-errors" class="level3" data-number="1.29.2">
<h3 data-number="1.29.2" class="anchored" data-anchor-id="measurement-errors"><span class="header-section-number">1.29.2</span> Measurement Errors</h3>
<section id="random-measurement-errors" class="level4" data-number="1.29.2.1">
<h4 data-number="1.29.2.1" class="anchored" data-anchor-id="random-measurement-errors"><span class="header-section-number">1.29.2.1</span> Random Measurement Errors</h4>
<ul>
<li><strong>Definition</strong>: Unpredictable fluctuations in measurements due to chance variability.</li>
<li><strong>Examples</strong>:
<ul>
<li>Slight variations in blood pressure readings due to a shaky hand.</li>
<li>Small environmental fluctuations affecting instrument readings.</li>
<li>Minor inconsistencies in repeated measurements.</li>
</ul></li>
<li><strong>Key Property</strong>: These errors tend to cancel out over multiple measurements.</li>
</ul>
</section>
<section id="systematic-measurement-errors" class="level4" data-number="1.29.2.2">
<h4 data-number="1.29.2.2" class="anchored" data-anchor-id="systematic-measurement-errors"><span class="header-section-number">1.29.2.2</span> Systematic Measurement Errors</h4>
<ul>
<li><strong>Calibration errors</strong>: Measurement tools consistently producing incorrect values.
<ul>
<li><em>Example</em>: A scale that always adds 2 pounds.</li>
</ul></li>
<li><strong>Observer bias</strong>: Researcher expectations subtly influencing data collection.
<ul>
<li><em>Example</em>: Unintentionally recording data that supports a hypothesis.</li>
</ul></li>
<li><strong>Social desirability bias</strong>: Participants altering responses to appear favorable.
<ul>
<li><em>Example</em>: Underreporting junk food intake in nutrition studies.</li>
</ul></li>
</ul>
</section>
</section>
<section id="inference-errors" class="level3" data-number="1.29.3">
<h3 data-number="1.29.3" class="anchored" data-anchor-id="inference-errors"><span class="header-section-number">1.29.3</span> Inference Errors</h3>
<section id="hypothesis-testing-errors" class="level4" data-number="1.29.3.1">
<h4 data-number="1.29.3.1" class="anchored" data-anchor-id="hypothesis-testing-errors"><span class="header-section-number">1.29.3.1</span> Hypothesis Testing Errors</h4>
<ul>
<li><strong>Type I error (False Positive)</strong>: Incorrectly concluding an effect exists.
<ul>
<li><em>Example</em>: Claiming a new drug is effective when its benefits are due to chance.</li>
<li><em>Context</em>: Linked to significance level (α).</li>
</ul></li>
<li><strong>Type II error (False Negative)</strong>: Failing to detect a real effect.
<ul>
<li><em>Example</em>: Concluding a drug is ineffective when it actually helps patients.</li>
<li><em>Context</em>: Related to statistical power (1-β).</li>
</ul></li>
<li><strong>Type III error</strong>: Addressing the wrong research question.
<ul>
<li><em>Example</em>: Studying whether a marketing strategy increases website traffic instead of sales.</li>
</ul></li>
</ul>
</section>
<section id="statistical-power-issues" class="level4" data-number="1.29.3.2">
<h4 data-number="1.29.3.2" class="anchored" data-anchor-id="statistical-power-issues"><span class="header-section-number">1.29.3.2</span> Statistical Power Issues</h4>
<ul>
<li><strong>Underpowered studies</strong>: Sample size too small to detect real effects.
<ul>
<li><em>Example</em>: Evaluating a weight loss program with only five participants.</li>
<li><em>Prevention</em>: Conducting power analyses before data collection.</li>
</ul></li>
</ul>
</section>
</section>
<section id="model-specification-errors" class="level3" data-number="1.29.4">
<h3 data-number="1.29.4" class="anchored" data-anchor-id="model-specification-errors"><span class="header-section-number">1.29.4</span> Model Specification Errors</h3>
<section id="variable-selection-errors" class="level4" data-number="1.29.4.1">
<h4 data-number="1.29.4.1" class="anchored" data-anchor-id="variable-selection-errors"><span class="header-section-number">1.29.4.1</span> Variable Selection Errors</h4>
<ul>
<li><strong>Omitted variable bias</strong>: Important variables are excluded.
<ul>
<li><em>Example</em>: Studying exercise and weight loss without considering diet.</li>
</ul></li>
<li><strong>Confounding</strong>: External factors influence both predictor and outcome.
<ul>
<li><em>Example</em>: Health-conscious individuals exercise and eat well, affecting weight loss results.</li>
<li><em>Solution</em>: Use randomization, stratification, or statistical controls.</li>
</ul></li>
</ul>
</section>
<section id="assumption-violations" class="level4" data-number="1.29.4.2">
<h4 data-number="1.29.4.2" class="anchored" data-anchor-id="assumption-violations"><span class="header-section-number">1.29.4.2</span> Assumption Violations</h4>
<ul>
<li><strong>Definition</strong>: Using statistical tests that do not fit the data characteristics.</li>
<li><strong>Example</strong>: Assuming normal distribution for highly skewed data.</li>
<li><strong>Prevention</strong>: Conduct diagnostic tests before analysis.</li>
</ul>
</section>
</section>
<section id="data-processing-and-analysis-errors" class="level3" data-number="1.29.5">
<h3 data-number="1.29.5" class="anchored" data-anchor-id="data-processing-and-analysis-errors"><span class="header-section-number">1.29.5</span> Data Processing and Analysis Errors</h3>
<section id="data-handling-errors" class="level4" data-number="1.29.5.1">
<h4 data-number="1.29.5.1" class="anchored" data-anchor-id="data-handling-errors"><span class="header-section-number">1.29.5.1</span> Data Handling Errors</h4>
<ul>
<li><strong>Data entry errors</strong>: Mistakes in recording information.
<ul>
<li><em>Example</em>: Entering “1050” instead of “150” for weight.</li>
<li><em>Prevention</em>: Double-entry verification, range checks.</li>
</ul></li>
<li><strong>Missing data issues</strong>: Improper handling of incomplete datasets.
<ul>
<li><em>Example</em>: Ignoring absent students when calculating test score averages.</li>
<li><em>Solution</em>: Use imputation methods, conduct sensitivity analyses.</li>
</ul></li>
</ul>
</section>
<section id="analysis-execution-errors" class="level4" data-number="1.29.5.2">
<h4 data-number="1.29.5.2" class="anchored" data-anchor-id="analysis-execution-errors"><span class="header-section-number">1.29.5.2</span> Analysis Execution Errors</h4>
<ul>
<li><strong>Software or user errors</strong>: Misuse of statistical software.
<ul>
<li><em>Example</em>: Applying the wrong statistical test.</li>
<li><em>Prevention</em>: Code review, reproducible workflows, thorough documentation.</li>
</ul></li>
</ul>
</section>
</section>
<section id="interpretation-and-reporting-errors" class="level3" data-number="1.29.6">
<h3 data-number="1.29.6" class="anchored" data-anchor-id="interpretation-and-reporting-errors"><span class="header-section-number">1.29.6</span> Interpretation and Reporting Errors</h3>
<section id="causal-inference-errors" class="level4" data-number="1.29.6.1">
<h4 data-number="1.29.6.1" class="anchored" data-anchor-id="causal-inference-errors"><span class="header-section-number">1.29.6.1</span> Causal Inference Errors</h4>
<ul>
<li><strong>Correlation ≠ Causation</strong>: Mistaking association for causation.
<ul>
<li><em>Example</em>: Assuming chocolate consumption causes Nobel Prizes because they correlate.</li>
<li><em>Prevention</em>: Use proper research designs and causal inference methods.</li>
</ul></li>
</ul>
</section>
<section id="reporting-and-communication-errors" class="level4" data-number="1.29.6.2">
<h4 data-number="1.29.6.2" class="anchored" data-anchor-id="reporting-and-communication-errors"><span class="header-section-number">1.29.6.2</span> Reporting and Communication Errors</h4>
<ul>
<li><strong>p-hacking</strong>: Conducting multiple analyses until finding significant results.
<ul>
<li><em>Example</em>: Running 20 tests and reporting only the one significant outcome.</li>
<li><em>Prevention</em>: Pre-registration, correcting for multiple comparisons.</li>
</ul></li>
<li><strong>Cherry-picking</strong>: Selectively reporting favorable results.
<ul>
<li><em>Example</em>: A diet pill company publishing only successful studies.</li>
<li><em>Prevention</em>: Comprehensive reporting, registered reports.</li>
</ul></li>
</ul>
</section>
</section>
</section>
<section id="strategies-to-minimize-statistical-errors" class="level2" data-number="1.30">
<h2 data-number="1.30" class="anchored" data-anchor-id="strategies-to-minimize-statistical-errors"><span class="header-section-number">1.30</span> Strategies to Minimize Statistical Errors</h2>
<ol type="1">
<li><strong>Robust study design</strong>
<ul>
<li>Use proper sampling techniques.</li>
<li>Randomize when possible.</li>
<li>Control for confounders.</li>
</ul></li>
<li><strong>Sufficient sample size</strong>
<ul>
<li>Base on power calculations.</li>
<li>Consider practical significance, not just statistical significance.</li>
<li>Account for potential dropouts or missing data.</li>
</ul></li>
<li><strong>Pre-registration</strong>
<ul>
<li>Define analysis plans before examining data.</li>
<li>Specify primary outcomes and methods.</li>
<li>Document any deviations from the plan.</li>
</ul></li>
<li><strong>Transparency</strong>
<ul>
<li>Share data and methods openly.</li>
<li>Provide access to raw data when possible.</li>
<li>Clearly document analytical decisions.</li>
</ul></li>
<li><strong>Replication</strong>
<ul>
<li>Encourage independent verification.</li>
<li>Conduct internal replications.</li>
<li>Support external replication efforts.</li>
</ul></li>
<li><strong>Ongoing education</strong>
<ul>
<li>Stay informed on best practices.</li>
<li>Follow field-specific guidelines.</li>
<li>Engage with methodological advancements.</li>
</ul></li>
</ol>
<p>By understanding and mitigating statistical errors, researchers can ensure their findings are reliable, reducing the risk of flawed conclusions in fields like medicine, policy, education, and business.</p>
</section>
<section id="appendices-additional-topics-in-statistics-and-data-science" class="level2" data-number="1.31">
<h2 data-number="1.31" class="anchored" data-anchor-id="appendices-additional-topics-in-statistics-and-data-science"><span class="header-section-number">1.31</span> Appendices: Additional Topics in Statistics and Data Science (*)</h2>
</section>
<section id="appendix-a-r-for-social-science-data-analysis" class="level2" data-number="1.32">
<h2 data-number="1.32" class="anchored" data-anchor-id="appendix-a-r-for-social-science-data-analysis"><span class="header-section-number">1.32</span> Appendix A: R for Social Science Data Analysis</h2>
<p>R offers powerful capabilities for social science research, from data manipulation to advanced statistical modeling.</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ lubridate 1.9.3     ✔ tibble    3.2.1
✔ purrr     1.0.2     ✔ tidyr     1.3.1
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate example data with a Simpson's Paradox</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_group =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Young"</span>, <span class="st">"Middle"</span>, <span class="st">"Old"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>)),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">education_years =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Young"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Middle"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">13</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Old"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">16</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">income =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Young"</span> <span class="sc">~</span> <span class="dv">70000</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> education_years <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5000</span>),</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Middle"</span> <span class="sc">~</span> <span class="dv">50000</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> education_years <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5000</span>),</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Old"</span> <span class="sc">~</span> <span class="dv">30000</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> education_years <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5000</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic data summary</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  age_group         education_years      income     
 Length:1000        Min.   : 6.628   Min.   :34068  
 Class :character   1st Qu.:10.913   1st Qu.:51508  
 Mode  :character   Median :13.004   Median :63376  
                    Mean   :12.986   Mean   :63307  
                    3rd Qu.:14.934   3rd Qu.:75023  
                    Max.   :18.861   Max.   :96620  </code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation analysis</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(data <span class="sc">%&gt;%</span> <span class="fu">select</span>(education_years, income))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                education_years     income
education_years       1.0000000 -0.8152477
income               -0.8152477  1.0000000</code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Overall trend (Simpson's Paradox)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>overall_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> education_years, <span class="at">y =</span> income)) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Overall Relationship between Education and Income"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Simpson's Paradox: Appears negative"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Years of Education"</span>, <span class="at">y =</span> <span class="st">"Income"</span>) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Trend by age group (Resolving Simpson's Paradox)</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>grouped_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> education_years, <span class="at">y =</span> income, <span class="at">color =</span> age_group)) <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relationship between Education and Income by Age Group"</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Resolving Simpson's Paradox: Positive relationship within groups"</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Years of Education"</span>, <span class="at">y =</span> <span class="st">"Income"</span>) <span class="sc">+</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(overall_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(grouped_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This example demonstrates Simpson’s Paradox, where the overall relationship between education and income appears negative, but when grouped by age, the relationship within each group is positive. This illustrates how critical it is to consider confounding variables in your analysis.</p>
</section>
<section id="appendix-b-causal-inference-vs.-observational-studies" class="level2" data-number="1.33">
<h2 data-number="1.33" class="anchored" data-anchor-id="appendix-b-causal-inference-vs.-observational-studies"><span class="header-section-number">1.33</span> Appendix B: Causal Inference vs.&nbsp;Observational Studies</h2>
<p>Understanding the relationship between variables is crucial in social sciences. Two key approaches are causal inference and observational studies, each with distinct strengths and limitations.</p>
<section id="causal-inference" class="level3" data-number="1.33.1">
<h3 data-number="1.33.1" class="anchored" data-anchor-id="causal-inference"><span class="header-section-number">1.33.1</span> Causal Inference</h3>
<ul>
<li>Aims to establish cause-and-effect relationships</li>
<li>Often involves experimental designs or advanced statistical techniques</li>
<li>Seeks to answer “What if?” questions and determine the impact of interventions</li>
<li>Examples: Randomized controlled trials, quasi-experimental designs, instrumental variables</li>
</ul>
</section>
<section id="observational-studies" class="level3" data-number="1.33.2">
<h3 data-number="1.33.2" class="anchored" data-anchor-id="observational-studies"><span class="header-section-number">1.33.2</span> Observational Studies</h3>
<ul>
<li>Examine relationships between variables without direct intervention</li>
<li>Rely on data collected from natural settings or existing datasets</li>
<li>Can identify correlations and patterns but struggle to establish causation</li>
<li>Examples: Cohort studies, case-control studies, cross-sectional surveys</li>
</ul>
<blockquote class="blockquote">
<p><strong>Important: Correlation Does Not Imply Causation</strong></p>
<ul>
<li><strong>Correlation</strong>: Measures the strength and direction of a relationship between variables</li>
<li><strong>Causation</strong>: Indicates that changes in one variable directly cause changes in another</li>
</ul>
<p>While strong correlations can suggest potential causal links, additional evidence and rigorous methods are required to establish causality.</p>
</blockquote>
</section>
<section id="challenges-in-establishing-causality" class="level3" data-number="1.33.3">
<h3 data-number="1.33.3" class="anchored" data-anchor-id="challenges-in-establishing-causality"><span class="header-section-number">1.33.3</span> Challenges in Establishing Causality</h3>
<ul>
<li><strong>Confounding variables</strong>: Unmeasured factors that affect both the presumed cause and effect</li>
<li><strong>Reverse causality</strong>: The presumed effect might actually be causing the presumed cause</li>
<li><strong>Selection bias</strong>: Non-random selection of subjects into study groups</li>
</ul>
</section>
<section id="methods-to-strengthen-causal-claims" class="level3" data-number="1.33.4">
<h3 data-number="1.33.4" class="anchored" data-anchor-id="methods-to-strengthen-causal-claims"><span class="header-section-number">1.33.4</span> Methods to Strengthen Causal Claims</h3>
<ol type="1">
<li>Randomized controlled trials (when ethical and feasible)</li>
<li>Natural experiments or quasi-experimental designs</li>
<li>Propensity score matching</li>
<li>Difference-in-differences analysis</li>
<li>Instrumental variable approaches</li>
<li>Directed acyclic graphs (DAGs) for visualizing causal relationships</li>
</ol>
<p>Understanding these distinctions is crucial in social sciences, where ethical considerations often limit experimental manipulation.</p>
</section>
</section>
<section id="appendix-c-understanding-spurious-correlations-confounders-and-colliders" class="level2" data-number="1.34">
<h2 data-number="1.34" class="anchored" data-anchor-id="appendix-c-understanding-spurious-correlations-confounders-and-colliders"><span class="header-section-number">1.34</span> Appendix C: Understanding Spurious Correlations, Confounders, and Colliders</h2>
<p>These concepts are essential for avoiding misinterpretations in statistical analysis. Let’s explore them with R examples.</p>
<div class="cell">
<details class="code-fold">
<summary>Load required libraries</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># for reproducibility</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="spurious-correlations" class="level3" data-number="1.34.1">
<h3 data-number="1.34.1" class="anchored" data-anchor-id="spurious-correlations"><span class="header-section-number">1.34.1</span> Spurious Correlations</h3>
<p>Spurious correlations are relationships between variables that appear to be causal but are actually coincidental or caused by an unseen third factor.</p>
<p><strong>Example: Ice Cream Sales and Drowning Incidents</strong></p>
<div class="cell">
<details class="code-fold">
<summary>R code for spurious correlation example</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>spurious_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ice_cream_sales =</span> <span class="dv">100</span> <span class="sc">+</span> <span class="dv">5</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">drowning_incidents =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the apparent correlation</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(spurious_data, <span class="fu">aes</span>(<span class="at">x =</span> ice_cream_sales, <span class="at">y =</span> drowning_incidents)) <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Spurious Correlation: Ice Cream Sales vs. Drowning"</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Ice Cream Sales"</span>, </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Drowning Incidents"</span>) <span class="sc">+</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the common cause</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(spurious_data, <span class="fu">aes</span>(<span class="at">x =</span> temperature)) <span class="sc">+</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> ice_cream_sales), <span class="at">color =</span> <span class="st">"#D55E00"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> drowning_incidents <span class="sc">*</span> <span class="dv">10</span>), <span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> ice_cream_sales), <span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#D55E00"</span>) <span class="sc">+</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> drowning_incidents <span class="sc">*</span> <span class="dv">10</span>), <span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Ice Cream Sales"</span>,</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="dv">10</span>, <span class="at">name =</span> <span class="st">"Drowning Incidents"</span>)</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Temperature as the Common Cause"</span>,</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Temperature (°C)"</span>) <span class="sc">+</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y.left =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#D55E00"</span>),</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y.right =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>)</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlation</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>cor_value <span class="ot">&lt;-</span> <span class="fu">cor</span>(spurious_data<span class="sc">$</span>ice_cream_sales, spurious_data<span class="sc">$</span>drowning_incidents)</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>R code for spurious correlation example</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>R code for spurious correlation example</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Correlation between ice cream sales and drowning incidents:"</span>, <span class="fu">round</span>(cor_value, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Correlation between ice cream sales and drowning incidents: 0.68</code></pre>
</div>
</div>
<p>In this example, temperature is the common cause (confounder) that influences both ice cream sales and drowning incidents. When we plot them against each other, they appear correlated (r ≈ 0.5), but this is spurious. The relationship disappears when we control for temperature.</p>
</section>
<section id="confounders" class="level3" data-number="1.34.2">
<h3 data-number="1.34.2" class="anchored" data-anchor-id="confounders"><span class="header-section-number">1.34.2</span> Confounders</h3>
<p>A confounder is a variable that influences both the dependent variable and independent variable, causing a spurious association.</p>
<p><strong>Example: Education, Income, and Age</strong></p>
<div class="cell">
<details class="code-fold">
<summary>R code for confounder example</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>confounder_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">runif</span>(n, <span class="dv">25</span>, <span class="dv">65</span>),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">education =</span> <span class="fu">round</span>(<span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> age <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">2</span>)),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">income =</span> <span class="dv">20000</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> education <span class="sc">+</span> <span class="dv">500</span> <span class="sc">*</span> age <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">5000</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create age groups for visualization</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>confounder_data <span class="ot">&lt;-</span> confounder_data <span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_group =</span> <span class="fu">cut</span>(age, <span class="at">breaks =</span> <span class="dv">3</span>, </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Young"</span>, <span class="st">"Middle"</span>, <span class="st">"Older"</span>)))</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Models with and without controlling for the confounder</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>model_naive <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> education, <span class="at">data =</span> confounder_data)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>model_adjusted <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> education <span class="sc">+</span> age, <span class="at">data =</span> confounder_data)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(confounder_data, <span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">y =</span> income)) <span class="sc">+</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> age), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> age_group, <span class="at">color =</span> <span class="fu">as.numeric</span>(age_group)), </span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Age"</span>, </span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">45</span>, <span class="dv">60</span>), </span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Young"</span>, <span class="st">"Middle"</span>, <span class="st">"Older"</span>)) <span class="sc">+</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Education vs Income, Confounded by Age"</span>,</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Without controlling for age: effect ="</span>, </span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">coef</span>(model_naive)[<span class="st">"education"</span>], <span class="dv">1</span>),</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"| With age control: effect ="</span>, </span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">coef</span>(model_adjusted)[<span class="st">"education"</span>], <span class="dv">1</span>)),</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Years of Education"</span>, </span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Income"</span>) <span class="sc">+</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this example, age is a confounder in the relationship between education and income. Without controlling for age, we overestimate the effect of education on income (the black line). When we examine the relationship within specific age groups (colored lines), we see a more accurate representation of the true effect.</p>
</section>
<section id="colliders" class="level3" data-number="1.34.3">
<h3 data-number="1.34.3" class="anchored" data-anchor-id="colliders"><span class="header-section-number">1.34.3</span> Colliders</h3>
<p>A collider is a variable that is influenced by both the independent variable and the dependent variable. Controlling for a collider can introduce a spurious correlation.</p>
<p><strong>Example: Job Satisfaction, Salary, and Work-Life Balance</strong></p>
<div class="cell">
<details class="code-fold">
<summary>R code for collider example</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>collider_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">job_satisfaction =</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">salary =</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Both job satisfaction and salary negatively affect work-life balance</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">work_life_balance =</span> <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> job_satisfaction <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> salary <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Without controlling for work-life balance</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>model_correct <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> job_satisfaction, <span class="at">data =</span> collider_data)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Incorrectly controlling for the collider</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>model_collider <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> job_satisfaction <span class="sc">+</span> work_life_balance, <span class="at">data =</span> collider_data)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(collider_data, <span class="fu">aes</span>(<span class="at">x =</span> job_satisfaction, <span class="at">y =</span> salary, </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> work_life_balance)) <span class="sc">+</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Work-Life</span><span class="sc">\n</span><span class="st">Balance"</span>) <span class="sc">+</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Job Satisfaction vs Salary, with Work-Life Balance as Collider"</span>,</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Without controlling: correlation ="</span>, </span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">coef</span>(model_correct)[<span class="st">"job_satisfaction"</span>], <span class="dv">3</span>),</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"| With control: correlation ="</span>, </span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">coef</span>(model_collider)[<span class="st">"job_satisfaction"</span>], <span class="dv">3</span>)),</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Job Satisfaction"</span>, </span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Salary"</span>) <span class="sc">+</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this example, there’s no inherent relationship between job satisfaction and salary (the black line shows near-zero correlation). However, both variables negatively impact work-life balance. If we control for work-life balance (the collider), we introduce a positive correlation between job satisfaction and salary that doesn’t actually exist.</p>
</section>
<section id="simpsons-paradox" class="level3" data-number="1.34.4">
<h3 data-number="1.34.4" class="anchored" data-anchor-id="simpsons-paradox"><span class="header-section-number">1.34.4</span> Simpson’s Paradox</h3>
<p>Simpson’s paradox occurs when a trend appears in different groups of data but disappears or reverses when these groups are combined.</p>
<p><strong>Example: Treatment Effectiveness Across Age Groups</strong></p>
<div class="cell">
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create example dataset</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>simpson_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_group =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Young"</span>, <span class="st">"Older"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.3</span>)),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Treatment A"</span>, <span class="st">"Treatment B"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Different recovery rates based on age and treatment</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovery_prob =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Young"</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">"Treatment A"</span> <span class="sc">~</span> <span class="fl">0.70</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Young"</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">"Treatment B"</span> <span class="sc">~</span> <span class="fl">0.80</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Older"</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">"Treatment A"</span> <span class="sc">~</span> <span class="fl">0.50</span>,</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Older"</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">"Treatment B"</span> <span class="sc">~</span> <span class="fl">0.40</span>,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># More older people get Treatment A</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="fu">if_else</span>(</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Older"</span> <span class="sc">&amp;</span> <span class="fu">runif</span>(n) <span class="sc">&lt;</span> <span class="fl">0.7</span>, </span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Treatment A"</span>, </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>      treatment</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate recovery outcomes</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovered =</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, recovery_prob)</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate data</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>overall_rates <span class="ot">&lt;-</span> simpson_data <span class="sc">%&gt;%</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_patients =</span> <span class="fu">n</span>(),</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovered_patients =</span> <span class="fu">sum</span>(recovered),</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovery_rate =</span> <span class="fu">mean</span>(recovered)</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>by_age_rates <span class="ot">&lt;-</span> simpson_data <span class="sc">%&gt;%</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment, age_group) <span class="sc">%&gt;%</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_patients =</span> <span class="fu">n</span>(),</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovered_patients =</span> <span class="fu">sum</span>(recovered),</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovery_rate =</span> <span class="fu">mean</span>(recovered)</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'treatment'. You can override using the
`.groups` argument.</code></pre>
</div>
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualization</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>overall_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(overall_rates, </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> recovery_rate, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(recovery_rate<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%"</span>)), </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Overall Recovery Rates"</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Simpson's Paradox: Treatment B appears worse overall"</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Recovery Rate"</span>) <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>by_age_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(by_age_rates, </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> recovery_rate, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(recovery_rate<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%"</span>)), </span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Recovery Rates by Age Group"</span>,</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Within each age group, Treatment B is actually better"</span>,</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Recovery Rate"</span>) <span class="sc">+</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>age_group) <span class="sc">+</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Display tables and plots</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(overall_rates, <span class="at">caption =</span> <span class="st">"Overall Recovery Rates by Treatment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Overall Recovery Rates by Treatment</caption>
<thead>
<tr class="header">
<th style="text-align: left;">treatment</th>
<th style="text-align: right;">total_patients</th>
<th style="text-align: right;">recovered_patients</th>
<th style="text-align: right;">recovery_rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Treatment A</td>
<td style="text-align: right;">594</td>
<td style="text-align: right;">356</td>
<td style="text-align: right;">0.5993266</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment B</td>
<td style="text-align: right;">406</td>
<td style="text-align: right;">297</td>
<td style="text-align: right;">0.7315271</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(by_age_rates, <span class="at">caption =</span> <span class="st">"Recovery Rates by Treatment and Age Group"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Recovery Rates by Treatment and Age Group</caption>
<colgroup>
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 21%">
<col style="width: 27%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">treatment</th>
<th style="text-align: left;">age_group</th>
<th style="text-align: right;">total_patients</th>
<th style="text-align: right;">recovered_patients</th>
<th style="text-align: right;">recovery_rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Treatment A</td>
<td style="text-align: left;">Older</td>
<td style="text-align: right;">240</td>
<td style="text-align: right;">116</td>
<td style="text-align: right;">0.4833333</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment A</td>
<td style="text-align: left;">Young</td>
<td style="text-align: right;">354</td>
<td style="text-align: right;">240</td>
<td style="text-align: right;">0.6779661</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Treatment B</td>
<td style="text-align: left;">Older</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0.4181818</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment B</td>
<td style="text-align: left;">Young</td>
<td style="text-align: right;">351</td>
<td style="text-align: right;">274</td>
<td style="text-align: right;">0.7806268</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(overall_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(by_age_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Simpson’s paradox is occurring here because:</p>
<ol type="1">
<li><strong>Within each age group</strong>: Treatment B has a higher recovery rate than Treatment A</li>
<li><strong>Overall</strong>: Treatment A appears to have a higher recovery rate than Treatment B</li>
</ol>
<p>This paradox happens because: - Treatment A is given more frequently to older patients - Older patients have lower recovery rates regardless of treatment - This skews the overall average to make Treatment A look better, even though Treatment B is better for both young and older patients</p>
</section>
<section id="directed-acyclic-graphs-dags" class="level3" data-number="1.34.5">
<h3 data-number="1.34.5" class="anchored" data-anchor-id="directed-acyclic-graphs-dags"><span class="header-section-number">1.34.5</span> Directed Acyclic Graphs (DAGs)</h3>
<p>DAGs are powerful tools for visualizing causal relationships and identifying potential biases in statistical analyses.</p>
<div class="cell">
<details class="code-fold">
<summary>R code for DAG examples</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Try to load dagitty and ggdag if available</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">"dagitty"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="sc">&amp;&amp;</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">requireNamespace</span>(<span class="st">"ggdag"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dagitty)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggdag)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example 1: Confounder</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  confounder_dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag {</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="st">    X -&gt; Y</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="st">    Z -&gt; X</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="st">    Z -&gt; Y</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="st">  }'</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example 2: Collider</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  collider_dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag {</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="st">    X -&gt; Z</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="st">    Y -&gt; Z</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="st">    X -- Y [unobserved]</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="st">  }'</span>)</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example 3: Simpson's Paradox</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>  simpson_dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag {</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="st">    Treatment -&gt; Recovery</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a><span class="st">    Age -&gt; Treatment</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="st">    Age -&gt; Recovery</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="st">  }'</span>)</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot the DAGs</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggdag</span>(confounder_dag) <span class="sc">+</span> </span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_dag</span>() <span class="sc">+</span> </span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Confounder (Z)"</span>)</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggdag</span>(collider_dag) <span class="sc">+</span> </span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_dag</span>() <span class="sc">+</span> </span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Collider (Z)"</span>)</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">ggdag</span>(simpson_dag) <span class="sc">+</span> </span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_dag</span>() <span class="sc">+</span> </span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Simpson's Paradox Structure"</span>)</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p1)</span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p2)</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p3)</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"DAG visualization packages not installed. Install dagitty and ggdag packages for these examples."</span>)</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggdag'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>DAGs help us visualize different causal structures:</p>
<ol type="1">
<li><strong>Confounder</strong>: A variable (Z) that affects both the exposure (X) and outcome (Y)</li>
<li><strong>Collider</strong>: A variable (Z) that is affected by both the exposure (X) and another variable (Y)</li>
<li><strong>Simpson’s Paradox</strong>: Often involves a confounder that influences both the treatment/exposure and the outcome</li>
</ol>
<p>Understanding these structures helps us decide which variables to control for in our analyses and which to leave out.</p>
</section>
</section>
<section id="appendix-d-models-in-science-from-deterministic-to-stochastic" class="level2" data-number="1.35">
<h2 data-number="1.35" class="anchored" data-anchor-id="appendix-d-models-in-science-from-deterministic-to-stochastic"><span class="header-section-number">1.35</span> Appendix D: Models in Science: From Deterministic to Stochastic</h2>
<p>Models are essential tools in scientific research, helping scientists to represent, understand, and predict complex phenomena.</p>
<section id="types-of-models" class="level3" data-number="1.35.1">
<h3 data-number="1.35.1" class="anchored" data-anchor-id="types-of-models"><span class="header-section-number">1.35.1</span> Types of Models</h3>
<section id="mathematical-models" class="level4" data-number="1.35.1.1">
<h4 data-number="1.35.1.1" class="anchored" data-anchor-id="mathematical-models"><span class="header-section-number">1.35.1.1</span> Mathematical Models</h4>
<p>Mathematical models use equations to describe and analyze systems. They can be divided into:</p>
<section id="deterministic-models" class="level5" data-number="1.35.1.1.1">
<h5 data-number="1.35.1.1.1" class="anchored" data-anchor-id="deterministic-models"><span class="header-section-number">1.35.1.1.1</span> Deterministic Models</h5>
<p>Deterministic models provide precise predictions based on a set of variables, without incorporating randomness.</p>
<p><strong>Example:</strong> Newton’s laws of motion, which can precisely predict the motion of objects under known forces:</p>
<p><span class="math display">x(t) = x_0 + v_0t + \frac{1}{2}at^2</span></p>
<p>Where <span class="math inline">x(t)</span> is the position at time <span class="math inline">t</span>, <span class="math inline">x_0</span> is the initial position, <span class="math inline">v_0</span> is the initial velocity, and <span class="math inline">a</span> is the acceleration.</p>
</section>
<section id="stochastic-models" class="level5" data-number="1.35.1.1.2">
<h5 data-number="1.35.1.1.2" class="anchored" data-anchor-id="stochastic-models"><span class="header-section-number">1.35.1.1.2</span> Stochastic Models</h5>
<p>Stochastic models incorporate randomness and probability. They come in two fundamentally different types:</p>
<p><strong>Classical Stochastic Models</strong>: Deal with randomness arising from incomplete information or complex interactions in classical systems. The underlying system is deterministic, but practical limitations lead to probabilistic descriptions.</p>
<p><strong>Example:</strong> Regression models in statistics, where the randomness represents unexplained variation:</p>
<p><span class="math display">y = \beta_0 + \beta_1x + \varepsilon</span></p>
<p>Where <span class="math inline">y</span> is the dependent variable, <span class="math inline">x</span> is the independent variable, <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1</span> are parameters, and <span class="math inline">\varepsilon</span> is the error term.</p>
<p><strong>Quantum Stochastic Models</strong>: Deal with the fundamental, irreducible randomness inherent in quantum mechanical systems.</p>
<p><strong>Example:</strong> The decay of a radioactive particle follows a probability distribution:</p>
<p><span class="math display">P(t) = e^{-t/\tau}</span></p>
<p>Where <span class="math inline">P(t)</span> is the probability that the particle has not decayed after time <span class="math inline">t</span>, and <span class="math inline">\tau</span> is the mean lifetime of the particle.</p>
</section>
</section>
<section id="other-model-types" class="level4" data-number="1.35.1.2">
<h4 data-number="1.35.1.2" class="anchored" data-anchor-id="other-model-types"><span class="header-section-number">1.35.1.2</span> Other Model Types</h4>
<ul>
<li><strong>Computer Simulation Models</strong>: Use algorithms to simulate complex systems</li>
<li><strong>Conceptual Models</strong>: Abstract representations using diagrams or flowcharts</li>
<li><strong>Physical Models</strong>: Tangible representations like scale models</li>
<li><strong>Theoretical Models</strong>: Abstract frameworks based on fundamental principles</li>
</ul>
</section>
</section>
<section id="model-error-and-bias-variance-tradeoff" class="level3" data-number="1.35.2">
<h3 data-number="1.35.2" class="anchored" data-anchor-id="model-error-and-bias-variance-tradeoff"><span class="header-section-number">1.35.2</span> Model Error and Bias-Variance Tradeoff</h3>
<p>All models involve some degree of error. Understanding the balance between bias and variance is crucial:</p>
<ul>
<li><strong>Bias</strong>: Systematic error from simplifying assumptions</li>
<li><strong>Variance</strong>: Error from sensitivity to small fluctuations in the training data</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/ModelError.png" class="img-fluid figure-img"></p>
<figcaption>Bias-Variance Tradeoff in Models</figcaption>
</figure>
</div>
<p>The ideal model balances complexity to minimize both bias and variance, leading to the best predictive performance.</p>
</section>
</section>
<section id="appendix-e-classical-vs-quantum-randomness" class="level2" data-number="1.36">
<h2 data-number="1.36" class="anchored" data-anchor-id="appendix-e-classical-vs-quantum-randomness"><span class="header-section-number">1.36</span> Appendix E: Classical vs Quantum Randomness</h2>
<p>To understand how randomness differs across scientific disciplines, we need to examine the origins and implications of different types of uncertainty.</p>
<section id="origin-of-randomness" class="level3" data-number="1.36.1">
<h3 data-number="1.36.1" class="anchored" data-anchor-id="origin-of-randomness"><span class="header-section-number">1.36.1</span> Origin of Randomness</h3>
<section id="classical-randomness-e.g.-regression-models" class="level4" data-number="1.36.1.1">
<h4 data-number="1.36.1.1" class="anchored" data-anchor-id="classical-randomness-e.g.-regression-models"><span class="header-section-number">1.36.1.1</span> Classical Randomness (e.g., Regression Models)</h4>
<ul>
<li><strong>Source</strong>: Incomplete information or complex interactions in an otherwise deterministic system</li>
<li><strong>Nature</strong>: Epistemic uncertainty (due to lack of knowledge)</li>
<li><strong>Example</strong>: In a regression model, the error term represents unexplained variation</li>
</ul>
</section>
<section id="quantum-randomness" class="level4" data-number="1.36.1.2">
<h4 data-number="1.36.1.2" class="anchored" data-anchor-id="quantum-randomness"><span class="header-section-number">1.36.1.2</span> Quantum Randomness</h4>
<ul>
<li><strong>Source</strong>: Fundamental property of quantum systems</li>
<li><strong>Nature</strong>: Ontic uncertainty (inherent to the system, not due to lack of knowledge)</li>
<li><strong>Example</strong>: The exact time of decay of a radioactive atom cannot be predicted</li>
</ul>
</section>
</section>
<section id="philosophical-implications-1" class="level3" data-number="1.36.2">
<h3 data-number="1.36.2" class="anchored" data-anchor-id="philosophical-implications-1"><span class="header-section-number">1.36.2</span> Philosophical Implications</h3>
<section id="classical-randomness" class="level4" data-number="1.36.2.1">
<h4 data-number="1.36.2.1" class="anchored" data-anchor-id="classical-randomness"><span class="header-section-number">1.36.2.1</span> Classical Randomness</h4>
<ul>
<li><strong>Determinism</strong>: Underlying reality is deterministic; randomness reflects our ignorance</li>
<li><strong>Hidden Variables</strong>: In principle, with complete information, we could predict outcomes precisely</li>
</ul>
</section>
<section id="quantum-randomness-1" class="level4" data-number="1.36.2.2">
<h4 data-number="1.36.2.2" class="anchored" data-anchor-id="quantum-randomness-1"><span class="header-section-number">1.36.2.2</span> Quantum Randomness</h4>
<ul>
<li><strong>Indeterminism</strong>: Randomness is a fundamental feature of reality</li>
<li><strong>No Hidden Variables</strong>: Even with complete information, some outcomes remain unpredictable (as suggested by Bell’s theorem)</li>
</ul>
</section>
</section>
<section id="practical-implications" class="level3" data-number="1.36.3">
<h3 data-number="1.36.3" class="anchored" data-anchor-id="practical-implications"><span class="header-section-number">1.36.3</span> Practical Implications</h3>
<section id="classical-randomness-1" class="level4" data-number="1.36.3.1">
<h4 data-number="1.36.3.1" class="anchored" data-anchor-id="classical-randomness-1"><span class="header-section-number">1.36.3.1</span> Classical Randomness</h4>
<ul>
<li><strong>Reducible</strong>: Can be reduced by gathering more data or improving measurement precision</li>
<li><strong>Controllable</strong>: Systematic errors can be identified and corrected</li>
</ul>
</section>
<section id="quantum-randomness-2" class="level4" data-number="1.36.3.2">
<h4 data-number="1.36.3.2" class="anchored" data-anchor-id="quantum-randomness-2"><span class="header-section-number">1.36.3.2</span> Quantum Randomness</h4>
<ul>
<li><strong>Irreducible</strong>: Cannot be eliminated even with perfect measurements</li>
<li><strong>Fundamentally Uncontrollable</strong>: The act of measurement itself affects the system</li>
</ul>
<p>Understanding these differences is crucial for correctly interpreting statistical models in different scientific contexts.</p>
</section>
</section>
</section>
<section id="appendix-f-ethical-considerations-in-social-science-data-analysis" class="level2" data-number="1.37">
<h2 data-number="1.37" class="anchored" data-anchor-id="appendix-f-ethical-considerations-in-social-science-data-analysis"><span class="header-section-number">1.37</span> Appendix F: Ethical Considerations in Social Science Data Analysis</h2>
<p>Ethics play a vital role in social science research. Key considerations include:</p>
<section id="privacy-and-consent" class="level3" data-number="1.37.1">
<h3 data-number="1.37.1" class="anchored" data-anchor-id="privacy-and-consent"><span class="header-section-number">1.37.1</span> 1. Privacy and Consent</h3>
<ul>
<li>Ensure participants understand how their data will be used</li>
<li>Obtain informed consent before collecting data</li>
<li>Protect personally identifiable information</li>
<li>Consider cultural differences in privacy expectations</li>
</ul>
</section>
<section id="data-protection" class="level3" data-number="1.37.2">
<h3 data-number="1.37.2" class="anchored" data-anchor-id="data-protection"><span class="header-section-number">1.37.2</span> 2. Data Protection</h3>
<ul>
<li>Securely store sensitive data</li>
<li>Implement appropriate access controls</li>
<li>Follow relevant regulations (e.g., GDPR, HIPAA)</li>
<li>Have a data management plan that includes secure disposal</li>
</ul>
</section>
<section id="bias-and-representation" class="level3" data-number="1.37.3">
<h3 data-number="1.37.3" class="anchored" data-anchor-id="bias-and-representation"><span class="header-section-number">1.37.3</span> 3. Bias and Representation</h3>
<ul>
<li>Address sampling bias that could exclude marginalized groups</li>
<li>Ensure diverse representation in research</li>
<li>Consider how variable definitions might reflect social biases</li>
<li>Be transparent about limitations in population coverage</li>
</ul>
</section>
<section id="transparency-and-reproducibility" class="level3" data-number="1.37.4">
<h3 data-number="1.37.4" class="anchored" data-anchor-id="transparency-and-reproducibility"><span class="header-section-number">1.37.4</span> 4. Transparency and Reproducibility</h3>
<ul>
<li>Clearly document research methods</li>
<li>Share code and data when possible</li>
<li>Pre-register studies when appropriate</li>
<li>Acknowledge limitations and potential biases</li>
</ul>
</section>
<section id="social-impact" class="level3" data-number="1.37.5">
<h3 data-number="1.37.5" class="anchored" data-anchor-id="social-impact"><span class="header-section-number">1.37.5</span> 5. Social Impact</h3>
<ul>
<li>Consider the potential societal implications of research findings</li>
<li>Avoid reinforcing harmful stereotypes</li>
<li>Think about how results might be misinterpreted or misused</li>
<li>Engage with communities being studied</li>
</ul>
<p>Ethical considerations should be integrated throughout the research process, from study design to data collection, analysis, and reporting of results.</p>
</section>
</section>
<section id="appendix-g-introduction-to-rstudio-and-the-tidyverse" class="level2" data-number="1.38">
<h2 data-number="1.38" class="anchored" data-anchor-id="appendix-g-introduction-to-rstudio-and-the-tidyverse"><span class="header-section-number">1.38</span> Appendix G: Introduction to RStudio and the tidyverse</h2>
<p>R is a powerful programming language for statistical computing and graphics. RStudio provides an integrated development environment that makes working with R easier.</p>
<section id="getting-started-with-rstudio" class="level3" data-number="1.38.1">
<h3 data-number="1.38.1" class="anchored" data-anchor-id="getting-started-with-rstudio"><span class="header-section-number">1.38.1</span> Getting Started with RStudio</h3>
<p>RStudio has four main panes:</p>
<ol type="1">
<li><strong>Source Editor</strong>: Where you write and edit your R scripts</li>
<li><strong>Console</strong>: Where you run R commands and see output</li>
<li><strong>Environment/History</strong>: Shows your workspace objects and command history</li>
<li><strong>Files/Plots/Packages/Help</strong>: For file management, viewing plots, managing packages, and accessing help</li>
</ol>
</section>
<section id="the-tidyverse-ecosystem" class="level3" data-number="1.38.2">
<h3 data-number="1.38.2" class="anchored" data-anchor-id="the-tidyverse-ecosystem"><span class="header-section-number">1.38.2</span> The tidyverse Ecosystem</h3>
<p>The tidyverse is a collection of R packages designed for data science with a consistent design philosophy.</p>
<p>Key packages include:</p>
<ul>
<li><strong>ggplot2</strong>: Data visualization</li>
<li><strong>dplyr</strong>: Data manipulation</li>
<li><strong>tidyr</strong>: Data tidying</li>
<li><strong>readr</strong>: Data import</li>
<li><strong>purrr</strong>: Functional programming</li>
<li><strong>tibble</strong>: Modern data frames</li>
</ul>
</section>
<section id="basic-tidyverse-workflow" class="level3" data-number="1.38.3">
<h3 data-number="1.38.3" class="anchored" data-anchor-id="basic-tidyverse-workflow"><span class="header-section-number">1.38.3</span> Basic tidyverse Workflow</h3>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load tidyverse</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"my_data.csv"</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean and transform</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(important_variable)) <span class="sc">%&gt;%</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(var1, var2, var3) <span class="sc">%&gt;%</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_var =</span> var1 <span class="sc">/</span> var2)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Group and summarize</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> cleaned_data <span class="sc">%&gt;%</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(category) <span class="sc">%&gt;%</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_val =</span> <span class="fu">mean</span>(var3),</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>()</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cleaned_data, <span class="fu">aes</span>(<span class="at">x =</span> var1, <span class="at">y =</span> var2, <span class="at">color =</span> category)) <span class="sc">+</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relationship between Variables"</span>,</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Variable 1"</span>,</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Variable 2"</span>) <span class="sc">+</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This workflow demonstrates the power of the tidyverse’s pipe operator (<code>%&gt;%</code>), which allows you to chain operations together in a readable way.</p>
</section>
<section id="resources-for-learning-r" class="level3" data-number="1.38.4">
<h3 data-number="1.38.4" class="anchored" data-anchor-id="resources-for-learning-r"><span class="header-section-number">1.38.4</span> Resources for Learning R</h3>
<ul>
<li><a href="https://r4ds.had.co.nz/">R for Data Science</a></li>
<li><a href="https://www.tidyverse.org/">tidyverse documentation</a></li>
<li><a href="https://www.rstudio.com/resources/cheatsheets/">RStudio Cheat Sheets</a></li>
<li><a href="https://quarto.org/docs/guide/">Quarto Guide</a></li>
</ul>
<p>The best way to learn R is through practice. Start with small, manageable projects and gradually build your skills.</p>
</section>
</section>
<section id="appendix-h-supplementary-content" class="level2" data-number="1.39">
<h2 data-number="1.39" class="anchored" data-anchor-id="appendix-h-supplementary-content"><span class="header-section-number">1.39</span> Appendix H: Supplementary Content (*)</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Optional: Proof that the sample mean is an unbiased estimator
</div>
</div>
<div class="callout-body-container callout-body">
<p>For the sample mean <span class="math inline">\bar{x}</span>, we can prove it’s an unbiased estimator of the population mean <span class="math inline">\mu</span> as follows:</p>
<p><span class="math inline">E(\bar{x}) = E\left(\frac{1}{n}\sum_{i=1}^{n}x_i\right)</span></p>
<p>Using the linearity property of expected values (the expected value of a sum equals the sum of expected values):</p>
<p><span class="math inline">E(\bar{x}) = \frac{1}{n}\sum_{i=1}^{n}E(x_i)</span></p>
<p>Since each <span class="math inline">x_i</span> is a random observation from the population with mean <span class="math inline">\mu</span>:</p>
<p><span class="math inline">E(x_i) = \mu \text{ for all } i</span></p>
<p>Therefore:</p>
<p><span class="math inline">E(\bar{x}) = \frac{1}{n}\sum_{i=1}^{n}\mu = \frac{1}{n} \cdot n \cdot \mu = \mu</span></p>
<p>This proves that the sample mean is an unbiased estimator of the population mean.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Optional: Understanding why the sample variance needs n-1 in the denominator
</div>
</div>
<div class="callout-body-container callout-body">
<p>The sample variance is commonly defined as:</p>
<p><span class="math inline">s^2 = \frac{1}{n-1}\sum_{i=1}^n (x_i - \bar{x})^2</span></p>
<p>Why do we use <span class="math inline">n-1</span> in the denominator rather than <span class="math inline">n</span>?</p>
<p>Let’s consider what happens if we used <span class="math inline">n</span> instead:</p>
<p><span class="math inline">\tilde{s}^2 = \frac{1}{n}\sum_{i=1}^n (x_i - \bar{x})^2</span></p>
<p>To check if this is unbiased, we need to find <span class="math inline">E(\tilde{s}^2)</span> and see if it equals <span class="math inline">\sigma^2</span>.</p>
<p>Without going through all the mathematical steps, the key insight is: 1. When we calculate <span class="math inline">(x_i - \bar{x})^2</span>, we’re using <span class="math inline">\bar{x}</span> (the sample mean) instead of <span class="math inline">\mu</span> (the population mean) 2. The sample mean <span class="math inline">\bar{x}</span> is itself estimated from the same data 3. This introduces a dependency that makes our variance estimator systematically underestimate the true variance 4. Specifically, <span class="math inline">E(\tilde{s}^2) = \frac{n-1}{n}\sigma^2</span>, which means it’s biased by a factor of <span class="math inline">\frac{n-1}{n}</span> 5. To correct this bias, we divide by <span class="math inline">n-1</span> instead of <span class="math inline">n</span>, giving us: <span class="math inline">E(s^2) = E\left(\frac{n}{n-1}\tilde{s}^2\right) = \frac{n}{n-1}E(\tilde{s}^2) = \frac{n}{n-1}\frac{n-1}{n}\sigma^2 = \sigma^2</span></p>
<p>Intuitively, we’re using <span class="math inline">n-1</span> because we’ve already “used up” one degree of freedom when estimating the mean. The denominator <span class="math inline">n-1</span> is called the “degrees of freedom” - the number of independent pieces of information available for estimating the variance after estimating the mean.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data Storage Methods in Data Science
</div>
</div>
<div class="callout-body-container callout-body">
<p>Data scientists use various methods to store data. Here are the most common ones:</p>
<hr>
<section id="csv-files" class="level3" data-number="1.39.1">
<h3 data-number="1.39.1" class="anchored" data-anchor-id="csv-files"><span class="header-section-number">1.39.1</span> <strong>CSV Files</strong></h3>
<p>These are simple text files where data is stored in rows, with values separated by commas.</p>
<ul>
<li><strong>Pros</strong>:
<ul>
<li>Easy to open and edit, even in a basic text editor.</li>
<li>Works with most data analysis tools.</li>
<li>Simple to share with others.</li>
</ul></li>
<li><strong>Cons</strong>:
<ul>
<li>Not suitable for complex data (e.g., images or videos).</li>
<li>Can be slow with very large datasets.</li>
<li>Sometimes issues with special characters (e.g., accents).</li>
</ul></li>
</ul>
<hr>
</section>
<section id="sql-databases" class="level3" data-number="1.39.2">
<h3 data-number="1.39.2" class="anchored" data-anchor-id="sql-databases"><span class="header-section-number">1.39.2</span> <strong>SQL Databases</strong></h3>
<p>These are advanced systems for storing data in tables that can be linked together.</p>
<ul>
<li><strong>Pros</strong>:
<ul>
<li>Ideal for managing complex data (e.g., orders and customers).</li>
<li>Fast searching and analysis.</li>
<li>Secure and reliable.</li>
</ul></li>
<li><strong>Cons</strong>:
<ul>
<li>Requires more expertise to manage.</li>
<li>Harder to adapt to changes in data structure.</li>
<li>Can be costly to maintain.</li>
</ul></li>
</ul>
<hr>
</section>
<section id="other-formats" class="level3" data-number="1.39.3">
<h3 data-number="1.39.3" class="anchored" data-anchor-id="other-formats"><span class="header-section-number">1.39.3</span> <strong>Other Formats</strong></h3>
<section id="parquet" class="level4" data-number="1.39.3.1">
<h4 data-number="1.39.3.1" class="anchored" data-anchor-id="parquet"><span class="header-section-number">1.39.3.1</span> <strong>Parquet</strong></h4>
<ul>
<li><strong>Pros</strong>:
<ul>
<li>Fast and efficient, especially for large datasets.</li>
<li>Saves space through compression.</li>
</ul></li>
<li><strong>Cons</strong>:
<ul>
<li>Harder to directly view or edit by humans.</li>
</ul></li>
</ul>
</section>
<section id="json" class="level4" data-number="1.39.3.2">
<h4 data-number="1.39.3.2" class="anchored" data-anchor-id="json"><span class="header-section-number">1.39.3.2</span> <strong>JSON</strong></h4>
<ul>
<li><strong>Pros</strong>:
<ul>
<li>Flexible, great for storing nested or complex data.</li>
<li>Human-readable.</li>
</ul></li>
<li><strong>Cons</strong>:
<ul>
<li>Takes up more space than CSV.</li>
<li>Slower to process.</li>
</ul></li>
</ul>
</section>
<section id="nosql" class="level4" data-number="1.39.3.3">
<h4 data-number="1.39.3.3" class="anchored" data-anchor-id="nosql"><span class="header-section-number">1.39.3.3</span> <strong>NoSQL</strong></h4>
<ul>
<li><strong>Pros</strong>:
<ul>
<li>Highly flexible, no fixed structure required.</li>
<li>Scalable, great for huge datasets.</li>
</ul></li>
<li><strong>Cons</strong>:
<ul>
<li>Less suitable for complex relationships between data.</li>
</ul></li>
</ul>
</section>
</section>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<section id="data-generating-process-superpopulation-population-and-sample" class="level2 callout-body-container callout-body" data-number="1.40">
<h2 data-number="1.40" class="anchored" data-anchor-id="data-generating-process-superpopulation-population-and-sample"><span class="header-section-number">1.40</span> Data Generating Process, Superpopulation, Population, and Sample</h2>
<p>To understand statistical inference, we must distinguish four key concepts: the <strong>Data Generating Process (DGP)</strong>, <strong>superpopulation</strong>, <strong>population</strong>, and <strong>sample</strong>. We’ll use an example of worker wages to illustrate these ideas.</p>
<hr>
<section id="data-generating-process-dgp" class="level3" data-number="1.40.1">
<h3 data-number="1.40.1" class="anchored" data-anchor-id="data-generating-process-dgp"><span class="header-section-number">1.40.1</span> Data Generating Process (DGP)</h3>
<p>The DGP is the “true” mechanism that produces the data we observe. It includes:<br>
- Systematic components (e.g., relationships between variables)<br>
- Random components (e.g., measurement error, unobserved factors)</p>
<p><strong>Example</strong>: Suppose a worker’s hourly wage (<span class="math inline">Y</span>) depends on their years of education (<span class="math inline">X</span>) and unobserved factors (<span class="math inline">\epsilon</span>):<br>
<span class="math display"> Y = 20 + 2.5X + \epsilon \quad \text{where } \epsilon \sim N(0, 5^2) </span></p>
<p>We can simulate this DGP in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate DGP for education (X) and wages (Y)</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>n_superpopulation <span class="ot">&lt;-</span> <span class="dv">100000</span>  <span class="co"># Superpopulation size</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>dgp_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">education =</span> <span class="fu">rpois</span>(n_superpopulation, <span class="at">lambda =</span> <span class="dv">10</span>),  <span class="co"># Years of education (~Poisson)</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">epsilon =</span> <span class="fu">rnorm</span>(n_superpopulation, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">wage =</span> <span class="dv">20</span> <span class="sc">+</span> <span class="fl">2.5</span> <span class="sc">*</span> education <span class="sc">+</span> epsilon</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the relationship</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dgp_data, <span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">y =</span> wage)) <span class="sc">+</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DGP: True Relationship Between Education and Wages"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="superpopulation" class="level3" data-number="1.40.2">
<h3 data-number="1.40.2" class="anchored" data-anchor-id="superpopulation"><span class="header-section-number">1.40.2</span> Superpopulation</h3>
<p>The superpopulation is a hypothetical, often infinite, set of potential observations from which our <em>observed</em> population is drawn. It is governed by the DGP.</p>
<p><strong>Example</strong>:<br>
- <strong>Superpopulation</strong>: All potential workers (past, present, future) whose wages follow the DGP above.<br>
- <strong>Observed population</strong>: A finite subset (e.g., all workers in 2024).</p>
<hr>
</section>
<section id="population" class="level3" data-number="1.40.3">
<h3 data-number="1.40.3" class="anchored" data-anchor-id="population"><span class="header-section-number">1.40.3</span> Population</h3>
<p>The population is the finite set of units we want to study. Its parameters (e.g., mean wage) are fixed but unknown.</p>
<p><strong>Example</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate our "population" (a finite subset of the superpopulation)</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> dgp_data <span class="sc">%&gt;%</span> <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">5000</span>)  <span class="co"># 5,000 workers</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># True population mean wage (unknown in practice)</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>pop_mean_wage <span class="ot">&lt;-</span> <span class="fu">mean</span>(population<span class="sc">$</span>wage)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>pop_mean_wage  <span class="co"># Display value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 45.08406</code></pre>
</div>
</div>
<hr>
</section>
<section id="sample" class="level3" data-number="1.40.4">
<h3 data-number="1.40.4" class="anchored" data-anchor-id="sample"><span class="header-section-number">1.40.4</span> Sample</h3>
<p>A sample is a subset of the population, used to estimate population parameters.</p>
<p><strong>Example</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a random sample from the population</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> population <span class="sc">%&gt;%</span> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> sample_size)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate mean wage from the sample</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>sample_mean_wage <span class="ot">&lt;-</span> <span class="fu">mean</span>(sample_data<span class="sc">$</span>wage)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>sample_mean_wage  <span class="co"># Compare to pop_mean_wage</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 44.647</code></pre>
</div>
</div>
<hr>
</section>
<section id="conceptual-diagram" class="level3" data-number="1.40.5">
<h3 data-number="1.40.5" class="anchored" data-anchor-id="conceptual-diagram"><span class="header-section-number">1.40.5</span> Conceptual Diagram</h3>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TD
  A[DGP&lt;br&gt;True wage model] --&gt; B[Superpopulation&lt;br&gt;All potential workers]
  B --&gt; C[Population&lt;br&gt;All workers in 2024]
  C --&gt; D[Sample&lt;br&gt;200 surveyed workers]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<hr>
</section>
<section id="why-this-matters" class="level3" data-number="1.40.6">
<h3 data-number="1.40.6" class="anchored" data-anchor-id="why-this-matters"><span class="header-section-number">1.40.6</span> Why This Matters</h3>
<ul>
<li><strong>Statistical inference</strong> uses the sample to estimate population parameters (e.g., mean wage).<br>
</li>
<li>The <strong>superpopulation</strong> framework allows us to generalize findings beyond the observed population.<br>
</li>
<li>The <strong>DGP</strong> reminds us that our models are approximations of reality.</li>
</ul>
<p><strong>Discussion Question</strong>: If the DGP includes <code>education</code> and <code>epsilon</code>, what might <code>epsilon</code> represent in the context of wages?</p>
</section>
<section id="examples-from-electoral-studies" class="level3" data-number="1.40.7">
<h3 data-number="1.40.7" class="anchored" data-anchor-id="examples-from-electoral-studies"><span class="header-section-number">1.40.7</span> Examples from Electoral Studies</h3>
<p><strong>Example 1: Voter Turnout</strong></p>
<ul>
<li><strong>DGP</strong>: <span class="math inline">Turnout_i = \beta_0 + \beta_1 Age_i + \beta_2 Education_i + \beta_3 Income_i + \varepsilon_i</span></li>
<li><strong>Superpopulation</strong>: All possible decisions to participate in elections that voters with different socio-demographic characteristics could make under different conditions</li>
<li><strong>Population</strong>: All eligible voters in the 2020 presidential election</li>
<li><strong>Sample</strong>: 1500 respondents of an exit poll after the election</li>
</ul>
<p><strong>Example 2: Support for Political Parties</strong></p>
<ul>
<li><strong>DGP</strong>: <span class="math inline">Support_{ij} = \beta_0 + \beta_1 Ideology_i + \beta_2 EconomicSituation_i + \beta_3 Age_i + \varepsilon_i</span></li>
<li><strong>Superpopulation</strong>: All possible electoral preferences of people with different characteristics in different socio-economic conditions</li>
<li><strong>Population</strong>: All voters in the United States in 2023</li>
<li><strong>Sample</strong>: Pre-election survey respondents (n=1000)</li>
</ul>
</section>
<section id="simulation-and-estimation-of-a-demand-function-as-dgp-in-r" class="level3" data-number="1.40.8">
<h3 data-number="1.40.8" class="anchored" data-anchor-id="simulation-and-estimation-of-a-demand-function-as-dgp-in-r"><span class="header-section-number">1.40.8</span> Simulation and Estimation of a Demand Function as DGP in R</h3>
<p>The following code illustrates how to simulate a demand function with multiple predictors as a DGP and estimate its parameters using OLS regression:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading required packages</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting random seed for reproducible results</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Defining the "true" DGP: Product demand function</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Model: Q = beta0 + beta1*P + beta2*I + beta3*P_sub + beta4*P_comp + beta5*A + epsilon</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Where:</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Q = quantity demanded</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co"># P = product price</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co"># I = consumer income</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co"># P_sub = price of substitute good</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co"># P_comp = price of complementary good</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co"># A = advertising expenditure</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="co"># True parameter values (consistent with economic theory)</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>beta0_true <span class="ot">&lt;-</span> <span class="dv">100</span>      <span class="co"># Constant</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>beta1_true <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.5</span>     <span class="co"># Own price effect (negative - according to the law of demand)</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>beta2_true <span class="ot">&lt;-</span> <span class="fl">0.8</span>      <span class="co"># Income effect (positive - normal good)</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>beta3_true <span class="ot">&lt;-</span> <span class="fl">1.2</span>      <span class="co"># Substitute price effect (positive)</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>beta4_true <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.7</span>     <span class="co"># Complementary good price effect (negative)</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>beta5_true <span class="ot">&lt;-</span> <span class="fl">0.5</span>      <span class="co"># Advertising effect (positive)</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>sigma_true <span class="ot">&lt;-</span> <span class="dv">5</span>        <span class="co"># Standard deviation of random error</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Simulating superpopulation (5000 potential markets/periods)</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>n_super <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating predictors</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_super, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)             <span class="co"># Product price ($)</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_super, <span class="at">mean =</span> <span class="dv">3000</span>, <span class="at">sd =</span> <span class="dv">500</span>)        <span class="co"># Average income ($)</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>price_substitute <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_super, <span class="at">min =</span> <span class="dv">4</span>, <span class="at">max =</span> <span class="dv">16</span>)  <span class="co"># Substitute price ($)</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>price_complement <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_super, <span class="at">min =</span> <span class="dv">2</span>, <span class="at">max =</span> <span class="dv">8</span>)   <span class="co"># Complement price ($)</span></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>advertising <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_super, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">100</span>)      <span class="co"># Advertising expenditure ($1000s)</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding correlation between variables (e.g., price and substitute price)</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>price_substitute <span class="ot">&lt;-</span> price_substitute <span class="sc">+</span> <span class="fu">rnorm</span>(n_super, <span class="at">mean =</span> <span class="fl">0.2</span> <span class="sc">*</span> price, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating demand according to DGP</span></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_super, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma_true)  <span class="co"># Random component</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>demand <span class="ot">&lt;-</span> beta0_true <span class="sc">+</span> </span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>         beta1_true <span class="sc">*</span> price <span class="sc">+</span> </span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>         beta2_true <span class="sc">*</span> (income<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">+</span>  <span class="co"># scaling income for better interpretation</span></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>         beta3_true <span class="sc">*</span> price_substitute <span class="sc">+</span> </span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>         beta4_true <span class="sc">*</span> price_complement <span class="sc">+</span> </span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>         beta5_true <span class="sc">*</span> (advertising<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span>   <span class="co"># scaling advertising for better interpretation</span></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>         epsilon</span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating superpopulation data frame</span></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>superpopulation <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n_super,</span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">price =</span> price,</span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">income =</span> income,</span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">price_substitute =</span> price_substitute,</span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">price_complement =</span> price_complement,</span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">advertising =</span> advertising,</span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">demand =</span> demand</span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Show first few observations</span></span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(superpopulation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
     id price income price_substitute price_complement advertising demand
  &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;       &lt;dbl&gt;  &lt;dbl&gt;
1     1  7.88  2661.            11.9              7.95        50.4   89.5
2     2 12.9   3287.             7.10             3.81        88.5   79.6
3     3  9.09  2648.            14.5              4.60        94.1   87.7
4     4 13.8   2733.            19.0              2.96        80.3   84.1
5     5 14.4   3387.            11.1              6.94        66.0   73.0
6     6  5.46  2762.            13.2              3.25        32.8   95.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Drawing a sample from superpopulation (e.g., 200 observations)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>n_sample <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>sample_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n_super, n_sample)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> superpopulation[sample_indices, ]</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Estimating OLS model based on the sample</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>ols_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(demand <span class="sc">~</span> price <span class="sc">+</span> <span class="fu">I</span>(income<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">+</span> price_substitute <span class="sc">+</span> </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>                price_complement <span class="sc">+</span> <span class="fu">I</span>(advertising<span class="sc">/</span><span class="dv">10</span>), <span class="at">data =</span> sample_data)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Displaying model summary</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ols_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = demand ~ price + I(income/1000) + price_substitute + 
    price_complement + I(advertising/10), data = sample_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.5705  -2.8401   0.1072   2.9881  14.1873 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        99.8079     2.7949  35.711  &lt; 2e-16 ***
price              -2.3571     0.1196 -19.711  &lt; 2e-16 ***
I(income/1000)      0.5259     0.6850   0.768 0.443582    
price_substitute    1.1635     0.0918  12.674  &lt; 2e-16 ***
price_complement   -0.7483     0.1933  -3.871 0.000148 ***
I(advertising/10)   0.5600     0.1170   4.785 3.38e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.843 on 194 degrees of freedom
Multiple R-squared:  0.7377,    Adjusted R-squared:  0.7309 
F-statistic: 109.1 on 5 and 194 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Comparing true parameters with estimated ones</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>true_parameters <span class="ot">&lt;-</span> <span class="fu">c</span>(beta0_true, beta1_true, beta2_true, </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>                     beta3_true, beta4_true, beta5_true)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>estimated_parameters <span class="ot">&lt;-</span> <span class="fu">coef</span>(ols_model)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameter =</span> <span class="fu">c</span>(<span class="st">"Intercept"</span>, <span class="st">"Price"</span>, <span class="st">"Income (thousands)"</span>, <span class="st">"Substitute price"</span>, </span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Complement price"</span>, <span class="st">"Advertising (10 thousands)"</span>),</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">true_value =</span> true_parameters,</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimated_value =</span> estimated_parameters,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">difference =</span> estimated_value <span class="sc">-</span> true_value,</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">percent_error =</span> <span class="fu">abs</span>(difference <span class="sc">/</span> true_value) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Display comparison</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  parameter                  true_value estimated_value difference percent_error
  &lt;chr&gt;                           &lt;dbl&gt;           &lt;dbl&gt;      &lt;dbl&gt;         &lt;dbl&gt;
1 Intercept                       100            99.8      -0.192          0.192
2 Price                            -2.5          -2.36      0.143          5.72 
3 Income (thousands)                0.8           0.526    -0.274         34.3  
4 Substitute price                  1.2           1.16     -0.0365         3.04 
5 Complement price                 -0.7          -0.748    -0.0483         6.90 
6 Advertising (10 thousands)        0.5           0.560     0.0600        12.0  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Visualizing comparison of true and estimated parameters</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comparison, <span class="fu">aes</span>(<span class="at">x =</span> parameter, <span class="at">y =</span> true_value)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimated_value), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> parameter, <span class="at">y =</span> true_value, </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> estimated_value), <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparison of True DGP with Estimated Model"</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Blue points: true values, Red points: estimated values"</span>,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Parameter"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) <span class="sc">+</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. Checking model's predictive ability on new data</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We draw new data from superpopulation (not used in estimation)</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>new_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n_super, sample_indices), <span class="dv">100</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> superpopulation[new_indices, ]</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction on new data</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>new_data<span class="sc">$</span>predicted_demand <span class="ot">&lt;-</span> <span class="fu">predict</span>(ols_model, <span class="at">newdata =</span> new_data)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating mean squared error (MSE) of prediction</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((new_data<span class="sc">$</span>demand <span class="sc">-</span> new_data<span class="sc">$</span>predicted_demand)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mse)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Root Mean Squared Error (RMSE):"</span>, <span class="fu">round</span>(rmse, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Root Mean Squared Error (RMSE): 5.47 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. Visualizing relationship between price and demand</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (ceteris paribus effect - controlling for other variables)</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>ceteris_paribus <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">price =</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">income =</span> <span class="fu">mean</span>(sample_data<span class="sc">$</span>income),</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">price_substitute =</span> <span class="fu">mean</span>(sample_data<span class="sc">$</span>price_substitute),</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">price_complement =</span> <span class="fu">mean</span>(sample_data<span class="sc">$</span>price_complement),</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">advertising =</span> <span class="fu">mean</span>(sample_data<span class="sc">$</span>advertising)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating predicted demand according to true DGP</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>ceteris_paribus<span class="sc">$</span>true_demand <span class="ot">&lt;-</span> beta0_true <span class="sc">+</span> </span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>                              beta1_true <span class="sc">*</span> ceteris_paribus<span class="sc">$</span>price <span class="sc">+</span> </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>                              beta2_true <span class="sc">*</span> (ceteris_paribus<span class="sc">$</span>income<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">+</span> </span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>                              beta3_true <span class="sc">*</span> ceteris_paribus<span class="sc">$</span>price_substitute <span class="sc">+</span> </span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>                              beta4_true <span class="sc">*</span> ceteris_paribus<span class="sc">$</span>price_complement <span class="sc">+</span> </span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>                              beta5_true <span class="sc">*</span> (ceteris_paribus<span class="sc">$</span>advertising<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating predicted demand according to estimated model</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>ceteris_paribus<span class="sc">$</span>estimated_demand <span class="ot">&lt;-</span> <span class="fu">predict</span>(ols_model, <span class="at">newdata =</span> ceteris_paribus)</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ceteris_paribus, <span class="fu">aes</span>(<span class="at">x =</span> price)) <span class="sc">+</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> true_demand, <span class="at">color =</span> <span class="st">"True DGP"</span>), <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimated_demand, <span class="at">color =</span> <span class="st">"Estimated model"</span>), <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"True DGP"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Estimated model"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Demand Curve: True DGP vs. Estimated Model"</span>,</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Ceteris paribus effect (with other variables held constant)"</span>,</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Product price ($)"</span>,</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Demand (quantity)"</span>,</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Model"</span>) <span class="sc">+</span></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This code demonstrates:</p>
<ol type="1">
<li>Defining a complex DGP for a demand function with multiple predictors consistent with economic theory</li>
<li>Simulating a superpopulation according to this DGP</li>
<li>Drawing a sample from the superpopulation</li>
<li>Estimating model parameters using OLS regression</li>
<li>Comparing estimated parameters with their true values</li>
<li>Visualizing the comparison of true and estimated parameters</li>
<li>Checking the model’s predictive ability on new data</li>
<li>Visualizing the relationship between price and demand with ceteris paribus effect</li>
</ol>
<p>This example shows how we can simulate complex economic relationships and then use econometric methods to discover these relationships based on a sample of data. It is an excellent illustration of how economic theory, DGP, and statistical methods are interconnected.</p>
<p>In reality, we never know the true DGP - that’s exactly what we’re trying to discover through statistical analysis. Simulations of this type, however, allow us to conceptually understand how statistical inference connects with the concept of DGP and superpopulation.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TD
    DGP[Data Generating Process] --&gt;|Generates| SP[Superpopulation]
    SP --&gt;|Single finite realization| A[Population]
    A --&gt;|Random Selection| B[Sample]
    B --&gt;|Statistical Inference| C[Estimates &amp; Conclusions]
    C --&gt;|Generalize back to| A
    C -.-&gt;|Infer parameters of| SP
    C -.-&gt;|Ultimate goal: estimate parameters of| DGP
    
    style DGP fill:#1E90FF,stroke:#000,stroke-width:4px,color:#FFF
    style SP fill:#9932CC,stroke:#000,stroke-width:4px,color:#FFF
    style A fill:#DC143C,stroke:#000,stroke-width:4px,color:#FFF
    style B fill:#228B22,stroke:#000,stroke-width:2px,color:#FFF
    style C fill:#8B4513,stroke:#000,stroke-width:2px,color:#FFF
    
    classDef note fill:#F0F0F0,stroke:#000,stroke-width:1px;
    H[["Superpopulation:
    All possible outcomes
    generated by the DGP
    (infinite, hypothetical)"]]
    D[["DGP:
    True mechanism with
    unknown parameters
    that generates data"]]
    E[["Population:
    Single, specific, finite
    realization from the
    superpopulation"]]
    F[["Sample:
    Observed subset
    of the population"]]
    G[["Inference:
    Drawing conclusions about
    population, superpopulation,
    and ultimately the DGP"]]
    
    class D,E,F,G,H note
    
    H --&gt; SP
    D --&gt; DGP
    E --&gt; A
    F --&gt; B
    G --&gt; C
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="supplementary-examples" class="level3" data-number="1.40.9">
<h3 data-number="1.40.9" class="anchored" data-anchor-id="supplementary-examples"><span class="header-section-number">1.40.9</span> Supplementary Examples</h3>
<section id="example-1-voter-opinion-survey" class="level4" data-number="1.40.9.1">
<h4 data-number="1.40.9.1" class="anchored" data-anchor-id="example-1-voter-opinion-survey"><span class="header-section-number">1.40.9.1</span> Example 1: Voter Opinion Survey</h4>
<ul>
<li><strong>Population</strong>: All registered voters in Poland in 2023 (approx. 30 million people).</li>
<li><strong>Sample</strong>: 1000 randomly selected voters surveyed in a poll.</li>
<li><strong>Superpopulation</strong>: All potential voters (current, future, and hypothetical) and all possible voting scenarios.</li>
<li><strong>DGP</strong> (Data Generating Process): The complex mechanism shaping voter opinions and decisions, including:
<ul>
<li>Demographic factors (age, education, place of residence).</li>
<li>Economic conditions (income, employment status).</li>
<li>Media influence and public debate.</li>
<li>Personal experiences.</li>
<li>Historical political context.</li>
</ul></li>
</ul>
</section>
<section id="example-2-study-of-a-diabetes-drugs-effectiveness" class="level4" data-number="1.40.9.2">
<h4 data-number="1.40.9.2" class="anchored" data-anchor-id="example-2-study-of-a-diabetes-drugs-effectiveness"><span class="header-section-number">1.40.9.2</span> Example 2: Study of a Diabetes Drug’s Effectiveness</h4>
<ul>
<li><strong>Population</strong>: All patients with type 2 diabetes in a given country (e.g., 2 million people).</li>
<li><strong>Sample</strong>: 500 patients participating in a clinical trial.</li>
<li><strong>Superpopulation</strong>: All potential patients with type 2 diabetes (current and future) with varying genetic and environmental profiles.</li>
<li><strong>DGP</strong>: The biological mechanism involving:
<ul>
<li>Drug interactions with receptors in the body.</li>
<li>Individual genetic predispositions.</li>
<li>Environmental factors (diet, physical activity).</li>
<li>Interactions with other medications.</li>
<li>Metabolic mechanisms of the body.</li>
</ul></li>
</ul>
</section>
<section id="example-3-when-the-sample-equals-the-population" class="level4" data-number="1.40.9.3">
<h4 data-number="1.40.9.3" class="anchored" data-anchor-id="example-3-when-the-sample-equals-the-population"><span class="header-section-number">1.40.9.3</span> Example 3: When the Sample Equals the Population</h4>
<p>Study of all 50 U.S. states:</p>
<ul>
<li><strong>Traditional Approach</strong>: No distinction between sample and population (all states are studied).</li>
<li><strong>Superpopulation Approach</strong>:
<ul>
<li><strong>Population/Sample</strong>: The 50 existing U.S. states.</li>
<li><strong>Superpopulation</strong>: The theoretical set of all possible territorial units resembling “states” under different historical, political, and social conditions.</li>
<li><strong>DGP</strong>: Fundamental geographic, historical, political, and socio-economic mechanisms shaping state characteristics.</li>
</ul></li>
</ul>
</section>
<section id="example-4-pizza-quality-in-new-york-city" class="level4" data-number="1.40.9.4">
<h4 data-number="1.40.9.4" class="anchored" data-anchor-id="example-4-pizza-quality-in-new-york-city"><span class="header-section-number">1.40.9.4</span> Example 4: Pizza Quality in New York City</h4>
<ul>
<li><strong>Population</strong>: All currently operating pizzerias in New York City (e.g., 2000 establishments).</li>
<li><strong>Sample</strong>: 50 randomly selected pizzerias from different neighborhoods.</li>
<li><strong>Superpopulation</strong>: All possible pizzerias that could exist in New York City:
<ul>
<li>Currently operating.</li>
<li>Future (not yet opened).</li>
<li>Historical (already closed).</li>
<li>Hypothetical (under alternative economic or cultural conditions).</li>
</ul></li>
<li><strong>DGP</strong>: Factors influencing pizza quality:
<ul>
<li>Ingredients and their quality.</li>
<li>Skills and experience of chefs.</li>
<li>Kitchen equipment and infrastructure.</li>
<li>Preparation methods and recipes.</li>
<li>Environmental factors (e.g., local water quality).</li>
<li>Cultural influences and culinary traditions.</li>
<li>Economic conditions (operational costs, rent).</li>
</ul></li>
</ul>
<p>The DGP is like a “recipe for pizza quality” that determines outcomes for all potential pizzerias in the superpopulation, not just the currently existing ones.</p>
</section>
</section>
</section>
</div>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Sample Size Considerations
</div>
</div>
<div class="callout-body-container callout-body">
<p>Determining the appropriate sample size is critical for reliable statistical analysis. The required sample size depends on three key factors:</p>
<ol type="1">
<li><strong>Type of Estimate</strong>
<ul>
<li>What are you estimating? (e.g., proportion, mean, regression parameter, etc.)</li>
</ul></li>
<li><strong>Desired Accuracy</strong>
<ul>
<li>Higher accuracy requires a larger sample size.<br>
</li>
<li>Example: Estimating within ±1% requires approximately 9 times more observations than estimating within ±3%.</li>
</ul></li>
<li><strong>Population Variability</strong>
<ul>
<li>For <strong>proportions</strong>: Maximum variability occurs at 50%, while variability decreases as proportions approach 0% or 100%.<br>
</li>
<li>For <strong>means</strong>: Variability depends on the variance of the measurements.<br>
</li>
<li>For <strong>regression models</strong>: Consider the variance of predictors and outcome variables.</li>
</ul></li>
</ol>
<hr>
<section id="small-population-considerations" class="level3" data-number="1.40.10">
<h3 data-number="1.40.10" class="anchored" data-anchor-id="small-population-considerations"><span class="header-section-number">1.40.10</span> Small Population Considerations</h3>
<p>When working with small populations (e.g., fewer than 1,000 individuals), special considerations apply:</p>
<ul>
<li><strong>Sampling Methods</strong>:
<ul>
<li>Simple random sampling traditionally assumes sampling <strong>with replacement</strong>.<br>
</li>
<li>In practice, sampling <strong>without replacement</strong> is more common.<br>
</li>
<li>The difference between these methods becomes significant in small populations.</li>
</ul></li>
<li><strong>Finite Population Correction (FPC)</strong>:
<ul>
<li>Essential when sampling more than 5-10% of the population.<br>
</li>
<li>Adjusts standard error calculations to account for the reduced variability in small populations.</li>
</ul></li>
</ul>
<section id="practical-recommendations-for-small-populations" class="level4" data-number="1.40.10.1">
<h4 data-number="1.40.10.1" class="anchored" data-anchor-id="practical-recommendations-for-small-populations"><span class="header-section-number">1.40.10.1</span> Practical Recommendations for Small Populations:</h4>
<ul>
<li>For populations under 200, consider conducting a <strong>complete census</strong>.<br>
</li>
<li>Use statistical formulas designed for sampling without replacement.<br>
</li>
<li>Standard formulas (based on sampling with replacement) overestimate error in small populations.<br>
</li>
<li>Clearly document the sampling methodology in research reports.</li>
</ul>
</section>
<section id="key-differences-between-sampling-methods" class="level4" data-number="1.40.10.2">
<h4 data-number="1.40.10.2" class="anchored" data-anchor-id="key-differences-between-sampling-methods"><span class="header-section-number">1.40.10.2</span> Key Differences Between Sampling Methods:</h4>
<ul>
<li><strong>Sampling with replacement</strong>: Each unit has a constant probability of selection (e.g., 1/N) in each draw.<br>
</li>
<li><strong>Sampling without replacement</strong>: Selection probability changes in subsequent draws (e.g., 1/N, 1/(N-1), 1/(N-2), etc.).<br>
</li>
<li>In large populations, the difference is negligible; in small populations, it is significant.<br>
</li>
<li>Sampling without replacement generally results in lower estimator variance.</li>
</ul>
<hr>
</section>
</section>
<section id="statistical-estimation-and-sample-size" class="level3" data-number="1.40.11">
<h3 data-number="1.40.11" class="anchored" data-anchor-id="statistical-estimation-and-sample-size"><span class="header-section-number">1.40.11</span> Statistical Estimation and Sample Size</h3>
<section id="proportions-percentages" class="level4" data-number="1.40.11.1">
<h4 data-number="1.40.11.1" class="anchored" data-anchor-id="proportions-percentages"><span class="header-section-number">1.40.11.1</span> Proportions (Percentages)</h4>
<p>When estimating a proportion (e.g., percentage of voters supporting a candidate), the required sample size depends on how close the proportion is to 50%.</p>
<p><strong>Why Proportions Near 50% Require Larger Samples</strong>:<br>
Proportions follow a binomial distribution, where variance is maximized at 50% and minimized at 0% or 100%. This means greater uncertainty and larger sample sizes are needed for proportions near 50%.</p>
<p><strong>Example</strong>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>True Population Proportion</th>
<th>Sample Size</th>
<th>Margin of Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>50%</td>
<td>100</td>
<td>±10%</td>
</tr>
<tr class="even">
<td>50%</td>
<td>400</td>
<td>±5%</td>
</tr>
<tr class="odd">
<td>50%</td>
<td>1,000</td>
<td>±3%</td>
</tr>
<tr class="even">
<td>10%</td>
<td>100</td>
<td>±6%</td>
</tr>
<tr class="odd">
<td>10%</td>
<td>400</td>
<td>±3%</td>
</tr>
<tr class="even">
<td>10%</td>
<td>1,000</td>
<td>±2%</td>
</tr>
</tbody>
</table>
<p><strong>Key Observations</strong>:<br>
1. <strong>Larger sample sizes reduce margin of error</strong>.<br>
2. <strong>Proportions near 50% have larger margins of error</strong> than those near 0% or 100%.</p>
<p><strong>Population Size Impact</strong>:<br>
For proportions near 50%, a sample size of ~1,000 provides a margin of error of ±3%, regardless of whether the population is 30,000 or 30 million. This explains why national polls can be accurate with relatively small samples.</p>
<hr>
</section>
<section id="averages-means" class="level4" data-number="1.40.11.2">
<h4 data-number="1.40.11.2" class="anchored" data-anchor-id="averages-means"><span class="header-section-number">1.40.11.2</span> Averages (Means)</h4>
<p>When estimating an average (e.g., household income or height):</p>
<ul>
<li>Sample size depends on the <strong>variance</strong> of the measurements.<br>
</li>
<li>Populations with greater variability require larger samples.<br>
</li>
<li>Unlike proportions, there is no “maximum uncertainty” at a specific value.<br>
</li>
<li>Sample size is directly proportional to the variance of the variable.</li>
</ul>
<p><strong>Example</strong>:<br>
Estimating average income typically requires a larger sample than estimating average height because income varies more widely.</p>
<hr>
</section>
<section id="model-parameters-and-complex-estimation" class="level4" data-number="1.40.11.3">
<h4 data-number="1.40.11.3" class="anchored" data-anchor-id="model-parameters-and-complex-estimation"><span class="header-section-number">1.40.11.3</span> Model Parameters and Complex Estimation</h4>
<p>Statistical modeling (e.g., regression) involves estimating relationships between variables. Sample size requirements become more nuanced in these contexts.</p>
<p><strong>Key Factors for Regression Models</strong>:<br>
1. <strong>Number of Parameters</strong>:<br>
- Each predictor variable and interaction term consumes degrees of freedom.<br>
- Rule of thumb: 10-20 observations per variable (minimum).<br>
- For detecting subtle effects: 50-100+ observations per variable may be needed.</p>
<ol start="2" type="1">
<li><strong>Effect Size</strong>:
<ul>
<li>Smaller effects require larger samples to detect reliably.<br>
</li>
<li>Conduct power analysis based on expected effect sizes.</li>
</ul></li>
<li><strong>Model Complexity</strong>:
<ul>
<li>Linear vs.&nbsp;non-linear relationships.<br>
</li>
<li>Interaction effects, nested/hierarchical data structures.<br>
</li>
<li>Non-normal distributions or heteroscedasticity.</li>
</ul></li>
<li><strong>Explained Variability</strong>:
<ul>
<li>Higher (R^2) values may reduce sample size requirements.<br>
</li>
<li>Greater residual variance increases sample size needs.</li>
</ul></li>
</ol>
<hr>
</section>
</section>
<section id="sample-size-planning-in-practice" class="level3" data-number="1.40.12">
<h3 data-number="1.40.12" class="anchored" data-anchor-id="sample-size-planning-in-practice"><span class="header-section-number">1.40.12</span> Sample Size Planning in Practice</h3>
<p>When planning a study, consider the following:</p>
<ol type="1">
<li><strong>Statistical Power</strong>:
<ul>
<li>Aim for at least 80% power to detect effects.<br>
</li>
<li>Conduct formal power analyses to determine sample size.</li>
</ul></li>
<li><strong>Precision</strong>:
<ul>
<li>Define the desired width of confidence intervals.<br>
</li>
<li>Greater precision requires larger samples.</li>
</ul></li>
<li><strong>Resource Constraints</strong>:
<ul>
<li>Balance statistical ideals with budget, time, and participant availability.<br>
</li>
<li>Consider sequential or adaptive sampling designs.</li>
</ul></li>
<li><strong>Ethical Considerations</strong>:
<ul>
<li>Collect enough data to answer research questions reliably.<br>
</li>
<li>Avoid unnecessary burden on participants or resource waste.</li>
</ul></li>
</ol>
<hr>
</section>
<section id="why-50-represents-maximum-uncertainty-for-proportions" class="level3" data-number="1.40.13">
<h3 data-number="1.40.13" class="anchored" data-anchor-id="why-50-represents-maximum-uncertainty-for-proportions"><span class="header-section-number">1.40.13</span> Why 50% Represents Maximum Uncertainty for Proportions</h3>
<p><strong>Simulation Example</strong>:<br>
Imagine a bag of 100 coins (gold or silver). You estimate the percentage of gold coins by drawing 20 coins repeatedly.</p>
<p><strong>Scenario A: 50% Gold (Maximum Uncertainty)</strong><br>
- Results vary widely (35% to 70%), with an average error of 10 percentage points.</p>
<p><strong>Scenario B: 10% Gold (Less Uncertainty)</strong><br>
- Results stay closer to the true value (0% to 15%), with an average error of 4 percentage points.</p>
<p><strong>Conclusion</strong>:<br>
Proportions near 50% have higher natural variability, requiring larger samples for accurate estimation.</p>
<hr>
</section>
<section id="opinion-poll-example-popular-vs.-unpopular-candidates" class="level3" data-number="1.40.14">
<h3 data-number="1.40.14" class="anchored" data-anchor-id="opinion-poll-example-popular-vs.-unpopular-candidates"><span class="header-section-number">1.40.14</span> Opinion Poll Example: Popular vs.&nbsp;Unpopular Candidates</h3>
<p>In a poll of 1,000 people:<br>
- <strong>Major candidate polling at 40%</strong>: Accuracy of ±3% (support between 37% and 43%).<br>
- <strong>Minor candidate polling at 3%</strong>: Accuracy of ±1% (support between 2% and 4%).</p>
<p><strong>Key Insight</strong>:<br>
- <strong>Absolute accuracy</strong> varies with the proportion.<br>
- <strong>Relative accuracy</strong> (as a percentage of the estimate) is higher for minor candidates.</p>
<hr>
</section>
<section id="summary-key-takeaways" class="level3" data-number="1.40.15">
<h3 data-number="1.40.15" class="anchored" data-anchor-id="summary-key-takeaways"><span class="header-section-number">1.40.15</span> Summary: Key Takeaways</h3>
<ol type="1">
<li><strong>Sample Size Depends On</strong>:
<ul>
<li>Type of estimate (proportion, mean, regression parameter).<br>
</li>
<li>Desired accuracy and population variability.<br>
</li>
<li>For proportions, values near 50% require larger samples.</li>
</ul></li>
<li><strong>Small Populations Require Special Considerations</strong>:
<ul>
<li>Use finite population correction.<br>
</li>
<li>Consider complete censuses for very small populations.</li>
</ul></li>
<li><strong>Statistical Power and Precision</strong>:
<ul>
<li>Aim for sufficient power and precision while balancing resource constraints.</li>
</ul></li>
<li><strong>Ethical and Practical Balance</strong>:
<ul>
<li>Ensure reliable results without overburdening participants or resources.</li>
</ul></li>
</ol>
<p>By understanding these principles, you can design studies that yield accurate and meaningful insights.</p>
</section>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Preface">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./rozdzial1.html" class="pagination-link" aria-label="Wprowadzenie do Nauki o Danych i Statystyki">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wprowadzenie do Nauki o Danych i Statystyki</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>