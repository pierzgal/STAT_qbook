<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; Introduction to Data Science and Statistics – Social Data Analysis: An Introduction (Wprowadzenie do analizy danych społecznych)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./rozdzial1.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter1.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Science and Statistics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Social Data Analysis: An Introduction (Wprowadzenie do analizy danych społecznych)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Science and Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wprowadzenie do Nauki o Danych i Statystyki</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Zrozumienie Typów Danych w Naukach Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">From Sample to Population - Understanding Randomness, Sampling, and Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Od Próby do Populacji - Zrozumienie Losowości, Próbkowania i Wnioskowania</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reliability and Validity in Data Science Research</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Rzetelność i Trafność w Badaniach Nauk o Danych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Research Designs: Experimental and Non-Experimental Approaches</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Projekty Badawcze: Podejścia Eksperymentalne i Nieeksperymentalne</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fundamentals of Univariate Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Podstawy Jednowymiarowej Statystyki Opisowej</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data Visualization: with examples in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Wizualizacja Danych: z przykładami w R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction to (Discrete) Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Wprowadzenie do Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rv_pdf_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Random Variables and Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rv_pdf_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Zmienna Losowa i Rozkład Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Statistical Hypothesis Testing: A Fundamental Logic</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Wprowadzenie do Wnioskowania Statystycznego: Logika Testowania Hipotez Statystycznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#what-are-statistics-and-data-science" id="toc-what-are-statistics-and-data-science" class="nav-link active" data-scroll-target="#what-are-statistics-and-data-science"><span class="header-section-number">1.1</span> What are Statistics and Data Science?</a></li>
  <li><a href="#the-relationship-between-statistics-and-data-science" id="toc-the-relationship-between-statistics-and-data-science" class="nav-link" data-scroll-target="#the-relationship-between-statistics-and-data-science"><span class="header-section-number">1.2</span> The Relationship Between Statistics and Data Science</a></li>
  <li><a href="#basic-concepts-in-data-science-and-statistics" id="toc-basic-concepts-in-data-science-and-statistics" class="nav-link" data-scroll-target="#basic-concepts-in-data-science-and-statistics"><span class="header-section-number">1.3</span> Basic Concepts in Data Science and Statistics</a>
  <ul class="collapse">
  <li><a href="#data-and-populations" id="toc-data-and-populations" class="nav-link" data-scroll-target="#data-and-populations"><span class="header-section-number">1.3.1</span> Data and Populations</a></li>
  <li><a href="#statistical-inference-how-can-a-small-sample-represent-a-large-population" id="toc-statistical-inference-how-can-a-small-sample-represent-a-large-population" class="nav-link" data-scroll-target="#statistical-inference-how-can-a-small-sample-represent-a-large-population"><span class="header-section-number">1.3.2</span> Statistical Inference: How Can a Small Sample Represent a Large Population?</a></li>
  <li><a href="#understanding-statistical-error" id="toc-understanding-statistical-error" class="nav-link" data-scroll-target="#understanding-statistical-error"><span class="header-section-number">1.3.3</span> Understanding Statistical Error</a></li>
  <li><a href="#sample-size-considerations" id="toc-sample-size-considerations" class="nav-link" data-scroll-target="#sample-size-considerations"><span class="header-section-number">1.3.11</span> Sample Size Considerations</a></li>
  <li><a href="#statistical-estimation-considerations" id="toc-statistical-estimation-considerations" class="nav-link" data-scroll-target="#statistical-estimation-considerations"><span class="header-section-number">1.3.12</span> Statistical Estimation Considerations</a></li>
  <li><a href="#maximum-uncertainty-for-proportion-example-why-50-is-the-worst-case" id="toc-maximum-uncertainty-for-proportion-example-why-50-is-the-worst-case" class="nav-link" data-scroll-target="#maximum-uncertainty-for-proportion-example-why-50-is-the-worst-case"><span class="header-section-number">1.3.13</span> Maximum Uncertainty for Proportion Example: Why 50% is the “Worst Case”</a></li>
  <li><a href="#summary-key-points-to-remember" id="toc-summary-key-points-to-remember" class="nav-link" data-scroll-target="#summary-key-points-to-remember"><span class="header-section-number">1.3.14</span> Summary: Key Points to Remember</a></li>
  </ul></li>
  <li><a href="#population-parameters" id="toc-population-parameters" class="nav-link" data-scroll-target="#population-parameters"><span class="header-section-number">1.4</span> Population Parameters</a></li>
  <li><a href="#distribution-of-sample-statistics" id="toc-distribution-of-sample-statistics" class="nav-link" data-scroll-target="#distribution-of-sample-statistics"><span class="header-section-number">1.5</span> Distribution of Sample Statistics</a></li>
  <li><a href="#expected-value-of-the-sample-statistic" id="toc-expected-value-of-the-sample-statistic" class="nav-link" data-scroll-target="#expected-value-of-the-sample-statistic"><span class="header-section-number">1.6</span> Expected Value of the Sample Statistic</a></li>
  <li><a href="#the-normal-distribution---the-bell-curve" id="toc-the-normal-distribution---the-bell-curve" class="nav-link" data-scroll-target="#the-normal-distribution---the-bell-curve"><span class="header-section-number">1.7</span> The Normal Distribution - The Bell Curve</a>
  <ul class="collapse">
  <li><a href="#mathematical-representation" id="toc-mathematical-representation" class="nav-link" data-scroll-target="#mathematical-representation"><span class="header-section-number">1.7.1</span> Mathematical Representation</a></li>
  <li><a href="#practical-significance-1" id="toc-practical-significance-1" class="nav-link" data-scroll-target="#practical-significance-1"><span class="header-section-number">1.7.2</span> Practical Significance</a></li>
  </ul></li>
  <li><a href="#types-of-data-and-variables" id="toc-types-of-data-and-variables" class="nav-link" data-scroll-target="#types-of-data-and-variables"><span class="header-section-number">1.8</span> Types of Data and Variables</a></li>
  <li><a href="#sources-of-data" id="toc-sources-of-data" class="nav-link" data-scroll-target="#sources-of-data"><span class="header-section-number">1.9</span> Sources of Data</a></li>
  <li><a href="#variables-and-constants" id="toc-variables-and-constants" class="nav-link" data-scroll-target="#variables-and-constants"><span class="header-section-number">1.10</span> Variables and Constants</a>
  <ul class="collapse">
  <li><a href="#classification-of-variables" id="toc-classification-of-variables" class="nav-link" data-scroll-target="#classification-of-variables"><span class="header-section-number">1.10.1</span> Classification of Variables</a></li>
  </ul></li>
  <li><a href="#statistical-estimation-concepts" id="toc-statistical-estimation-concepts" class="nav-link" data-scroll-target="#statistical-estimation-concepts"><span class="header-section-number">1.11</span> Statistical Estimation Concepts</a></li>
  <li><a href="#population-parameter-estimand" id="toc-population-parameter-estimand" class="nav-link" data-scroll-target="#population-parameter-estimand"><span class="header-section-number">1.12</span> Population Parameter (Estimand)</a></li>
  <li><a href="#estimator-statistic" id="toc-estimator-statistic" class="nav-link" data-scroll-target="#estimator-statistic"><span class="header-section-number">1.13</span> Estimator (Statistic)</a></li>
  <li><a href="#estimate" id="toc-estimate" class="nav-link" data-scroll-target="#estimate"><span class="header-section-number">1.14</span> Estimate</a></li>
  <li><a href="#properties-of-good-estimators" id="toc-properties-of-good-estimators" class="nav-link" data-scroll-target="#properties-of-good-estimators"><span class="header-section-number">1.15</span> Properties of Good Estimators</a></li>
  <li><a href="#statistical-models-and-inference" id="toc-statistical-models-and-inference" class="nav-link" data-scroll-target="#statistical-models-and-inference"><span class="header-section-number">1.16</span> Statistical Models and Inference</a>
  <ul class="collapse">
  <li><a href="#statistical-models" id="toc-statistical-models" class="nav-link" data-scroll-target="#statistical-models"><span class="header-section-number">1.16.1</span> Statistical Models</a></li>
  <li><a href="#causal-vs.-predictive-inference" id="toc-causal-vs.-predictive-inference" class="nav-link" data-scroll-target="#causal-vs.-predictive-inference"><span class="header-section-number">1.16.2</span> Causal vs.&nbsp;Predictive Inference</a></li>
  <li><a href="#challenges-of-causal-inference" id="toc-challenges-of-causal-inference" class="nav-link" data-scroll-target="#challenges-of-causal-inference"><span class="header-section-number">1.16.3</span> Challenges of Causal Inference</a></li>
  </ul></li>
  <li><a href="#statistical-inference" id="toc-statistical-inference" class="nav-link" data-scroll-target="#statistical-inference"><span class="header-section-number">1.17</span> Statistical Inference</a>
  <ul class="collapse">
  <li><a href="#estimation" id="toc-estimation" class="nav-link" data-scroll-target="#estimation"><span class="header-section-number">1.17.1</span> 1. Estimation</a></li>
  <li><a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing"><span class="header-section-number">1.17.2</span> 2. Hypothesis Testing</a></li>
  <li><a href="#types-of-errors-in-hypothesis-testing" id="toc-types-of-errors-in-hypothesis-testing" class="nav-link" data-scroll-target="#types-of-errors-in-hypothesis-testing"><span class="header-section-number">1.17.3</span> Types of Errors in Hypothesis Testing</a></li>
  </ul></li>
  <li><a href="#foundations-for-good-statistical-research" id="toc-foundations-for-good-statistical-research" class="nav-link" data-scroll-target="#foundations-for-good-statistical-research"><span class="header-section-number">1.18</span> Foundations for Good Statistical Research</a>
  <ul class="collapse">
  <li><a href="#summary-of-key-concepts" id="toc-summary-of-key-concepts" class="nav-link" data-scroll-target="#summary-of-key-concepts"><span class="header-section-number">1.18.1</span> Summary of Key Concepts</a></li>
  </ul></li>
  <li><a href="#appendices-additional-topics-in-statistics-and-data-science" id="toc-appendices-additional-topics-in-statistics-and-data-science" class="nav-link" data-scroll-target="#appendices-additional-topics-in-statistics-and-data-science"><span class="header-section-number">2</span> Appendices: Additional Topics in Statistics and Data Science (*)</a>
  <ul class="collapse">
  <li><a href="#appendix-a-r-for-social-science-data-analysis" id="toc-appendix-a-r-for-social-science-data-analysis" class="nav-link" data-scroll-target="#appendix-a-r-for-social-science-data-analysis"><span class="header-section-number">2.1</span> Appendix A: R for Social Science Data Analysis</a></li>
  <li><a href="#appendix-b-causal-inference-vs.-observational-studies" id="toc-appendix-b-causal-inference-vs.-observational-studies" class="nav-link" data-scroll-target="#appendix-b-causal-inference-vs.-observational-studies"><span class="header-section-number">2.2</span> Appendix B: Causal Inference vs.&nbsp;Observational Studies</a>
  <ul class="collapse">
  <li><a href="#causal-inference" id="toc-causal-inference" class="nav-link" data-scroll-target="#causal-inference"><span class="header-section-number">2.2.1</span> Causal Inference</a></li>
  <li><a href="#observational-studies" id="toc-observational-studies" class="nav-link" data-scroll-target="#observational-studies"><span class="header-section-number">2.2.2</span> Observational Studies</a></li>
  <li><a href="#challenges-in-establishing-causality" id="toc-challenges-in-establishing-causality" class="nav-link" data-scroll-target="#challenges-in-establishing-causality"><span class="header-section-number">2.2.3</span> Challenges in Establishing Causality</a></li>
  <li><a href="#methods-to-strengthen-causal-claims" id="toc-methods-to-strengthen-causal-claims" class="nav-link" data-scroll-target="#methods-to-strengthen-causal-claims"><span class="header-section-number">2.2.4</span> Methods to Strengthen Causal Claims</a></li>
  </ul></li>
  <li><a href="#appendix-c-understanding-spurious-correlations-confounders-and-colliders" id="toc-appendix-c-understanding-spurious-correlations-confounders-and-colliders" class="nav-link" data-scroll-target="#appendix-c-understanding-spurious-correlations-confounders-and-colliders"><span class="header-section-number">2.3</span> Appendix C: Understanding Spurious Correlations, Confounders, and Colliders</a>
  <ul class="collapse">
  <li><a href="#spurious-correlations" id="toc-spurious-correlations" class="nav-link" data-scroll-target="#spurious-correlations"><span class="header-section-number">2.3.1</span> Spurious Correlations</a></li>
  <li><a href="#confounders" id="toc-confounders" class="nav-link" data-scroll-target="#confounders"><span class="header-section-number">2.3.2</span> Confounders</a></li>
  <li><a href="#colliders" id="toc-colliders" class="nav-link" data-scroll-target="#colliders"><span class="header-section-number">2.3.3</span> Colliders</a></li>
  <li><a href="#simpsons-paradox" id="toc-simpsons-paradox" class="nav-link" data-scroll-target="#simpsons-paradox"><span class="header-section-number">2.3.4</span> Simpson’s Paradox</a></li>
  <li><a href="#directed-acyclic-graphs-dags" id="toc-directed-acyclic-graphs-dags" class="nav-link" data-scroll-target="#directed-acyclic-graphs-dags"><span class="header-section-number">2.3.5</span> Directed Acyclic Graphs (DAGs)</a></li>
  </ul></li>
  <li><a href="#appendix-d-models-in-science-from-deterministic-to-stochastic" id="toc-appendix-d-models-in-science-from-deterministic-to-stochastic" class="nav-link" data-scroll-target="#appendix-d-models-in-science-from-deterministic-to-stochastic"><span class="header-section-number">2.4</span> Appendix D: Models in Science: From Deterministic to Stochastic</a>
  <ul class="collapse">
  <li><a href="#types-of-models" id="toc-types-of-models" class="nav-link" data-scroll-target="#types-of-models"><span class="header-section-number">2.4.1</span> Types of Models</a></li>
  <li><a href="#model-error-and-bias-variance-tradeoff" id="toc-model-error-and-bias-variance-tradeoff" class="nav-link" data-scroll-target="#model-error-and-bias-variance-tradeoff"><span class="header-section-number">2.4.2</span> Model Error and Bias-Variance Tradeoff</a></li>
  </ul></li>
  <li><a href="#appendix-e-classical-vs-quantum-randomness" id="toc-appendix-e-classical-vs-quantum-randomness" class="nav-link" data-scroll-target="#appendix-e-classical-vs-quantum-randomness"><span class="header-section-number">2.5</span> Appendix E: Classical vs Quantum Randomness</a>
  <ul class="collapse">
  <li><a href="#origin-of-randomness" id="toc-origin-of-randomness" class="nav-link" data-scroll-target="#origin-of-randomness"><span class="header-section-number">2.5.1</span> Origin of Randomness</a></li>
  <li><a href="#philosophical-implications" id="toc-philosophical-implications" class="nav-link" data-scroll-target="#philosophical-implications"><span class="header-section-number">2.5.2</span> Philosophical Implications</a></li>
  <li><a href="#practical-implications" id="toc-practical-implications" class="nav-link" data-scroll-target="#practical-implications"><span class="header-section-number">2.5.3</span> Practical Implications</a></li>
  </ul></li>
  <li><a href="#appendix-f-ethical-considerations-in-social-science-data-analysis" id="toc-appendix-f-ethical-considerations-in-social-science-data-analysis" class="nav-link" data-scroll-target="#appendix-f-ethical-considerations-in-social-science-data-analysis"><span class="header-section-number">2.6</span> Appendix F: Ethical Considerations in Social Science Data Analysis</a>
  <ul class="collapse">
  <li><a href="#privacy-and-consent" id="toc-privacy-and-consent" class="nav-link" data-scroll-target="#privacy-and-consent"><span class="header-section-number">2.6.1</span> 1. Privacy and Consent</a></li>
  <li><a href="#data-protection" id="toc-data-protection" class="nav-link" data-scroll-target="#data-protection"><span class="header-section-number">2.6.2</span> 2. Data Protection</a></li>
  <li><a href="#bias-and-representation" id="toc-bias-and-representation" class="nav-link" data-scroll-target="#bias-and-representation"><span class="header-section-number">2.6.3</span> 3. Bias and Representation</a></li>
  <li><a href="#transparency-and-reproducibility" id="toc-transparency-and-reproducibility" class="nav-link" data-scroll-target="#transparency-and-reproducibility"><span class="header-section-number">2.6.4</span> 4. Transparency and Reproducibility</a></li>
  <li><a href="#social-impact" id="toc-social-impact" class="nav-link" data-scroll-target="#social-impact"><span class="header-section-number">2.6.5</span> 5. Social Impact</a></li>
  </ul></li>
  <li><a href="#appendix-g-introduction-to-rstudio-and-the-tidyverse" id="toc-appendix-g-introduction-to-rstudio-and-the-tidyverse" class="nav-link" data-scroll-target="#appendix-g-introduction-to-rstudio-and-the-tidyverse"><span class="header-section-number">2.7</span> Appendix G: Introduction to RStudio and the tidyverse</a>
  <ul class="collapse">
  <li><a href="#getting-started-with-rstudio" id="toc-getting-started-with-rstudio" class="nav-link" data-scroll-target="#getting-started-with-rstudio"><span class="header-section-number">2.7.1</span> Getting Started with RStudio</a></li>
  <li><a href="#the-tidyverse-ecosystem" id="toc-the-tidyverse-ecosystem" class="nav-link" data-scroll-target="#the-tidyverse-ecosystem"><span class="header-section-number">2.7.2</span> The tidyverse Ecosystem</a></li>
  <li><a href="#basic-tidyverse-workflow" id="toc-basic-tidyverse-workflow" class="nav-link" data-scroll-target="#basic-tidyverse-workflow"><span class="header-section-number">2.7.3</span> Basic tidyverse Workflow</a></li>
  <li><a href="#resources-for-learning-r" id="toc-resources-for-learning-r" class="nav-link" data-scroll-target="#resources-for-learning-r"><span class="header-section-number">2.7.4</span> Resources for Learning R</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Science and Statistics</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="what-are-statistics-and-data-science" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="what-are-statistics-and-data-science"><span class="header-section-number">1.1</span> What are Statistics and Data Science?</h2>
<blockquote class="blockquote">
<p><strong>Important</strong></p>
<p>Statistics and data science are both the art and science of learning from data – they help us understand the world through methodical analysis of collected information.</p>
</blockquote>
<p>Statistics and data science provide essential tools for social science researchers, regardless of specialization. Whether you study political science, economics, sociology, or another social science field, these tools enable you to:</p>
<ul>
<li>Analyze social trends and behaviors</li>
<li>Measure the effects of various policies</li>
<li>Form conclusions based on empirical evidence rather than intuition</li>
</ul>
<p>Statistics provides the mathematical foundations for data analysis, including research design, information synthesis, and hypothesis testing. Data science extends these capabilities by combining statistics with programming skills and domain knowledge, enabling work with complex datasets.</p>
<p>In today’s digital era, with rapidly expanding available data, these analytical competencies have become essential for contemporary researchers and social science specialists.</p>
<blockquote class="blockquote">
<p><strong>Note</strong></p>
<p>In social sciences, data science constitutes a set of methods for solving complex research problems – combining statistical approaches, computational tools, and specialized knowledge to more effectively analyze social processes.</p>
</blockquote>
</section>
<section id="the-relationship-between-statistics-and-data-science" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="the-relationship-between-statistics-and-data-science"><span class="header-section-number">1.2</span> The Relationship Between Statistics and Data Science</h2>
<p>Rather than viewing statistics and data science as separate disciplines, it’s more helpful to see them as complementary approaches within the spectrum of data analysis methods. Data science can be understood as a contemporary extension of traditional statistics that has evolved in response to:</p>
<ul>
<li>New technological possibilities</li>
<li>The need to analyze increasingly complex social data</li>
<li>The availability of computational tools for handling large datasets</li>
</ul>
</section>
<section id="basic-concepts-in-data-science-and-statistics" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="basic-concepts-in-data-science-and-statistics"><span class="header-section-number">1.3</span> Basic Concepts in Data Science and Statistics</h2>
<section id="data-and-populations" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="data-and-populations"><span class="header-section-number">1.3.1</span> Data and Populations</h3>
<ol type="1">
<li><p><strong>Data</strong>: Information collected during research – this includes survey responses, experimental results, economic indicators, social media content, or any other measurable observations.</p></li>
<li><p><strong>Population</strong>: The complete set of units (individuals, institutions, events) that the research concerns – the entire group about which the researcher wants to draw conclusions.</p>
<ul>
<li><em>Example</em>: In a study of voting preferences, the population consists of all citizens eligible to vote in a given country.</li>
</ul></li>
<li><p><strong>Sample</strong>: A subset of the population selected for study. A <strong>representative</strong> sample reflects the key characteristics of the target population in appropriate proportions.</p>
<ul>
<li><em>Example</em>: Instead of studying all eligible voters, researchers might analyze 1,500 randomly selected individuals, accounting for the appropriate distribution of age, gender, education, and region of residence.</li>
</ul>
<p>A properly selected sample enables inference about the entire population while significantly reducing research costs and time.</p></li>
<li><p><strong>Sampling</strong>: The procedure of selecting individuals from a population for investigation. An unbiased sampling method gives every individual in the population an equal chance of selection, ensuring representative results.</p></li>
<li><p><strong>Statistical inference</strong>: The process of drawing conclusions about a population based on data from a sample. It involves:</p>
<ul>
<li>Calculating estimates for population parameters</li>
<li>Assessing the reliability of these estimates</li>
<li>Testing hypotheses about population characteristics</li>
</ul></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/population_vs_sample.png" class="img-fluid figure-img"></p>
<figcaption>The process of using a sample to estimate a population parameter. In this example, a sample of 10 individuals found 6 who own an iPhone, yielding an estimated population proportion of 60%. The actual population proportion is 53.8%.</figcaption>
</figure>
</div>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TD
    DGP[Data Generating Process] --&gt;|Generates| A[Population]
    A --&gt;|Random Selection| B[Sample]
    B --&gt;|Statistical Inference| C[Estimates &amp; Conclusions]
    C --&gt;|Generalize back to| A
    C -.-&gt;|Attempt to understand| DGP

    style DGP fill:#1E90FF,stroke:#000,stroke-width:4px,color:#FFF
    style A fill:#DC143C,stroke:#000,stroke-width:4px,color:#FFF
    style B fill:#228B22,stroke:#000,stroke-width:2px,color:#FFF
    style C fill:#8B4513,stroke:#000,stroke-width:2px,color:#FFF
    
    classDef note fill:#F0F0F0,stroke:#000,stroke-width:1px;
    D[["DGP:
    Underlying process
    that generates data"]]
    E[["Population:
    Entire group of interest"]]
    F[["Sample:
    Subset of population"]]
    G[["Inference:
    Drawing conclusions
    about population
    and DGP"]]
    
    class D,E,F,G note
    
    D --&gt; DGP
    E --&gt; A
    F --&gt; B
    G --&gt; C
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data Storage Methods in Data Science
</div>
</div>
<div class="callout-body-container callout-body">
<p>Data scientists commonly work with several storage formats:</p>
<ul>
<li><strong>CSV (Comma-Separated Values)</strong>: Simple text files where values are separated by commas.
<ul>
<li><strong>Advantages</strong>: Portable, human-readable, supported by all analytical tools, easy to share.</li>
<li><strong>Disadvantages</strong>: No support for complex data types, limited scalability for large datasets, no relationship handling, character encoding issues.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reading CSV in R</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"dataset.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reading CSV in Python</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">"dataset.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>SQL Databases</strong>: Relational databases that store data in tables with defined relationships.
<ul>
<li><strong>Advantages</strong>: Excellent handling of complex relationships, support for transactions, concurrency and data integrity, optimized queries, scalability.</li>
<li><strong>Disadvantages</strong>: Higher complexity to manage, rigid data structure, higher maintenance costs, horizontal scaling challenges.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Connecting to SQL database in R</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), <span class="st">"database.db"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"SELECT * FROM table_name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Connecting to SQL database in Python</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>conn <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"database.db"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * FROM table_name"</span>, conn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>Other formats</strong>:
<ul>
<li><strong>Parquet</strong>:
<ul>
<li><strong>Advantages</strong>: Columnar storage increasing query performance, compression, efficient handling of large datasets.</li>
<li><strong>Disadvantages</strong>: Less flexibility for modifications, limited human readability.</li>
</ul></li>
<li><strong>JSON</strong>:
<ul>
<li><strong>Advantages</strong>: Flexibility for nested data, widespread support, human readability.</li>
<li><strong>Disadvantages</strong>: Larger file sizes, slower parsing, lack of type standardization.</li>
</ul></li>
<li><strong>NoSQL</strong>:
<ul>
<li><strong>Advantages</strong>: Schema flexibility, excellent horizontal scalability, performance for specific use cases.</li>
<li><strong>Disadvantages</strong>: Limited data consistency, less advanced querying, reduced support for complex relationships.</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="statistical-inference-how-can-a-small-sample-represent-a-large-population" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="statistical-inference-how-can-a-small-sample-represent-a-large-population"><span class="header-section-number">1.3.2</span> Statistical Inference: How Can a Small Sample Represent a Large Population?</h3>
<p>When pollsters survey just 1,000 voters to predict an election with 30,000,000 voters (only 0.003% of the population), it might seem puzzling. How can such a tiny fraction tell us about the whole?</p>
<p>It’s similar to tasting soup. When you cook a large pot of soup and stir it thoroughly, you don’t need to eat the entire pot to know how it tastes. A single spoonful is enough—as long as the soup is well-stirred.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>The Soup Analogy: A Taste of Statistics</strong></p>
<p><img src="stat_imgs/soup-svgrepo-com.svg" class="img-fluid" style="width:30.0%"></p>
<ul>
<li>When you taste a spoonful of soup and decide it isn’t salty enough, that’s exploratory/descriptive analysis.</li>
<li>If you generalize and conclude that your entire pot of soup needs salt, that’s an inference.</li>
<li>For your inference to be valid, the spoonful you tasted (the sample) needs to be representative of the entire pot (the population).</li>
<li>If the soup is not well stirred (heterogeneous population), it doesn’t matter how large a spoon you have (sample size), it will still not accurately represent the whole. If the soup is well stirred (homogeneous population), even a small spoon will suffice to test the soup.</li>
</ul>
</div>
</div>
<section id="why-random-sampling-works" class="level4" data-number="1.3.2.1">
<h4 data-number="1.3.2.1" class="anchored" data-anchor-id="why-random-sampling-works"><span class="header-section-number">1.3.2.1</span> Why Random Sampling Works</h4>
<p>Random sampling works because of three key principles:</p>
<ol type="1">
<li><p><strong>Equal opportunity</strong>: Every person in the population has the same chance of being selected, which prevents systematic bias.</p></li>
<li><p><strong>Representative diversity</strong>: When everyone has an equal chance, you naturally tend to get people from all different groups in roughly the same proportions as they exist in the population.</p>
<p><em>Example</em>: If 51% of voters are women, then about 51% of your random sample will likely be women (give or take some random variation).</p></li>
<li><p><strong>Law of large numbers</strong>: As your sample size (n) grows, random fluctuations become less influential and your sample statistics get closer to the true population values.</p>
<p><em>Example</em>: If you flip a fair coin 10 times, you might get 7 heads (70%). But if you flip it 1,000 times, you’re much more likely to get close to 500 heads (50%).</p></li>
</ol>
<p>Without proper random sampling, you could easily end up with a biased sample. For instance, if you only surveyed people at a shopping mall during weekday mornings, you’d miss most working people and students, giving you a skewed picture of the population.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Randomness as a Fundamental Law of Nature
</div>
</div>
<div class="callout-body-container callout-body">
<p>Randomness can be viewed as one of the fundamental laws of nature that shapes reality at multiple levels:</p>
<ul>
<li><p><strong>In quantum mechanics</strong>: Heisenberg’s uncertainty principle and the probabilistic nature of quantum phenomena indicate that randomness is built into the fundamental structure of reality, rather than merely resulting from imperfections in our measurements or knowledge</p></li>
<li><p><strong>In genetics</strong>: Random mutations and genetic recombinations constitute the basic mechanism of evolution and biological diversity</p></li>
<li><p><strong>In chaos theory</strong>: Deterministic systems can exhibit unpredictable behaviors due to sensitivity to initial conditions (the so-called “butterfly effect”)</p></li>
<li><p><strong>In statistical research</strong>: Random sampling is the foundation for inferring properties of a population - without this natural property, we would not be able to formulate reliable generalizations from limited data sets</p></li>
</ul>
<p>This natural randomness becomes the foundation of empirical science methodology, particularly evident in two key aspects:</p>
<p><strong>1. Randomization in Experiments</strong></p>
<p>Randomization is the process of randomly assigning research units to experimental groups. It is a key element of experimental methodology that: - Minimizes the influence of confounding variables - Balances unknown factors between groups - Reduces the risk of systematic error - Enables the use of statistical tests for analyzing results</p>
<p>Example in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomization in an experiment</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>) <span class="co"># for reproducibility</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>participants <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>  <span class="co"># 30 study participants</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Control"</span>, <span class="dv">15</span>), <span class="fu">rep</span>(<span class="st">"Experimental"</span>, <span class="dv">15</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>random_assignment <span class="ot">&lt;-</span> <span class="fu">sample</span>(groups)  <span class="co"># random assignment to groups</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">data.frame</span>(<span class="at">ID =</span> participants[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">Group =</span> random_assignment[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ID        Group
1  1 Experimental
2  2      Control
3  3      Control
4  4 Experimental
5  5      Control
6  6      Control</code></pre>
</div>
</div>
<p><strong>2. Simple Random Sampling</strong></p>
<p>Simple random sampling is the basic method of taking a sample in which each element of the population has an equal chance of being included in the sample. This property of randomness: - Ensures sample representativeness - Enables inference about population parameters - Allows for calculating random errors and constructing confidence intervals</p>
<p>Example in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drawing a simple random sample from a population</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>  <span class="co"># population of 1000 elements</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">sample</span>(population, <span class="dv">50</span>)  <span class="co"># random sample of 50 elements</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sample_data)  <span class="co"># basic statistics of the drawn sample</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    3.0   249.2   405.5   473.7   719.8   993.0 </code></pre>
</div>
</div>
<p>Recognizing randomness as a law of nature changes our perception of reality - from a deterministic view, where everything is theoretically predictable with sufficient knowledge, to a stochastic one, where uncertainty and variability are inherent features of the world. This allows us to design studies that utilize this natural property to reliably understand the reality around us.</p>
</div>
</div>
</section>
</section>
<section id="understanding-statistical-error" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="understanding-statistical-error"><span class="header-section-number">1.3.3</span> Understanding Statistical Error</h3>
<p>When using a sample to learn about a population, we inevitably encounter statistical error:</p>
<p><strong>Statistical error</strong> is the difference between our sample estimate and the true population value.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Comprehensive Classification of Statistical Errors
</div>
</div>
<div class="callout-body-container callout-body">
<p>Statistical errors can compromise the validity and reliability of research findings. Understanding these errors is crucial for designing good studies, analyzing data correctly, and drawing appropriate conclusions. Here is a comprehensive classification of statistical errors:</p>
<section id="sampling-errors" class="level3" data-number="1.3.4">
<h3 data-number="1.3.4" class="anchored" data-anchor-id="sampling-errors"><span class="header-section-number">1.3.4</span> Sampling Errors</h3>
<p><strong>Random Sampling Errors</strong></p>
<ul>
<li>Think of these as the natural “luck of the draw” when selecting samples</li>
<li>Example: If you randomly select 30 students from a university to measure average height, you’ll likely get a slightly different average each time you take a sample</li>
<li>These errors get smaller as you include more people in your sample</li>
<li>Can’t be eliminated completely, but can be estimated using concepts like “margin of error”</li>
</ul>
<p><strong>Non-Random (Systematic) Sampling Errors (Bias)</strong></p>
<ul>
<li><strong>Selection bias</strong>: When your sample doesn’t fairly represent everyone it should
<ul>
<li>Example: Conducting a phone survey that only reaches people with landlines, missing those who only use cell phones</li>
</ul></li>
<li><strong>Undercoverage</strong>: When some groups are left out of your sample
<ul>
<li>Example: A campus survey conducted only during daytime classes would miss evening students</li>
</ul></li>
<li><strong>Self-selection bias</strong>: When people choose whether to participate, potentially skewing results
<ul>
<li>Example: Only people with strong opinions respond to a customer satisfaction survey</li>
</ul></li>
<li><strong>Non-response bias</strong>: When certain types of people tend not to answer surveys
<ul>
<li>Example: Very busy people might not complete your questionnaire, giving you results that over-represent those with more free time</li>
</ul></li>
</ul>
</section>
<section id="measurement-errors" class="level3" data-number="1.3.5">
<h3 data-number="1.3.5" class="anchored" data-anchor-id="measurement-errors"><span class="header-section-number">1.3.5</span> Measurement Errors</h3>
<p><strong>Random Measurement Errors</strong></p>
<ul>
<li>Unpredictable “noise” when measuring something</li>
<li>Example: A slightly shaky hand when measuring blood pressure gives slightly different readings each time</li>
<li>These tend to balance out with repeated measurements</li>
</ul>
<p><strong>Systematic Measurement Errors</strong></p>
<ul>
<li><strong>Calibration errors</strong>: When your measuring tool is consistently off
<ul>
<li>Example: A scale that always adds 2 pounds to everyone’s weight</li>
</ul></li>
<li><strong>Observer bias</strong>: When the person collecting data influences the measurements
<ul>
<li>Example: A researcher unconsciously recording data in a way that supports their hypothesis</li>
</ul></li>
<li><strong>Social desirability bias</strong>: When people answer questions how they think they “should” respond, not truthfully
<ul>
<li>Example: Underreporting how much junk food they eat in a nutrition study</li>
</ul></li>
</ul>
</section>
<section id="inference-errors" class="level3" data-number="1.3.6">
<h3 data-number="1.3.6" class="anchored" data-anchor-id="inference-errors"><span class="header-section-number">1.3.6</span> Inference Errors</h3>
<p><strong>Hypothesis Testing Errors</strong> (explained in simple terms)</p>
<ul>
<li><strong>Type I error</strong>: Seeing an effect or relationship that isn’t really there (false alarm)
<ul>
<li>Example: Concluding a medicine works when its benefits were just due to chance</li>
</ul></li>
<li><strong>Type II error</strong>: Missing an effect or relationship that actually exists (missed detection)
<ul>
<li>Example: Concluding a medicine doesn’t work when it actually does help patients</li>
</ul></li>
<li><strong>Type III error</strong>: Solving the wrong problem or asking the wrong question entirely
<ul>
<li>Example: Studying whether a teaching method improves test scores when the real question should be about improving long-term understanding</li>
</ul></li>
</ul>
<p><strong>Statistical Power Issues</strong></p>
<ul>
<li><strong>Underpowered studies</strong>: Not including enough participants to reliably detect effects
<ul>
<li>Example: Trying to test a weight loss program with only 5 people—too few to draw reliable conclusions</li>
</ul></li>
</ul>
</section>
<section id="model-specification-errors" class="level3" data-number="1.3.7">
<h3 data-number="1.3.7" class="anchored" data-anchor-id="model-specification-errors"><span class="header-section-number">1.3.7</span> Model Specification Errors</h3>
<p><strong>Variable Selection Errors</strong></p>
<ul>
<li><strong>Omitted variable bias</strong>: Leaving out important factors that affect your results
<ul>
<li>Example: Studying the relationship between exercise and weight loss without accounting for participants’ diets</li>
</ul></li>
<li><strong>Confounding</strong>: When an outside factor influences both what you’re testing and the outcome
<ul>
<li>Example: People who exercise (variable 1) might also tend to eat healthier (hidden factor), both of which affect weight loss (outcome)</li>
</ul></li>
</ul>
<p><strong>Assumption Errors</strong></p>
<ul>
<li>When the statistical test you’re using doesn’t match your data
<ul>
<li>Example: Using a test that assumes your data follows a bell curve when it actually doesn’t</li>
</ul></li>
</ul>
</section>
<section id="data-processing-and-analysis-errors" class="level3" data-number="1.3.8">
<h3 data-number="1.3.8" class="anchored" data-anchor-id="data-processing-and-analysis-errors"><span class="header-section-number">1.3.8</span> Data Processing and Analysis Errors</h3>
<p><strong>Data Handling Errors</strong></p>
<ul>
<li><strong>Data entry errors</strong>: Simple mistakes when recording information
<ul>
<li>Example: Typing “1050” instead of “150” for someone’s weight</li>
</ul></li>
<li><strong>Missing data problems</strong>: Not properly accounting for incomplete information
<ul>
<li>Example: Calculating the average test score while ignoring students who were absent</li>
</ul></li>
</ul>
<p><strong>Analysis Execution Errors</strong></p>
<ul>
<li><strong>Software bugs or user errors</strong>: Mistakes in how statistical programs are used
<ul>
<li>Example: Selecting the wrong type of test in your statistics software</li>
</ul></li>
</ul>
</section>
<section id="interpretation-and-reporting-errors" class="level3" data-number="1.3.9">
<h3 data-number="1.3.9" class="anchored" data-anchor-id="interpretation-and-reporting-errors"><span class="header-section-number">1.3.9</span> Interpretation and Reporting Errors</h3>
<p><strong>Causal Inference Errors</strong></p>
<ul>
<li><strong>Correlation-causation fallacy</strong>: Assuming that when two things happen together, one must cause the other
<ul>
<li>Example: Noticing that countries with more chocolate consumption have more Nobel Prize winners, and wrongly concluding that chocolate makes people smarter</li>
</ul></li>
</ul>
<p><strong>Reporting and Communication Errors</strong></p>
<ul>
<li><strong>p-hacking</strong>: Trying many different analyses until you find something “significant”
<ul>
<li>Example: Analyzing your data in 20 different ways and only reporting the one analysis that showed the result you wanted</li>
</ul></li>
<li><strong>Cherry-picking</strong>: Only sharing results that support your hypothesis
<ul>
<li>Example: A diet pill company only publishing studies where their product worked, hiding studies where it didn’t</li>
</ul></li>
</ul>
</section>
<section id="remedy-strategies" class="level3" data-number="1.3.10">
<h3 data-number="1.3.10" class="anchored" data-anchor-id="remedy-strategies"><span class="header-section-number">1.3.10</span> Remedy Strategies</h3>
<p>Ways to reduce these errors:</p>
<ul>
<li><strong>Proper research design</strong>: Planning studies carefully before collecting data</li>
<li><strong>Adequate sample size</strong>: Including enough participants based on statistical calculations</li>
<li><strong>Pre-registration</strong>: Declaring what you’ll analyze before seeing the data</li>
<li><strong>Transparency</strong>: Sharing your data and analysis methods with others</li>
<li><strong>Replication</strong>: Having different researchers repeat the study to see if they get similar results</li>
</ul>
<p>Understanding these errors helps ensure that research findings are trustworthy and that we don’t draw false conclusions that could lead to poor decisions in fields like medicine, public policy, education, and business.</p>
</section>
</div>
</div>
</section>
<section id="sample-size-considerations" class="level3" data-number="1.3.11">
<h3 data-number="1.3.11" class="anchored" data-anchor-id="sample-size-considerations"><span class="header-section-number">1.3.11</span> Sample Size Considerations</h3>
<p>The necessary sample size depends on three main factors:</p>
<ol type="1">
<li><p><strong>What type of estimate are you making?</strong> (proportion, average, regression parameter, etc.)</p></li>
<li><p><strong>How accurate do you need your estimate to be?</strong></p>
<ul>
<li>More accurate = larger sample</li>
<li>Example: Estimating within ±1% requires about 9 times more people than estimating within ±3%</li>
</ul></li>
<li><p><strong>How diverse is your population?</strong></p>
<ul>
<li>For proportions: Maximum variability occurs at 50%, minimum at 0% or 100%</li>
<li>For means: Check how much measurements differ from each other (variance)</li>
<li>For regression models: Consider the variance of your predictors and outcome variables</li>
</ul></li>
</ol>
<section id="small-population-considerations" class="level4" data-number="1.3.11.1">
<h4 data-number="1.3.11.1" class="anchored" data-anchor-id="small-population-considerations"><span class="header-section-number">1.3.11.1</span> Small Population Considerations</h4>
<p>When working with small populations (e.g., 1,000 people or fewer):</p>
<ul>
<li>There are significant methodological differences compared to large populations</li>
<li>A simple random sample traditionally assumes sampling with replacement</li>
<li>In research practice, sampling without replacement is typically used</li>
<li>The smaller the population, the greater the difference between these approaches</li>
<li>The <strong>finite population correction factor</strong> becomes essential when studying more than 5-10% of the population</li>
</ul>
<p><strong>Practical recommendations for small populations:</strong></p>
<ul>
<li>For populations under 200 units, consider a complete census</li>
<li>Use appropriate statistical formulas that account for sampling without replacement</li>
<li>Standard formulas for standard errors based on sampling with replacement will overestimate error in small populations</li>
<li>Clearly document the sampling mechanism in research reports</li>
</ul>
<p><strong>Explaining the difference:</strong></p>
<ul>
<li>Sampling with replacement: each unit has a constant probability of selection in each draw (e.g., 1/N)</li>
<li>Sampling without replacement: selection probability changes in subsequent draws (from 1/N to 1/(N-1), 1/(N-2), etc.)</li>
<li>In large populations, the difference is minimal; in small ones - fundamental</li>
<li>Sampling without replacement schemes often have lower estimator variance than sampling with replacement</li>
</ul>
</section>
</section>
<section id="statistical-estimation-considerations" class="level3" data-number="1.3.12">
<h3 data-number="1.3.12" class="anchored" data-anchor-id="statistical-estimation-considerations"><span class="header-section-number">1.3.12</span> Statistical Estimation Considerations</h3>
<section id="proportions-percentages" class="level4" data-number="1.3.12.1">
<h4 data-number="1.3.12.1" class="anchored" data-anchor-id="proportions-percentages"><span class="header-section-number">1.3.12.1</span> Proportions (percentages)</h4>
<p>When estimating a proportion (like the percentage of voters supporting a candidate), the required sample size depends heavily on how close that proportion is to 50%.</p>
<p><strong>Why proportions near 50% need larger samples:</strong></p>
<p>Let’s use a concrete example with different sample sizes to see why:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>True Population Proportion</th>
<th>Sample Size</th>
<th>Typical Margin of Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>50% (maximum uncertainty)</td>
<td>100</td>
<td>±10 percentage points</td>
</tr>
<tr class="even">
<td>50% (maximum uncertainty)</td>
<td>400</td>
<td>±5 percentage points</td>
</tr>
<tr class="odd">
<td>50% (maximum uncertainty)</td>
<td>1,000</td>
<td>±3 percentage points</td>
</tr>
<tr class="even">
<td>10% (less uncertainty)</td>
<td>100</td>
<td>±6 percentage points</td>
</tr>
<tr class="odd">
<td>10% (less uncertainty)</td>
<td>400</td>
<td>±3 percentage points</td>
</tr>
<tr class="even">
<td>10% (less uncertainty)</td>
<td>1,000</td>
<td>±2 percentage points</td>
</tr>
</tbody>
</table>
<p>These numbers demonstrate two important patterns: 1. <strong>As sample size increases, margin of error decreases</strong> (comparing across rows) 2. <strong>At the same sample size, proportions near 50% have larger margins of error</strong> than proportions near 0% or 100% (comparing 50% vs 10%)</p>
<p>This happens because proportions follow a binomial distribution, where the variance is maximum at p=0.5 (50%) and minimum at p=0 or p=1 (0% or 100%).</p>
<p><strong>Population size has minimal impact:</strong></p>
<p>For a typical election poll with proportions near 50%, about 1,000 randomly selected people provide accuracy around ±3 percentage points. Surprisingly, this sample size remains roughly the same whether your population is 30,000 or 30 million. This counterintuitive fact is why national polls can be accurate with relatively small samples.</p>
</section>
<section id="averages-means" class="level4" data-number="1.3.12.2">
<h4 data-number="1.3.12.2" class="anchored" data-anchor-id="averages-means"><span class="header-section-number">1.3.12.2</span> Averages (means)</h4>
<p>When estimating an average (like typical household income or height):</p>
<ul>
<li>An average summarizes continuous measurements that can take many different values</li>
<li>Sample size depends primarily on how much these measurements vary from person to person</li>
<li>Key considerations:
<ul>
<li>Populations with more varied measurements require larger samples</li>
<li>More precise estimates require larger samples</li>
<li>Unlike proportions, there is no “maximum uncertainty” at a certain value</li>
<li>The necessary sample size is directly proportional to the variance of the variable</li>
</ul></li>
<li>For example, estimating average income might require a larger sample than estimating average height because incomes typically vary more widely than heights</li>
</ul>
</section>
<section id="model-parameters-and-complex-estimation" class="level4" data-number="1.3.12.3">
<h4 data-number="1.3.12.3" class="anchored" data-anchor-id="model-parameters-and-complex-estimation"><span class="header-section-number">1.3.12.3</span> Model Parameters and Complex Estimation</h4>
<p>Statistical modeling extends beyond simple proportions and averages to examine relationships between variables and make predictions. Sample size requirements become more nuanced in these contexts.</p>
<section id="regression-model-parameters" class="level5" data-number="1.3.12.3.1">
<h5 data-number="1.3.12.3.1" class="anchored" data-anchor-id="regression-model-parameters"><span class="header-section-number">1.3.12.3.1</span> Regression Model Parameters</h5>
<p>Regression models describe how one variable (the dependent variable) relates to one or more other variables (the independent variables). Sample size considerations for regression include:</p>
<p><strong>Key factors affecting required sample size:</strong></p>
<ul>
<li><strong>Number of parameters</strong>: Each predictor variable and interaction term consumes “degrees of freedom”
<ul>
<li>More variables = larger sample needed</li>
<li>Rule of thumb: 10-20 observations per variable is a minimum starting point</li>
<li>For detecting subtle effects: may need 50-100+ observations per variable</li>
</ul></li>
<li><strong>Effect size</strong>: The strength of the relationships being studied
<ul>
<li>Smaller effects require larger samples to detect reliably</li>
<li>Power analysis should be conducted based on expected effect sizes</li>
</ul></li>
<li><strong>Variability explanations</strong>:
<ul>
<li><span class="math inline">R^2</span> values - higher values indicate models that explain more variance, potentially requiring smaller samples</li>
<li>Residual variance - greater unexplained variability requires larger samples</li>
</ul></li>
<li><strong>Model complexity</strong>:
<ul>
<li>Linear vs.&nbsp;non-linear relationships</li>
<li>Interaction effects</li>
<li>Nested or hierarchical data structures</li>
<li>Non-normal distributions or heteroscedasticity</li>
</ul></li>
</ul>
</section>
<section id="advanced-modeling-considerations" class="level5" data-number="1.3.12.3.2">
<h5 data-number="1.3.12.3.2" class="anchored" data-anchor-id="advanced-modeling-considerations"><span class="header-section-number">1.3.12.3.2</span> Advanced Modeling Considerations</h5>
<p><strong>Multilevel and Hierarchical Models:</strong></p>
<ul>
<li>These models handle nested data structures (e.g., students within classrooms within schools)</li>
<li>Sample size requirements operate at multiple levels:
<ul>
<li>Level 1: Individual observations (e.g., students)</li>
<li>Level 2: Grouping factors (e.g., classrooms)</li>
<li>Level 3: Higher-level groups (e.g., schools)</li>
</ul></li>
<li>Rule of thumb: Need at least 30+ groups at higher levels for reliable estimation</li>
<li>Power depends more on the number of higher-level units than on the total sample size</li>
</ul>
<p><strong>Structural Equation Models (SEM):</strong></p>
<ul>
<li>Complex models examining relationships among latent variables</li>
<li>Sample size requirements typically larger than simple regression</li>
<li>Recommendations range from 200 minimum to 10-20 observations per estimated parameter</li>
<li>Model complexity and expected effect sizes heavily influence required sample sizes</li>
</ul>
<p><strong>Bayesian Approaches:</strong></p>
<ul>
<li>Prior information can sometimes compensate for smaller sample sizes</li>
<li>However, still require sufficient data, especially for complex models</li>
<li>Posterior predictive checks help assess if sample size is adequate</li>
</ul>
</section>
</section>
<section id="sample-size-planning-in-practice" class="level4" data-number="1.3.12.4">
<h4 data-number="1.3.12.4" class="anchored" data-anchor-id="sample-size-planning-in-practice"><span class="header-section-number">1.3.12.4</span> Sample Size Planning in Practice</h4>
<p>When planning studies, consider:</p>
<ol type="1">
<li><strong>Statistical power</strong>: The ability to detect effects when they truly exist
<ul>
<li>Commonly aim for 80% power (or higher for critical decisions)</li>
<li>Conduct formal power analyses when possible</li>
</ul></li>
<li><strong>Precision</strong>: How narrow you need confidence intervals to be
<ul>
<li>Consider the practical importance of precision in your field</li>
<li>More precision requires larger samples</li>
</ul></li>
<li><strong>Resource constraints</strong>: Balance statistical ideals with practical limitations
<ul>
<li>Budget, time, participant availability</li>
<li>Consider sequential or adaptive sampling when appropriate</li>
</ul></li>
<li><strong>Ethical considerations</strong>: Collect enough data to answer questions reliably, but don’t waste resources or unnecessarily burden participants</li>
</ol>
<p>Remember that these are guidelines, and specific research questions may require consulting with a statistician for optimal sample size determination.</p>
</section>
</section>
<section id="maximum-uncertainty-for-proportion-example-why-50-is-the-worst-case" class="level3" data-number="1.3.13">
<h3 data-number="1.3.13" class="anchored" data-anchor-id="maximum-uncertainty-for-proportion-example-why-50-is-the-worst-case"><span class="header-section-number">1.3.13</span> Maximum Uncertainty for Proportion Example: Why 50% is the “Worst Case”</h3>
<p>To understand why proportions near 50% require larger samples, let’s look at a simulation:</p>
<p>Imagine you have 100 coins in a bag that are either gold or silver. You want to estimate what percentage are gold by randomly selecting 20 coins.</p>
<p><strong>Scenario A: 50% Gold (Maximum Uncertainty)</strong></p>
<ul>
<li>The bag contains 50 gold and 50 silver coins (50% gold)</li>
<li>Let’s simulate drawing 20 coins 10 different times:
<ul>
<li>Draw 1: 8 gold coins (40% - off by 10%)</li>
<li>Draw 2: 12 gold coins (60% - off by 10%)</li>
<li>Draw 3: 9 gold coins (45% - off by 5%)</li>
<li>Draw 4: 7 gold coins (35% - off by 15%)</li>
<li>Draw 5: 11 gold coins (55% - off by 5%)</li>
<li>Draw 6: 14 gold coins (70% - off by 20%)</li>
<li>Draw 7: 8 gold coins (40% - off by 10%)</li>
<li>Draw 8: 10 gold coins (50% - perfect!)</li>
<li>Draw 9: 7 gold coins (35% - off by 15%)</li>
<li>Draw 10: 12 gold coins (60% - off by 10%)</li>
</ul></li>
</ul>
<p>These results vary widely, from 35% to 70%, with an average error of 10 percentage points!</p>
<p><strong>Scenario B: 10% Gold (Less Uncertainty)</strong></p>
<ul>
<li>The bag contains 10 gold and 90 silver coins (10% gold)</li>
<li>Let’s simulate drawing 20 coins 10 different times:
<ul>
<li>Draw 1: 1 gold coin (5% - off by 5%)</li>
<li>Draw 2: 2 gold coins (10% - perfect!)</li>
<li>Draw 3: 3 gold coins (15% - off by 5%)</li>
<li>Draw 4: 1 gold coin (5% - off by 5%)</li>
<li>Draw 5: 2 gold coins (10% - perfect!)</li>
<li>Draw 6: 0 gold coins (0% - off by 10%)</li>
<li>Draw 7: 3 gold coins (15% - off by 5%)</li>
<li>Draw 8: 2 gold coins (10% - perfect!)</li>
<li>Draw 9: 1 gold coin (5% - off by 5%)</li>
<li>Draw 10: 2 gold coins (10% - perfect!)</li>
</ul></li>
</ul>
<p>These results stay much closer to the true 10%, ranging from 0% to 15%, with an average error of just 4 percentage points.</p>
<p>This demonstrates why we need larger samples when the proportion is close to 50% - the natural variability is much greater. When the true proportion is 50%, any deviation from this perfect balance is equally likely in either direction, creating maximum uncertainty.</p>
<section id="opinion-poll-example-popular-vs.-unpopular-candidates" class="level4" data-number="1.3.13.1">
<h4 data-number="1.3.13.1" class="anchored" data-anchor-id="opinion-poll-example-popular-vs.-unpopular-candidates"><span class="header-section-number">1.3.13.1</span> Opinion Poll Example: Popular vs.&nbsp;Unpopular Candidates</h4>
<p>In an election poll with 1,000 people:</p>
<p><strong>For a major candidate polling at 40%:</strong></p>
<ul>
<li>Our accuracy would be about ±3 percentage points</li>
<li>We can estimate their support is between 37% and 43%</li>
</ul>
<p><strong>For a minor candidate polling at 3%:</strong></p>
<ul>
<li>Our accuracy would be about ±1 percentage point</li>
<li>We can estimate their support is between 2% and 4%</li>
</ul>
<p><strong>Important clarification about accuracy:</strong></p>
<ol type="1">
<li><p><strong>Absolute accuracy (in percentage points):</strong></p>
<ul>
<li>For a minor candidate (3%): ±1 percentage point (smaller absolute error)</li>
<li>For a major candidate (40%): ±3 percentage points (larger absolute error)</li>
</ul></li>
<li><p><strong>Relative accuracy (as a proportion of the estimate):</strong></p>
<ul>
<li>For a minor candidate (3%): ±1 percentage point is 33% of their support level</li>
<li>For a major candidate (40%): ±3 percentage points is only 7.5% of their support level</li>
</ul></li>
</ol>
<p>This explains why polls can reliably detect the presence of minor candidates but might have difficulty precisely measuring small changes in their support levels. The same sample size gives different absolute accuracies depending on how close the proportion is to 50%.</p>
</section>
</section>
<section id="summary-key-points-to-remember" class="level3" data-number="1.3.14">
<h3 data-number="1.3.14" class="anchored" data-anchor-id="summary-key-points-to-remember"><span class="header-section-number">1.3.14</span> Summary: Key Points to Remember</h3>
<ol type="1">
<li><p><strong>Statistics and data science</strong> provide essential tools for understanding social phenomena through data analysis.</p></li>
<li><p><strong>Properly selected samples</strong> allow us to make reliable inferences about entire populations without studying everyone.</p></li>
<li><p><strong>Statistical error</strong> comes in two forms:</p>
<ul>
<li>Random error (reduced by larger samples)</li>
<li>Systematic error (reduced by better methodology)</li>
</ul></li>
<li><p><strong>Sample size needs</strong> vary based on:</p>
<ul>
<li>What you’re measuring (proportions vs.&nbsp;averages)</li>
<li>Desired accuracy</li>
<li>Population variability</li>
<li>For proportions specifically, values near 50% require larger samples</li>
</ul></li>
<li><p><strong>Small populations</strong> require special sampling considerations and may benefit from using the finite population correction factor.</p></li>
</ol>
<p>By understanding these foundational concepts, you’ll be better equipped to design and interpret research in the social sciences.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">SRS</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Stratified sampling</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Cluster sampling</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p><strong>Simple Random Sampling</strong>: Every individual has an equal probability of selection. The entire population is randomly sampled without any predetermined pattern.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/Simple_Random_Sampling2.svg" class="img-fluid figure-img"></p>
<figcaption>Simple Random Sampling. Retrieved from: https://app.passyourmath.com/courses/theory/116/1750/26640/en</figcaption>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p><strong>Stratified Sampling</strong>: The population is divided into distinct subgroups (strata) before random samples are drawn from each stratum proportionally.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/Stratified2.svg" class="img-fluid figure-img"></p>
<figcaption>Stratified Sampling. Retrieved from: https://app.passyourmath.com/courses/theory/116/1750/26640/en</figcaption>
</figure>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p><strong>Cluster Sampling</strong>: The population is divided into clusters, and entire clusters are randomly selected for analysis rather than individuals.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/Cluster2.svg" class="img-fluid figure-img"></p>
<figcaption>Cluster Sampling. Retrieved from: https://app.passyourmath.com/courses/theory/116/1750/26640/en</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data Generating Process and Superpopulation in the Context of Statistical Research
</div>
</div>
<div class="callout-body-container callout-body">
<p>In statistics and econometrics, we often use the concepts of population and sample. However, for a complete understanding of statistical models, it’s worth introducing two additional concepts: <strong>data generating process (DGP)</strong> and <strong>superpopulation</strong>. These concepts will help us better understand how the data we analyze is generated.</p>
<section id="basic-concepts" class="level3" data-number="1.3.15">
<h3 data-number="1.3.15" class="anchored" data-anchor-id="basic-concepts"><span class="header-section-number">1.3.15</span> Basic Concepts</h3>
<p><strong>Population</strong>: The set of all units (people, firms, countries, etc.) that are the subject of our study. For example, all households in the United States.</p>
<p><strong>Sample</strong>: A subset of the population that we study to draw conclusions about the entire population. For example, 1000 randomly selected households in the United States.</p>
</section>
<section id="data-generating-process-dgp" class="level3" data-number="1.3.16">
<h3 data-number="1.3.16" class="anchored" data-anchor-id="data-generating-process-dgp"><span class="header-section-number">1.3.16</span> Data Generating Process (DGP)</h3>
<p><strong>Data Generating Process</strong> is a mechanism or stochastic (random) model that determines how the values of variables we observe are generated.</p>
<p>Key features of DGP:</p>
<ul>
<li>It is an abstract, mathematical model describing how variables are related to each other</li>
<li>It contains both deterministic (predictable) and random (unpredictable) elements</li>
<li>It is usually expressed using equations and probability distributions</li>
</ul>
<section id="example-of-dgp" class="level4" data-number="1.3.16.1">
<h4 data-number="1.3.16.1" class="anchored" data-anchor-id="example-of-dgp"><span class="header-section-number">1.3.16.1</span> Example of DGP:</h4>
<p>Let’s assume we’re studying household incomes. The DGP model (a mathematical equation) could look like this:</p>
<p><span class="math inline">Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \varepsilon_i</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">Y_i</span> is the income of household <span class="math inline">i</span></li>
<li><span class="math inline">X_{1i}</span> is the number of employed people in household <span class="math inline">i</span></li>
<li><span class="math inline">X_{2i}</span> is the education level of the main earner in household <span class="math inline">i</span></li>
<li><span class="math inline">\varepsilon_i</span> is a random factor (error)</li>
<li><span class="math inline">\beta_0, \beta_1, \beta_2</span> are model parameters</li>
</ul>
<p>In this example, the DGP determines how income depends on the number of working people and education, plus a random element.</p>
</section>
</section>
<section id="superpopulation" class="level3" data-number="1.3.17">
<h3 data-number="1.3.17" class="anchored" data-anchor-id="superpopulation"><span class="header-section-number">1.3.17</span> Superpopulation</h3>
<p><strong>Superpopulation</strong> is a hypothetical, infinite population from which our actual population can be treated as a sample.</p>
<p>Key features of superpopulation:</p>
<ul>
<li>It is a conceptual extension of the population concept</li>
<li>It represents all possible realizations of the data generating process (DGP)</li>
<li>It allows for inference not only about the current population but about general regularities</li>
</ul>
<section id="examples-of-superpopulation" class="level4" data-number="1.3.17.1">
<h4 data-number="1.3.17.1" class="anchored" data-anchor-id="examples-of-superpopulation"><span class="header-section-number">1.3.17.1</span> Examples of superpopulation:</h4>
<ol type="1">
<li><p>We are studying SAT results in the United States in 2024 (population). The superpopulation is the hypothetical SAT results of all possible students who could take the SAT in similar conditions in any year.</p></li>
<li><p>We are analyzing the GDP of European countries in 2023 (population). The superpopulation is all possible realizations of these countries’ GDP under different economic conditions.</p></li>
</ol>
</section>
</section>
<section id="relationships-between-concepts" class="level3" data-number="1.3.18">
<h3 data-number="1.3.18" class="anchored" data-anchor-id="relationships-between-concepts"><span class="header-section-number">1.3.18</span> Relationships Between Concepts</h3>
<pre><code>DGP → Superpopulation → Population → Sample</code></pre>
<ul>
<li><strong>DGP</strong> defines the mechanism of data generation</li>
<li><strong>Superpopulation</strong> is all possible realizations of DGP</li>
<li><strong>Population</strong> is a specific, finite realization from the superpopulation</li>
<li><strong>Sample</strong> is a subset of the population that we actually observe and analyze</li>
</ul>
</section>
<section id="practical-significance" class="level3" data-number="1.3.19">
<h3 data-number="1.3.19" class="anchored" data-anchor-id="practical-significance"><span class="header-section-number">1.3.19</span> Practical Significance</h3>
<section id="why-are-these-concepts-important" class="level4" data-number="1.3.19.1">
<h4 data-number="1.3.19.1" class="anchored" data-anchor-id="why-are-these-concepts-important"><span class="header-section-number">1.3.19.1</span> Why are these concepts important?</h4>
<ol type="1">
<li><p><strong>Econometric modeling</strong> - DGP is the foundation of econometric modeling, allowing us to understand how economic variables affect each other.</p></li>
<li><p><strong>Statistical inference</strong> - The concept of superpopulation allows for formulating general conclusions that go beyond a specific time or group.</p></li>
<li><p><strong>Forecasting</strong> - Understanding DGP enables better forecasting of future values of economic variables.</p></li>
<li><p><strong>Hypothesis testing</strong> - It helps better determine whether observed relationships are due to chance or reflect actual regularities.</p></li>
</ol>
</section>
</section>
<section id="example-of-application-in-economics" class="level3" data-number="1.3.20">
<h3 data-number="1.3.20" class="anchored" data-anchor-id="example-of-application-in-economics"><span class="header-section-number">1.3.20</span> Example of Application in Economics</h3>
<p>Let’s assume an economist is studying the impact of interest rates on inflation:</p>
<ul>
<li><strong>DGP</strong>: Equation describing how interest rates and other factors affect inflation</li>
<li><strong>Superpopulation</strong>: All possible inflation values at different levels of interest rates and other factors</li>
<li><strong>Population</strong>: Actual inflation values in all countries during a given period</li>
<li><strong>Sample</strong>: Inflation data from 30 selected countries that we study</li>
</ul>
</section>
<section id="examples-from-electoral-studies" class="level3" data-number="1.3.21">
<h3 data-number="1.3.21" class="anchored" data-anchor-id="examples-from-electoral-studies"><span class="header-section-number">1.3.21</span> Examples from Electoral Studies</h3>
<p><strong>Example 1: Voter Turnout</strong></p>
<ul>
<li><strong>DGP</strong>: <span class="math inline">Turnout_i = \beta_0 + \beta_1 Age_i + \beta_2 Education_i + \beta_3 Income_i + \varepsilon_i</span></li>
<li><strong>Superpopulation</strong>: All possible decisions to participate in elections that voters with different socio-demographic characteristics could make under different conditions</li>
<li><strong>Population</strong>: All eligible voters in the 2020 presidential election</li>
<li><strong>Sample</strong>: 1500 respondents of an exit poll after the election</li>
</ul>
<p><strong>Example 2: Support for Political Parties</strong></p>
<ul>
<li><strong>DGP</strong>: <span class="math inline">Support_{ij} = \beta_0 + \beta_1 Ideology_i + \beta_2 EconomicSituation_i + \beta_3 Age_i + \varepsilon_i</span></li>
<li><strong>Superpopulation</strong>: All possible electoral preferences of people with different characteristics in different socio-economic conditions</li>
<li><strong>Population</strong>: All voters in the United States in 2023</li>
<li><strong>Sample</strong>: Pre-election survey respondents (n=1000)</li>
</ul>
</section>
<section id="simulation-and-estimation-of-a-demand-function-as-dgp-in-r" class="level3" data-number="1.3.22">
<h3 data-number="1.3.22" class="anchored" data-anchor-id="simulation-and-estimation-of-a-demand-function-as-dgp-in-r"><span class="header-section-number">1.3.22</span> Simulation and Estimation of a Demand Function as DGP in R</h3>
<p>The following code illustrates how to simulate a demand function with multiple predictors as a DGP and estimate its parameters using OLS regression:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading required packages</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting random seed for reproducible results</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Defining the "true" DGP: Product demand function</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Model: Q = beta0 + beta1*P + beta2*I + beta3*P_sub + beta4*P_comp + beta5*A + epsilon</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Where:</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Q = quantity demanded</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># P = product price</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co"># I = consumer income</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># P_sub = price of substitute good</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># P_comp = price of complementary good</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co"># A = advertising expenditure</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co"># True parameter values (consistent with economic theory)</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>beta0_true <span class="ot">&lt;-</span> <span class="dv">100</span>      <span class="co"># Constant</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>beta1_true <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.5</span>     <span class="co"># Own price effect (negative - according to the law of demand)</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>beta2_true <span class="ot">&lt;-</span> <span class="fl">0.8</span>      <span class="co"># Income effect (positive - normal good)</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>beta3_true <span class="ot">&lt;-</span> <span class="fl">1.2</span>      <span class="co"># Substitute price effect (positive)</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>beta4_true <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.7</span>     <span class="co"># Complementary good price effect (negative)</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>beta5_true <span class="ot">&lt;-</span> <span class="fl">0.5</span>      <span class="co"># Advertising effect (positive)</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>sigma_true <span class="ot">&lt;-</span> <span class="dv">5</span>        <span class="co"># Standard deviation of random error</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Simulating superpopulation (5000 potential markets/periods)</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>n_super <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating predictors</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_super, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)             <span class="co"># Product price ($)</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_super, <span class="at">mean =</span> <span class="dv">3000</span>, <span class="at">sd =</span> <span class="dv">500</span>)        <span class="co"># Average income ($)</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>price_substitute <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_super, <span class="at">min =</span> <span class="dv">4</span>, <span class="at">max =</span> <span class="dv">16</span>)  <span class="co"># Substitute price ($)</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>price_complement <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_super, <span class="at">min =</span> <span class="dv">2</span>, <span class="at">max =</span> <span class="dv">8</span>)   <span class="co"># Complement price ($)</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>advertising <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_super, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">100</span>)      <span class="co"># Advertising expenditure ($1000s)</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding correlation between variables (e.g., price and substitute price)</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>price_substitute <span class="ot">&lt;-</span> price_substitute <span class="sc">+</span> <span class="fu">rnorm</span>(n_super, <span class="at">mean =</span> <span class="fl">0.2</span> <span class="sc">*</span> price, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating demand according to DGP</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_super, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma_true)  <span class="co"># Random component</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>demand <span class="ot">&lt;-</span> beta0_true <span class="sc">+</span> </span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>         beta1_true <span class="sc">*</span> price <span class="sc">+</span> </span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>         beta2_true <span class="sc">*</span> (income<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">+</span>  <span class="co"># scaling income for better interpretation</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>         beta3_true <span class="sc">*</span> price_substitute <span class="sc">+</span> </span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>         beta4_true <span class="sc">*</span> price_complement <span class="sc">+</span> </span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>         beta5_true <span class="sc">*</span> (advertising<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span>   <span class="co"># scaling advertising for better interpretation</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>         epsilon</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating superpopulation data frame</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>superpopulation <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n_super,</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">price =</span> price,</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">income =</span> income,</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">price_substitute =</span> price_substitute,</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">price_complement =</span> price_complement,</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">advertising =</span> advertising,</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">demand =</span> demand</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Show first few observations</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(superpopulation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
     id price income price_substitute price_complement advertising demand
  &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;       &lt;dbl&gt;  &lt;dbl&gt;
1     1  7.88  2661.            11.9              7.95        50.4   89.5
2     2 12.9   3287.             7.10             3.81        88.5   79.6
3     3  9.09  2648.            14.5              4.60        94.1   87.7
4     4 13.8   2733.            19.0              2.96        80.3   84.1
5     5 14.4   3387.            11.1              6.94        66.0   73.0
6     6  5.46  2762.            13.2              3.25        32.8   95.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Drawing a sample from superpopulation (e.g., 200 observations)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>n_sample <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>sample_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n_super, n_sample)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> superpopulation[sample_indices, ]</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Estimating OLS model based on the sample</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>ols_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(demand <span class="sc">~</span> price <span class="sc">+</span> <span class="fu">I</span>(income<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">+</span> price_substitute <span class="sc">+</span> </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                price_complement <span class="sc">+</span> <span class="fu">I</span>(advertising<span class="sc">/</span><span class="dv">10</span>), <span class="at">data =</span> sample_data)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Displaying model summary</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ols_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = demand ~ price + I(income/1000) + price_substitute + 
    price_complement + I(advertising/10), data = sample_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.5705  -2.8401   0.1072   2.9881  14.1873 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        99.8079     2.7949  35.711  &lt; 2e-16 ***
price              -2.3571     0.1196 -19.711  &lt; 2e-16 ***
I(income/1000)      0.5259     0.6850   0.768 0.443582    
price_substitute    1.1635     0.0918  12.674  &lt; 2e-16 ***
price_complement   -0.7483     0.1933  -3.871 0.000148 ***
I(advertising/10)   0.5600     0.1170   4.785 3.38e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.843 on 194 degrees of freedom
Multiple R-squared:  0.7377,    Adjusted R-squared:  0.7309 
F-statistic: 109.1 on 5 and 194 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Comparing true parameters with estimated ones</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>true_parameters <span class="ot">&lt;-</span> <span class="fu">c</span>(beta0_true, beta1_true, beta2_true, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                     beta3_true, beta4_true, beta5_true)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>estimated_parameters <span class="ot">&lt;-</span> <span class="fu">coef</span>(ols_model)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameter =</span> <span class="fu">c</span>(<span class="st">"Intercept"</span>, <span class="st">"Price"</span>, <span class="st">"Income (thousands)"</span>, <span class="st">"Substitute price"</span>, </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Complement price"</span>, <span class="st">"Advertising (10 thousands)"</span>),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">true_value =</span> true_parameters,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimated_value =</span> estimated_parameters,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">difference =</span> estimated_value <span class="sc">-</span> true_value,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">percent_error =</span> <span class="fu">abs</span>(difference <span class="sc">/</span> true_value) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Display comparison</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  parameter                  true_value estimated_value difference percent_error
  &lt;chr&gt;                           &lt;dbl&gt;           &lt;dbl&gt;      &lt;dbl&gt;         &lt;dbl&gt;
1 Intercept                       100            99.8      -0.192          0.192
2 Price                            -2.5          -2.36      0.143          5.72 
3 Income (thousands)                0.8           0.526    -0.274         34.3  
4 Substitute price                  1.2           1.16     -0.0365         3.04 
5 Complement price                 -0.7          -0.748    -0.0483         6.90 
6 Advertising (10 thousands)        0.5           0.560     0.0600        12.0  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Visualizing comparison of true and estimated parameters</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comparison, <span class="fu">aes</span>(<span class="at">x =</span> parameter, <span class="at">y =</span> true_value)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimated_value), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> parameter, <span class="at">y =</span> true_value, </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> estimated_value), <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparison of True DGP with Estimated Model"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Blue points: true values, Red points: estimated values"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Parameter"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. Checking model's predictive ability on new data</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We draw new data from superpopulation (not used in estimation)</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>new_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n_super, sample_indices), <span class="dv">100</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> superpopulation[new_indices, ]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction on new data</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>new_data<span class="sc">$</span>predicted_demand <span class="ot">&lt;-</span> <span class="fu">predict</span>(ols_model, <span class="at">newdata =</span> new_data)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating mean squared error (MSE) of prediction</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((new_data<span class="sc">$</span>demand <span class="sc">-</span> new_data<span class="sc">$</span>predicted_demand)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mse)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Root Mean Squared Error (RMSE):"</span>, <span class="fu">round</span>(rmse, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Root Mean Squared Error (RMSE): 5.47 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. Visualizing relationship between price and demand</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (ceteris paribus effect - controlling for other variables)</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>ceteris_paribus <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">price =</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">income =</span> <span class="fu">mean</span>(sample_data<span class="sc">$</span>income),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">price_substitute =</span> <span class="fu">mean</span>(sample_data<span class="sc">$</span>price_substitute),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">price_complement =</span> <span class="fu">mean</span>(sample_data<span class="sc">$</span>price_complement),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">advertising =</span> <span class="fu">mean</span>(sample_data<span class="sc">$</span>advertising)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating predicted demand according to true DGP</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>ceteris_paribus<span class="sc">$</span>true_demand <span class="ot">&lt;-</span> beta0_true <span class="sc">+</span> </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>                              beta1_true <span class="sc">*</span> ceteris_paribus<span class="sc">$</span>price <span class="sc">+</span> </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>                              beta2_true <span class="sc">*</span> (ceteris_paribus<span class="sc">$</span>income<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">+</span> </span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>                              beta3_true <span class="sc">*</span> ceteris_paribus<span class="sc">$</span>price_substitute <span class="sc">+</span> </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>                              beta4_true <span class="sc">*</span> ceteris_paribus<span class="sc">$</span>price_complement <span class="sc">+</span> </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>                              beta5_true <span class="sc">*</span> (ceteris_paribus<span class="sc">$</span>advertising<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating predicted demand according to estimated model</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>ceteris_paribus<span class="sc">$</span>estimated_demand <span class="ot">&lt;-</span> <span class="fu">predict</span>(ols_model, <span class="at">newdata =</span> ceteris_paribus)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ceteris_paribus, <span class="fu">aes</span>(<span class="at">x =</span> price)) <span class="sc">+</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> true_demand, <span class="at">color =</span> <span class="st">"True DGP"</span>), <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimated_demand, <span class="at">color =</span> <span class="st">"Estimated model"</span>), <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"True DGP"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Estimated model"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Demand Curve: True DGP vs. Estimated Model"</span>,</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Ceteris paribus effect (with other variables held constant)"</span>,</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Product price ($)"</span>,</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Demand (quantity)"</span>,</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Model"</span>) <span class="sc">+</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This code demonstrates:</p>
<ol type="1">
<li>Defining a complex DGP for a demand function with multiple predictors consistent with economic theory</li>
<li>Simulating a superpopulation according to this DGP</li>
<li>Drawing a sample from the superpopulation</li>
<li>Estimating model parameters using OLS regression</li>
<li>Comparing estimated parameters with their true values</li>
<li>Visualizing the comparison of true and estimated parameters</li>
<li>Checking the model’s predictive ability on new data</li>
<li>Visualizing the relationship between price and demand with ceteris paribus effect</li>
</ol>
<p>This example shows how we can simulate complex economic relationships and then use econometric methods to discover these relationships based on a sample of data. It is an excellent illustration of how economic theory, DGP, and statistical methods are interconnected.</p>
<p>In reality, we never know the true DGP - that’s exactly what we’re trying to discover through statistical analysis. Simulations of this type, however, allow us to conceptually understand how statistical inference connects with the concept of DGP and superpopulation.</p>
</section>
<section id="supplementary-examples" class="level3" data-number="1.3.23">
<h3 data-number="1.3.23" class="anchored" data-anchor-id="supplementary-examples"><span class="header-section-number">1.3.23</span> Supplementary Examples</h3>
<section id="example-1-voter-opinion-study" class="level4" data-number="1.3.23.1">
<h4 data-number="1.3.23.1" class="anchored" data-anchor-id="example-1-voter-opinion-study"><span class="header-section-number">1.3.23.1</span> Example 1: Voter Opinion Study</h4>
<ul>
<li><strong>Population</strong>: All registered voters in the United States in 2023 (approx. 168 million people)</li>
<li><strong>Sample</strong>: 1000 randomly selected voters surveyed in a poll</li>
<li><strong>Superpopulation</strong>: All possible voters (present, future, and hypothetical) and all possible voting scenarios</li>
<li><strong>DGP</strong> (Data Generating Process): Complex mechanism shaping opinions and voting decisions, including:
<ul>
<li>Demographic factors (age, education, place of residence)</li>
<li>Economic conditions (income, employment status)</li>
<li>Media influence and public debate</li>
<li>Personal experiences</li>
<li>Historical political conditions</li>
</ul></li>
</ul>
</section>
<section id="example-2-anti-diabetic-drug-effects-study" class="level4" data-number="1.3.23.2">
<h4 data-number="1.3.23.2" class="anchored" data-anchor-id="example-2-anti-diabetic-drug-effects-study"><span class="header-section-number">1.3.23.2</span> Example 2: Anti-diabetic Drug Effects Study</h4>
<ul>
<li><strong>Population</strong>: All patients with type 2 diabetes in a given country (e.g., 34 million people)</li>
<li><strong>Sample</strong>: 500 patients participating in a clinical trial</li>
<li><strong>Superpopulation</strong>: All possible type 2 diabetes patients (present and future) with various genetic and environmental profiles</li>
<li><strong>DGP</strong>: Biological mechanism including:
<ul>
<li>Drug interactions with receptors in the body</li>
<li>Individual genetic factors</li>
<li>Environmental factors (diet, physical activity)</li>
<li>Interactions with other medications</li>
<li>Metabolic mechanisms of the organism</li>
</ul></li>
</ul>
</section>
<section id="example-3-when-sample-equals-population" class="level4" data-number="1.3.23.3">
<h4 data-number="1.3.23.3" class="anchored" data-anchor-id="example-3-when-sample-equals-population"><span class="header-section-number">1.3.23.3</span> Example 3: When Sample Equals Population</h4>
<p>Study of all 50 US states: - <strong>Traditional approach</strong>: No distinction between sample and population (we study all states) - <strong>Superpopulation approach</strong>: - <strong>Population/Sample</strong>: 50 existing US states - <strong>Superpopulation</strong>: Theoretical set of all possible territorial units of the “state” type under different historical, political, and social conditions - <strong>DGP</strong>: Fundamental geographic, historical, political, and socio-economic mechanisms shaping state characteristics</p>
</section>
<section id="example-4-pizza-quality-in-new-york-city" class="level4" data-number="1.3.23.4">
<h4 data-number="1.3.23.4" class="anchored" data-anchor-id="example-4-pizza-quality-in-new-york-city"><span class="header-section-number">1.3.23.4</span> Example 4: Pizza Quality in New York City</h4>
<ul>
<li><strong>Population</strong>: All currently operating pizzerias in New York City (e.g., 2000 establishments)</li>
<li><strong>Sample</strong>: 50 randomly selected pizzerias from different neighborhoods</li>
<li><strong>Superpopulation</strong>: All possible pizzerias that could exist in New York City:
<ul>
<li>Currently operating</li>
<li>Future (not yet opened)</li>
<li>Historical (already closed)</li>
<li>Hypothetical (in alternative economic or cultural conditions)</li>
</ul></li>
<li><strong>DGP</strong>: Factors affecting pizza quality:
<ul>
<li>Ingredients and their quality</li>
<li>Skills and experience of chefs</li>
<li>Kitchen equipment and infrastructure</li>
<li>Preparation methods and recipes</li>
<li>Environmental factors (e.g., local water quality)</li>
<li>Cultural influences and culinary traditions</li>
<li>Economic conditions (operating costs, rent)</li>
</ul></li>
</ul>
<p>DGP is like a “recipe for pizza quality” that determines outcomes for all potential pizzerias in the superpopulation, not just currently existing establishments.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TD
    A[Data Generating Process DGP]
    S(Superpopulation)
    B(Population)
    C[Sample]
    A --&gt;|Generates| S
    S --&gt;|One realization| B
    B --&gt;|Sampling| C
    C -.-&gt;|Inference| B
    C -.-&gt;|Inference| S
    C -.-&gt;|Inference| A
    B -.-&gt;|Inference| S
    B -.-&gt;|Inference| A
    S -.-&gt;|Inference| A
    
    classDef dgp fill:#f9f,stroke:#333,stroke-width:4px;
    classDef superpop fill:#fce,stroke:#333,stroke-width:3px;
    classDef pop fill:#bbf,stroke:#333,stroke-width:2px;
    classDef sam fill:#bfb,stroke:#333,stroke-width:2px;
    
    class A dgp;
    class S superpop;
    class B pop;
    class C sam;
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
</section>
</div>
</div>
</section>
</section>
<section id="population-parameters" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="population-parameters"><span class="header-section-number">1.4</span> Population Parameters</h2>
<blockquote class="blockquote">
<p><strong>Important</strong></p>
<p>A <strong>population parameter</strong> (<span class="math inline">\theta</span>) is a numerical value that characterizes a specific feature of the entire population. Population parameters are usually unknown and are the subject of estimation based on a sample.</p>
</blockquote>
<p>Common population parameters include:</p>
<ul>
<li><span class="math inline">\mu</span> (population mean): The average value in the population</li>
<li><span class="math inline">\sigma^2</span> (population variance): The average squared deviation from the mean</li>
<li><span class="math inline">\sigma</span> (population standard deviation): The square root of the variance</li>
<li><span class="math inline">p</span> (population proportion): The fraction of the population with a certain characteristic</li>
</ul>
<p>Since studying an entire population is usually impractical, we use samples to estimate these parameters.</p>
</section>
<section id="distribution-of-sample-statistics" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="distribution-of-sample-statistics"><span class="header-section-number">1.5</span> Distribution of Sample Statistics</h2>
<p>A <strong>sample statistic</strong> (<span class="math inline">\hat{\theta}</span>) is a value calculated from sample observations used to estimate a population parameter <span class="math inline">\theta</span>.</p>
<p>The distribution of a statistic describes how its values vary when repeatedly drawing samples of the same size <span class="math inline">n</span> from the same population. This concept is fundamental to understanding statistical inference.</p>
<p>Think of it this way: When we take a sample and calculate a statistic (like a sample mean), we get one specific value. But if we repeated this process many times—taking different random samples of the same size from the same population—we would get different values each time. The distribution of the statistic describes this pattern of variability.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/sampling-estimators.svg" class="img-fluid figure-img"></p>
<figcaption>Various random samples of equal size and their statistics. Retrieved from: https://allmodelsarewrong.github.io/mse.html</figcaption>
</figure>
</div>
<p>Key points about the distribution of a statistic:</p>
<ol type="1">
<li>It shows how the statistic varies from sample to sample</li>
<li>It helps us understand sampling error and uncertainty</li>
<li>It allows us to make probabilistic statements about how close our estimate is to the true population parameter</li>
<li>It forms the foundation for statistical inference</li>
</ol>
<p>Example: If we’re interested in the population mean <span class="math inline">\mu</span>, its estimator is the sample mean <span class="math inline">\bar{x}</span>, calculated as:</p>
<p><span class="math inline">\bar{x} = \frac{1}{n}\sum_{i=1}^{n}x_i</span></p>
<p>where <span class="math inline">x_1, x_2, ..., x_n</span> are observations in a random sample.</p>
</section>
<section id="expected-value-of-the-sample-statistic" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="expected-value-of-the-sample-statistic"><span class="header-section-number">1.6</span> Expected Value of the Sample Statistic</h2>
<p>Before going further, let’s briefly explain what we mean by “expected value”:</p>
<p>The <strong>expected value</strong> (or mean) of a random variable is the long-run average value we would observe if we could repeat a random experiment infinitely many times. It’s essentially the “center of gravity” of a probability distribution - the value around which the distribution balances.</p>
<p>For a discrete random variable X, the expected value is calculated as:</p>
<p><span class="math inline">E(X) = \sum_i x_i \cdot P(X = x_i)</span></p>
<p>Where <span class="math inline">x_i</span> are the possible values and <span class="math inline">P(X = x_i)</span> are their probabilities.</p>
<p>With this in mind, the expected value of a sample statistic <span class="math inline">E(\hat{\theta})</span> is the average value that the statistic takes when repeatedly drawing samples from the population.</p>
<p>For well-constructed estimators, the expected value equals the parameter we’re trying to estimate:</p>
<p><span class="math inline">E(\hat{\theta}) = \theta</span></p>
<p>This means a “good” estimator will, on average, give us the right answer. Such an estimator is called <strong>unbiased</strong>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Optional: Proof that the sample mean is an unbiased estimator
</div>
</div>
<div class="callout-body-container callout-body">
<p>For the sample mean <span class="math inline">\bar{x}</span>, we can prove it’s an unbiased estimator of the population mean <span class="math inline">\mu</span> as follows:</p>
<p><span class="math inline">E(\bar{x}) = E\left(\frac{1}{n}\sum_{i=1}^{n}x_i\right)</span></p>
<p>Using the linearity property of expected values (the expected value of a sum equals the sum of expected values):</p>
<p><span class="math inline">E(\bar{x}) = \frac{1}{n}\sum_{i=1}^{n}E(x_i)</span></p>
<p>Since each <span class="math inline">x_i</span> is a random observation from the population with mean <span class="math inline">\mu</span>:</p>
<p><span class="math inline">E(x_i) = \mu \text{ for all } i</span></p>
<p>Therefore:</p>
<p><span class="math inline">E(\bar{x}) = \frac{1}{n}\sum_{i=1}^{n}\mu = \frac{1}{n} \cdot n \cdot \mu = \mu</span></p>
<p>This proves that the sample mean is an unbiased estimator of the population mean.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Optional: Understanding why the sample variance needs n-1 in the denominator
</div>
</div>
<div class="callout-body-container callout-body">
<p>The sample variance is commonly defined as:</p>
<p><span class="math inline">s^2 = \frac{1}{n-1}\sum_{i=1}^n (x_i - \bar{x})^2</span></p>
<p>Why do we use <span class="math inline">n-1</span> in the denominator rather than <span class="math inline">n</span>?</p>
<p>Let’s consider what happens if we used <span class="math inline">n</span> instead:</p>
<p><span class="math inline">\tilde{s}^2 = \frac{1}{n}\sum_{i=1}^n (x_i - \bar{x})^2</span></p>
<p>To check if this is unbiased, we need to find <span class="math inline">E(\tilde{s}^2)</span> and see if it equals <span class="math inline">\sigma^2</span>.</p>
<p>Without going through all the mathematical steps, the key insight is: 1. When we calculate <span class="math inline">(x_i - \bar{x})^2</span>, we’re using <span class="math inline">\bar{x}</span> (the sample mean) instead of <span class="math inline">\mu</span> (the population mean) 2. The sample mean <span class="math inline">\bar{x}</span> is itself estimated from the same data 3. This introduces a dependency that makes our variance estimator systematically underestimate the true variance 4. Specifically, <span class="math inline">E(\tilde{s}^2) = \frac{n-1}{n}\sigma^2</span>, which means it’s biased by a factor of <span class="math inline">\frac{n-1}{n}</span> 5. To correct this bias, we divide by <span class="math inline">n-1</span> instead of <span class="math inline">n</span>, giving us: <span class="math inline">E(s^2) = E\left(\frac{n}{n-1}\tilde{s}^2\right) = \frac{n}{n-1}E(\tilde{s}^2) = \frac{n}{n-1}\frac{n-1}{n}\sigma^2 = \sigma^2</span></p>
<p>Intuitively, we’re using <span class="math inline">n-1</span> because we’ve already “used up” one degree of freedom when estimating the mean. The denominator <span class="math inline">n-1</span> is called the “degrees of freedom” - the number of independent pieces of information available for estimating the variance after estimating the mean.</p>
</div>
</div>
<p>Not all estimators are unbiased. For instance, as we just saw, the simple variance estimator needs a correction (<span class="math inline">\frac{1}{n-1}</span> instead of <span class="math inline">\frac{1}{n}</span>) to be unbiased.</p>
</section>
<section id="the-normal-distribution---the-bell-curve" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="the-normal-distribution---the-bell-curve"><span class="header-section-number">1.7</span> The Normal Distribution - The Bell Curve</h2>
<blockquote class="blockquote">
<p><strong>Note</strong></p>
<p>The normal distribution (also known as the Gaussian distribution or bell curve) is one of the most important probability distributions in statistics. It has a symmetric bell shape and is fully described by two parameters:</p>
<ul>
<li>The mean <span class="math inline">\mu</span> (centers the distribution)</li>
<li>The standard deviation <span class="math inline">\sigma</span> (determines the width of the “bell”)</li>
</ul>
<p>The normal distribution appears frequently in nature and human systems (heights, measurement errors, test scores).</p>
</blockquote>
<section id="mathematical-representation" class="level3" data-number="1.7.1">
<h3 data-number="1.7.1" class="anchored" data-anchor-id="mathematical-representation"><span class="header-section-number">1.7.1</span> Mathematical Representation</h3>
<p>The probability density function (PDF) of the normal distribution is:</p>
<p><span class="math display">
f(x) = \frac{1}{\sigma\sqrt{2\pi}} e^{-\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^2}
</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">x</span> is a random variable</li>
<li><span class="math inline">\mu</span> is the mean (location parameter)</li>
<li><span class="math inline">\sigma</span> is the standard deviation (scale parameter)</li>
<li><span class="math inline">e</span> is Euler’s number (approximately 2.71828)</li>
<li><span class="math inline">\pi</span> is the mathematical constant pi (approximately 3.14159)</li>
</ul>
</section>
<section id="practical-significance-1" class="level3" data-number="1.7.2">
<h3 data-number="1.7.2" class="anchored" data-anchor-id="practical-significance-1"><span class="header-section-number">1.7.2</span> Practical Significance</h3>
<p>The normal distribution is especially important because of:</p>
<ol type="1">
<li><p>The <strong>68-95-99.7 Rule</strong>: Approximately 68% of values fall within 1 standard deviation of the mean, 95% within 2 standard deviations, and 99.7% within 3 standard deviations.</p></li>
<li><p>The <strong>Central Limit Theorem</strong>: Sample means tend to follow a normal distribution regardless of the original distribution’s shape (given a sufficiently large sample size).</p></li>
<li><p><strong>Statistical Inference</strong>: The normal distribution forms the foundation for many statistical tests and confidence intervals.</p></li>
</ol>
</section>
</section>
<section id="types-of-data-and-variables" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="types-of-data-and-variables"><span class="header-section-number">1.8</span> Types of Data and Variables</h2>
<p>Data forms the foundation of statistical analysis. To better understand its role, it’s important to familiarize yourself with key concepts.</p>
</section>
<section id="sources-of-data" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="sources-of-data"><span class="header-section-number">1.9</span> Sources of Data</h2>
<ul>
<li><strong>Primary data</strong>: Collected directly for a specific research purpose (e.g., conducting your own survey)</li>
<li><strong>Secondary data</strong>: Obtained from existing sources (e.g., databases or government statistics)</li>
</ul>
</section>
<section id="variables-and-constants" class="level2" data-number="1.10">
<h2 data-number="1.10" class="anchored" data-anchor-id="variables-and-constants"><span class="header-section-number">1.10</span> Variables and Constants</h2>
<p><strong>Variables</strong> are characteristics that can take on different values in a dataset. They are the objects of our research and analysis.</p>
<section id="classification-of-variables" class="level3" data-number="1.10.1">
<h3 data-number="1.10.1" class="anchored" data-anchor-id="classification-of-variables"><span class="header-section-number">1.10.1</span> Classification of Variables</h3>
<ol type="1">
<li><strong>Quantitative Variables</strong> (represent quantities or measurements):
<ul>
<li><strong>Continuous</strong>: Can take any value within a specific range (e.g., height, weight, temperature)</li>
<li><strong>Discrete</strong>: Take only specific values, usually integers (e.g., number of children, errors)</li>
</ul></li>
<li><strong>Qualitative Variables</strong> (represent categories or qualities):
<ul>
<li><strong>Nominal</strong>: Categories with no natural order (e.g., blood type, gender, region)</li>
<li><strong>Ordinal</strong>: Categories with a natural order (e.g., education level, satisfaction ratings)</li>
</ul></li>
</ol>
<p><strong>Constants</strong> are values that remain unchanged throughout the analysis and often serve as reference points.</p>
</section>
</section>
<section id="statistical-estimation-concepts" class="level2" data-number="1.11">
<h2 data-number="1.11" class="anchored" data-anchor-id="statistical-estimation-concepts"><span class="header-section-number">1.11</span> Statistical Estimation Concepts</h2>
<p>In statistics, several similar-sounding concepts are often confused. Here’s a clear distinction between these key terms:</p>
</section>
<section id="population-parameter-estimand" class="level2" data-number="1.12">
<h2 data-number="1.12" class="anchored" data-anchor-id="population-parameter-estimand"><span class="header-section-number">1.12</span> Population Parameter (Estimand)</h2>
<p>A <strong>population parameter</strong> is a numerical value describing a characteristic of the entire population:</p>
<ol type="1">
<li>It concerns the <em>entire</em> population, not just a sample</li>
<li>Usually denoted by Greek letters (μ, σ, π, ρ)</li>
<li>In most cases remains <strong>unknown</strong> (we cannot study the entire population)</li>
<li>Is determined by the actual Data Generating Process (DGP)</li>
</ol>
<p>An <strong>estimand</strong> is the specific population parameter or function of parameters that we want to estimate. It is the <em>goal of our estimation</em>.</p>
<blockquote class="blockquote">
<p><strong>Important distinction!</strong></p>
<p>The estimand (population parameter) is a value in the population that we want to know but that remains unknown to us. It is our research target.</p>
</blockquote>
</section>
<section id="estimator-statistic" class="level2" data-number="1.13">
<h2 data-number="1.13" class="anchored" data-anchor-id="estimator-statistic"><span class="header-section-number">1.13</span> Estimator (Statistic)</h2>
<p>An <strong>estimator</strong> is a mathematical function (formula, procedure) that provides an estimate of a population parameter based on sample data. <strong>An estimator is a random variable</strong> because its value depends on the specific sample.</p>
<p>A <strong>statistic</strong> is any measure calculated from sample data. When a statistic is used to estimate a population parameter, we call it an estimator.</p>
<p>Examples of estimators:</p>
<ul>
<li>Sample mean: <span class="math inline">\bar{x} = \frac{1}{n}\sum_{i=1}^n x_i</span> (estimator of population mean μ)</li>
<li>Sample variance: <span class="math inline">s^2 = \frac{1}{n-1}\sum_{i=1}^n (x_i - \bar{x})^2</span> (estimator of population variance σ²)</li>
<li>Sample proportion: <span class="math inline">\hat{p} = \frac{x}{n}</span> (estimator of population proportion p)</li>
</ul>
<blockquote class="blockquote">
<p><strong>Note: Estimator as a procedure</strong></p>
<p>An estimator should be understood as a <strong>recipe</strong> for calculating a value based on a sample. The same estimator applied to different samples will yield different results.</p>
<p>Example: The mean estimator <span class="math inline">\bar{x} = \frac{1}{n}\sum_{i=1}^n x_i</span> is a procedure of “sum all values and divide by their count.”</p>
</blockquote>
</section>
<section id="estimate" class="level2" data-number="1.14">
<h2 data-number="1.14" class="anchored" data-anchor-id="estimate"><span class="header-section-number">1.14</span> Estimate</h2>
<p>An <strong>estimate</strong> is a specific numerical value obtained after applying an estimator to a particular sample. It is a single number, being a realization of the random variable that is the estimator.</p>
<blockquote class="blockquote">
<p><strong>Example distinguishing these concepts</strong></p>
<ul>
<li><strong>Estimand</strong>: Average height of all adults in a country (μ) - unknown value</li>
<li><strong>Estimator</strong>: Formula for sample mean <span class="math inline">\bar{x} = \frac{1}{n}\sum_{i=1}^n x_i</span> - computational procedure</li>
<li><strong>Estimate</strong>: 173.5 cm - specific value obtained from a sample</li>
</ul>
<p>Different samples will give different estimates of the same estimand using the same estimator.</p>
</blockquote>
</section>
<section id="properties-of-good-estimators" class="level2" data-number="1.15">
<h2 data-number="1.15" class="anchored" data-anchor-id="properties-of-good-estimators"><span class="header-section-number">1.15</span> Properties of Good Estimators</h2>
<p>A good estimator should have favorable statistical properties:</p>
<ol type="1">
<li><p><strong>Unbiasedness</strong>: An estimator is unbiased if its expected value equals the parameter it’s estimating. Formally: E(<span class="math inline">\hat{\theta}</span>) = <span class="math inline">\theta</span></p></li>
<li><p><strong>Efficiency</strong>: An estimator is efficient if it has the smallest possible variance among all unbiased estimators</p></li>
<li><p><strong>Consistency</strong>: An estimator is consistent if, as the sample size increases, its value approaches the true parameter value</p></li>
<li><p><strong>Sufficiency</strong>: An estimator is sufficient if it uses all available information from the sample regarding the parameter being estimated</p></li>
</ol>
</section>
<section id="statistical-models-and-inference" class="level2" data-number="1.16">
<h2 data-number="1.16" class="anchored" data-anchor-id="statistical-models-and-inference"><span class="header-section-number">1.16</span> Statistical Models and Inference</h2>
<section id="statistical-models" class="level3" data-number="1.16.1">
<h3 data-number="1.16.1" class="anchored" data-anchor-id="statistical-models"><span class="header-section-number">1.16.1</span> Statistical Models</h3>
<p>A statistical model is a mathematical representation of reality that describes relationships between variables and the structure of data. It allows for describing the data generating process (DGP) and making inferences about parameters.</p>
<blockquote class="blockquote">
<p><strong>Components of a Statistical Model</strong></p>
<p>A complete statistical model consists of:</p>
<ol type="1">
<li><strong>Functional form</strong>: The mathematical structure defining the relationship between variables (e.g., linear, quadratic)</li>
<li><strong>Variables</strong>:
<ul>
<li>Dependent variable(s): What we’re trying to predict or explain</li>
<li>Independent/explanatory variables: Factors that might influence the dependent variable</li>
</ul></li>
<li><strong>Parameters</strong>: Unknown values we estimate from data (e.g., regression coefficients)</li>
<li><strong>Random component</strong>: The error term accounting for unexplained variability</li>
<li><strong>Probability distribution assumptions</strong>: Specifications about how the random component is distributed</li>
</ol>
</blockquote>
<p>Example of a linear regression model: <span class="math inline">y = \beta_0 + \beta_1x + \epsilon</span>, where <span class="math inline">\epsilon \sim N(0, \sigma^2)</span></p>
<p>In this model:</p>
<ul>
<li><span class="math inline">\beta_0</span> and <span class="math inline">\beta_1</span> are parameters we want to estimate</li>
<li><span class="math inline">\epsilon</span> is a random component representing unexplained variability</li>
<li>We assume normality of the error distribution</li>
</ul>
</section>
<section id="causal-vs.-predictive-inference" class="level3" data-number="1.16.2">
<h3 data-number="1.16.2" class="anchored" data-anchor-id="causal-vs.-predictive-inference"><span class="header-section-number">1.16.2</span> Causal vs.&nbsp;Predictive Inference</h3>
<p>In statistical analysis, we may have two main goals:</p>
<ol type="1">
<li><strong>Causal inference</strong>: Determining whether variable X <em>causes</em> a change in variable Y
<ul>
<li>Requires additional assumptions or special research designs</li>
<li>Enables predicting the effects of interventions</li>
</ul></li>
<li><strong>Predictive inference</strong>: Predicting Y values based on X
<ul>
<li>Does not need to assume a causal relationship</li>
<li>Focuses on prediction accuracy</li>
</ul></li>
</ol>
<blockquote class="blockquote">
<p><strong>Warning: Correlation ≠ Causation</strong></p>
<p>A spurious relationship or spurious correlation occurs when two or more variables are associated but not causally related.</p>
<p>Two variables can be strongly correlated because of:</p>
<ol type="1">
<li>A confounding variable that affects both variables</li>
<li>Reverse causality (Y affects X, not vice versa)</li>
<li>Chance (spurious correlation)</li>
</ol>
</blockquote>
</section>
<section id="challenges-of-causal-inference" class="level3" data-number="1.16.3">
<h3 data-number="1.16.3" class="anchored" data-anchor-id="challenges-of-causal-inference"><span class="header-section-number">1.16.3</span> Challenges of Causal Inference</h3>
<p>The fundamental problem of causal inference is the impossibility of observing <strong>counterfactuals</strong> (alternative scenarios). For a given unit, we can observe only one potential outcome.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/meme_horse.svg" class="img-fluid figure-img"></p>
<figcaption>The fundamental problem of causal inference: We can think of causal inference as a PREDICTION problem. How can we predict the counterfactual given that we never observe it?</figcaption>
</figure>
</div>
<p>Example: - We observe a person who completed college and earns $8,000 per month - We cannot observe how much the same person would earn if they had not completed college</p>
<p>Causal methods attempt to solve this problem through:</p>
<ol type="1">
<li>Randomized experiments</li>
<li>Instrumental variables</li>
<li>Matching methods</li>
<li>Regression discontinuity analysis</li>
<li>Difference-in-differences</li>
</ol>
<p>Common problems in causal inference:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/IMG_4337.jpg" class="img-fluid figure-img"></p>
<figcaption>Confounding bias: drinking the night before is a common cause of sleeping with shoes on and waking up with a headache</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/ff13-23.png" class="img-fluid figure-img"></p>
<figcaption>Reverse causality</figcaption>
</figure>
</div>
</section>
</section>
<section id="statistical-inference" class="level2" data-number="1.17">
<h2 data-number="1.17" class="anchored" data-anchor-id="statistical-inference"><span class="header-section-number">1.17</span> Statistical Inference</h2>
<p>Statistical inference is the process of drawing conclusions about a population based on sample data. It encompasses two main areas:</p>
<section id="estimation" class="level3" data-number="1.17.1">
<h3 data-number="1.17.1" class="anchored" data-anchor-id="estimation"><span class="header-section-number">1.17.1</span> 1. Estimation</h3>
<p>Estimation is the process of using sample data to estimate unknown population parameters. We distinguish:</p>
<ul>
<li><strong>Point estimation</strong>: Providing a single value as the best approximation of the parameter</li>
<li><strong>Interval estimation</strong>: Constructing a confidence interval that indicates the range of possible parameter values consistent with our data</li>
</ul>
<p>Example of a confidence interval: “The 95% confidence interval for the average height of adults is (173 cm, 175 cm).”</p>
<p><strong>Correct interpretation of confidence interval</strong>: If we were to repeatedly take samples from the same population and construct a 95% confidence interval for each sample using the same method, about 95% of these intervals would contain the true population parameter value.</p>
<p><strong>Incorrect interpretation</strong>: “There is a 95% chance that the true mean is in the interval (173 cm, 175 cm)” – this is incorrect because the population parameter is a fixed (though unknown) value, not a random variable.</p>
</section>
<section id="hypothesis-testing" class="level3" data-number="1.17.2">
<h3 data-number="1.17.2" class="anchored" data-anchor-id="hypothesis-testing"><span class="header-section-number">1.17.2</span> 2. Hypothesis Testing</h3>
<p>Hypothesis testing is a formal procedure for verifying claims about population parameters.</p>
<blockquote class="blockquote">
<p><strong>Example: Binomial test for a coin</strong></p>
<p>Imagine we want to check if a coin is fair.</p>
<ol type="1">
<li><p><strong>Research question</strong>: Is the coin fair (probability of heads = 0.5)?</p></li>
<li><p><strong>Formulate hypotheses</strong>:</p>
<ul>
<li><strong>Null hypothesis (H₀)</strong>: p = 0.5 (the coin is fair)</li>
<li><strong>Alternative hypothesis (H₁)</strong>: p ≠ 0.5 (the coin is not fair)</li>
</ul></li>
<li><p><strong>Collect data</strong>: We flip the coin 100 times and get 65 heads.</p></li>
<li><p><strong>Analyze</strong>: Is 65 heads out of 100 flips evidence against the hypothesis that the coin is fair?</p></li>
<li><p><strong>Reasoning</strong>:</p>
<ul>
<li>If the coin were fair (p = 0.5), the number of heads in 100 flips should follow a binomial distribution B(100, 0.5)</li>
<li>For this distribution, we expect an average of 50 heads, with a standard deviation of √(100 × 0.5 × 0.5) = 5</li>
<li>Getting 65 heads means a deviation of 3 standard deviations from the expected value</li>
<li>The probability of getting 65 or more heads with a fair coin is very small (p &lt; 0.01)</li>
</ul></li>
<li><p><strong>Conclusion</strong>: Since the observed result is very unlikely under the assumption that the coin is fair, we reject the null hypothesis and conclude that the coin is most likely not fair.</p></li>
</ol>
</blockquote>
<p>General hypothesis testing procedure:</p>
<ol type="1">
<li>Formulate the null hypothesis (H₀) and alternative hypothesis (H₁)</li>
<li>Choose a significance level α (usually 0.05)</li>
<li>Collect data and calculate the appropriate test statistic</li>
<li>Calculate the p-value (the probability of obtaining our data or more extreme results, assuming H₀ is true)</li>
<li>Make a decision: if p &lt; α, reject H₀ in favor of H₁</li>
</ol>
<blockquote class="blockquote">
<p><strong>Note: Intuition behind hypothesis testing</strong></p>
<p>Hypothesis testing resembles a court procedure:</p>
</blockquote>
<blockquote class="blockquote">
<ul>
<li>H₀ corresponds to the principle of “innocent until proven guilty”</li>
<li>Data constitutes “evidence” against H₀</li>
<li>P-value determines how strong this evidence is</li>
<li>If the evidence is strong enough (p &lt; α), we “convict” H₀ (reject it)</li>
<li>If the evidence is not strong enough, we do not reject H₀ (but we do not prove its truth)</li>
</ul>
</blockquote>
<blockquote class="blockquote">
<p><strong>Important: Common errors in interpreting p-values and tests</strong></p>
<ol type="1">
<li>P-value is <strong>NOT</strong> the probability that the null hypothesis is true</li>
<li>P-value is <strong>NOT</strong> the probability of making an error when rejecting H₀</li>
<li>Failing to reject H₀ does <strong>NOT</strong> mean proving it</li>
<li>A very small p-value does <strong>NOT</strong> indicate a large practical effect (statistical significance ≠ practical significance)</li>
<li>P-value depends on sample size - with very large samples, even small, practically insignificant differences can be statistically significant</li>
</ol>
<p><strong>Definition of p-value</strong>: The probability of observing a result at least as extreme as the one obtained, assuming the null hypothesis is true.</p>
</blockquote>
</section>
<section id="types-of-errors-in-hypothesis-testing" class="level3" data-number="1.17.3">
<h3 data-number="1.17.3" class="anchored" data-anchor-id="types-of-errors-in-hypothesis-testing"><span class="header-section-number">1.17.3</span> Types of Errors in Hypothesis Testing</h3>
<ul>
<li><strong>Type I error (α)</strong>: Rejecting a true null hypothesis (“convicting an innocent”)
<ul>
<li>The probability of this error is controlled by the significance level α</li>
</ul></li>
<li><strong>Type II error (β)</strong>: Failing to reject a false null hypothesis (“acquitting the guilty”)
<ul>
<li>The probability of avoiding this error (1-β) is called the power of the test</li>
<li>Test power increases with sample size and effect size</li>
</ul></li>
</ul>
</section>
</section>
<section id="foundations-for-good-statistical-research" class="level2" data-number="1.18">
<h2 data-number="1.18" class="anchored" data-anchor-id="foundations-for-good-statistical-research"><span class="header-section-number">1.18</span> Foundations for Good Statistical Research</h2>
<p>To conduct reliable statistical research, ensure:</p>
<ol type="1">
<li><strong>Representativeness of the sample</strong>: The sample should well reflect the studied population</li>
<li><strong>Adequate sample size</strong>: Larger samples provide more accurate estimates and greater statistical power</li>
<li><strong>Control of confounding variables</strong>: Both in research design and data analysis</li>
<li><strong>Appropriate statistical methods</strong>: Matched to the type of data and research questions</li>
<li><strong>Clear interpretation</strong>: Taking into account study limitations and alternative explanations</li>
</ol>
<section id="summary-of-key-concepts" class="level3" data-number="1.18.1">
<h3 data-number="1.18.1" class="anchored" data-anchor-id="summary-of-key-concepts"><span class="header-section-number">1.18.1</span> Summary of Key Concepts</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 36%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Concept</th>
<th>Definition</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Population parameter (Estimand)</strong></td>
<td>Value characterizing the population, usually unknown</td>
<td>μ (population mean)</td>
</tr>
<tr class="even">
<td><strong>Estimator (Statistic)</strong></td>
<td>Function/procedure for estimating a parameter based on a sample</td>
<td><span class="math inline">\bar{x} = \frac{1}{n}\sum_{i=1}^n x_i</span></td>
</tr>
<tr class="odd">
<td><strong>Estimate</strong></td>
<td>Specific value obtained after applying an estimator to a sample</td>
<td><span class="math inline">\bar{x} = 173.5</span> cm</td>
</tr>
<tr class="even">
<td><strong>Standard error</strong></td>
<td>Measure of estimator variability between samples</td>
<td><span class="math inline">SE(\bar{x}) = \frac{s}{\sqrt{n}}</span></td>
</tr>
<tr class="odd">
<td><strong>Confidence interval</strong></td>
<td>Range of values that, with specified probability, contains the parameter</td>
<td>(173 cm, 175 cm)</td>
</tr>
<tr class="even">
<td><strong>P-value</strong></td>
<td>Probability of observing the data assuming H₀ is true</td>
<td>p = 0.03</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="appendices-additional-topics-in-statistics-and-data-science" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Appendices: Additional Topics in Statistics and Data Science (*)</h1>
<section id="appendix-a-r-for-social-science-data-analysis" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="appendix-a-r-for-social-science-data-analysis"><span class="header-section-number">2.1</span> Appendix A: R for Social Science Data Analysis</h2>
<p>R offers powerful capabilities for social science research, from data manipulation to advanced statistical modeling.</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate example data with a Simpson's Paradox</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_group =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Young"</span>, <span class="st">"Middle"</span>, <span class="st">"Old"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>)),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">education_years =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Young"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Middle"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">13</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Old"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">16</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">income =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Young"</span> <span class="sc">~</span> <span class="dv">70000</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> education_years <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5000</span>),</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Middle"</span> <span class="sc">~</span> <span class="dv">50000</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> education_years <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5000</span>),</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Old"</span> <span class="sc">~</span> <span class="dv">30000</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> education_years <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5000</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic data summary</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  age_group         education_years      income     
 Length:1000        Min.   : 6.628   Min.   :34068  
 Class :character   1st Qu.:10.913   1st Qu.:51508  
 Mode  :character   Median :13.004   Median :63376  
                    Mean   :12.986   Mean   :63307  
                    3rd Qu.:14.934   3rd Qu.:75023  
                    Max.   :18.861   Max.   :96620  </code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation analysis</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(data <span class="sc">%&gt;%</span> <span class="fu">select</span>(education_years, income))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                education_years     income
education_years       1.0000000 -0.8152477
income               -0.8152477  1.0000000</code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Overall trend (Simpson's Paradox)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>overall_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> education_years, <span class="at">y =</span> income)) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Overall Relationship between Education and Income"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Simpson's Paradox: Appears negative"</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Years of Education"</span>, <span class="at">y =</span> <span class="st">"Income"</span>) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Trend by age group (Resolving Simpson's Paradox)</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>grouped_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> education_years, <span class="at">y =</span> income, <span class="at">color =</span> age_group)) <span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relationship between Education and Income by Age Group"</span>,</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Resolving Simpson's Paradox: Positive relationship within groups"</span>,</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Years of Education"</span>, <span class="at">y =</span> <span class="st">"Income"</span>) <span class="sc">+</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(overall_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(grouped_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This example demonstrates Simpson’s Paradox, where the overall relationship between education and income appears negative, but when grouped by age, the relationship within each group is positive. This illustrates how critical it is to consider confounding variables in your analysis.</p>
</section>
<section id="appendix-b-causal-inference-vs.-observational-studies" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="appendix-b-causal-inference-vs.-observational-studies"><span class="header-section-number">2.2</span> Appendix B: Causal Inference vs.&nbsp;Observational Studies</h2>
<p>Understanding the relationship between variables is crucial in social sciences. Two key approaches are causal inference and observational studies, each with distinct strengths and limitations.</p>
<section id="causal-inference" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="causal-inference"><span class="header-section-number">2.2.1</span> Causal Inference</h3>
<ul>
<li>Aims to establish cause-and-effect relationships</li>
<li>Often involves experimental designs or advanced statistical techniques</li>
<li>Seeks to answer “What if?” questions and determine the impact of interventions</li>
<li>Examples: Randomized controlled trials, quasi-experimental designs, instrumental variables</li>
</ul>
</section>
<section id="observational-studies" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="observational-studies"><span class="header-section-number">2.2.2</span> Observational Studies</h3>
<ul>
<li>Examine relationships between variables without direct intervention</li>
<li>Rely on data collected from natural settings or existing datasets</li>
<li>Can identify correlations and patterns but struggle to establish causation</li>
<li>Examples: Cohort studies, case-control studies, cross-sectional surveys</li>
</ul>
<blockquote class="blockquote">
<p><strong>Important: Correlation Does Not Imply Causation</strong></p>
<ul>
<li><strong>Correlation</strong>: Measures the strength and direction of a relationship between variables</li>
<li><strong>Causation</strong>: Indicates that changes in one variable directly cause changes in another</li>
</ul>
<p>While strong correlations can suggest potential causal links, additional evidence and rigorous methods are required to establish causality.</p>
</blockquote>
</section>
<section id="challenges-in-establishing-causality" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="challenges-in-establishing-causality"><span class="header-section-number">2.2.3</span> Challenges in Establishing Causality</h3>
<ul>
<li><strong>Confounding variables</strong>: Unmeasured factors that affect both the presumed cause and effect</li>
<li><strong>Reverse causality</strong>: The presumed effect might actually be causing the presumed cause</li>
<li><strong>Selection bias</strong>: Non-random selection of subjects into study groups</li>
</ul>
</section>
<section id="methods-to-strengthen-causal-claims" class="level3" data-number="2.2.4">
<h3 data-number="2.2.4" class="anchored" data-anchor-id="methods-to-strengthen-causal-claims"><span class="header-section-number">2.2.4</span> Methods to Strengthen Causal Claims</h3>
<ol type="1">
<li>Randomized controlled trials (when ethical and feasible)</li>
<li>Natural experiments or quasi-experimental designs</li>
<li>Propensity score matching</li>
<li>Difference-in-differences analysis</li>
<li>Instrumental variable approaches</li>
<li>Directed acyclic graphs (DAGs) for visualizing causal relationships</li>
</ol>
<p>Understanding these distinctions is crucial in social sciences, where ethical considerations often limit experimental manipulation.</p>
</section>
</section>
<section id="appendix-c-understanding-spurious-correlations-confounders-and-colliders" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="appendix-c-understanding-spurious-correlations-confounders-and-colliders"><span class="header-section-number">2.3</span> Appendix C: Understanding Spurious Correlations, Confounders, and Colliders</h2>
<p>These concepts are essential for avoiding misinterpretations in statistical analysis. Let’s explore them with R examples.</p>
<div class="cell">
<details class="code-fold">
<summary>Load required libraries</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># for reproducibility</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="spurious-correlations" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="spurious-correlations"><span class="header-section-number">2.3.1</span> Spurious Correlations</h3>
<p>Spurious correlations are relationships between variables that appear to be causal but are actually coincidental or caused by an unseen third factor.</p>
<p><strong>Example: Ice Cream Sales and Drowning Incidents</strong></p>
<div class="cell">
<details class="code-fold">
<summary>R code for spurious correlation example</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>spurious_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ice_cream_sales =</span> <span class="dv">100</span> <span class="sc">+</span> <span class="dv">5</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">drowning_incidents =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the apparent correlation</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(spurious_data, <span class="fu">aes</span>(<span class="at">x =</span> ice_cream_sales, <span class="at">y =</span> drowning_incidents)) <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Spurious Correlation: Ice Cream Sales vs. Drowning"</span>,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Ice Cream Sales"</span>, </span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Drowning Incidents"</span>) <span class="sc">+</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the common cause</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(spurious_data, <span class="fu">aes</span>(<span class="at">x =</span> temperature)) <span class="sc">+</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> ice_cream_sales), <span class="at">color =</span> <span class="st">"#D55E00"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> drowning_incidents <span class="sc">*</span> <span class="dv">10</span>), <span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> ice_cream_sales), <span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#D55E00"</span>) <span class="sc">+</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> drowning_incidents <span class="sc">*</span> <span class="dv">10</span>), <span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Ice Cream Sales"</span>,</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="dv">10</span>, <span class="at">name =</span> <span class="st">"Drowning Incidents"</span>)</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Temperature as the Common Cause"</span>,</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Temperature (°C)"</span>) <span class="sc">+</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y.left =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#D55E00"</span>),</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y.right =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>)</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlation</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>cor_value <span class="ot">&lt;-</span> <span class="fu">cor</span>(spurious_data<span class="sc">$</span>ice_cream_sales, spurious_data<span class="sc">$</span>drowning_incidents)</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>R code for spurious correlation example</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>R code for spurious correlation example</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Correlation between ice cream sales and drowning incidents:"</span>, <span class="fu">round</span>(cor_value, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Correlation between ice cream sales and drowning incidents: 0.68</code></pre>
</div>
</div>
<p>In this example, temperature is the common cause (confounder) that influences both ice cream sales and drowning incidents. When we plot them against each other, they appear correlated (r ≈ 0.5), but this is spurious. The relationship disappears when we control for temperature.</p>
</section>
<section id="confounders" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="confounders"><span class="header-section-number">2.3.2</span> Confounders</h3>
<p>A confounder is a variable that influences both the dependent variable and independent variable, causing a spurious association.</p>
<p><strong>Example: Education, Income, and Age</strong></p>
<div class="cell">
<details class="code-fold">
<summary>R code for confounder example</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>confounder_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">runif</span>(n, <span class="dv">25</span>, <span class="dv">65</span>),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">education =</span> <span class="fu">round</span>(<span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> age <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">2</span>)),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">income =</span> <span class="dv">20000</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> education <span class="sc">+</span> <span class="dv">500</span> <span class="sc">*</span> age <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">5000</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create age groups for visualization</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>confounder_data <span class="ot">&lt;-</span> confounder_data <span class="sc">%&gt;%</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_group =</span> <span class="fu">cut</span>(age, <span class="at">breaks =</span> <span class="dv">3</span>, </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Young"</span>, <span class="st">"Middle"</span>, <span class="st">"Older"</span>)))</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Models with and without controlling for the confounder</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>model_naive <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> education, <span class="at">data =</span> confounder_data)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>model_adjusted <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> education <span class="sc">+</span> age, <span class="at">data =</span> confounder_data)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(confounder_data, <span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">y =</span> income)) <span class="sc">+</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> age), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> age_group, <span class="at">color =</span> <span class="fu">as.numeric</span>(age_group)), </span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Age"</span>, </span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">45</span>, <span class="dv">60</span>), </span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Young"</span>, <span class="st">"Middle"</span>, <span class="st">"Older"</span>)) <span class="sc">+</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Education vs Income, Confounded by Age"</span>,</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Without controlling for age: effect ="</span>, </span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">coef</span>(model_naive)[<span class="st">"education"</span>], <span class="dv">1</span>),</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"| With age control: effect ="</span>, </span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">coef</span>(model_adjusted)[<span class="st">"education"</span>], <span class="dv">1</span>)),</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Years of Education"</span>, </span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Income"</span>) <span class="sc">+</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this example, age is a confounder in the relationship between education and income. Without controlling for age, we overestimate the effect of education on income (the black line). When we examine the relationship within specific age groups (colored lines), we see a more accurate representation of the true effect.</p>
</section>
<section id="colliders" class="level3" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="colliders"><span class="header-section-number">2.3.3</span> Colliders</h3>
<p>A collider is a variable that is influenced by both the independent variable and the dependent variable. Controlling for a collider can introduce a spurious correlation.</p>
<p><strong>Example: Job Satisfaction, Salary, and Work-Life Balance</strong></p>
<div class="cell">
<details class="code-fold">
<summary>R code for collider example</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>collider_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">job_satisfaction =</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">salary =</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Both job satisfaction and salary negatively affect work-life balance</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">work_life_balance =</span> <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> job_satisfaction <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> salary <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Without controlling for work-life balance</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>model_correct <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> job_satisfaction, <span class="at">data =</span> collider_data)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Incorrectly controlling for the collider</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>model_collider <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> job_satisfaction <span class="sc">+</span> work_life_balance, <span class="at">data =</span> collider_data)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(collider_data, <span class="fu">aes</span>(<span class="at">x =</span> job_satisfaction, <span class="at">y =</span> salary, </span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> work_life_balance)) <span class="sc">+</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Work-Life</span><span class="sc">\n</span><span class="st">Balance"</span>) <span class="sc">+</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Job Satisfaction vs Salary, with Work-Life Balance as Collider"</span>,</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Without controlling: correlation ="</span>, </span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">coef</span>(model_correct)[<span class="st">"job_satisfaction"</span>], <span class="dv">3</span>),</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"| With control: correlation ="</span>, </span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">coef</span>(model_collider)[<span class="st">"job_satisfaction"</span>], <span class="dv">3</span>)),</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Job Satisfaction"</span>, </span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Salary"</span>) <span class="sc">+</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this example, there’s no inherent relationship between job satisfaction and salary (the black line shows near-zero correlation). However, both variables negatively impact work-life balance. If we control for work-life balance (the collider), we introduce a positive correlation between job satisfaction and salary that doesn’t actually exist.</p>
</section>
<section id="simpsons-paradox" class="level3" data-number="2.3.4">
<h3 data-number="2.3.4" class="anchored" data-anchor-id="simpsons-paradox"><span class="header-section-number">2.3.4</span> Simpson’s Paradox</h3>
<p>Simpson’s paradox occurs when a trend appears in different groups of data but disappears or reverses when these groups are combined.</p>
<p><strong>Example: Treatment Effectiveness Across Age Groups</strong></p>
<div class="cell">
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create example dataset</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>simpson_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_group =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Young"</span>, <span class="st">"Older"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.3</span>)),</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Treatment A"</span>, <span class="st">"Treatment B"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Different recovery rates based on age and treatment</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovery_prob =</span> <span class="fu">case_when</span>(</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Young"</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">"Treatment A"</span> <span class="sc">~</span> <span class="fl">0.70</span>,</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Young"</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">"Treatment B"</span> <span class="sc">~</span> <span class="fl">0.80</span>,</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Older"</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">"Treatment A"</span> <span class="sc">~</span> <span class="fl">0.50</span>,</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Older"</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">"Treatment B"</span> <span class="sc">~</span> <span class="fl">0.40</span>,</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># More older people get Treatment A</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="fu">if_else</span>(</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Older"</span> <span class="sc">&amp;</span> <span class="fu">runif</span>(n) <span class="sc">&lt;</span> <span class="fl">0.7</span>, </span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Treatment A"</span>, </span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>      treatment</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate recovery outcomes</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovered =</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, recovery_prob)</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate data</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>overall_rates <span class="ot">&lt;-</span> simpson_data <span class="sc">%&gt;%</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_patients =</span> <span class="fu">n</span>(),</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovered_patients =</span> <span class="fu">sum</span>(recovered),</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovery_rate =</span> <span class="fu">mean</span>(recovered)</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>by_age_rates <span class="ot">&lt;-</span> simpson_data <span class="sc">%&gt;%</span></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment, age_group) <span class="sc">%&gt;%</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_patients =</span> <span class="fu">n</span>(),</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovered_patients =</span> <span class="fu">sum</span>(recovered),</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovery_rate =</span> <span class="fu">mean</span>(recovered)</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'treatment'. You can override using the
`.groups` argument.</code></pre>
</div>
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualization</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>overall_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(overall_rates, </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> recovery_rate, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(recovery_rate<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%"</span>)), </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Overall Recovery Rates"</span>,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Simpson's Paradox: Treatment B appears worse overall"</span>,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Recovery Rate"</span>) <span class="sc">+</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>by_age_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(by_age_rates, </span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> recovery_rate, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(recovery_rate<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%"</span>)), </span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Recovery Rates by Age Group"</span>,</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Within each age group, Treatment B is actually better"</span>,</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Recovery Rate"</span>) <span class="sc">+</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>age_group) <span class="sc">+</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Display tables and plots</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(overall_rates, <span class="at">caption =</span> <span class="st">"Overall Recovery Rates by Treatment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Overall Recovery Rates by Treatment</caption>
<thead>
<tr class="header">
<th style="text-align: left;">treatment</th>
<th style="text-align: right;">total_patients</th>
<th style="text-align: right;">recovered_patients</th>
<th style="text-align: right;">recovery_rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Treatment A</td>
<td style="text-align: right;">594</td>
<td style="text-align: right;">356</td>
<td style="text-align: right;">0.5993266</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment B</td>
<td style="text-align: right;">406</td>
<td style="text-align: right;">297</td>
<td style="text-align: right;">0.7315271</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(by_age_rates, <span class="at">caption =</span> <span class="st">"Recovery Rates by Treatment and Age Group"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Recovery Rates by Treatment and Age Group</caption>
<colgroup>
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 21%">
<col style="width: 27%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">treatment</th>
<th style="text-align: left;">age_group</th>
<th style="text-align: right;">total_patients</th>
<th style="text-align: right;">recovered_patients</th>
<th style="text-align: right;">recovery_rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Treatment A</td>
<td style="text-align: left;">Older</td>
<td style="text-align: right;">240</td>
<td style="text-align: right;">116</td>
<td style="text-align: right;">0.4833333</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment A</td>
<td style="text-align: left;">Young</td>
<td style="text-align: right;">354</td>
<td style="text-align: right;">240</td>
<td style="text-align: right;">0.6779661</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Treatment B</td>
<td style="text-align: left;">Older</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0.4181818</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment B</td>
<td style="text-align: left;">Young</td>
<td style="text-align: right;">351</td>
<td style="text-align: right;">274</td>
<td style="text-align: right;">0.7806268</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(overall_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(by_age_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Simpson’s paradox is occurring here because:</p>
<ol type="1">
<li><strong>Within each age group</strong>: Treatment B has a higher recovery rate than Treatment A</li>
<li><strong>Overall</strong>: Treatment A appears to have a higher recovery rate than Treatment B</li>
</ol>
<p>This paradox happens because: - Treatment A is given more frequently to older patients - Older patients have lower recovery rates regardless of treatment - This skews the overall average to make Treatment A look better, even though Treatment B is better for both young and older patients</p>
</section>
<section id="directed-acyclic-graphs-dags" class="level3" data-number="2.3.5">
<h3 data-number="2.3.5" class="anchored" data-anchor-id="directed-acyclic-graphs-dags"><span class="header-section-number">2.3.5</span> Directed Acyclic Graphs (DAGs)</h3>
<p>DAGs are powerful tools for visualizing causal relationships and identifying potential biases in statistical analyses.</p>
<div class="cell">
<details class="code-fold">
<summary>R code for DAG examples</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Try to load dagitty and ggdag if available</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">"dagitty"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="sc">&amp;&amp;</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">requireNamespace</span>(<span class="st">"ggdag"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dagitty)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggdag)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example 1: Confounder</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  confounder_dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag {</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="st">    X -&gt; Y</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="st">    Z -&gt; X</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="st">    Z -&gt; Y</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="st">  }'</span>)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example 2: Collider</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  collider_dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag {</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="st">    X -&gt; Z</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="st">    Y -&gt; Z</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="st">    X -- Y [unobserved]</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="st">  }'</span>)</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example 3: Simpson's Paradox</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>  simpson_dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag {</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="st">    Treatment -&gt; Recovery</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="st">    Age -&gt; Treatment</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="st">    Age -&gt; Recovery</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="st">  }'</span>)</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot the DAGs</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggdag</span>(confounder_dag) <span class="sc">+</span> </span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_dag</span>() <span class="sc">+</span> </span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Confounder (Z)"</span>)</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggdag</span>(collider_dag) <span class="sc">+</span> </span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_dag</span>() <span class="sc">+</span> </span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Collider (Z)"</span>)</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">ggdag</span>(simpson_dag) <span class="sc">+</span> </span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_dag</span>() <span class="sc">+</span> </span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Simpson's Paradox Structure"</span>)</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p1)</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p2)</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p3)</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"DAG visualization packages not installed. Install dagitty and ggdag packages for these examples."</span>)</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggdag'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter1_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>DAGs help us visualize different causal structures:</p>
<ol type="1">
<li><strong>Confounder</strong>: A variable (Z) that affects both the exposure (X) and outcome (Y)</li>
<li><strong>Collider</strong>: A variable (Z) that is affected by both the exposure (X) and another variable (Y)</li>
<li><strong>Simpson’s Paradox</strong>: Often involves a confounder that influences both the treatment/exposure and the outcome</li>
</ol>
<p>Understanding these structures helps us decide which variables to control for in our analyses and which to leave out.</p>
</section>
</section>
<section id="appendix-d-models-in-science-from-deterministic-to-stochastic" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="appendix-d-models-in-science-from-deterministic-to-stochastic"><span class="header-section-number">2.4</span> Appendix D: Models in Science: From Deterministic to Stochastic</h2>
<p>Models are essential tools in scientific research, helping scientists to represent, understand, and predict complex phenomena.</p>
<section id="types-of-models" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="types-of-models"><span class="header-section-number">2.4.1</span> Types of Models</h3>
<section id="mathematical-models" class="level4" data-number="2.4.1.1">
<h4 data-number="2.4.1.1" class="anchored" data-anchor-id="mathematical-models"><span class="header-section-number">2.4.1.1</span> Mathematical Models</h4>
<p>Mathematical models use equations to describe and analyze systems. They can be divided into:</p>
<section id="deterministic-models" class="level5" data-number="2.4.1.1.1">
<h5 data-number="2.4.1.1.1" class="anchored" data-anchor-id="deterministic-models"><span class="header-section-number">2.4.1.1.1</span> Deterministic Models</h5>
<p>Deterministic models provide precise predictions based on a set of variables, without incorporating randomness.</p>
<p><strong>Example:</strong> Newton’s laws of motion, which can precisely predict the motion of objects under known forces:</p>
<p><span class="math display">x(t) = x_0 + v_0t + \frac{1}{2}at^2</span></p>
<p>Where <span class="math inline">x(t)</span> is the position at time <span class="math inline">t</span>, <span class="math inline">x_0</span> is the initial position, <span class="math inline">v_0</span> is the initial velocity, and <span class="math inline">a</span> is the acceleration.</p>
</section>
<section id="stochastic-models" class="level5" data-number="2.4.1.1.2">
<h5 data-number="2.4.1.1.2" class="anchored" data-anchor-id="stochastic-models"><span class="header-section-number">2.4.1.1.2</span> Stochastic Models</h5>
<p>Stochastic models incorporate randomness and probability. They come in two fundamentally different types:</p>
<p><strong>Classical Stochastic Models</strong>: Deal with randomness arising from incomplete information or complex interactions in classical systems. The underlying system is deterministic, but practical limitations lead to probabilistic descriptions.</p>
<p><strong>Example:</strong> Regression models in statistics, where the randomness represents unexplained variation:</p>
<p><span class="math display">y = \beta_0 + \beta_1x + \varepsilon</span></p>
<p>Where <span class="math inline">y</span> is the dependent variable, <span class="math inline">x</span> is the independent variable, <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1</span> are parameters, and <span class="math inline">\varepsilon</span> is the error term.</p>
<p><strong>Quantum Stochastic Models</strong>: Deal with the fundamental, irreducible randomness inherent in quantum mechanical systems.</p>
<p><strong>Example:</strong> The decay of a radioactive particle follows a probability distribution:</p>
<p><span class="math display">P(t) = e^{-t/\tau}</span></p>
<p>Where <span class="math inline">P(t)</span> is the probability that the particle has not decayed after time <span class="math inline">t</span>, and <span class="math inline">\tau</span> is the mean lifetime of the particle.</p>
</section>
</section>
<section id="other-model-types" class="level4" data-number="2.4.1.2">
<h4 data-number="2.4.1.2" class="anchored" data-anchor-id="other-model-types"><span class="header-section-number">2.4.1.2</span> Other Model Types</h4>
<ul>
<li><strong>Computer Simulation Models</strong>: Use algorithms to simulate complex systems</li>
<li><strong>Conceptual Models</strong>: Abstract representations using diagrams or flowcharts</li>
<li><strong>Physical Models</strong>: Tangible representations like scale models</li>
<li><strong>Theoretical Models</strong>: Abstract frameworks based on fundamental principles</li>
</ul>
</section>
</section>
<section id="model-error-and-bias-variance-tradeoff" class="level3" data-number="2.4.2">
<h3 data-number="2.4.2" class="anchored" data-anchor-id="model-error-and-bias-variance-tradeoff"><span class="header-section-number">2.4.2</span> Model Error and Bias-Variance Tradeoff</h3>
<p>All models involve some degree of error. Understanding the balance between bias and variance is crucial:</p>
<ul>
<li><strong>Bias</strong>: Systematic error from simplifying assumptions</li>
<li><strong>Variance</strong>: Error from sensitivity to small fluctuations in the training data</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/ModelError.png" class="img-fluid figure-img"></p>
<figcaption>Bias-Variance Tradeoff in Models</figcaption>
</figure>
</div>
<p>The ideal model balances complexity to minimize both bias and variance, leading to the best predictive performance.</p>
</section>
</section>
<section id="appendix-e-classical-vs-quantum-randomness" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="appendix-e-classical-vs-quantum-randomness"><span class="header-section-number">2.5</span> Appendix E: Classical vs Quantum Randomness</h2>
<p>To understand how randomness differs across scientific disciplines, we need to examine the origins and implications of different types of uncertainty.</p>
<section id="origin-of-randomness" class="level3" data-number="2.5.1">
<h3 data-number="2.5.1" class="anchored" data-anchor-id="origin-of-randomness"><span class="header-section-number">2.5.1</span> Origin of Randomness</h3>
<section id="classical-randomness-e.g.-regression-models" class="level4" data-number="2.5.1.1">
<h4 data-number="2.5.1.1" class="anchored" data-anchor-id="classical-randomness-e.g.-regression-models"><span class="header-section-number">2.5.1.1</span> Classical Randomness (e.g., Regression Models)</h4>
<ul>
<li><strong>Source</strong>: Incomplete information or complex interactions in an otherwise deterministic system</li>
<li><strong>Nature</strong>: Epistemic uncertainty (due to lack of knowledge)</li>
<li><strong>Example</strong>: In a regression model, the error term represents unexplained variation</li>
</ul>
</section>
<section id="quantum-randomness" class="level4" data-number="2.5.1.2">
<h4 data-number="2.5.1.2" class="anchored" data-anchor-id="quantum-randomness"><span class="header-section-number">2.5.1.2</span> Quantum Randomness</h4>
<ul>
<li><strong>Source</strong>: Fundamental property of quantum systems</li>
<li><strong>Nature</strong>: Ontic uncertainty (inherent to the system, not due to lack of knowledge)</li>
<li><strong>Example</strong>: The exact time of decay of a radioactive atom cannot be predicted</li>
</ul>
</section>
</section>
<section id="philosophical-implications" class="level3" data-number="2.5.2">
<h3 data-number="2.5.2" class="anchored" data-anchor-id="philosophical-implications"><span class="header-section-number">2.5.2</span> Philosophical Implications</h3>
<section id="classical-randomness" class="level4" data-number="2.5.2.1">
<h4 data-number="2.5.2.1" class="anchored" data-anchor-id="classical-randomness"><span class="header-section-number">2.5.2.1</span> Classical Randomness</h4>
<ul>
<li><strong>Determinism</strong>: Underlying reality is deterministic; randomness reflects our ignorance</li>
<li><strong>Hidden Variables</strong>: In principle, with complete information, we could predict outcomes precisely</li>
</ul>
</section>
<section id="quantum-randomness-1" class="level4" data-number="2.5.2.2">
<h4 data-number="2.5.2.2" class="anchored" data-anchor-id="quantum-randomness-1"><span class="header-section-number">2.5.2.2</span> Quantum Randomness</h4>
<ul>
<li><strong>Indeterminism</strong>: Randomness is a fundamental feature of reality</li>
<li><strong>No Hidden Variables</strong>: Even with complete information, some outcomes remain unpredictable (as suggested by Bell’s theorem)</li>
</ul>
</section>
</section>
<section id="practical-implications" class="level3" data-number="2.5.3">
<h3 data-number="2.5.3" class="anchored" data-anchor-id="practical-implications"><span class="header-section-number">2.5.3</span> Practical Implications</h3>
<section id="classical-randomness-1" class="level4" data-number="2.5.3.1">
<h4 data-number="2.5.3.1" class="anchored" data-anchor-id="classical-randomness-1"><span class="header-section-number">2.5.3.1</span> Classical Randomness</h4>
<ul>
<li><strong>Reducible</strong>: Can be reduced by gathering more data or improving measurement precision</li>
<li><strong>Controllable</strong>: Systematic errors can be identified and corrected</li>
</ul>
</section>
<section id="quantum-randomness-2" class="level4" data-number="2.5.3.2">
<h4 data-number="2.5.3.2" class="anchored" data-anchor-id="quantum-randomness-2"><span class="header-section-number">2.5.3.2</span> Quantum Randomness</h4>
<ul>
<li><strong>Irreducible</strong>: Cannot be eliminated even with perfect measurements</li>
<li><strong>Fundamentally Uncontrollable</strong>: The act of measurement itself affects the system</li>
</ul>
<p>Understanding these differences is crucial for correctly interpreting statistical models in different scientific contexts.</p>
</section>
</section>
</section>
<section id="appendix-f-ethical-considerations-in-social-science-data-analysis" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="appendix-f-ethical-considerations-in-social-science-data-analysis"><span class="header-section-number">2.6</span> Appendix F: Ethical Considerations in Social Science Data Analysis</h2>
<p>Ethics play a vital role in social science research. Key considerations include:</p>
<section id="privacy-and-consent" class="level3" data-number="2.6.1">
<h3 data-number="2.6.1" class="anchored" data-anchor-id="privacy-and-consent"><span class="header-section-number">2.6.1</span> 1. Privacy and Consent</h3>
<ul>
<li>Ensure participants understand how their data will be used</li>
<li>Obtain informed consent before collecting data</li>
<li>Protect personally identifiable information</li>
<li>Consider cultural differences in privacy expectations</li>
</ul>
</section>
<section id="data-protection" class="level3" data-number="2.6.2">
<h3 data-number="2.6.2" class="anchored" data-anchor-id="data-protection"><span class="header-section-number">2.6.2</span> 2. Data Protection</h3>
<ul>
<li>Securely store sensitive data</li>
<li>Implement appropriate access controls</li>
<li>Follow relevant regulations (e.g., GDPR, HIPAA)</li>
<li>Have a data management plan that includes secure disposal</li>
</ul>
</section>
<section id="bias-and-representation" class="level3" data-number="2.6.3">
<h3 data-number="2.6.3" class="anchored" data-anchor-id="bias-and-representation"><span class="header-section-number">2.6.3</span> 3. Bias and Representation</h3>
<ul>
<li>Address sampling bias that could exclude marginalized groups</li>
<li>Ensure diverse representation in research</li>
<li>Consider how variable definitions might reflect social biases</li>
<li>Be transparent about limitations in population coverage</li>
</ul>
</section>
<section id="transparency-and-reproducibility" class="level3" data-number="2.6.4">
<h3 data-number="2.6.4" class="anchored" data-anchor-id="transparency-and-reproducibility"><span class="header-section-number">2.6.4</span> 4. Transparency and Reproducibility</h3>
<ul>
<li>Clearly document research methods</li>
<li>Share code and data when possible</li>
<li>Pre-register studies when appropriate</li>
<li>Acknowledge limitations and potential biases</li>
</ul>
</section>
<section id="social-impact" class="level3" data-number="2.6.5">
<h3 data-number="2.6.5" class="anchored" data-anchor-id="social-impact"><span class="header-section-number">2.6.5</span> 5. Social Impact</h3>
<ul>
<li>Consider the potential societal implications of research findings</li>
<li>Avoid reinforcing harmful stereotypes</li>
<li>Think about how results might be misinterpreted or misused</li>
<li>Engage with communities being studied</li>
</ul>
<p>Ethical considerations should be integrated throughout the research process, from study design to data collection, analysis, and reporting of results.</p>
</section>
</section>
<section id="appendix-g-introduction-to-rstudio-and-the-tidyverse" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="appendix-g-introduction-to-rstudio-and-the-tidyverse"><span class="header-section-number">2.7</span> Appendix G: Introduction to RStudio and the tidyverse</h2>
<p>R is a powerful programming language for statistical computing and graphics. RStudio provides an integrated development environment that makes working with R easier.</p>
<section id="getting-started-with-rstudio" class="level3" data-number="2.7.1">
<h3 data-number="2.7.1" class="anchored" data-anchor-id="getting-started-with-rstudio"><span class="header-section-number">2.7.1</span> Getting Started with RStudio</h3>
<p>RStudio has four main panes:</p>
<ol type="1">
<li><strong>Source Editor</strong>: Where you write and edit your R scripts</li>
<li><strong>Console</strong>: Where you run R commands and see output</li>
<li><strong>Environment/History</strong>: Shows your workspace objects and command history</li>
<li><strong>Files/Plots/Packages/Help</strong>: For file management, viewing plots, managing packages, and accessing help</li>
</ol>
</section>
<section id="the-tidyverse-ecosystem" class="level3" data-number="2.7.2">
<h3 data-number="2.7.2" class="anchored" data-anchor-id="the-tidyverse-ecosystem"><span class="header-section-number">2.7.2</span> The tidyverse Ecosystem</h3>
<p>The tidyverse is a collection of R packages designed for data science with a consistent design philosophy.</p>
<p>Key packages include:</p>
<ul>
<li><strong>ggplot2</strong>: Data visualization</li>
<li><strong>dplyr</strong>: Data manipulation</li>
<li><strong>tidyr</strong>: Data tidying</li>
<li><strong>readr</strong>: Data import</li>
<li><strong>purrr</strong>: Functional programming</li>
<li><strong>tibble</strong>: Modern data frames</li>
</ul>
</section>
<section id="basic-tidyverse-workflow" class="level3" data-number="2.7.3">
<h3 data-number="2.7.3" class="anchored" data-anchor-id="basic-tidyverse-workflow"><span class="header-section-number">2.7.3</span> Basic tidyverse Workflow</h3>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load tidyverse</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"my_data.csv"</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean and transform</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(important_variable)) <span class="sc">%&gt;%</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(var1, var2, var3) <span class="sc">%&gt;%</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_var =</span> var1 <span class="sc">/</span> var2)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Group and summarize</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> cleaned_data <span class="sc">%&gt;%</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(category) <span class="sc">%&gt;%</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_val =</span> <span class="fu">mean</span>(var3),</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>()</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cleaned_data, <span class="fu">aes</span>(<span class="at">x =</span> var1, <span class="at">y =</span> var2, <span class="at">color =</span> category)) <span class="sc">+</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relationship between Variables"</span>,</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Variable 1"</span>,</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Variable 2"</span>) <span class="sc">+</span></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This workflow demonstrates the power of the tidyverse’s pipe operator (<code>%&gt;%</code>), which allows you to chain operations together in a readable way.</p>
</section>
<section id="resources-for-learning-r" class="level3" data-number="2.7.4">
<h3 data-number="2.7.4" class="anchored" data-anchor-id="resources-for-learning-r"><span class="header-section-number">2.7.4</span> Resources for Learning R</h3>
<ul>
<li><a href="https://r4ds.had.co.nz/">R for Data Science</a></li>
<li><a href="https://www.tidyverse.org/">tidyverse documentation</a></li>
<li><a href="https://www.rstudio.com/resources/cheatsheets/">RStudio Cheat Sheets</a></li>
<li><a href="https://quarto.org/docs/guide/">Quarto Guide</a></li>
</ul>
<p>The best way to learn R is through practice. Start with small, manageable projects and gradually build your skills.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Preface">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./rozdzial1.html" class="pagination-link" aria-label="Wprowadzenie do Nauki o Danych i Statystyki">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wprowadzenie do Nauki o Danych i Statystyki</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>