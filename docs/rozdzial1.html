<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Wprowadzenie do Nauki o Danych i Statystyki – Social Data Analysis: An Introduction (Wprowadzenie do analizy danych społecznych)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chapter2.html" rel="next">
<link href="./chapter1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./rozdzial1.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wprowadzenie do Nauki o Danych i Statystyki</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Social Data Analysis: An Introduction (Wprowadzenie do analizy danych społecznych)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Science and Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wprowadzenie do Nauki o Danych i Statystyki</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Zrozumienie Typów Danych w Naukach Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">From Sample to Population - Understanding Randomness, Sampling, and Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Od Próby do Populacji - Zrozumienie Losowości, Próbkowania i Wnioskowania</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reliability and Validity in Data Science Research</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Rzetelność i Trafność w Badaniach Nauk o Danych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Research Designs: Experimental and Non-Experimental Approaches</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Projekty Badawcze: Podejścia Eksperymentalne i Nieeksperymentalne</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fundamentals of Univariate Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Podstawy Jednowymiarowej Statystyki Opisowej</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data Visualization: with examples in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Wizualizacja Danych: z przykładami w R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction to (Discrete) Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Wprowadzenie do Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rv_pdf_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Random Variables and Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rv_pdf_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Zmienna Losowa i Rozkład Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Statistical Hypothesis Testing: A Fundamental Logic</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Wprowadzenie do Wnioskowania Statystycznego: Logika Testowania Hipotez Statystycznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#czym-są-statystyka-i-nauka-o-danych-data-science" id="toc-czym-są-statystyka-i-nauka-o-danych-data-science" class="nav-link active" data-scroll-target="#czym-są-statystyka-i-nauka-o-danych-data-science"><span class="header-section-number">2.1</span> Czym są Statystyka i Nauka o Danych (Data Science)?</a></li>
  <li><a href="#związek-między-statystyką-a-nauką-o-danych" id="toc-związek-między-statystyką-a-nauką-o-danych" class="nav-link" data-scroll-target="#związek-między-statystyką-a-nauką-o-danych"><span class="header-section-number">2.2</span> Związek między Statystyką a Nauką o Danych</a></li>
  <li><a href="#podstawowe-pojęcia-w-nauce-o-danych-i-statystyce" id="toc-podstawowe-pojęcia-w-nauce-o-danych-i-statystyce" class="nav-link" data-scroll-target="#podstawowe-pojęcia-w-nauce-o-danych-i-statystyce"><span class="header-section-number">2.3</span> Podstawowe Pojęcia w Nauce o Danych i Statystyce</a>
  <ul class="collapse">
  <li><a href="#dane-i-populacje" id="toc-dane-i-populacje" class="nav-link" data-scroll-target="#dane-i-populacje"><span class="header-section-number">2.3.1</span> Dane i Populacje</a></li>
  <li><a href="#wnioskowanie-statystyczne-jak-mała-próba-może-reprezentować-dużą-populację" id="toc-wnioskowanie-statystyczne-jak-mała-próba-może-reprezentować-dużą-populację" class="nav-link" data-scroll-target="#wnioskowanie-statystyczne-jak-mała-próba-może-reprezentować-dużą-populację"><span class="header-section-number">2.3.7</span> Wnioskowanie Statystyczne: Jak Mała Próba Może Reprezentować Dużą Populację?</a></li>
  </ul></li>
  <li><a href="#podstawowe-pojęcia-estymacji-statystycznej" id="toc-podstawowe-pojęcia-estymacji-statystycznej" class="nav-link" data-scroll-target="#podstawowe-pojęcia-estymacji-statystycznej"><span class="header-section-number">2.8</span> Podstawowe Pojęcia Estymacji Statystycznej</a>
  <ul class="collapse">
  <li><a href="#parametry-populacji-vs.-statystyki-próby" id="toc-parametry-populacji-vs.-statystyki-próby" class="nav-link" data-scroll-target="#parametry-populacji-vs.-statystyki-próby"><span class="header-section-number">2.8.1</span> Parametry populacji vs.&nbsp;Statystyki próby</a></li>
  <li><a href="#czym-jest-estymand" id="toc-czym-jest-estymand" class="nav-link" data-scroll-target="#czym-jest-estymand"><span class="header-section-number">2.8.2</span> Czym jest Estymand?</a></li>
  <li><a href="#czym-jest-estymator" id="toc-czym-jest-estymator" class="nav-link" data-scroll-target="#czym-jest-estymator"><span class="header-section-number">2.8.3</span> Czym jest Estymator?</a></li>
  <li><a href="#czym-jest-estymata" id="toc-czym-jest-estymata" class="nav-link" data-scroll-target="#czym-jest-estymata"><span class="header-section-number">2.8.4</span> Czym jest Estymata?</a></li>
  <li><a href="#co-czyni-estymator-dobrym" id="toc-co-czyni-estymator-dobrym" class="nav-link" data-scroll-target="#co-czyni-estymator-dobrym"><span class="header-section-number">2.8.5</span> Co Czyni Estymator Dobrym?</a></li>
  <li><a href="#dlaczego-szacowania-się-różnią-rozkład-próbkowania" id="toc-dlaczego-szacowania-się-różnią-rozkład-próbkowania" class="nav-link" data-scroll-target="#dlaczego-szacowania-się-różnią-rozkład-próbkowania"><span class="header-section-number">2.8.6</span> Dlaczego Szacowania Się Różnią? (Rozkład Próbkowania)</a></li>
  </ul></li>
  <li><a href="#wnioskowanie-statystyczne-nieformalne-wprowadzenie" id="toc-wnioskowanie-statystyczne-nieformalne-wprowadzenie" class="nav-link" data-scroll-target="#wnioskowanie-statystyczne-nieformalne-wprowadzenie"><span class="header-section-number">2.18</span> Wnioskowanie Statystyczne: Nieformalne Wprowadzenie</a></li>
  <li><a href="#estymacja" id="toc-estymacja" class="nav-link" data-scroll-target="#estymacja"><span class="header-section-number">2.19</span> Estymacja</a></li>
  <li><a href="#testowanie-hipotez" id="toc-testowanie-hipotez" class="nav-link" data-scroll-target="#testowanie-hipotez"><span class="header-section-number">2.20</span> Testowanie Hipotez</a>
  <ul class="collapse">
  <li><a href="#przykład-1-testowanie-czy-moneta-jest-stronnicza-na-korzyść-orła" id="toc-przykład-1-testowanie-czy-moneta-jest-stronnicza-na-korzyść-orła" class="nav-link" data-scroll-target="#przykład-1-testowanie-czy-moneta-jest-stronnicza-na-korzyść-orła"><span class="header-section-number">2.20.1</span> Przykład 1: Testowanie, czy moneta jest stronnicza na korzyść orła</a></li>
  <li><a href="#przykład-2-testowanie-wpływu-muzyki-w-tle-na-pamięć" id="toc-przykład-2-testowanie-wpływu-muzyki-w-tle-na-pamięć" class="nav-link" data-scroll-target="#przykład-2-testowanie-wpływu-muzyki-w-tle-na-pamięć"><span class="header-section-number">2.20.2</span> Przykład 2: Testowanie wpływu muzyki w tle na pamięć</a></li>
  </ul></li>
  <li><a href="#ogólne-kroki-testowania-hipotez" id="toc-ogólne-kroki-testowania-hipotez" class="nav-link" data-scroll-target="#ogólne-kroki-testowania-hipotez"><span class="header-section-number">2.21</span> Ogólne kroki testowania hipotez</a></li>
  <li><a href="#intuicja-testowania-hipotez" id="toc-intuicja-testowania-hipotez" class="nav-link" data-scroll-target="#intuicja-testowania-hipotez"><span class="header-section-number">2.22</span> Intuicja testowania hipotez</a></li>
  <li><a href="#częste-błędy-związane-z-wartościami-p" id="toc-częste-błędy-związane-z-wartościami-p" class="nav-link" data-scroll-target="#częste-błędy-związane-z-wartościami-p"><span class="header-section-number">2.23</span> Częste błędy związane z wartościami p</a></li>
  <li><a href="#rodzaje-błędów-w-testowaniu-hipotez" id="toc-rodzaje-błędów-w-testowaniu-hipotez" class="nav-link" data-scroll-target="#rodzaje-błędów-w-testowaniu-hipotez"><span class="header-section-number">2.24</span> Rodzaje błędów w testowaniu hipotez</a></li>
  <li><a href="#kluczowe-wnioski" id="toc-kluczowe-wnioski" class="nav-link" data-scroll-target="#kluczowe-wnioski"><span class="header-section-number">2.25</span> Kluczowe wnioski</a></li>
  <li><a href="#modele-statystyczne" id="toc-modele-statystyczne" class="nav-link" data-scroll-target="#modele-statystyczne"><span class="header-section-number">2.26</span> Modele Statystyczne</a>
  <ul class="collapse">
  <li><a href="#wnioskowanie-przyczynowe-vs.-predykcyjne" id="toc-wnioskowanie-przyczynowe-vs.-predykcyjne" class="nav-link" data-scroll-target="#wnioskowanie-przyczynowe-vs.-predykcyjne"><span class="header-section-number">2.26.1</span> Wnioskowanie Przyczynowe vs.&nbsp;Predykcyjne</a></li>
  <li><a href="#wyzwania-wnioskowania-przyczynowego" id="toc-wyzwania-wnioskowania-przyczynowego" class="nav-link" data-scroll-target="#wyzwania-wnioskowania-przyczynowego"><span class="header-section-number">2.26.2</span> Wyzwania Wnioskowania Przyczynowego</a></li>
  </ul></li>
  <li><a href="#zrozumienie-błędów-statystycznych" id="toc-zrozumienie-błędów-statystycznych" class="nav-link" data-scroll-target="#zrozumienie-błędów-statystycznych"><span class="header-section-number">2.27</span> Zrozumienie błędów statystycznych</a></li>
  <li><a href="#rodzaje-błędów-statystycznych" id="toc-rodzaje-błędów-statystycznych" class="nav-link" data-scroll-target="#rodzaje-błędów-statystycznych"><span class="header-section-number">2.28</span> Rodzaje błędów statystycznych</a>
  <ul class="collapse">
  <li><a href="#błędy-próbkowania" id="toc-błędy-próbkowania" class="nav-link" data-scroll-target="#błędy-próbkowania"><span class="header-section-number">2.28.1</span> Błędy próbkowania</a></li>
  <li><a href="#błędy-pomiarowe" id="toc-błędy-pomiarowe" class="nav-link" data-scroll-target="#błędy-pomiarowe"><span class="header-section-number">2.28.2</span> Błędy pomiarowe</a></li>
  <li><a href="#błędy-wnioskowania" id="toc-błędy-wnioskowania" class="nav-link" data-scroll-target="#błędy-wnioskowania"><span class="header-section-number">2.28.3</span> Błędy wnioskowania</a></li>
  <li><a href="#błędy-modelowania-statystycznego" id="toc-błędy-modelowania-statystycznego" class="nav-link" data-scroll-target="#błędy-modelowania-statystycznego"><span class="header-section-number">2.28.4</span> Błędy modelowania statystycznego</a></li>
  </ul></li>
  <li><a href="#strategie-minimalizowania-błędów-statystycznych" id="toc-strategie-minimalizowania-błędów-statystycznych" class="nav-link" data-scroll-target="#strategie-minimalizowania-błędów-statystycznych"><span class="header-section-number">2.29</span> Strategie minimalizowania błędów statystycznych</a></li>
  <li><a href="#appendices-additional-topics-in-statistics-and-data-science" id="toc-appendices-additional-topics-in-statistics-and-data-science" class="nav-link" data-scroll-target="#appendices-additional-topics-in-statistics-and-data-science"><span class="header-section-number">2.30</span> Appendices: Additional Topics in Statistics and Data Science (*)</a></li>
  <li><a href="#appendix-a-r-for-social-science-data-analysis" id="toc-appendix-a-r-for-social-science-data-analysis" class="nav-link" data-scroll-target="#appendix-a-r-for-social-science-data-analysis"><span class="header-section-number">2.31</span> Appendix A: R for Social Science Data Analysis</a></li>
  <li><a href="#appendix-b-causal-inference-vs.-observational-studies" id="toc-appendix-b-causal-inference-vs.-observational-studies" class="nav-link" data-scroll-target="#appendix-b-causal-inference-vs.-observational-studies"><span class="header-section-number">2.32</span> Appendix B: Causal Inference vs.&nbsp;Observational Studies</a>
  <ul class="collapse">
  <li><a href="#causal-inference" id="toc-causal-inference" class="nav-link" data-scroll-target="#causal-inference"><span class="header-section-number">2.32.1</span> Causal Inference</a></li>
  <li><a href="#observational-studies" id="toc-observational-studies" class="nav-link" data-scroll-target="#observational-studies"><span class="header-section-number">2.32.2</span> Observational Studies</a></li>
  <li><a href="#challenges-in-establishing-causality" id="toc-challenges-in-establishing-causality" class="nav-link" data-scroll-target="#challenges-in-establishing-causality"><span class="header-section-number">2.32.3</span> Challenges in Establishing Causality</a></li>
  <li><a href="#methods-to-strengthen-causal-claims" id="toc-methods-to-strengthen-causal-claims" class="nav-link" data-scroll-target="#methods-to-strengthen-causal-claims"><span class="header-section-number">2.32.4</span> Methods to Strengthen Causal Claims</a></li>
  </ul></li>
  <li><a href="#appendix-c-understanding-spurious-correlations-confounders-and-colliders" id="toc-appendix-c-understanding-spurious-correlations-confounders-and-colliders" class="nav-link" data-scroll-target="#appendix-c-understanding-spurious-correlations-confounders-and-colliders"><span class="header-section-number">2.33</span> Appendix C: Understanding Spurious Correlations, Confounders, and Colliders</a>
  <ul class="collapse">
  <li><a href="#spurious-correlations" id="toc-spurious-correlations" class="nav-link" data-scroll-target="#spurious-correlations"><span class="header-section-number">2.33.1</span> Spurious Correlations</a></li>
  <li><a href="#confounders" id="toc-confounders" class="nav-link" data-scroll-target="#confounders"><span class="header-section-number">2.33.2</span> Confounders</a></li>
  <li><a href="#colliders" id="toc-colliders" class="nav-link" data-scroll-target="#colliders"><span class="header-section-number">2.33.3</span> Colliders</a></li>
  <li><a href="#simpsons-paradox" id="toc-simpsons-paradox" class="nav-link" data-scroll-target="#simpsons-paradox"><span class="header-section-number">2.33.4</span> Simpson’s Paradox</a></li>
  <li><a href="#directed-acyclic-graphs-dags" id="toc-directed-acyclic-graphs-dags" class="nav-link" data-scroll-target="#directed-acyclic-graphs-dags"><span class="header-section-number">2.33.5</span> Directed Acyclic Graphs (DAGs)</a></li>
  </ul></li>
  <li><a href="#appendix-d-models-in-science-from-deterministic-to-stochastic" id="toc-appendix-d-models-in-science-from-deterministic-to-stochastic" class="nav-link" data-scroll-target="#appendix-d-models-in-science-from-deterministic-to-stochastic"><span class="header-section-number">2.34</span> Appendix D: Models in Science: From Deterministic to Stochastic</a>
  <ul class="collapse">
  <li><a href="#types-of-models" id="toc-types-of-models" class="nav-link" data-scroll-target="#types-of-models"><span class="header-section-number">2.34.1</span> Types of Models</a></li>
  <li><a href="#model-error-and-bias-variance-tradeoff" id="toc-model-error-and-bias-variance-tradeoff" class="nav-link" data-scroll-target="#model-error-and-bias-variance-tradeoff"><span class="header-section-number">2.34.2</span> Model Error and Bias-Variance Tradeoff</a></li>
  </ul></li>
  <li><a href="#appendix-e-classical-vs-quantum-randomness" id="toc-appendix-e-classical-vs-quantum-randomness" class="nav-link" data-scroll-target="#appendix-e-classical-vs-quantum-randomness"><span class="header-section-number">2.35</span> Appendix E: Classical vs Quantum Randomness</a>
  <ul class="collapse">
  <li><a href="#origin-of-randomness" id="toc-origin-of-randomness" class="nav-link" data-scroll-target="#origin-of-randomness"><span class="header-section-number">2.35.1</span> Origin of Randomness</a></li>
  <li><a href="#philosophical-implications" id="toc-philosophical-implications" class="nav-link" data-scroll-target="#philosophical-implications"><span class="header-section-number">2.35.2</span> Philosophical Implications</a></li>
  <li><a href="#practical-implications" id="toc-practical-implications" class="nav-link" data-scroll-target="#practical-implications"><span class="header-section-number">2.35.3</span> Practical Implications</a></li>
  </ul></li>
  <li><a href="#appendix-f-ethical-considerations-in-social-science-data-analysis" id="toc-appendix-f-ethical-considerations-in-social-science-data-analysis" class="nav-link" data-scroll-target="#appendix-f-ethical-considerations-in-social-science-data-analysis"><span class="header-section-number">2.36</span> Appendix F: Ethical Considerations in Social Science Data Analysis</a>
  <ul class="collapse">
  <li><a href="#privacy-and-consent" id="toc-privacy-and-consent" class="nav-link" data-scroll-target="#privacy-and-consent"><span class="header-section-number">2.36.1</span> 1. Privacy and Consent</a></li>
  <li><a href="#data-protection" id="toc-data-protection" class="nav-link" data-scroll-target="#data-protection"><span class="header-section-number">2.36.2</span> 2. Data Protection</a></li>
  <li><a href="#bias-and-representation" id="toc-bias-and-representation" class="nav-link" data-scroll-target="#bias-and-representation"><span class="header-section-number">2.36.3</span> 3. Bias and Representation</a></li>
  <li><a href="#transparency-and-reproducibility" id="toc-transparency-and-reproducibility" class="nav-link" data-scroll-target="#transparency-and-reproducibility"><span class="header-section-number">2.36.4</span> 4. Transparency and Reproducibility</a></li>
  <li><a href="#social-impact" id="toc-social-impact" class="nav-link" data-scroll-target="#social-impact"><span class="header-section-number">2.36.5</span> 5. Social Impact</a></li>
  </ul></li>
  <li><a href="#appendix-g-introduction-to-rstudio-and-the-tidyverse" id="toc-appendix-g-introduction-to-rstudio-and-the-tidyverse" class="nav-link" data-scroll-target="#appendix-g-introduction-to-rstudio-and-the-tidyverse"><span class="header-section-number">2.37</span> Appendix G: Introduction to RStudio and the tidyverse</a>
  <ul class="collapse">
  <li><a href="#getting-started-with-rstudio" id="toc-getting-started-with-rstudio" class="nav-link" data-scroll-target="#getting-started-with-rstudio"><span class="header-section-number">2.37.1</span> Getting Started with RStudio</a></li>
  <li><a href="#the-tidyverse-ecosystem" id="toc-the-tidyverse-ecosystem" class="nav-link" data-scroll-target="#the-tidyverse-ecosystem"><span class="header-section-number">2.37.2</span> The tidyverse Ecosystem</a></li>
  <li><a href="#basic-tidyverse-workflow" id="toc-basic-tidyverse-workflow" class="nav-link" data-scroll-target="#basic-tidyverse-workflow"><span class="header-section-number">2.37.3</span> Basic tidyverse Workflow</a></li>
  <li><a href="#resources-for-learning-r" id="toc-resources-for-learning-r" class="nav-link" data-scroll-target="#resources-for-learning-r"><span class="header-section-number">2.37.4</span> Resources for Learning R</a></li>
  </ul></li>
  <li><a href="#appendix-h-symulacja-centralnego-twierdzenia-granicznego" id="toc-appendix-h-symulacja-centralnego-twierdzenia-granicznego" class="nav-link" data-scroll-target="#appendix-h-symulacja-centralnego-twierdzenia-granicznego"><span class="header-section-number">2.38</span> Appendix H: Symulacja Centralnego Twierdzenia Granicznego</a>
  <ul class="collapse">
  <li><a href="#czym-jest-centralne-twierdzenie-graniczne" id="toc-czym-jest-centralne-twierdzenie-graniczne" class="nav-link" data-scroll-target="#czym-jest-centralne-twierdzenie-graniczne"><span class="header-section-number">2.38.1</span> Czym jest Centralne Twierdzenie Graniczne?</a></li>
  <li><a href="#prosty-eksperyment" id="toc-prosty-eksperyment" class="nav-link" data-scroll-target="#prosty-eksperyment"><span class="header-section-number">2.38.2</span> Prosty eksperyment</a></li>
  <li><a href="#jak-wyglądają-nasze-populacje" id="toc-jak-wyglądają-nasze-populacje" class="nav-link" data-scroll-target="#jak-wyglądają-nasze-populacje"><span class="header-section-number">2.38.3</span> Jak wyglądają nasze populacje?</a></li>
  <li><a href="#jak-zmieniają-się-rozkłady-średnich-z-próby" id="toc-jak-zmieniają-się-rozkłady-średnich-z-próby" class="nav-link" data-scroll-target="#jak-zmieniają-się-rozkłady-średnich-z-próby"><span class="header-section-number">2.38.4</span> Jak zmieniają się rozkłady średnich z próby?</a></li>
  <li><a href="#porównanie-wszystkich-trzech-rozkładów-dla-n30" id="toc-porównanie-wszystkich-trzech-rozkładów-dla-n30" class="nav-link" data-scroll-target="#porównanie-wszystkich-trzech-rozkładów-dla-n30"><span class="header-section-number">2.38.5</span> Porównanie wszystkich trzech rozkładów dla n=30</a></li>
  <li><a href="#kluczowe-wnioski-1" id="toc-kluczowe-wnioski-1" class="nav-link" data-scroll-target="#kluczowe-wnioski-1"><span class="header-section-number">2.38.6</span> Kluczowe wnioski</a></li>
  </ul></li>
  <li><a href="#appendix-i-symulacja-prawa-wielkich-liczb" id="toc-appendix-i-symulacja-prawa-wielkich-liczb" class="nav-link" data-scroll-target="#appendix-i-symulacja-prawa-wielkich-liczb"><span class="header-section-number">2.39</span> Appendix I: Symulacja Prawa Wielkich Liczb</a>
  <ul class="collapse">
  <li><a href="#prawo-wielkich-liczb" id="toc-prawo-wielkich-liczb" class="nav-link" data-scroll-target="#prawo-wielkich-liczb"><span class="header-section-number">2.39.1</span> Prawo Wielkich Liczb</a></li>
  <li><a href="#symulacja-rzutów-monetą" id="toc-symulacja-rzutów-monetą" class="nav-link" data-scroll-target="#symulacja-rzutów-monetą"><span class="header-section-number">2.39.2</span> Symulacja Rzutów Monetą</a></li>
  <li><a href="#symulacja-rzutów-kostką" id="toc-symulacja-rzutów-kostką" class="nav-link" data-scroll-target="#symulacja-rzutów-kostką"><span class="header-section-number">2.39.3</span> Symulacja Rzutów Kostką</a></li>
  <li><a href="#kluczowe-wnioski-2" id="toc-kluczowe-wnioski-2" class="nav-link" data-scroll-target="#kluczowe-wnioski-2"><span class="header-section-number">2.39.4</span> Kluczowe Wnioski</a></li>
  <li><a href="#zrozumienie-teoretycznych-granic-1n" id="toc-zrozumienie-teoretycznych-granic-1n" class="nav-link" data-scroll-target="#zrozumienie-teoretycznych-granic-1n"><span class="header-section-number">2.39.5</span> Zrozumienie Teoretycznych Granic (±1/√n)</a></li>
  </ul></li>
  <li><a href="#appendix-j-sample-size-determination-for-proportions" id="toc-appendix-j-sample-size-determination-for-proportions" class="nav-link" data-scroll-target="#appendix-j-sample-size-determination-for-proportions"><span class="header-section-number">2.40</span> Appendix J: Sample Size Determination for Proportions</a>
  <ul class="collapse">
  <li><a href="#understanding-margin-of-error" id="toc-understanding-margin-of-error" class="nav-link" data-scroll-target="#understanding-margin-of-error"><span class="header-section-number">2.40.1</span> Understanding Margin of Error</a></li>
  <li><a href="#the-sample-size-formula-for-proportions" id="toc-the-sample-size-formula-for-proportions" class="nav-link" data-scroll-target="#the-sample-size-formula-for-proportions"><span class="header-section-number">2.40.2</span> The Sample Size Formula for Proportions</a></li>
  <li><a href="#derivation-of-the-sample-size-formula" id="toc-derivation-of-the-sample-size-formula" class="nav-link" data-scroll-target="#derivation-of-the-sample-size-formula"><span class="header-section-number">2.40.3</span> Derivation of the Sample Size Formula</a></li>
  <li><a href="#selecting-the-confidence-level" id="toc-selecting-the-confidence-level" class="nav-link" data-scroll-target="#selecting-the-confidence-level"><span class="header-section-number">2.40.4</span> Selecting the Confidence Level</a></li>
  <li><a href="#estimating-the-expected-proportion" id="toc-estimating-the-expected-proportion" class="nav-link" data-scroll-target="#estimating-the-expected-proportion"><span class="header-section-number">2.40.5</span> Estimating the Expected Proportion</a></li>
  <li><a href="#step-by-step-example-calculating-sample-size-with-5-p.p.-error" id="toc-step-by-step-example-calculating-sample-size-with-5-p.p.-error" class="nav-link" data-scroll-target="#step-by-step-example-calculating-sample-size-with-5-p.p.-error"><span class="header-section-number">2.40.6</span> Step-by-Step Example: Calculating Sample Size with 5 p.p. Error</a></li>
  <li><a href="#sample-size-for-different-precision-levels" id="toc-sample-size-for-different-precision-levels" class="nav-link" data-scroll-target="#sample-size-for-different-precision-levels"><span class="header-section-number">2.40.7</span> Sample Size for Different Precision Levels</a></li>
  <li><a href="#adjusting-for-known-expected-proportions" id="toc-adjusting-for-known-expected-proportions" class="nav-link" data-scroll-target="#adjusting-for-known-expected-proportions"><span class="header-section-number">2.40.8</span> Adjusting for Known Expected Proportions</a></li>
  <li><a href="#adjusting-for-finite-populations" id="toc-adjusting-for-finite-populations" class="nav-link" data-scroll-target="#adjusting-for-finite-populations"><span class="header-section-number">2.40.9</span> Adjusting for Finite Populations</a></li>
  <li><a href="#practical-considerations" id="toc-practical-considerations" class="nav-link" data-scroll-target="#practical-considerations"><span class="header-section-number">2.40.10</span> Practical Considerations</a></li>
  <li><a href="#implementing-in-r" id="toc-implementing-in-r" class="nav-link" data-scroll-target="#implementing-in-r"><span class="header-section-number">2.40.11</span> Implementing in R</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">2.40.12</span> Conclusion</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">2.40.13</span> Exercises</a></li>
  </ul></li>
  <li><a href="#appendix-g-treści-uzupełniające" id="toc-appendix-g-treści-uzupełniające" class="nav-link" data-scroll-target="#appendix-g-treści-uzupełniające"><span class="header-section-number">2.41</span> Appendix G: Treści uzupełniające (*)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wprowadzenie do Nauki o Danych i Statystyki</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="czym-są-statystyka-i-nauka-o-danych-data-science" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="czym-są-statystyka-i-nauka-o-danych-data-science"><span class="header-section-number">2.1</span> Czym są Statystyka i Nauka o Danych (Data Science)?</h2>
<blockquote class="blockquote">
<p><strong>Ważne</strong></p>
<p>Statystyka i nauka o danych to zarówno sztuka, jak i nauka wydobywania wiedzy z danych – pomagają nam zrozumieć świat poprzez metodyczną analizę zebranych informacji.</p>
</blockquote>
<p>Statystyka (statistics) i nauka o danych (data science) dostarczają niezbędnych narzędzi dla badaczy nauk społecznych, niezależnie od specjalizacji. Bez względu na to, czy studiujesz nauki polityczne, ekonomię, socjologię czy inną dziedzinę nauk społecznych, narzędzia te umożliwiają:</p>
<ul>
<li>Analizę trendów i zachowań społecznych</li>
<li>Mierzenie skutków różnych polityk</li>
<li>Formułowanie wniosków w oparciu o dowody empiryczne, a nie intuicję</li>
</ul>
<p>Statystyka dostarcza matematycznych podstaw do analizy danych, w tym projektowania badań, syntezy informacji i testowania hipotez. Nauka o danych rozszerza te możliwości, łącząc statystykę z umiejętnościami programowania i wiedzą dziedzinową, umożliwiając pracę ze złożonymi zbiorami danych.</p>
<p>W dzisiejszej erze cyfrowej, wraz z szybko rosnącą ilością dostępnych danych, kompetencje analityczne stały się niezbędne dla współczesnych badaczy i specjalistów nauk społecznych.</p>
<blockquote class="blockquote">
<p><strong>Uwaga</strong></p>
<p>W naukach społecznych nauka o danych stanowi zestaw metod do rozwiązywania złożonych problemów badawczych – łącząc podejścia statystyczne, narzędzia obliczeniowe i specjalistyczną wiedzę w celu skuteczniejszej analizy procesów społecznych.</p>
</blockquote>
</section>
<section id="związek-między-statystyką-a-nauką-o-danych" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="związek-między-statystyką-a-nauką-o-danych"><span class="header-section-number">2.2</span> Związek między Statystyką a Nauką o Danych</h2>
<p>Zamiast traktować statystykę i naukę o danych jako odrębne dyscypliny, korzystniej jest postrzegać je jako podejścia uzupełniające się w ramach spektrum metod analizy danych. Naukę o danych można rozumieć jako współczesne rozszerzenie tradycyjnej statystyki, które ewoluowało w odpowiedzi na:</p>
<ul>
<li>Nowe możliwości technologiczne</li>
<li>Potrzebę analizy coraz bardziej złożonych danych społecznych</li>
<li>Dostępność narzędzi obliczeniowych do przetwarzania dużych zbiorów danych</li>
</ul>
</section>
<section id="podstawowe-pojęcia-w-nauce-o-danych-i-statystyce" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="podstawowe-pojęcia-w-nauce-o-danych-i-statystyce"><span class="header-section-number">2.3</span> Podstawowe Pojęcia w Nauce o Danych i Statystyce</h2>
<section id="dane-i-populacje" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="dane-i-populacje"><span class="header-section-number">2.3.1</span> Dane i Populacje</h3>
<ol type="1">
<li><strong>Dane</strong>: Informacje zebrane podczas badania – obejmują odpowiedzi z ankiet, wyniki eksperymentów, wskaźniki ekonomiczne, treści z mediów społecznościowych lub wszelkie inne mierzalne obserwacje.</li>
</ol>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Rodzaje i Formaty Zbiorów Danych
</div>
</div>
<div class="callout-body-container callout-body">
<section id="dane-przekrojowe" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="dane-przekrojowe"><span class="header-section-number">2.3.2</span> Dane Przekrojowe</h3>
<p>Obserwacje zebrane w jednym punkcie czasowym dla wielu podmiotów:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Osoba</th>
<th>Wiek</th>
<th>Dochód</th>
<th>Wykształcenie</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>25</td>
<td>5000</td>
<td>Licencjat</td>
</tr>
<tr class="even">
<td>2</td>
<td>35</td>
<td>7500</td>
<td>Magister</td>
</tr>
<tr class="odd">
<td>3</td>
<td>45</td>
<td>9000</td>
<td>Doktorat</td>
</tr>
</tbody>
</table>
</section>
<section id="szeregi-czasowe" class="level3" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="szeregi-czasowe"><span class="header-section-number">2.3.3</span> Szeregi Czasowe</h3>
<p>Obserwacje jednego podmiotu w kolejnych punktach czasowych:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Rok</th>
<th>PKB (w mld)</th>
<th>Stopa Bezrobocia</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2018</td>
<td>20.580</td>
<td>3,9%</td>
</tr>
<tr class="even">
<td>2019</td>
<td>21.433</td>
<td>3,7%</td>
</tr>
<tr class="odd">
<td>2020</td>
<td>20.933</td>
<td>8,1%</td>
</tr>
</tbody>
</table>
</section>
<section id="dane-panelowe-longitudinalne" class="level3" data-number="2.3.4">
<h3 data-number="2.3.4" class="anchored" data-anchor-id="dane-panelowe-longitudinalne"><span class="header-section-number">2.3.4</span> Dane Panelowe (Longitudinalne)</h3>
<p>Obserwacje wielu podmiotów w czasie:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>Rok</th>
<th>PKB per capita</th>
<th>Długość życia</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Polska</td>
<td>2018</td>
<td>32.794</td>
<td>76,7</td>
</tr>
<tr class="even">
<td>Polska</td>
<td>2019</td>
<td>35.118</td>
<td>76,8</td>
</tr>
<tr class="odd">
<td>Niemcy</td>
<td>2018</td>
<td>46.194</td>
<td>81,9</td>
</tr>
<tr class="even">
<td>Niemcy</td>
<td>2019</td>
<td>46.194</td>
<td>82,0</td>
</tr>
</tbody>
</table>
</section>
<section id="dane-przekrojowo-czasowe-tscs" class="level3" data-number="2.3.5">
<h3 data-number="2.3.5" class="anchored" data-anchor-id="dane-przekrojowo-czasowe-tscs"><span class="header-section-number">2.3.5</span> Dane Przekrojowo-Czasowe (TSCS)</h3>
<p>Szczególny przypadek danych panelowych gdzie:</p>
<ul>
<li>Liczba punktów czasowych &gt; liczba podmiotów</li>
<li>Struktura podobna do danych panelowych</li>
<li>Często stosowane w ekonomii i naukach politycznych</li>
</ul>
</section>
<section id="formaty-danych" class="level3" data-number="2.3.6">
<h3 data-number="2.3.6" class="anchored" data-anchor-id="formaty-danych"><span class="header-section-number">2.3.6</span> Formaty Danych</h3>
<section id="format-szeroki" class="level4" data-number="2.3.6.1">
<h4 data-number="2.3.6.1" class="anchored" data-anchor-id="format-szeroki"><span class="header-section-number">2.3.6.1</span> Format Szeroki</h4>
<p>Każdy wiersz to podmiot; kolumny to zmienne/punkty czasowe:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>PKB_2018</th>
<th>PKB_2019</th>
<th>DŻ_2018</th>
<th>DŻ_2019</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Polska</td>
<td>32.794</td>
<td>35.118</td>
<td>76,7</td>
<td>76,8</td>
</tr>
<tr class="even">
<td>Niemcy</td>
<td>46.194</td>
<td>46.194</td>
<td>81,9</td>
<td>82,0</td>
</tr>
</tbody>
</table>
</section>
<section id="format-długi" class="level4" data-number="2.3.6.2">
<h4 data-number="2.3.6.2" class="anchored" data-anchor-id="format-długi"><span class="header-section-number">2.3.6.2</span> Format Długi</h4>
<p>Każdy wiersz to unikalna kombinacja podmiot-czas-zmienna:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>Rok</th>
<th>Zmienna</th>
<th>Wartość</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Polska</td>
<td>2018</td>
<td>PKB per capita</td>
<td>32.794</td>
</tr>
<tr class="even">
<td>Polska</td>
<td>2019</td>
<td>PKB per capita</td>
<td>35.118</td>
</tr>
<tr class="odd">
<td>Polska</td>
<td>2018</td>
<td>Długość życia</td>
<td>76,7</td>
</tr>
<tr class="even">
<td>Polska</td>
<td>2019</td>
<td>Długość życia</td>
<td>76,8</td>
</tr>
<tr class="odd">
<td>Niemcy</td>
<td>2018</td>
<td>PKB per capita</td>
<td>46.194</td>
</tr>
<tr class="even">
<td>Niemcy</td>
<td>2019</td>
<td>PKB per capita</td>
<td>46.194</td>
</tr>
<tr class="odd">
<td>Niemcy</td>
<td>2018</td>
<td>Długość życia</td>
<td>81,9</td>
</tr>
<tr class="even">
<td>Niemcy</td>
<td>2019</td>
<td>Długość życia</td>
<td>82,0</td>
</tr>
</tbody>
</table>
<p><strong>Uwaga:</strong> Format długi jest zazwyczaj preferowany do:</p>
<ul>
<li>Manipulacji danymi w R i Pythonie</li>
<li>Analiz statystycznych</li>
<li>Wizualizacji danych</li>
<li>Modelowania efektów mieszanych</li>
<li>Analiz powtarzanych pomiarów</li>
</ul>
</section>
</section>
</div>
</div>
<ol start="2" type="1">
<li><p><strong>Populacja</strong>: Pełny zbiór jednostek (osób, instytucji, zdarzeń), których dotyczy badanie – cała grupa, na temat której badacz chce wyciągnąć wnioski.</p>
<ul>
<li><em>Przykład</em>: W badaniu preferencji wyborczych populację stanowią wszyscy obywatele uprawnieni do głosowania w danym kraju.</li>
</ul></li>
<li><p><strong>Próba</strong>: Podzbiór populacji wybrany do badania. <strong>Reprezentatywna</strong> próba odzwierciedla kluczowe cechy populacji docelowej we właściwych proporcjach.</p>
<ul>
<li><em>Przykład</em>: Zamiast badać wszystkich uprawnionych do głosowania, badacze mogą analizować 1500 losowo wybranych osób, uwzględniając odpowiedni rozkład wieku, płci, wykształcenia i regionu zamieszkania.</li>
</ul>
<p>Właściwie dobrana próba umożliwia wnioskowanie o całej populacji przy jednoczesnym znacznym zmniejszeniu kosztów i czasu badań.</p></li>
<li><p><strong>Dobór próby</strong>: Procedura wybierania jednostek z populacji do badania. Nieobciążona metoda doboru próby daje każdej jednostce w populacji równą szansę wyboru, zapewniając reprezentatywne wyniki.</p></li>
</ol>
<p>Wybrane schematy losowego doboru próby:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Prosty Dobór Losowy</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Dobór warstwowy</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Dobór grupowy (klastrowy)</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p><strong>Prosty Dobór Losowy</strong>: Każda jednostka ma równe prawdopodobieństwo wyboru. Cała populacja jest losowo próbkowana bez żadnego z góry ustalonego wzorca.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/Simple_Random_Sampling2.svg" class="img-fluid figure-img"></p>
<figcaption>Prosty Dobór Losowy. Źródło: https://app.passyourmath.com/courses/theory/116/1750/26640/en</figcaption>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p><strong>Dobór Warstwowy</strong>: Populacja jest podzielona na odrębne podgrupy (warstwy) przed losowym pobraniem próbek z każdej warstwy proporcjonalnie.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/Stratified2.svg" class="img-fluid figure-img"></p>
<figcaption>Dobór Warstwowy. Źródło: https://app.passyourmath.com/courses/theory/116/1750/26640/en</figcaption>
</figure>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p><strong>Dobór Grupowy</strong>: Populacja jest podzielona na skupiska (klastry), a całe skupiska są losowo wybierane do analizy zamiast pojedynczych jednostek.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/Cluster2.svg" class="img-fluid figure-img"></p>
<figcaption>Dobór Grupowy. Źródło: https://app.passyourmath.com/courses/theory/116/1750/26640/en</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ol start="5" type="1">
<li><p><strong>Wnioskowanie statystyczne</strong>: Proces wyciągania wniosków o populacji na podstawie danych z próby. Obejmuje:</p>
<ul>
<li>Obliczanie oszacowań parametrów populacji</li>
<li>Ocenę wiarygodności tych oszacowań</li>
<li>Testowanie hipotez dotyczących cech populacji</li>
</ul></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/population_vs_sample.png" class="img-fluid figure-img"></p>
<figcaption>Proces wykorzystania próby do oszacowania parametru populacji. W tym przykładzie, w próbie 10 osób stwierdzono, że 6 posiada iPhone’a, co daje szacowaną proporcję w populacji na poziomie 60%. Rzeczywista proporcja w populacji wynosi 53,8%.</figcaption>
</figure>
</div>
</section>
<section id="wnioskowanie-statystyczne-jak-mała-próba-może-reprezentować-dużą-populację" class="level3" data-number="2.3.7">
<h3 data-number="2.3.7" class="anchored"><span class="header-section-number">2.3.7</span> Wnioskowanie Statystyczne: Jak Mała Próba Może Reprezentować Dużą Populację?</h3>
<p>Kiedy ankieterzy badają tylko 1000 wyborców, aby przewidzieć wynik wyborów z 30 000 000 uprawnionych do głosowania (zaledwie 0,003% populacji), może się to wydawać zagadkowe. Jak tak niewielki ułamek może powiedzieć nam coś o całości?</p>
<p>To podobne do próbowania zupy. Gdy gotujesz duży garnek zupy i dokładnie ją mieszasz, nie musisz zjeść całego garnka, aby wiedzieć, jak smakuje. Wystarczy jedna łyżka – o ile zupa jest dobrze wymieszana.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Analogia Zupy
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="stat_imgs/soup-svgrepo-com.svg" class="img-fluid" style="width:30.0%"></p>
<ul>
<li><strong>Analiza Eksploracyjna</strong>: Gdy próbujesz łyżkę zupy, aby ocenić jej smak, to jest analiza eksploracyjna/opisowa.</li>
<li><strong>Wnioskowanie Statystyczne</strong>: Jeśli na podstawie tej łyżki wnioskujesz, że cały garnek potrzebuje soli, to jest wnioskowanie.</li>
<li><strong>Próba vs.&nbsp;Populacja</strong>: Twoja łyżka to próba; cały garnek to populacja.</li>
<li><strong>Reprezentatywne Próbkowanie</strong>: Aby Twoje wnioskowanie było trafne, łyżka, którą spróbowałeś, musi być reprezentatywna dla całego garnka.</li>
<li><strong>Dobrze Wymieszana Zupa</strong>: Zakładamy, że zupa jest dobrze wymieszana. Oznacza to, że każda łyżka powinna smakować podobnie do każdej innej łyżki, co pozwala na wiarygodne wnioskowanie o całym garnku na podstawie jednej próby.</li>
</ul>
<section id="ważne" class="level3" data-number="2.3.8">
<h3 data-number="2.3.8" class="anchored" data-anchor-id="ważne"><span class="header-section-number">2.3.8</span> Ważne!</h3>
<ul>
<li><strong>Wielkość Próby</strong>: Użycie większej łyżki (większa próba) zazwyczaj daje większą pewność co do smaku całego garnka, nawet w dobrze wymieszanej zupie.</li>
<li><strong>Zmienność</strong>: Pomimo dobrego wymieszania, żadne dwie łyżki nie będą dokładnie identyczne - zawsze istnieje pewna naturalna zmienność w rozkładzie składników.</li>
</ul>
</section>
</div>
</div>
<section id="dlaczego-losowy-dobór-próby-działa" class="level4" data-number="2.3.8.1">
<h4 data-number="2.3.8.1" class="anchored"><span class="header-section-number">2.3.8.1</span> Dlaczego Losowy Dobór Próby Działa</h4>
<p>Losowy dobór próby działa dzięki trzem kluczowym zasadom:</p>
<ol type="1">
<li><p><strong>Równe szanse</strong>: Każda osoba w populacji ma taką samą szansę na wybór, co zapobiega systematycznemu błędowi.</p></li>
<li><p><strong>Reprezentatywna różnorodność</strong>: Gdy każdy ma równą szansę, naturalnie otrzymujesz osoby ze wszystkich różnych grup w mniej więcej takich samych proporcjach, w jakich występują w populacji.</p>
<p><em>Przykład</em>: Jeśli 51% wyborców to kobiety, to około 51% twojej losowej próby prawdopodobnie będą stanowić kobiety (plus minus pewne losowe wahania).</p></li>
<li><p><strong>Prawo wielkich liczb</strong>: Wraz ze wzrostem wielkości próby (n), losowe wahania stają się mniej istotne, a statystyki próby zbliżają się do prawdziwych wartości populacji.</p>
<p><em>Przykład</em>: Jeśli rzucisz monetą 10 razy, możesz otrzymać 7 orłów (70%). Ale jeśli rzucisz nią 1000 razy, jest znacznie bardziej prawdopodobne, że otrzymasz około 500 orłów (50%).</p></li>
</ol>
<p>Bez właściwego losowego doboru próby można łatwo uzyskać próbę obciążoną. Na przykład, gdybyś przeprowadzał ankiety tylko wśród osób w centrum handlowym w dni powszednie rano, pominąłbyś większość pracujących osób i studentów, co dałoby zniekształcony obraz populacji.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Losowość: Fundamentalne Prawo Natury
</div>
</div>
<div class="callout-body-container callout-body">
<section id="istota-losowości" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="istota-losowości"><span class="header-section-number">2.4</span> Istota Losowości</h2>
<p>Losowość stanowi nieodłączną właściwość rzeczywistości, a nie jedynie odzwierciedlenie ograniczeń naszej wiedzy. Przejawia się ona jako nieprzewidywalne wzorce i procesy probabilistyczne (procesy stochastyczne), które przenikają zjawiska naturalne na wielu poziomach.</p>
</section>
<section id="przejawy-losowości-w-systemach-naturalnych" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="przejawy-losowości-w-systemach-naturalnych"><span class="header-section-number">2.5</span> Przejawy Losowości w Systemach Naturalnych</h2>
<section id="mechanika-kwantowa-probabilistyczne-podstawy-rzeczywistości-fizycznej" class="level3" data-number="2.5.1">
<h3 data-number="2.5.1" class="anchored" data-anchor-id="mechanika-kwantowa-probabilistyczne-podstawy-rzeczywistości-fizycznej"><span class="header-section-number">2.5.1</span> <strong>Mechanika Kwantowa:</strong> Probabilistyczne Podstawy Rzeczywistości Fizycznej</h3>
<p>Na poziomie subatomowym deterministyczne ramy ustępują miejsca probabilistycznym:</p>
<ul>
<li><p><strong>Zasada Nieoznaczoności Heisenberga:</strong> Zasada ta ustanawia niemożność jednoczesnego określenia sparowanych właściwości fizycznych (takich jak położenie i pęd) z dowolną precyzją. Nieoznaczoność ta nie wynika z ograniczeń pomiarowych, lecz jest fundamentalną właściwością samych systemów kwantowych.</p>
<p><em>Przykład:</em> Położenie elektronów w atomach podlega rozkładom prawdopodobieństwa, a nie zdefiniowanym orbitom. Ta kwantowa losowość umożliwia fuzję jądrową w gwiazdach—bez niej elektrony wpadałyby do jąder atomowych, a gwiazdy nie mogłyby istnieć.</p></li>
<li><p><strong>Kolaps Funkcji Falowej:</strong> Obiekty kwantowe istnieją jednocześnie w wielu potencjalnych stanach (superpozycja). Podczas pomiaru te potencjalności rozstrzygają się w jeden określony stan, zgodnie z regułami prawdopodobieństwa, a nie mechanizmami przyczynowymi.</p>
<p><em>Przykład:</em> W eksperymencie z podwójną szczeliną pojedyncze cząstki przechodzą jednocześnie przez dwie szczeliny (jak fale), ale lądują jako dyskretne punkty na detektorze, przy czym ich konkretne miejsca lądowania są fundamentalnie nieprzewidywalne.</p></li>
</ul>
</section>
<section id="zmienność-genetyczna-i-procesy-ewolucyjne" class="level3" data-number="2.5.2">
<h3 data-number="2.5.2" class="anchored" data-anchor-id="zmienność-genetyczna-i-procesy-ewolucyjne"><span class="header-section-number">2.5.2</span> <strong>Zmienność Genetyczna i Procesy Ewolucyjne</strong></h3>
<p>Losowe zmiany w informacji genetycznej stanowią materiał dla doboru naturalnego:</p>
<ul>
<li><p><strong>Spontaniczne Mutacje:</strong> Przypadkowe zmiany w sekwencjach DNA wynikają z niestabilności molekularnych i fluktuacji termodynamicznych. Te nieprzewidywalne zmiany generują nowe cechy, które mogą wpływać na przeżycie i reprodukcję organizmu.</p>
<p><em>Przykład:</em> Przypadkowa mutacja w DNA bakterii może nadać oporność na antybiotyki. To losowe zdarzenie, a nie ukierunkowana odpowiedź na antybiotyk, umożliwia przetrwanie, gdy populacja napotyka lek.</p></li>
<li><p><strong>Rekombinacja Genetyczna:</strong> Wymiana materiału genetycznego podczas formowania komórek rozrodczych wprowadza losowe kombinacje genetyczne, tworząc różnorodność.</p>
<p><em>Przykład:</em> Rodzeństwo dzieli około 50% swoich zmiennych genów, jednak konkretna kombinacja, którą każde z nich otrzymuje, jest określana losowo podczas mejozy, co wyjaśnia znaczne różnice między rodzeństwem.</p></li>
</ul>
</section>
<section id="teoria-chaosu-deterministyczne-systemy-z-nieprzewidywalnym-zachowaniem" class="level3" data-number="2.5.3">
<h3 data-number="2.5.3" class="anchored" data-anchor-id="teoria-chaosu-deterministyczne-systemy-z-nieprzewidywalnym-zachowaniem"><span class="header-section-number">2.5.3</span> <strong>Teoria Chaosu:</strong> Deterministyczne Systemy z Nieprzewidywalnym Zachowaniem</h3>
<p>Systemy rządzone przez stałe reguły matematyczne mogą mimo to wykazywać pozorną losowość:</p>
<ul>
<li><p><strong>Wrażliwość na Warunki Początkowe:</strong> Minimalne zmiany w stanach początkowych narastają wykładniczo w czasie, czyniąc długoterminowe przewidywania funkcjonalnie niemożliwymi, mimo że system podąża za deterministycznymi prawami.</p>
<p><em>Przykład:</em> Systemy pogodowe podlegają jasnym prawom fizycznym, jednak 10-dniowa prognoza pozostaje wyzwaniem, ponieważ 0,1% błędu pomiarowego dzisiaj może skutkować przewidywaniem słońca zamiast burzy w przyszłym tygodniu.</p></li>
<li><p><strong>Złożoność Emergentna:</strong> Proste reguły iteracyjne mogą generować wzorce, których złożoność wymaga opisów statystycznych, mimo ich deterministycznego pochodzenia.</p>
<p><em>Przykład:</em> Zbiór Mandelbrota—elegancki wzór matematyczny—wywodzi się z prostego równania (<span class="math inline">z_{n+1} = z_n^2 + c</span>), a jednak tworzy nieskończenie złożone struktury, które wydają się losowe na różnych skalach.</p></li>
</ul>
</section>
<section id="podejścia-statystyczne-w-badaniach-naukowych" class="level3" data-number="2.5.4">
<h3 data-number="2.5.4" class="anchored" data-anchor-id="podejścia-statystyczne-w-badaniach-naukowych"><span class="header-section-number">2.5.4</span> <strong>Podejścia Statystyczne w Badaniach Naukowych</strong></h3>
<p>Naukowcy wykorzystują losowość do ustanowienia solidnych ram empirycznych:</p>
<ul>
<li><p><strong>Probabilistyczne Metody Próbkowania:</strong> Procedury losowego wyboru łagodzą systematyczne błędy i umożliwiają prawidłowe wnioskowanie o całych populacjach na podstawie reprezentatywnych podzbiorów.</p>
<p><em>Przykład:</em> Ankieterzy polityczni badający 1500 losowo wybranych wyborców mogą przewidzieć wyniki wyborów dla milionów z dokładnością około ±3%—wyczyn niemożliwy przy nielosowym próbkowaniu.</p></li>
<li><p><strong>Randomizowane Projekty Eksperymentalne:</strong> Losowy przydział jednostek eksperymentalnych do różnych warunków kontroluje zmienne zakłócające, w tym te nieprzewidziane przez badaczy.</p>
<p><em>Przykład:</em> W badaniach farmaceutycznych pacjenci otrzymują lek lub placebo poprzez randomizację, co zapewnia, że czynniki takie jak wiek, dieta czy predyspozycje genetyczne rozkładają się równomiernie między grupami.</p></li>
</ul>
</section>
</section>
<section id="metodologiczne-zastosowania-losowości" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="metodologiczne-zastosowania-losowości"><span class="header-section-number">2.6</span> Metodologiczne Zastosowania Losowości</h2>
<section id="randomizacja-w-projektowaniu-eksperymentalnym" class="level3" data-number="2.6.1">
<h3 data-number="2.6.1" class="anchored" data-anchor-id="randomizacja-w-projektowaniu-eksperymentalnym"><span class="header-section-number">2.6.1</span> Randomizacja w Projektowaniu Eksperymentalnym</h3>
<p>Losowy przydział podmiotów do warunków eksperymentalnych pełni wiele ważnych funkcji:</p>
<p>✅ <strong>Łagodzi błędy selekcji:</strong> Zapobiega systematycznym zniekształceniom w sposobie przydzielania podmiotów do różnych warunków.</p>
<p>✅ <strong>Kontroluje zmienne zakłócające:</strong> Rozkłada zarówno znane, jak i nieznane czynniki wpływające równomiernie między grupami eksperymentalnymi.</p>
<p>✅ <strong>Waliduje wnioskowanie statystyczne:</strong> Ustanawia podstawę do obliczeń prawdopodobieństwa przy testowaniu hipotez.</p>
<p><em>Przykład:</em> Badacz testujący metody edukacyjne losowo przydziela uczniów do różnych podejść instruktażowych. Ta randomizacja zapewnia, że cechy takie jak inteligencja, wcześniejsza wiedza i motywacja są rozłożone podobnie między grupami, izolując efekt samej metody nauczania.</p>
</section>
<section id="probabilistyczne-ramy-próbkowania" class="level3" data-number="2.6.2">
<h3 data-number="2.6.2" class="anchored" data-anchor-id="probabilistyczne-ramy-próbkowania"><span class="header-section-number">2.6.2</span> Probabilistyczne Ramy Próbkowania</h3>
<p>Losowe procesy wyboru w próbkowaniu zapewniają reprezentatywność i ważność statystyczną:</p>
<p>✅ <strong>Równe prawdopodobieństwo wyboru:</strong> Każdy członek populacji ma tę samą szansę na włączenie do próby.</p>
<p>✅ <strong>Uogólnialność statystyczna:</strong> Pozwala na kwantyfikację błędu próbkowania i pewności wyników.</p>
<p>✅ <strong>Nieobciążona estymacja:</strong> Tworzy pomiary, których średnie wartości zbiegają do prawdziwych wartości populacji, gdy są powtarzane.</p>
<p><em>Przykład:</em> Inżynierowie kontroli jakości losowo próbkują 50 jednostek z linii produkcyjnej liczącej 10 000 komponentów. Takie podejście zapewnia dokładne oszacowanie wskaźników defektów przy inspekcji tylko 0,5% całkowitej produkcji.</p>
</section>
</section>
<section id="implikacje-filozoficzne" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="implikacje-filozoficzne"><span class="header-section-number">2.7</span> Implikacje Filozoficzne</h2>
<p>Uznanie nieodłącznej losowości wymaga przejścia od całkowicie deterministycznego światopoglądu (gdzie wszystkie wydarzenia wynikają koniecznie z wcześniejszych przyczyn) do probabilistycznego zrozumienia rzeczywistości. Ta transformacja wykracza poza metodologię naukową do fundamentalnych pytań o przyczynowość, przewidywanie i wiedzę:</p>
<ul>
<li><p><strong>Fundamentalny Indeterminizm:</strong> Rzeczywistość fizyczna zawiera autentyczną nieprzewidywalność, a nie tylko pozorną losowość wynikającą z niepełnej informacji.</p></li>
<li><p><strong>Wiedza Probabilistyczna:</strong> Absolutna pewność ustępuje miejsca stopniom pewności i obliczeniom prawdopodobieństwa jako najwyższej osiągalnej formie wiedzy w fundamentalnych dziedzinach.</p></li>
<li><p><strong>Modele Probabilistyczne:</strong> Ramy matematyczne uwzględniające losowość często wykazują lepszą moc predykcyjną i użyteczność koncepcyjną w porównaniu z czysto deterministycznymi alternatywami.</p></li>
</ul>
<p><em>Przykład:</em> Nowoczesne podejścia obliczeniowe do zwijania białek integrują zarówno algorytmy oparte na fizyce, jak i metody próbkowania stochastycznego. To hybrydowe podejście—uznające zarówno deterministyczne siły, jak i nieodłączną losowość—przyniosło przełomy niemożliwe przy użyciu czysto deterministycznych modeli.</p>
<p>Ta zmiana paradygmatu umożliwia bardziej wyrafinowane podejścia do złożoności, zmienności i niepewności, wzbogacając zarówno zrozumienie teoretyczne, jak i praktyczne zastosowania w dyscyplinach naukowych.</p>
</section>
</div>
</div>
</section>
</section>
</section>
<section id="podstawowe-pojęcia-estymacji-statystycznej" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="podstawowe-pojęcia-estymacji-statystycznej"><span class="header-section-number">2.8</span> Podstawowe Pojęcia Estymacji Statystycznej</h2>
<section id="parametry-populacji-vs.-statystyki-próby" class="level3" data-number="2.8.1">
<h3 data-number="2.8.1" class="anchored" data-anchor-id="parametry-populacji-vs.-statystyki-próby"><span class="header-section-number">2.8.1</span> Parametry populacji vs.&nbsp;Statystyki próby</h3>
<p>W statystyce często chcemy poznać pewne wartości opisujące całą <strong>populację</strong>, ale zwykle nie możemy zbadać wszystkich jej elementów. Zamiast tego pobieramy <strong>próbę</strong> i obliczamy z niej wartości, które pomagają nam oszacować <strong>parametry populacyjne</strong>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Kluczowa różnica:</strong><br>
- <strong>Parametr populacji</strong> (oznaczany jako <span class="math inline">\theta</span>) to stała, ale <strong>nieznana</strong> wartość opisująca całą populację.<br>
- <strong>Statystyka próby</strong> (oznaczana jako <span class="math inline">\hat{\theta}</span> podczas estymacji) to wartość obliczona na podstawie próby, używana do oszacowania parametru populacyjnego.</p>
</div>
</div>
<section id="przykłady-parametrów-populacyjnych-i-statystyk-próby" class="level4" data-number="2.8.1.1">
<h4 data-number="2.8.1.1" class="anchored" data-anchor-id="przykłady-parametrów-populacyjnych-i-statystyk-próby"><span class="header-section-number">2.8.1.1</span> Przykłady parametrów populacyjnych i statystyk próby</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 37%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Koncepcja</strong></th>
<th><strong>Parametr populacji (Nieznany, stały)</strong></th>
<th><strong>Statystyka próby (Obliczona z próby)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Średnia (średnia arytmetyczna)</td>
<td><span class="math inline">\theta = \mu</span> (prawdziwa średnia populacji)</td>
<td><span class="math inline">\hat{\theta} = \bar{x}</span> (średnia z próby)</td>
</tr>
<tr class="even">
<td>Wariancja</td>
<td><span class="math inline">\theta = \sigma^2</span> (prawdziwa wariancja populacji)</td>
<td><span class="math inline">\hat{\theta} = s^2</span> (wariancja z próby)</td>
</tr>
<tr class="odd">
<td>Proporcja</td>
<td><span class="math inline">\theta = p</span> (prawdziwa proporcja)</td>
<td><span class="math inline">\hat{\theta} = \hat{p}</span> (proporcja w próbie)</td>
</tr>
</tbody>
</table>
<p>Ponieważ <strong>nie możemy bezpośrednio zaobserwować</strong> wartości <span class="math inline">\theta</span>, używamy <strong>statystyki próby</strong> (np. <span class="math inline">\hat{\theta}</span>) do jej oszacowania.</p>
<hr>
</section>
</section>
<section id="czym-jest-estymand" class="level3" data-number="2.8.2">
<h3 data-number="2.8.2" class="anchored" data-anchor-id="czym-jest-estymand"><span class="header-section-number">2.8.2</span> Czym jest Estymand?</h3>
<p><strong>Estymand</strong> to konkretny parametr populacyjny <span class="math inline">\theta</span>, który chcemy oszacować. Reprezentuje nieznaną wartość w populacji, którą próbujemy określić.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Przykład:</strong><br>
- Jeśli chcemy poznać <strong>średni wzrost dorosłych w Polsce</strong>, to prawdziwa średnia <strong>(</strong><span class="math inline">\theta = \mu</span>) jest <strong>estymandem</strong>.<br>
- Jeśli chcemy oszacować <strong>proporcję wyborców popierających kandydata</strong>, to prawdziwa proporcja <strong>(</strong><span class="math inline">\theta = p</span>) jest <strong>estymandem</strong>.</p>
</div>
</div>
<hr>
</section>
<section id="czym-jest-estymator" class="level3" data-number="2.8.3">
<h3 data-number="2.8.3" class="anchored" data-anchor-id="czym-jest-estymator"><span class="header-section-number">2.8.3</span> Czym jest Estymator?</h3>
<p><strong>Estymator</strong> to <strong>reguła, wzór lub funkcja</strong>, którą stosujemy do próby, aby oszacować parametr populacyjny <span class="math inline">\theta</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Kluczowa idea:</strong><br>
- <strong>Estymator to procedura, a nie konkretna liczba!</strong><br>
- Ponieważ różne próby dają różne wyniki, estymator jest <strong>zmienną losową</strong>, czyli jego wartość zależy od wybranej próby.</p>
</div>
</div>
<section id="notacja" class="level4" data-number="2.8.3.1">
<h4 data-number="2.8.3.1" class="anchored" data-anchor-id="notacja"><span class="header-section-number">2.8.3.1</span> Notacja</h4>
<ul>
<li><span class="math inline">\theta</span> = Prawdziwy parametr populacji (nieznany)<br>
</li>
<li><span class="math inline">\hat{\theta}</span> = Estymator (funkcja danych z próby)</li>
</ul>
</section>
<section id="przykłady-estymatorów" class="level4" data-number="2.8.3.2">
<h4 data-number="2.8.3.2" class="anchored" data-anchor-id="przykłady-estymatorów"><span class="header-section-number">2.8.3.2</span> Przykłady estymatorów</h4>
<ul>
<li><p><strong>Średnia z próby (estymator</strong> <span class="math inline">\mu</span>):<br>
<span class="math display">
\hat{\theta} = \bar{x} = \frac{1}{n} \sum_{i=1}^{n} x_i
</span></p></li>
<li><p><strong>Wariancja z próby (estymator</strong> <span class="math inline">\sigma^2</span>):<br>
<span class="math display">
\hat{\theta} = s^2 = \frac{1}{n-1} \sum_{i=1}^{n} (x_i - \bar{x})^2
</span></p></li>
<li><p><strong>Proporcja z próby (estymator</strong> <span class="math inline">p</span>):<br>
<span class="math display">
\hat{\theta} = \hat{p} = \frac{x}{n}
</span></p></li>
</ul>
<hr>
</section>
</section>
<section id="czym-jest-estymata" class="level3" data-number="2.8.4">
<h3 data-number="2.8.4" class="anchored" data-anchor-id="czym-jest-estymata"><span class="header-section-number">2.8.4</span> Czym jest Estymata?</h3>
<p><strong>Estymata</strong> to konkretna wartość liczbowa, którą uzyskujemy po zastosowaniu estymatora <span class="math inline">\hat{\theta}</span> do próby.</p>
<section id="przykład-oszacowanie-średniego-wzrostu-dorosłych" class="level4" data-number="2.8.4.1">
<h4 data-number="2.8.4.1" class="anchored" data-anchor-id="przykład-oszacowanie-średniego-wzrostu-dorosłych"><span class="header-section-number">2.8.4.1</span> Przykład: Oszacowanie średniego wzrostu dorosłych</h4>
<ul>
<li><strong>Estymand</strong>: Prawdziwa średnia wzrostu <strong>(</strong><span class="math inline">\theta = \mu</span>) (nieznana).<br>
</li>
<li><strong>Estymator</strong>: Wzór na średnią z próby <span class="math inline">\hat{\theta} = \bar{x} = \frac{1}{n} \sum x_i</span>.<br>
</li>
<li><strong>Estymata</strong>: Konkretna wartość, np. <strong>173,5 cm</strong>, uzyskana na podstawie jednej próby.</li>
</ul>
<hr>
</section>
</section>
<section id="co-czyni-estymator-dobrym" class="level3" data-number="2.8.5">
<h3 data-number="2.8.5" class="anchored" data-anchor-id="co-czyni-estymator-dobrym"><span class="header-section-number">2.8.5</span> Co Czyni Estymator Dobrym?</h3>
<p>Gdy używamy danych do oszacowania jakiejś wartości (np. średniego wzrostu uczniów w szkole), chcemy, aby nasze oszacowanie było jak <strong>najdokładniejsze i najbardziej wiarygodne</strong>. Dobry <strong>estymator</strong> powinien spełniać cztery kluczowe cechy:</p>
<section id="nieobciążoność-brak-systematycznego-błędu" class="level4" data-number="2.8.5.1">
<h4 data-number="2.8.5.1" class="anchored" data-anchor-id="nieobciążoność-brak-systematycznego-błędu"><span class="header-section-number">2.8.5.1</span> 1️⃣ Nieobciążoność: Brak Systematycznego Błędu</h4>
<p>Dobry estymator powinien średnio dawać <strong>poprawny wynik</strong>! Oznacza to, że jeśli wielokrotnie pobierzemy próbki i obliczymy oszacowania, <strong>średnia wszystkich oszacowań</strong> powinna być równa rzeczywistej wartości, którą próbujemy oszacować (<span class="math inline">\theta</span>).</p>
<p>Matematycznie:<br>
<span class="math display">
E(\hat{\theta}) = \theta
</span><br>
Tutaj <span class="math inline">E(\hat{\theta})</span> (tzw. <strong>operator wartości oczekiwanej</strong>) oznacza <strong>średnią wartość estymatora</strong> <span class="math inline">\hat{\theta}</span> w wielu próbkach. Mówiąc prościej, jeśli powtarzalibyśmy badanie wiele razy, średnia naszych oszacowań powinna być równa prawdziwej wartości <span class="math inline">\theta</span>. To zapewnia, że estymator <strong>nie ma systematycznej tendencji do zawyżania lub zaniżania</strong> wyników.</p>
</section>
<section id="efektywność-jak-najmniejsza-zmienność" class="level4" data-number="2.8.5.2">
<h4 data-number="2.8.5.2" class="anchored" data-anchor-id="efektywność-jak-najmniejsza-zmienność"><span class="header-section-number">2.8.5.2</span> 2️⃣ Efektywność: Jak Najmniejsza Zmienność</h4>
<p>Nawet jeśli estymator jest nieobciążony, jego wyniki mogą być <strong>rozproszone</strong>. <strong>Dobry</strong> estymator powinien dawać <strong>możliwie najmniejszą wariancję</strong>, czyli wyniki blisko siebie, a nie zbyt rozrzucone. Im mniej “skacze” wokół prawdziwej wartości, tym jest bardziej <strong>wiarygodny</strong>.</p>
</section>
<section id="zbieżność-więcej-danych-większa-dokładność" class="level4" data-number="2.8.5.3">
<h4 data-number="2.8.5.3" class="anchored" data-anchor-id="zbieżność-więcej-danych-większa-dokładność"><span class="header-section-number">2.8.5.3</span> 3️⃣ Zbieżność: Więcej Danych = Większa Dokładność</h4>
<p><strong>Zbieżny estymator</strong> poprawia się w miarę zwiększania liczby obserwacji. Gdy mamy małą próbkę, oszacowanie może być niedokładne, ale jeśli zbierzemy <strong>więcej danych</strong>, nasz estymator powinien coraz bardziej <strong>zbliżać się do prawdziwej wartości</strong> <span class="math inline">\theta</span>.</p>
</section>
<section id="dostateczność-wykorzystuje-całą-informację-z-próby" class="level4" data-number="2.8.5.4">
<h4 data-number="2.8.5.4" class="anchored" data-anchor-id="dostateczność-wykorzystuje-całą-informację-z-próby"><span class="header-section-number">2.8.5.4</span> 4️⃣ Dostateczność: Wykorzystuje Całą Informację z Próby</h4>
<p><strong>Dostateczny estymator</strong> maksymalnie wykorzystuje dostępne dane. Nie <strong>marnuje informacji</strong>, ani nie pomija niczego istotnego. Jeśli mamy pełny zestaw danych, dostateczny estymator zapewnia, że uzyskujemy <strong>wszystkie możliwe informacje</strong> o <span class="math inline">\theta</span> z naszej próbki.</p>
<hr>
</section>
</section>
<section id="dlaczego-szacowania-się-różnią-rozkład-próbkowania" class="level3" data-number="2.8.6">
<h3 data-number="2.8.6" class="anchored"><span class="header-section-number">2.8.6</span> Dlaczego Szacowania Się Różnią? (Rozkład Próbkowania)</h3>
<p>Jeśli pobierzemy różne próbki z populacji, dostaniemy <strong>różne oszacowania</strong>. Aby zrozumieć te różnice, analizujemy <strong>rozkład próbkowania</strong>—czyli rozkład wartości estymatora w różnych próbkach.</p>
<section id="kluczowe-fakty-o-rozkładach-próbkowania" class="level4" data-number="2.8.6.1">
<h4 data-number="2.8.6.1" class="anchored" data-anchor-id="kluczowe-fakty-o-rozkładach-próbkowania"><span class="header-section-number">2.8.6.1</span> Kluczowe Fakty o Rozkładach Próbkowania</h4>
<ol type="1">
<li><strong>Każda próbka daje inne oszacowanie</strong> – Dwie osoby, które przeprowadzą niezależne badania, mogą uzyskać różne wyniki.<br>
</li>
<li><strong>Różnice te nie są przypadkowe</strong> – <strong>Rozkład próbkowania</strong> opisuje, jak te oszacowania są rozłożone.<br>
</li>
<li><strong>Większa próba oznacza mniejszą zmienność</strong> – Im więcej danych, tym dokładniejsze oszacowanie.<br>
</li>
<li><strong>Rozkład próbkowania pozwala mierzyć niepewność</strong> – Dzięki niemu możemy wyznaczać przedziały ufności i przeprowadzać testy statystyczne.</li>
</ol>
</section>
<section id="przykład-średnia-próby" class="level4" data-number="2.8.6.2">
<h4 data-number="2.8.6.2" class="anchored"><span class="header-section-number">2.8.6.2</span> Przykład: Średnia Próby</h4>
<p>Załóżmy, że wielokrotnie losujemy próbki z populacji i za każdym razem obliczamy średnią. Otrzymane wartości utworzą <strong>rozkład próbkowania średniej</strong>, którego centrum będzie się znajdować w pobliżu prawdziwej wartości <span class="math inline">\mu</span>.</p>
<p>Matematycznie, średnia z próby to:<br>
<span class="math display">
\hat{\theta} = \bar{x} = \frac{1}{n} \sum_{i=1}^{n} x_i
</span><br>
gdzie <span class="math inline">x_1, x_2, ..., x_n</span> to wartości w naszej próbie.</p>
<p>Oznacza to, że jeśli wielokrotnie pobieramy próbki, <strong>średnia wszystkich średnich próbkowych</strong> powinna być bliska rzeczywistej średniej <span class="math inline">\mu</span> populacji.</p>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Rozkład Normalny - Fundament Teorii Prawdopodobieństwa
</div>
</div>
<div class="callout-body-container callout-body">
<section id="rozkłady-prawdopodobieństwa" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="rozkłady-prawdopodobieństwa"><span class="header-section-number">2.9</span> Rozkłady Prawdopodobieństwa</h2>
<p>Rozkład prawdopodobieństwa to funkcja matematyczna przypisująca prawdopodobieństwa wszystkim możliwym wynikom zmiennej losowej. Wyróżniamy:</p>
<ul>
<li><strong>Rozkłady dyskretne</strong>: Dla policzalnych wyników (np. dwumianowy, Poissona)</li>
<li><strong>Rozkłady ciągłe</strong>: Dla przedziałów wartości (np. normalny, wykładniczy)</li>
</ul>
</section>
<section id="rozkład-normalny-kluczowe-właściwości" class="level2" data-number="2.10">
<h2 data-number="2.10" class="anchored" data-anchor-id="rozkład-normalny-kluczowe-właściwości"><span class="header-section-number">2.10</span> Rozkład Normalny: Kluczowe Właściwości</h2>
<p>Rozkład normalny (Gaussa) charakteryzuje się doskonałą symetrią i jest opisany funkcją:</p>
<p><span class="math display">f(x) = \frac{1}{\sigma\sqrt{2\pi}}e^{-\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^2}</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">\mu</span> (mi): Średnia, określająca centralne położenie</li>
<li><span class="math inline">\sigma</span> (sigma): Odchylenie standardowe, określające rozproszenie</li>
</ul>
<p>Główne cechy:</p>
<ol type="1">
<li><strong>Symetria</strong> wokół średniej</li>
<li><strong>Unimodalność</strong>: Pojedynczy szczyt pokrywający się ze średnią i medianą</li>
<li><strong>Punkty przegięcia</strong> dokładnie w <span class="math inline">\mu \pm \sigma</span></li>
</ol>
</section>
<section id="standardowy-rozkład-normalny-i-reguła-empiryczna" class="level2" data-number="2.11">
<h2 data-number="2.11" class="anchored" data-anchor-id="standardowy-rozkład-normalny-i-reguła-empiryczna"><span class="header-section-number">2.11</span> Standardowy Rozkład Normalny i Reguła Empiryczna</h2>
<p>Po standaryzacji (<span class="math inline">Z = \frac{X-\mu}{\sigma}</span>) otrzymujemy standardowy rozkład normalny (Z) z <span class="math inline">\mu = 0</span> i <span class="math inline">\sigma = 1</span>.</p>
<section id="reguła-68-95-997" class="level3" data-number="2.11.1">
<h3 data-number="2.11.1" class="anchored" data-anchor-id="reguła-68-95-997"><span class="header-section-number">2.11.1</span> Reguła 68-95-99,7</h3>
<ul>
<li>68,27% danych mieści się w przedziale <span class="math inline">\mu \pm 1\sigma</span></li>
<li>95,45% danych mieści się w przedziale <span class="math inline">\mu \pm 2\sigma</span></li>
<li>99,73% danych mieści się w przedziale <span class="math inline">\mu \pm 3\sigma</span></li>
</ul>
<p><em>Przykład:</em> Przy wzroście mężczyzn o średniej <span class="math inline">\mu = 175</span> cm i <span class="math inline">\sigma = 7</span> cm, około 95% mężczyzn ma wzrost między 161 a 189 cm.</p>
</section>
<section id="centralne-twierdzenie-graniczne" class="level3" data-number="2.11.2">
<h3 data-number="2.11.2" class="anchored" data-anchor-id="centralne-twierdzenie-graniczne"><span class="header-section-number">2.11.2</span> Centralne Twierdzenie Graniczne</h3>
<p>Kluczowe twierdzenie statystyki stanowiące, że średnie z próby losowej zbliżają się do rozkładu normalnego wraz ze wzrostem liczebności próby, niezależnie od pierwotnego rozkładu populacji.</p>
<p><em>Praktyczne znaczenie:</em> Nawet gdy dane nie mają rozkładu normalnego (np. czasy reakcji są zwykle skośne), średnie z wielu grup będą zbliżać się do rozkładu normalnego.</p>
</section>
</section>
<section id="zastosowania-praktyczne" class="level2" data-number="2.12">
<h2 data-number="2.12" class="anchored" data-anchor-id="zastosowania-praktyczne"><span class="header-section-number">2.12</span> Zastosowania Praktyczne</h2>
<ol type="1">
<li><strong>Testowanie hipotez</strong>: Testy t i Z</li>
<li><strong>Przedziały ufności</strong>: Szacowanie parametrów populacji</li>
<li><strong>Analiza regresji</strong>: Modelowanie zależności</li>
<li><strong>Kontrola jakości</strong>: Monitorowanie procesów</li>
</ol>
<p><em>Przykład:</em> Badacze farmaceutyczni mierzą wyniki poprawy u pacjentów. Przed zastosowaniem testów statystycznych weryfikują oni założenie o normalności rozkładu danych. W zależności od wyniku wybierają testy parametryczne (test t) lub nieparametryczne (test Manna-Whitneya).</p>
</section>
<section id="wizualizacja" class="level2" data-number="2.13">
<h2 data-number="2.13" class="anchored" data-anchor-id="wizualizacja"><span class="header-section-number">2.13</span> Wizualizacja</h2>
<p>Rozkład normalny tworzy charakterystyczną krzywą dzwonową, gdzie większość obserwacji grupuje się wokół średniej, a wartości ekstremalne są coraz rzadsze:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wczytaj niezbędne biblioteki</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Zdefiniuj parametry</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span>        <span class="co"># Średnia</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span>     <span class="co"># Odchylenie standardowe</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Utwórz sekwencję wartości x</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(mu <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>sigma, mu <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>sigma, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Oblicz odpowiadające wartości y (gęstość prawdopodobieństwa)</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Utwórz ramkę danych do wizualizacji</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>normal_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Oblicz regiony dla reguły empirycznej</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>sd1_min <span class="ot">&lt;-</span> mu <span class="sc">-</span> sigma</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>sd1_max <span class="ot">&lt;-</span> mu <span class="sc">+</span> sigma</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>sd2_min <span class="ot">&lt;-</span> mu <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>sigma</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>sd2_max <span class="ot">&lt;-</span> mu <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>sigma</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>sd3_min <span class="ot">&lt;-</span> mu <span class="sc">-</span> <span class="dv">3</span><span class="sc">*</span>sigma</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>sd3_max <span class="ot">&lt;-</span> mu <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>sigma</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Utwórz wykres</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(normal_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Wypełnij obszary dla reguły empirycznej</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> <span class="fu">subset</span>(normal_df, x <span class="sc">&gt;=</span> sd1_min <span class="sc">&amp;</span> x <span class="sc">&lt;=</span> sd1_max), </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">"darkblue"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> <span class="fu">subset</span>(normal_df, (x <span class="sc">&gt;=</span> sd2_min <span class="sc">&amp;</span> x <span class="sc">&lt;</span> sd1_min) <span class="sc">|</span> (x <span class="sc">&gt;</span> sd1_max <span class="sc">&amp;</span> x <span class="sc">&lt;=</span> sd2_max)), </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> <span class="fu">subset</span>(normal_df, (x <span class="sc">&gt;=</span> sd3_min <span class="sc">&amp;</span> x <span class="sc">&lt;</span> sd2_min) <span class="sc">|</span> (x <span class="sc">&gt;</span> sd2_max <span class="sc">&amp;</span> x <span class="sc">&lt;=</span> sd3_max)), </span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Dodaj pionowe linie przy odchyleniach standardowych</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(sd1_min, sd1_max), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(sd2_min, sd2_max), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(sd3_min, sd3_max), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Dodaj linię średniej</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mu, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Dodaj adnotacje</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">label =</span> <span class="st">"68,27%"</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">label =</span> <span class="st">"13,59%"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">label =</span> <span class="st">"13,59%"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">2.5</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">label =</span> <span class="st">"2,14%"</span>, <span class="at">color =</span> <span class="st">"lightblue"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">label =</span> <span class="st">"2,14%"</span>, <span class="at">color =</span> <span class="st">"lightblue"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Standardowy Rozkład Normalny i Reguła Empiryczna"</span>,</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Ilustracja reguły 68-95-99,7"</span>,</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Wartość Z (odchylenia standardowe od średniej)"</span>,</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Gęstość prawdopodobieństwa"</span>) <span class="sc">+</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ta wizualizacja demonstruje, jak masa prawdopodobieństwa koncentruje się wokół średniej i zmniejsza się na krańcach, ilustrując dlaczego wartości ekstremalne w zmiennych o rozkładzie normalnym są coraz mniej prawdopodobne w miarę oddalania się od średniej.</p>
</section>
<section id="znaczenie-filozoficzne" class="level2" data-number="2.14">
<h2 data-number="2.14" class="anchored" data-anchor-id="znaczenie-filozoficzne"><span class="header-section-number">2.14</span> Znaczenie Filozoficzne</h2>
<p>Rozkład normalny pokazuje jak losowość na poziomie indywidualnym może tworzyć przewidywalne wzorce na poziomie zbiorowym. To jedno z najważniejszych połączeń między determinizmem a losowością w nauce.</p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Typy Danych i Zmiennych
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dane stanowią empiryczną podstawę całego wnioskowania statystycznego. Natura danych determinuje, które metody analityczne są odpowiednie, jakie wnioski można wyciągnąć oraz jakie ograniczenia istnieją w interpretacji.</p>
<section id="metody-pozyskiwania-danych" class="level2" data-number="2.15">
<h2 data-number="2.15" class="anchored" data-anchor-id="metody-pozyskiwania-danych"><span class="header-section-number">2.15</span> Metody Pozyskiwania Danych</h2>
<ol type="1">
<li><strong>Dane pierwotne</strong>: Zbierane bezpośrednio dla konkretnego pytania badawczego
<ul>
<li><em>Przykłady</em>: Pomiary eksperymentalne, ankiety, wywiady, obserwacje</li>
<li><em>Zalety</em>: Bezpośrednia istotność, kontrola nad metodami zbierania, znane parametry jakości</li>
<li><em>Ograniczenia</em>: Czasochłonność, potencjalne stronniczość badacza</li>
</ul></li>
<li><strong>Dane wtórne</strong>: Pozyskane z wcześniej istniejących źródeł, nieprzeznaczonych specjalnie dla danego badania
<ul>
<li><em>Przykłady</em>: Dane spisowe, rejestry administracyjne, opublikowane dane badawcze, komercyjne bazy danych</li>
<li><em>Zalety</em>: Efektywność kosztowa, często większe próby, dostępność danych longitudinalnych</li>
<li><em>Ograniczenia</em>: Potencjalne luki w istotności, nieznane problemy jakościowe, ograniczona kontrola nad zmiennymi</li>
</ul></li>
</ol>
</section>
<section id="podstawowe-struktury-danych" class="level2" data-number="2.16">
<h2 data-number="2.16" class="anchored" data-anchor-id="podstawowe-struktury-danych"><span class="header-section-number">2.16</span> Podstawowe Struktury Danych</h2>
<ol type="1">
<li><strong>Dane przekrojowe</strong>: Obserwacje zebrane w jednym punkcie czasowym
<ul>
<li><em>Przykład</em>: Badanie 1000 gospodarstw domowych przeprowadzone w marcu 2023 r.</li>
</ul></li>
<li><strong>Szeregi czasowe</strong>: Obserwacje jednego podmiotu zbierane przez wiele okresów
<ul>
<li><em>Przykład</em>: Miesięczne stopy bezrobocia dla kraju w latach 2000-2023</li>
</ul></li>
<li><strong>Dane panelowe/longitudinalne</strong>: Obserwacje wielu podmiotów zbierane przez wiele okresów
<ul>
<li><em>Przykład</em>: Pomiary zdrowotne 500 pacjentów śledzone kwartalnie przez pięć lat</li>
</ul></li>
<li><strong>Dane hierarchiczne/zagnieżdżone</strong>: Obserwacje zorganizowane w zagnieżdżonych poziomach
<ul>
<li><em>Przykład</em>: Wyniki uczniów w klasach w szkołach w okręgach</li>
</ul></li>
</ol>
</section>
<section id="klasyfikacja-zmiennych" class="level2" data-number="2.17">
<h2 data-number="2.17" class="anchored" data-anchor-id="klasyfikacja-zmiennych"><span class="header-section-number">2.17</span> Klasyfikacja Zmiennych</h2>
<section id="według-właściwości-matematycznych" class="level3" data-number="2.17.1">
<h3 data-number="2.17.1" class="anchored" data-anchor-id="według-właściwości-matematycznych"><span class="header-section-number">2.17.1</span> Według Właściwości Matematycznych</h3>
<ol type="1">
<li><p><strong>Zmienne ilościowe</strong>: Reprezentują wartości liczbowe, które można zmierzyć</p>
<ol type="a">
<li><strong>Zmienne ciągłe</strong>: Mogą przyjmować dowolną wartość w określonym zakresie (ograniczone jedynie dokładnością pomiaru)
<ul>
<li><em>Przykłady</em>: Wzrost (172,68 cm), waga (68,3 kg), temperatura (36,7°C), czas (3,82 sekundy)</li>
<li><em>Metody analizy</em>: Średnia, odchylenie standardowe, histogramy, testy t, regresja</li>
</ul></li>
<li><strong>Zmienne dyskretne</strong>: Przyjmują określone, policzalne wartości, często całkowite
<ul>
<li><em>Przykłady</em>: Liczba dzieci (3), błędy w dokumencie (12), liczba klientów (548)</li>
<li><em>Metody analizy</em>: Tabele częstości, dominanta, regresja Poissona</li>
</ul></li>
</ol></li>
<li><p><strong>Zmienne jakościowe</strong>: Reprezentują kategorie lub cechy</p>
<ol type="a">
<li><strong>Zmienne nominalne</strong>: Kategorie bez naturalnej kolejności czy rankingu
<ul>
<li><em>Przykłady</em>: Grupa krwi (A, B, AB, O), płeć, kraj, typ produktu</li>
<li><em>Metody analizy</em>: Tabele częstości, dominanta, testy chi-kwadrat, wizualizacja kategoryczna</li>
</ul></li>
<li><strong>Zmienne porządkowe</strong>: Kategorie z naturalnym uporządkowaniem, ale nieznanymi lub nieregularnymi odstępami
<ul>
<li><em>Przykłady</em>: Poziom wykształcenia (podstawowe, średnie, licencjat, magisterium), oceny zadowolenia (słabe, dostateczne, dobre, doskonałe), status społeczno-ekonomiczny (niski, średni, wysoki)</li>
<li><em>Metody analizy</em>: Mediana, percentyle, testy nieparametryczne, regresja porządkowa</li>
</ul></li>
</ol></li>
</ol>
</section>
<section id="według-skali-pomiaru" class="level3" data-number="2.17.2">
<h3 data-number="2.17.2" class="anchored" data-anchor-id="według-skali-pomiaru"><span class="header-section-number">2.17.2</span> Według Skali Pomiaru</h3>
<ol type="1">
<li><strong>Skala nominalna</strong>: Klasyfikacja bez porządku (jakościowa, kategorie)
<ul>
<li><em>Właściwości</em>: Można określić równość/nierówność</li>
<li><em>Operacje</em>: Dominanta, liczebności, przynależność do kategorii</li>
</ul></li>
<li><strong>Skala porządkowa</strong>: Klasyfikacja z porządkiem, ale nieregularnymi odstępami
<ul>
<li><em>Właściwości</em>: Można określić relacje większy/mniejszy</li>
<li><em>Operacje</em>: Mediana, percentyle, korelacje rangowe</li>
</ul></li>
<li><strong>Skala interwałowa</strong>: Uporządkowana z regularnymi odstępami, ale bez znaczącego punktu zerowego
<ul>
<li><em>Przykłady</em>: Temperatura (°C, °F), daty kalendarzowe, wyniki IQ</li>
<li><em>Właściwości</em>: Różnice między wartościami są znaczące</li>
<li><em>Operacje</em>: Średnia, odchylenie standardowe, dodawanie/odejmowanie</li>
</ul></li>
<li><strong>Skala ilorazowa</strong>: Uporządkowana z regularnymi odstępami i znaczącym punktem zerowym
<ul>
<li><em>Przykłady</em>: Wzrost, waga, dochód, czas reakcji, temperatura absolutna (K)</li>
<li><em>Właściwości</em>: Proporcje między wartościami są znaczące (10 kg jest dwa razy cięższe niż 5 kg)</li>
<li><em>Operacje</em>: Wszystkie operacje arytmetyczne, średnia geometryczna, współczynnik zmienności</li>
</ul></li>
</ol>
</section>
<section id="według-roli-w-analizie" class="level3" data-number="2.17.3">
<h3 data-number="2.17.3" class="anchored" data-anchor-id="według-roli-w-analizie"><span class="header-section-number">2.17.3</span> Według Roli w Analizie</h3>
<ol type="1">
<li><strong>Zmienne niezależne</strong> (predyktory, zmienne objaśniające): Zmienne manipulowane lub wybierane w celu zbadania ich wpływu na zmienne zależne
<ul>
<li><em>Przykład</em>: Dawka leku w badaniu klinicznym</li>
</ul></li>
<li><strong>Zmienne zależne</strong> (zmienne odpowiedzi, wyniki): Zmienne mierzone w celu oceny wpływu zmiennych niezależnych
<ul>
<li><em>Przykład</em>: Obniżenie ciśnienia krwi po podaniu leku</li>
</ul></li>
<li><strong>Zmienne zakłócające</strong>: Niekontrolowane zmienne, które mogą wpływać na związek między zmiennymi niezależnymi a zależnymi
<ul>
<li><em>Przykład</em>: Wiek pacjenta wpływający zarówno na wybór leczenia, jak i na wynik powrotu do zdrowia</li>
</ul></li>
<li><strong>Zmienne kontrolne</strong>: Zmienne utrzymywane na stałym poziomie lub uwzględniane statystycznie
<ul>
<li><em>Przykład</em>: Wykształcenie w analizie determinantów dochodu</li>
</ul></li>
</ol>
<p>Zrozumienie natury danych zapewnia wybór odpowiednich metod statystycznych, pozwalając uniknąć mylących wniosków wynikających z niedopasowania metodologicznego.</p>
</section>
</section>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="wnioskowanie-statystyczne-nieformalne-wprowadzenie" class="level2" data-number="2.18">
<h2 data-number="2.18" class="anchored" data-anchor-id="wnioskowanie-statystyczne-nieformalne-wprowadzenie"><span class="header-section-number">2.18</span> Wnioskowanie Statystyczne: Nieformalne Wprowadzenie</h2>
<p>Wnioskowanie statystyczne to proces wyciągania wniosków o populacji na podstawie danych z próby. Wyobraź to sobie jako formułowanie trafnych przypuszczeń o całej pizzy po spróbowaniu tylko jednego kawałka. Obejmuje ono dwie główne dziedziny:</p>
</section>
<section id="estymacja" class="level2" data-number="2.19">
<h2 data-number="2.19" class="anchored" data-anchor-id="estymacja"><span class="header-section-number">2.19</span> Estymacja</h2>
<p>Estymacja to proces wykorzystywania danych z próby do oszacowania nieznanych parametrów populacji. Rozróżniamy:</p>
<ul>
<li><strong>Estymacja punktowa</strong>: Podanie pojedynczej wartości jako najlepszego przybliżenia parametru (jakby powiedzieć “Myślę, że średni wzrost to dokładnie 174 cm”)</li>
<li><strong>Estymacja przedziałowa</strong>: Tworzenie przedziału ufności, który wskazuje zakres możliwych wartości parametru zgodnych z naszymi danymi (jakby powiedzieć “Jestem w miarę pewien, że średni wzrost mieści się między 173 cm a 175 cm”)</li>
</ul>
<p>Przykład przedziału ufności: “95% przedział ufności dla średniego wzrostu dorosłych wynosi (173 cm, 175 cm).”</p>
<p><strong>Poprawna interpretacja przedziału ufności</strong>: Gdybyśmy wielokrotnie pobierali próby z tej samej populacji i konstruowali 95% przedział ufności dla każdej próby, używając tej samej metody, około 95% tych przedziałów zawierałoby prawdziwą wartość parametru populacji.</p>
<p><strong>Niepoprawna interpretacja</strong>: “Istnieje 95% szansa, że prawdziwa średnia znajduje się w przedziale (173 cm, 175 cm)” – jest to niepoprawne, ponieważ parametr populacji jest stałą (choć nieznaną) wartością, a nie zmienną losową. To jak powiedzenie “albo prawdziwa wartość jest w tym przedziale, albo nie jest” - te 95% odnosi się do niezawodności metody, a nie do prawdopodobieństwa zawierania prawdziwej wartości w pojedynczym przedziale.</p>
</section>
<section id="testowanie-hipotez" class="level2" data-number="2.20">
<h2 data-number="2.20" class="anchored" data-anchor-id="testowanie-hipotez"><span class="header-section-number">2.20</span> Testowanie Hipotez</h2>
<p>Testowanie hipotez to sposób sprawdzania, czy twierdzenie dotyczące grupy (lub populacji) jest prawdopodobnie prawdziwe, czy nie. To jak bycie detektywem: zbierasz dowody (dane) i decydujesz, czy dowody potwierdzają twoje twierdzenie.</p>
<section id="przykład-1-testowanie-czy-moneta-jest-stronnicza-na-korzyść-orła" class="level3" data-number="2.20.1">
<h3 data-number="2.20.1" class="anchored" data-anchor-id="przykład-1-testowanie-czy-moneta-jest-stronnicza-na-korzyść-orła"><span class="header-section-number">2.20.1</span> Przykład 1: Testowanie, czy moneta jest stronnicza na korzyść orła</h3>
<p>Wyobraź sobie, że twój przyjaciel ma monetę, która wydaje się częściej wypadać orłem niż reszką. Sprawdźmy eksperymentalnie, czy moneta jest stronnicza.</p>
<section id="krok-1-zadaj-pytanie-badawcze" class="level4" data-number="2.20.1.1">
<h4 data-number="2.20.1.1" class="anchored" data-anchor-id="krok-1-zadaj-pytanie-badawcze"><span class="header-section-number">2.20.1.1</span> Krok 1: Zadaj pytanie badawcze</h4>
<ul>
<li><strong>Pytanie</strong>: Czy moneta jest stronnicza na korzyść orła? (Czy prawdopodobieństwo wypadnięcia orła jest większe niż 0,5?)</li>
</ul>
</section>
<section id="krok-2-ustaw-dwie-hipotezy" class="level4" data-number="2.20.1.2">
<h4 data-number="2.20.1.2" class="anchored" data-anchor-id="krok-2-ustaw-dwie-hipotezy"><span class="header-section-number">2.20.1.2</span> Krok 2: Ustaw dwie hipotezy</h4>
<ul>
<li><strong>Hipoteza zerowa (H₀)</strong>: Moneta jest uczciwa. (Prawdopodobieństwo wypadnięcia orła = 0,5)</li>
<li><strong>Hipoteza alternatywna (H₁)</strong>: Moneta jest stronnicza na korzyść orła. (Prawdopodobieństwo wypadnięcia orła &gt; 0,5)</li>
</ul>
<p>Pomyśl o hipotezie zerowej jak o pozycji “niewinny, dopóki nie udowodni się winy”. Zakładamy, że moneta jest uczciwa, chyba że nasze dowody silnie sugerują inaczej.</p>
</section>
<section id="krok-3-zbierz-dane" class="level4" data-number="2.20.1.3">
<h4 data-number="2.20.1.3" class="anchored" data-anchor-id="krok-3-zbierz-dane"><span class="header-section-number">2.20.1.3</span> Krok 3: Zbierz dane</h4>
<ul>
<li>Rzucasz monetą 100 razy i otrzymujesz <strong>65 orłów</strong>.</li>
</ul>
</section>
<section id="krok-4-analizuj-dane" class="level4" data-number="2.20.1.4">
<h4 data-number="2.20.1.4" class="anchored" data-anchor-id="krok-4-analizuj-dane"><span class="header-section-number">2.20.1.4</span> Krok 4: Analizuj dane</h4>
<ul>
<li>Gdyby moneta była uczciwa, spodziewałbyś się około 50 orłów w 100 rzutach.</li>
<li>Otrzymanie 65 orłów to więcej niż oczekiwaliśmy, ale czy to wystarczy, aby stwierdzić, że moneta jest stronnicza?</li>
<li>Odchylenie standardowe (miara tego, jak bardzo wyniki zwykle się różnią) dla 100 rzutów uczciwą monetą wynosi 5.</li>
<li>Otrzymanie 65 orłów to <strong>3 odchylenia standardowe powyżej</strong> oczekiwanych 50 orłów. To jak koszykarz, który zwykle zdobywa 20 punktów na mecz, nagle zdobywający 35 - to nietypowe!</li>
</ul>
</section>
<section id="krok-5-oblicz-wartość-p" class="level4" data-number="2.20.1.5">
<h4 data-number="2.20.1.5" class="anchored" data-anchor-id="krok-5-oblicz-wartość-p"><span class="header-section-number">2.20.1.5</span> Krok 5: Oblicz wartość p</h4>
<ul>
<li><strong>Wartość p</strong> to prawdopodobieństwo uzyskania wyniku tak skrajnego lub bardziej skrajnego niż zaobserwowany (65 orłów), jeśli moneta byłaby uczciwa.</li>
<li>Dla testu jednostronnego (ponieważ nasza H₁ to “moneta jest stronnicza na korzyść orła”), oznacza to prawdopodobieństwo uzyskania 65 lub więcej orłów ze 100 rzutów uczciwą monetą.</li>
<li>W tym przypadku wartość p jest bardzo mała (około 0,0013), co oznacza, że bardzo rzadko można by uzyskać tak wiele orłów przez przypadek przy uczciwej monecie.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Formalny sposób obliczania wartości p
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dla naszego przykładu z rzutem monetą z testem jednostronnym:</p>
<ol type="1">
<li>Hipoteza zerowa H₀: p = 0,5 (uczciwa moneta)</li>
<li>Hipoteza alternatywna H₁: p &gt; 0,5 (stronnicza na korzyść orła)</li>
<li>Statystyka testowa: X = 65 orłów z n = 100 rzutów</li>
</ol>
<p>Wartość p dla testu jednostronnego to:</p>
<p><span class="math inline">p\text{-wartość} = P(X \geq 65 | n=100, p=0,5)</span></p>
<p>Korzystając z funkcji masy prawdopodobieństwa rozkładu dwumianowego:</p>
<p><span class="math inline">P(X = k) = {n \choose k}p^k(1-p)^{n-k}</span></p>
<p>Dla zaobserwowanego wyniku (65 orłów): <span class="math inline">P(X \geq 65) = 1 - P(X \leq 64) = 1 - \sum_{k=0}^{64}{100 \choose k}(0,5)^k(0,5)^{100-k} \approx 0,0013</span></p>
<p>Ta wartość p jest znacznie poniżej powszechnego progu istotności 0,05, co wskazuje na silne dowody przeciwko hipotezie zerowej.</p>
</div>
</div>
</section>
<section id="krok-6-podejmij-decyzję" class="level4" data-number="2.20.1.6">
<h4 data-number="2.20.1.6" class="anchored" data-anchor-id="krok-6-podejmij-decyzję"><span class="header-section-number">2.20.1.6</span> Krok 6: Podejmij decyzję</h4>
<ul>
<li>Jeśli wartość p jest mała (zwykle mniejsza niż 0,05), <strong>odrzucamy hipotezę zerową</strong>.</li>
<li>Tutaj wartość p (0,0013) jest znacznie mniejsza niż 0,05, więc dochodzimy do wniosku, że moneta jest <strong>stronnicza na korzyść orła</strong>.</li>
<li>To jakby powiedzieć: “Gdyby moneta była uczciwa, zobaczylibyśmy 65 lub więcej orłów ze 100 rzutów tylko w około 0,13% przypadków, co jest tak rzadkie, że nie wierzymy, że ta moneta jest uczciwa.”</li>
</ul>
</section>
</section>
<section id="przykład-2-testowanie-wpływu-muzyki-w-tle-na-pamięć" class="level3" data-number="2.20.2">
<h3 data-number="2.20.2" class="anchored" data-anchor-id="przykład-2-testowanie-wpływu-muzyki-w-tle-na-pamięć"><span class="header-section-number">2.20.2</span> Przykład 2: Testowanie wpływu muzyki w tle na pamięć</h3>
<p>Przyjrzyjmy się innemu przykładowi z psychologii: Czy słuchanie muzyki klasycznej poprawia pamięć?</p>
<section id="krok-1-pytanie-badawcze" class="level4" data-number="2.20.2.1">
<h4 data-number="2.20.2.1" class="anchored" data-anchor-id="krok-1-pytanie-badawcze"><span class="header-section-number">2.20.2.1</span> Krok 1: Pytanie badawcze</h4>
<p>Czy słuchanie muzyki klasycznej podczas nauki poprawia zapamiętywanie w porównaniu do nauki w ciszy?</p>
</section>
<section id="krok-2-hipotezy" class="level4" data-number="2.20.2.2">
<h4 data-number="2.20.2.2" class="anchored" data-anchor-id="krok-2-hipotezy"><span class="header-section-number">2.20.2.2</span> Krok 2: Hipotezy</h4>
<ul>
<li><strong>H₀</strong>: Muzyka klasyczna nie ma wpływu na zapamiętywanie (średnie wyniki zapamiętywania są takie same).</li>
<li><strong>H₁</strong>: Muzyka klasyczna poprawia zapamiętywanie (średnie wyniki zapamiętywania są wyższe przy muzyce).</li>
</ul>
<p>Pomyśl o tym jako o rozpoczęciu z założeniem, że muzyka nie robi różnicy (H₀), a następnie sprawdzeniu, czy nasze dane przekonują nas inaczej.</p>
</section>
<section id="krok-3-zbierz-dane-1" class="level4" data-number="2.20.2.3">
<h4 data-number="2.20.2.3" class="anchored" data-anchor-id="krok-3-zbierz-dane-1"><span class="header-section-number">2.20.2.3</span> Krok 3: Zbierz dane</h4>
<p>Losowo przydzielasz 60 studentów do dwóch grup:</p>
<ul>
<li>Grupa A (30 studentów): Uczy się listy słów w ciszy</li>
<li>Grupa B (30 studentów): Uczy się tej samej listy, słuchając muzyki klasycznej</li>
</ul>
<p>Po 20 minutach obie grupy piszą ten sam test pamięci. Grupa A (cisza) pamięta średnio 14,2 słowa, podczas gdy Grupa B (muzyka) pamięta średnio 16,8 słowa.</p>
</section>
<section id="krok-4-6-analiza-i-decyzja" class="level4" data-number="2.20.2.4">
<h4 data-number="2.20.2.4" class="anchored" data-anchor-id="krok-4-6-analiza-i-decyzja"><span class="header-section-number">2.20.2.4</span> Krok 4-6: Analiza i decyzja</h4>
<p>Po przeanalizowaniu danych obliczasz wartość p wynoszącą 0,02. Oznacza to, że gdyby muzyka naprawdę nie miała wpływu, zobaczylibyśmy różnicę tak dużą lub większą tylko w około 2% przypadków przez czysty przypadek.</p>
<p>Ponieważ 0,02 &lt; 0,05, odrzucasz H₀ i dochodzisz do wniosku, że muzyka klasyczna rzeczywiście wydaje się poprawiać zapamiętywanie.</p>
<p><strong>Ważna uwaga dotycząca wielkości efektu</strong>: Różnica 2,6 słowa może być statystycznie istotna, ale powinna być oceniana pod kątem praktycznego znaczenia. Czy zapamiętanie około 3 słów więcej jest znaczące w kontekstach świata rzeczywistego? To jak wykrycie, że nowa technika nauki pomaga uczniom zapamiętać 3 słowa więcej – statystycznie wykrywalne, ale czy to wystarczy, aby zmienić sposób, w jaki się uczymy? To podkreśla, dlaczego musimy brać pod uwagę zarówno istotność statystyczną, JAK I praktyczne znaczenie.</p>
</section>
</section>
</section>
<section id="ogólne-kroki-testowania-hipotez" class="level2" data-number="2.21">
<h2 data-number="2.21" class="anchored" data-anchor-id="ogólne-kroki-testowania-hipotez"><span class="header-section-number">2.21</span> Ogólne kroki testowania hipotez</h2>
<ol type="1">
<li><strong>Sformułuj hipotezy</strong>:
<ul>
<li>Hipoteza zerowa (H₀): Domyślne twierdzenie lub twierdzenie o “braku efektu”.</li>
<li>Hipoteza alternatywna (H₁): Twierdzenie, które testujesz.</li>
</ul></li>
<li><strong>Wybierz poziom istotności (α)</strong>:
<ul>
<li>Jest to próg decydujący, czy wartość p jest wystarczająco mała, aby odrzucić H₀. Powszechne wybory to 0,05 lub 0,01.</li>
<li>Pomyśl o tym jako o decydowaniu “jak pewny” musisz być, zanim postawisz tezę - jak ustalenie bariery dla “uzasadnionych wątpliwości” w sprawie sądowej.</li>
</ul></li>
<li><strong>Zbierz dane</strong>:
<ul>
<li>Zgromadź dowody z reprezentatywnej próby.</li>
</ul></li>
<li><strong>Oblicz statystykę testową i wartość p</strong>:
<ul>
<li><strong>Statystyka testowa</strong> mierzy, jak daleko twoje dane odbiegają od tego, co przewiduje H₀.</li>
<li><strong>Wartość p</strong> mówi ci, jak prawdopodobny jest zaobserwowany wynik/efekt (lub wynik/efekt bardziej skrajny), jeśli H₀ jest prawdziwa.</li>
<li>Pomyśl o wartości p jako o mierze tego, jak bardzo byłbyś zaskoczony, widząc swoje wyniki, gdyby hipoteza zerowa była prawdziwa.</li>
</ul></li>
<li><strong>Podejmij decyzję</strong>:
<ul>
<li>Jeśli wartość p &lt; α, odrzuć H₀ i przyjmij H₁.</li>
<li>Jeśli wartość p ≥ α, nie odrzucaj H₀ (ale to nie dowodzi, że H₀ jest prawdziwa).</li>
</ul></li>
<li><strong>Zinterpretuj wyniki w kontekście</strong>:
<ul>
<li>Rozważ zarówno istotność statystyczną, jak i praktyczne znaczenie.</li>
<li>Zapytaj: “Nawet jeśli ten efekt jest ‘istotny’ w sensie statystycznym, czy ma on praktyczne znaczenie w świecie rzeczywistym?”</li>
</ul></li>
</ol>
</section>
<section id="intuicja-testowania-hipotez" class="level2" data-number="2.22">
<h2 data-number="2.22" class="anchored" data-anchor-id="intuicja-testowania-hipotez"><span class="header-section-number">2.22</span> Intuicja testowania hipotez</h2>
<p>Pomyśl o testowaniu hipotez jak o procesie sądowym:</p>
<ul>
<li><strong>Hipoteza zerowa (H₀)</strong>: Oskarżony jest niewinny.</li>
<li><strong>Hipoteza alternatywna (H₁)</strong>: Oskarżony jest winny.</li>
<li><strong>Dane</strong>: Dowody przedstawione w sądzie.</li>
<li><strong>Wartość p</strong>: Jak mało prawdopodobne byłyby dowody, gdyby oskarżony był naprawdę niewinny.</li>
<li><strong>Poziom istotności (α)</strong>: Standard dowodu potrzebny do skazania.</li>
</ul>
<p>Jeśli dowody są bardzo mało prawdopodobne przy założeniu niewinności (wartość p &lt; α), odrzucamy H₀ (skazujemy oskarżonego). Jeśli nie, nie odrzucamy H₀ (oskarżony pozostaje “nieudowodniony jako winny”).</p>
</section>
<section id="częste-błędy-związane-z-wartościami-p" class="level2" data-number="2.23">
<h2 data-number="2.23" class="anchored" data-anchor-id="częste-błędy-związane-z-wartościami-p"><span class="header-section-number">2.23</span> Częste błędy związane z wartościami p</h2>
<ol type="1">
<li><strong>Wartość p NIE jest prawdopodobieństwem, że H₀ jest prawdziwa</strong>.
<ul>
<li>Jest to prawdopodobieństwo zobaczenia twoich danych (lub czegoś bardziej skrajnego) <strong>jeśli H₀ byłaby prawdziwa</strong>.</li>
<li>Pomyśl o tym jako o prawdopodobieństwie wylosowania zwycięskiego losu na loterii (twoje dane), JEŚLI loteria byłaby uczciwa, a nie o prawdopodobieństwie, że loteria jest uczciwa.</li>
</ul></li>
<li><strong>Wartość p NIE jest szansą popełnienia błędu</strong>.
<ul>
<li>Nie mówi ci o prawdopodobieństwie pomyłki przy odrzucaniu H₀.</li>
</ul></li>
<li><strong>Nieodrzucenie H₀ NIE dowodzi, że jest ona prawdziwa</strong>.
<ul>
<li>Oznacza to tylko, że nie ma wystarczających dowodów, aby ją odrzucić (“brak dowodów nie jest dowodem nieobecności”).</li>
<li>Jak gdy detektyw mówi “niewystarczające dowody” - nie oznacza to, że podejrzany jest niewinny, tylko że nie mogli udowodnić winy.</li>
</ul></li>
<li><strong>Mała wartość p NIE oznacza, że wynik jest ważny</strong>.
<ul>
<li>Oznacza tylko, że wynik jest statystycznie istotny. Efekt może być nadal znikomy w kategoriach świata rzeczywistego.</li>
<li>Jak wykrycie, że jeden samochód jest o 0,1 km/h szybszy od drugiego - wykrywalnie różny, ale praktycznie bez znaczenia.</li>
</ul></li>
<li><strong>Wartości p zależą od wielkości próby</strong>.
<ul>
<li>Przy bardzo dużych próbach nawet drobne, praktycznie nieistotne różnice mogą stać się statystycznie istotne.</li>
<li>Jak bardzo czuła waga, która może wykryć różnice wagi 0,001g, ale nie oznacza to, że takie różnice mają znaczenie dla większości celów.</li>
</ul></li>
</ol>
</section>
<section id="rodzaje-błędów-w-testowaniu-hipotez" class="level2" data-number="2.24">
<h2 data-number="2.24" class="anchored" data-anchor-id="rodzaje-błędów-w-testowaniu-hipotez"><span class="header-section-number">2.24</span> Rodzaje błędów w testowaniu hipotez</h2>
<ol type="1">
<li><strong>Błąd typu I (Fałszywie Pozytywny)</strong>:
<ul>
<li>Odrzucenie H₀, gdy jest ona faktycznie prawdziwa.</li>
<li>Przykład: Stwierdzenie, że lek działa, gdy faktycznie nie działa.</li>
<li>Prawdopodobieństwo tego błędu = α (poziom istotności).</li>
<li>Pomyśl o tym jako o skazaniu niewinnej osoby.</li>
</ul></li>
<li><strong>Błąd typu II (Fałszywie Negatywny)</strong>:
<ul>
<li>Nieodrzucenie H₀, gdy jest ona faktycznie fałszywa.</li>
<li>Przykład: Stwierdzenie, że lek nie działa, gdy faktycznie działa.</li>
<li>Prawdopodobieństwo tego błędu = β.</li>
<li>Pomyśl o tym jako o wypuszczeniu winnej osoby na wolność.</li>
</ul></li>
<li><strong>Moc testu (1 - β)</strong>:
<ul>
<li>Prawdopodobieństwo poprawnego odrzucenia H₀, gdy jest ona fałszywa.</li>
<li>Pomyśl o tym jako o zdolności testu do wykrycia rzeczywistego efektu, gdy on istnieje.</li>
<li>Jak zdolność wykrywacza metali do znajdowania rzeczywistych metalowych przedmiotów.</li>
<li>Moc zwiększa się wraz z:
<ul>
<li>Większymi próbami (badanie większej ilości dowodów)</li>
<li>Większymi wielkościami efektu (szukanie większego metalowego przedmiotu)</li>
<li>Wyższymi poziomami istotności (bycie mniej restrykcyjnym co do tego, co liczy się jako “metal”)</li>
</ul></li>
</ul></li>
</ol>
<p>Rozważ tę tabelę pokazującą możliwe wyniki:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Rzeczywistość</th>
<th>Decyzja: Odrzuć H₀</th>
<th>Decyzja: Nie odrzucaj H₀</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>H₀ Prawdziwa</td>
<td>Błąd typu I (α)</td>
<td>Poprawna decyzja</td>
</tr>
<tr class="even">
<td>H₀ Fałszywa</td>
<td>Poprawna decyzja (Moc)</td>
<td>Błąd typu II (β)</td>
</tr>
</tbody>
</table>
</section>
<section id="kluczowe-wnioski" class="level2" data-number="2.25">
<h2 data-number="2.25" class="anchored" data-anchor-id="kluczowe-wnioski"><span class="header-section-number">2.25</span> Kluczowe wnioski</h2>
<ul>
<li>Testowanie hipotez pomaga zdecydować, czy twoje dane potwierdzają twierdzenie.</li>
<li>Wartość p mówi ci, jak zaskakujące są twoje dane, zakładając, że H₀ jest prawdziwa.</li>
<li>Zawsze interpretuj wartości p ostrożnie i unikaj typowych błędów.</li>
<li>Pamiętaj: Istotność statystyczna ≠ znaczenie praktyczne.</li>
<li>Zarówno poziom istotności (α), jak i moc (1-β) są ważne dla wiarygodnego wnioskowania.</li>
<li>Większe próby zmniejszają oba rodzaje błędów, ale mogą sprawić, że błahe efekty staną się statystycznie istotne.</li>
</ul>
</section>
<section id="modele-statystyczne" class="level2" data-number="2.26">
<h2 data-number="2.26" class="anchored" data-anchor-id="modele-statystyczne"><span class="header-section-number">2.26</span> Modele Statystyczne</h2>
<p><strong>Model statystyczny</strong> to matematyczna reprezentacja rzeczywistości, która opisuje relacje między zmiennymi oraz strukturę danych. Pozwala on opisać <strong>proces generowania danych (DGP)</strong> oraz umożliwia wnioskowanie o nieznanych parametrach.</p>
<blockquote class="blockquote">
<p><strong>Składniki Modelu Statystycznego</strong></p>
<p>Kompletny model statystyczny składa się z następujących elementów:</p>
<ol type="1">
<li><strong>Forma funkcjonalna</strong>: Struktura matematyczna definiująca relację między zmiennymi (np. liniowa, kwadratowa, wykładnicza).</li>
<li><strong>Zmienne</strong>:
<ul>
<li><strong>Zmienna zależna</strong>: Wynik, który chcemy przewidzieć lub wyjaśnić.</li>
<li><strong>Zmienne niezależne/objaśniające</strong>: Czynniki, które mogą wpływać na zmienną zależną.</li>
</ul></li>
<li><strong>Parametry</strong>: Nieznane wielkości, które szacujemy na podstawie danych (np. współczynniki regresji, takie jak <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span>).</li>
<li><strong>Składnik losowy</strong>: Składnik błędu (<span class="math inline">\epsilon</span>), który uwzględnia niewyjaśnioną zmienność w danych.</li>
<li><strong>Założenia dotyczące rozkładu prawdopodobieństwa</strong>: Założenia dotyczące rozkładu składnika losowego (np. normalność, homoskedastyczność).</li>
</ol>
</blockquote>
<p><strong>Przykład modelu regresji liniowej</strong>:</p>
<p><span class="math display">
y = \beta_0 + \beta_1x + \epsilon, \quad \text{gdzie} \quad \epsilon \sim N(0, \sigma^2)
</span></p>
<p>W tym modelu:</p>
<ul>
<li><span class="math inline">\beta_0</span> (wyraz wolny) i <span class="math inline">\beta_1</span> (współczynnik nachylenia) to parametry, które szacujemy.</li>
<li><span class="math inline">\epsilon</span> reprezentuje składnik losowy, który przechwytuje zmienność niewyjaśnioną przez model.</li>
<li>Zakładamy, że składnik losowy ma rozkład normalny o średniej 0 i wariancji <span class="math inline">\sigma^2</span>.</li>
</ul>
<hr>
<section id="wnioskowanie-przyczynowe-vs.-predykcyjne" class="level3" data-number="2.26.1">
<h3 data-number="2.26.1" class="anchored" data-anchor-id="wnioskowanie-przyczynowe-vs.-predykcyjne"><span class="header-section-number">2.26.1</span> Wnioskowanie Przyczynowe vs.&nbsp;Predykcyjne</h3>
<p>W modelowaniu statystycznym można wyróżnić dwa główne cele:</p>
<ol type="1">
<li><strong>Wnioskowanie Przyczynowe</strong>:
<ul>
<li><strong>Cel</strong>: Określenie, czy zmiana zmiennej <strong>X</strong> <em>powoduje</em> zmianę zmiennej <strong>Y</strong>.</li>
<li><strong>Wymagania</strong>: Silne założenia lub specjalne projekty badawcze (np. randomizowane badania kontrolowane, zmienne instrumentalne).</li>
<li><strong>Zastosowanie</strong>: Używane do przewidywania efektów interwencji lub zmian politycznych.</li>
<li><strong>Przykład</strong>: Czy podniesienie płacy minimalnej (X) powoduje spadek zatrudnienia (Y)?</li>
</ul></li>
<li><strong>Wnioskowanie Predykcyjne</strong>:
<ul>
<li><strong>Cel</strong>: Przewidywanie wartości <strong>Y</strong> na podstawie <strong>X</strong>.</li>
<li><strong>Wymagania</strong>: Nie ma potrzeby zakładania związku przyczynowego między zmiennymi.</li>
<li><strong>Skupienie</strong>: Maksymalizacja dokładności predykcji, często z wykorzystaniem technik uczenia maszynowego.</li>
<li><strong>Przykład</strong>: Przewidywanie cen domów (Y) na podstawie cech takich jak powierzchnia, lokalizacja i liczba sypialni (X).</li>
</ul></li>
</ol>
<blockquote class="blockquote">
<p><strong>Ostrzeżenie: Korelacja ≠ Przyczynowość</strong></p>
<p><strong>Fałszywa zależność</strong> (lub fałszywa korelacja) występuje, gdy dwie zmienne są statystycznie powiązane, ale nie mają związku przyczynowego. Może to wynikać z:</p>
<ol type="1">
<li><strong>Zmiennej zakłócającej</strong>: Trzecia zmienna wpływa na zarówno X, jak i Y.
<ul>
<li><em>Przykład</em>: Sprzedaż lodów (X) i liczba utonięć (Y) są skorelowane, ponieważ oba zjawiska nasilają się latem (zmienna zakłócająca: temperatura).</li>
</ul></li>
<li><strong>Odwrotnej przyczynowości</strong>: Y wpływa na X, a nie odwrotnie.
<ul>
<li><em>Przykład</em>: Wyższa przestępczość (Y) prowadzi do większej obecności policji (X), a nie na odwrót.</li>
</ul></li>
<li><strong>Przypadku</strong>: Losowe korelacje, które występują przez przypadek.
<ul>
<li><em>Przykład</em>: Korelacja między liczbą piratów a globalną temperaturą (czysty przypadek).</li>
</ul></li>
</ol>
</blockquote>
<hr>
</section>
<section id="wyzwania-wnioskowania-przyczynowego" class="level3" data-number="2.26.2">
<h3 data-number="2.26.2" class="anchored" data-anchor-id="wyzwania-wnioskowania-przyczynowego"><span class="header-section-number">2.26.2</span> Wyzwania Wnioskowania Przyczynowego</h3>
<p>Fundamentalnym problemem wnioskowania przyczynowego jest niemożność zaobserwowania <strong>stanów kontrfaktycznych</strong> (alternatywnych scenariuszy). Dla danej jednostki możemy zaobserwować tylko jeden potencjalny wynik.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/meme_horse.svg" class="img-fluid figure-img"></p>
<figcaption>Fundamentalny problem wnioskowania przyczynowego: Możemy myśleć o wnioskowaniu przyczynowym jako o problemie PRZEWIDYWANIA. Jak możemy przewidzieć stan kontrfaktyczny, skoro nigdy go nie obserwujemy?</figcaption>
</figure>
</div>
<p>Przykład:</p>
<ul>
<li>Obserwujemy osobę, która ukończyła studia i zarabia 8000 zł miesięcznie</li>
<li>Nie możemy zaobserwować, ile ta sama osoba zarabiałaby, gdyby nie ukończyła studiów</li>
</ul>
<p>Metody przyczynowe próbują rozwiązać ten problem, na przykład, poprzez:</p>
<ol type="1">
<li>Eksperymenty randomizowane</li>
<li>Zmienne instrumentalne</li>
<li>Metody dopasowania (ang. matching methods)</li>
<li>Analizę nieciągłości regresji (ang. regression discontinuity)</li>
<li>Różnicę w różnicach (ang. difference-in-differences)</li>
</ol>
<p>Typowe problemy we wnioskowaniu przyczynowym:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/IMG_4337.jpg" class="img-fluid figure-img"></p>
<figcaption>Błąd zmiennej zakłócającej: picie alkoholu poprzedniego wieczoru jest wspólną przyczyną spania w butach i budzenia się z bólem głowy</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/ff13-23.png" class="img-fluid figure-img"></p>
<figcaption>Odwrotna przyczynowość</figcaption>
</figure>
</div>
<hr>
</section>
</section>
<section id="zrozumienie-błędów-statystycznych" class="level2" data-number="2.27">
<h2 data-number="2.27" class="anchored" data-anchor-id="zrozumienie-błędów-statystycznych"><span class="header-section-number">2.27</span> Zrozumienie błędów statystycznych</h2>
<p>Podczas używania próby do wnioskowania o populacji nieuniknione są błędy statystyczne:</p>
<blockquote class="blockquote">
<p><strong>Błąd statystyczny</strong> to różnica między oszacowaniem na podstawie próby a rzeczywistą wartością populacyjną.</p>
</blockquote>
<p>Błędy te mogą wpływać na wiarygodność i rzetelność badań. Ich zrozumienie jest kluczowe dla projektowania solidnych badań, dokładnej analizy danych i wyciągania poprawnych wniosków.</p>
</section>
<section id="rodzaje-błędów-statystycznych" class="level2" data-number="2.28">
<h2 data-number="2.28" class="anchored" data-anchor-id="rodzaje-błędów-statystycznych"><span class="header-section-number">2.28</span> Rodzaje błędów statystycznych</h2>
<section id="błędy-próbkowania" class="level3" data-number="2.28.1">
<h3 data-number="2.28.1" class="anchored" data-anchor-id="błędy-próbkowania"><span class="header-section-number">2.28.1</span> Błędy próbkowania</h3>
<section id="losowe-błędy-próbkowania" class="level4" data-number="2.28.1.1">
<h4 data-number="2.28.1.1" class="anchored" data-anchor-id="losowe-błędy-próbkowania"><span class="header-section-number">2.28.1.1</span> Losowe błędy próbkowania</h4>
<ul>
<li><strong>Definicja</strong>: Naturalna zmienność oszacowań wynikająca z losowego doboru próby.</li>
<li><strong>Przykład</strong>: Średni wzrost 30 losowo wybranych studentów uniwersytetu różni się między próbkami.</li>
<li><strong>Właściwości</strong>:
<ul>
<li>Nieuniknione, ale kontrolowalne</li>
<li>Zmniejszają się wraz ze wzrostem wielkości próby</li>
<li>Kwantyfikowane za pomocą marginesu błędu</li>
<li>Podlegają przewidywalnym wzorcom statystycznym</li>
</ul></li>
</ul>
</section>
<section id="systematyczne-błędy-próbkowania-stronniczość" class="level4" data-number="2.28.1.2">
<h4 data-number="2.28.1.2" class="anchored" data-anchor-id="systematyczne-błędy-próbkowania-stronniczość"><span class="header-section-number">2.28.1.2</span> Systematyczne błędy próbkowania (stronniczość)</h4>
<ul>
<li><strong>Stronniczość selekcji</strong>: Próba nie reprezentuje docelowej populacji.
<ul>
<li><em>Przykład</em>: Ankieta telefoniczna dociera tylko do użytkowników telefonów stacjonarnych, pomijając użytkowników telefonów komórkowych.</li>
</ul></li>
<li><strong>Niedoreprezentowanie</strong>: Systematyczne wykluczenie grup.
<ul>
<li><em>Przykład</em>: Ankieta na kampusie przeprowadzona w ciągu dnia pomija studentów uczących się wieczorami.</li>
</ul></li>
<li><strong>Stronniczość autoselekcji</strong>: Wyniki są zniekształcone przez wybór uczestników.
<ul>
<li><em>Przykład</em>: Ankiety dotyczące satysfakcji klientów wypełniają głównie osoby o silnych opiniach.</li>
</ul></li>
<li><strong>Stronniczość braku odpowiedzi</strong>: Niektóre grupy rzadziej odpowiadają.
<ul>
<li><em>Przykład</em>: Zapracowane osoby nie wypełniają ankiet, co prowadzi do nadreprezentacji osób z większą ilością wolnego czasu.</li>
</ul></li>
</ul>
</section>
</section>
<section id="błędy-pomiarowe" class="level3" data-number="2.28.2">
<h3 data-number="2.28.2" class="anchored" data-anchor-id="błędy-pomiarowe"><span class="header-section-number">2.28.2</span> Błędy pomiarowe</h3>
<section id="losowe-błędy-pomiarowe" class="level4" data-number="2.28.2.1">
<h4 data-number="2.28.2.1" class="anchored" data-anchor-id="losowe-błędy-pomiarowe"><span class="header-section-number">2.28.2.1</span> Losowe błędy pomiarowe</h4>
<ul>
<li><strong>Definicja</strong>: Nieprzewidywalne wahania pomiarów wynikające z przypadkowej zmienności.</li>
<li><strong>Przykłady</strong>:
<ul>
<li>Niewielkie różnice w pomiarach ciśnienia krwi z powodu drżącej ręki.</li>
<li>Małe zmiany wynikające z warunków środowiskowych wpływających na instrumenty pomiarowe.</li>
<li>Drobne nieścisłości w powtarzanych pomiarach.</li>
</ul></li>
<li><strong>Kluczowa cecha</strong>: Błędy te mają tendencję do równoważenia się przy wielokrotnych pomiarach.</li>
</ul>
</section>
<section id="systematyczne-błędy-pomiarowe" class="level4" data-number="2.28.2.2">
<h4 data-number="2.28.2.2" class="anchored" data-anchor-id="systematyczne-błędy-pomiarowe"><span class="header-section-number">2.28.2.2</span> Systematyczne błędy pomiarowe</h4>
<ul>
<li><strong>Błędy kalibracji</strong>: Narzędzia pomiarowe systematycznie dostarczają nieprawidłowe wartości.
<ul>
<li><em>Przykład</em>: Waga, która zawsze dodaje 2 kg.</li>
</ul></li>
<li><strong>Stronniczość obserwatora</strong>: Oczekiwania badacza subtelnie wpływają na zbieranie danych.
<ul>
<li><em>Przykład</em>: Nieświadome rejestrowanie danych zgodnych z hipotezą.</li>
</ul></li>
<li><strong>Stronniczość społecznej aprobaty</strong>: Uczestnicy zmieniają odpowiedzi, aby wyglądać lepiej.
<ul>
<li><em>Przykład</em>: Niedoszacowanie spożycia niezdrowej żywności w badaniach żywieniowych.</li>
</ul></li>
</ul>
</section>
</section>
<section id="błędy-wnioskowania" class="level3" data-number="2.28.3">
<h3 data-number="2.28.3" class="anchored" data-anchor-id="błędy-wnioskowania"><span class="header-section-number">2.28.3</span> Błędy wnioskowania</h3>
<section id="błędy-testowania-hipotez" class="level4" data-number="2.28.3.1">
<h4 data-number="2.28.3.1" class="anchored" data-anchor-id="błędy-testowania-hipotez"><span class="header-section-number">2.28.3.1</span> Błędy testowania hipotez</h4>
<ul>
<li><strong>Błąd typu I (fałszywie pozytywny)</strong>: Błędne stwierdzenie, że istnieje efekt.
<ul>
<li><em>Przykład</em>: Twierdzenie, że nowy lek działa, gdy w rzeczywistości jego korzyści wynikają z przypadku.</li>
<li><em>Kontekst</em>: Powiązany z poziomem istotności (α).</li>
</ul></li>
<li><strong>Błąd typu II (fałszywie negatywny)</strong>: Niezauważenie rzeczywistego efektu.
<ul>
<li><em>Przykład</em>: Wniosek, że lek jest nieskuteczny, gdy faktycznie pomaga pacjentom.</li>
<li><em>Kontekst</em>: Związany z mocą statystyczną (1-β).</li>
</ul></li>
<li><strong>Błąd typu III</strong>: Analizowanie niewłaściwego problemu badawczego.
<ul>
<li><em>Przykład</em>: Badanie wpływu strategii marketingowej na ruch na stronie zamiast na sprzedaż.</li>
</ul></li>
</ul>
</section>
<section id="problemy-z-mocą-statystyczną" class="level4" data-number="2.28.3.2">
<h4 data-number="2.28.3.2" class="anchored" data-anchor-id="problemy-z-mocą-statystyczną"><span class="header-section-number">2.28.3.2</span> Problemy z mocą statystyczną</h4>
<ul>
<li><strong>Badania o niskiej mocy</strong>: Zbyt mała próba, aby wykryć rzeczywiste efekty.
<ul>
<li><em>Przykład</em>: Ocena programu odchudzania na podstawie pięciu uczestników.</li>
<li><em>Zapobieganie</em>: Przeprowadzanie analizy mocy przed zbieraniem danych.</li>
</ul></li>
</ul>
</section>
</section>
<section id="błędy-modelowania-statystycznego" class="level3" data-number="2.28.4">
<h3 data-number="2.28.4" class="anchored" data-anchor-id="błędy-modelowania-statystycznego"><span class="header-section-number">2.28.4</span> Błędy modelowania statystycznego</h3>
<section id="błędy-wyboru-zmiennych" class="level4" data-number="2.28.4.1">
<h4 data-number="2.28.4.1" class="anchored" data-anchor-id="błędy-wyboru-zmiennych"><span class="header-section-number">2.28.4.1</span> Błędy wyboru zmiennych</h4>
<ul>
<li><strong>Pominięcie istotnych zmiennych</strong>.
<ul>
<li><em>Przykład</em>: Analiza wpływu ćwiczeń na utratę wagi bez uwzględnienia diety.</li>
</ul></li>
<li><strong>Zmienne zakłócające</strong>: Czynniki zewnętrzne wpływają na predyktor i wynik.
<ul>
<li><em>Przykład</em>: Osoby ćwiczące często jedzą zdrowiej, co wpływa na wyniki.</li>
<li><em>Rozwiązanie</em>: Randomizacja, stratyfikacja lub kontrola statystyczna.</li>
</ul></li>
</ul>
</section>
<section id="naruszenie-założeń" class="level4" data-number="2.28.4.2">
<h4 data-number="2.28.4.2" class="anchored" data-anchor-id="naruszenie-założeń"><span class="header-section-number">2.28.4.2</span> Naruszenie założeń</h4>
<ul>
<li><strong>Definicja</strong>: Stosowanie testów statystycznych niepasujących do charakterystyki danych.</li>
<li><strong>Przykład</strong>: Zakładanie normalnego rozkładu przy silnym skośności danych.</li>
<li><strong>Zapobieganie</strong>: Weryfikacja założeń przed analizą.</li>
</ul>
</section>
</section>
</section>
<section id="strategie-minimalizowania-błędów-statystycznych" class="level2" data-number="2.29">
<h2 data-number="2.29" class="anchored" data-anchor-id="strategie-minimalizowania-błędów-statystycznych"><span class="header-section-number">2.29</span> Strategie minimalizowania błędów statystycznych</h2>
<ol type="1">
<li><strong>Solidne projektowanie badań</strong>
<ul>
<li>Używanie odpowiednich metod próbkowania.</li>
<li>Randomizacja tam, gdzie to możliwe.</li>
<li>Kontrola zmiennych zakłócających.</li>
</ul></li>
<li><strong>Wystarczająca wielkość próby</strong>
<ul>
<li>Opieranie na analizie mocy.</li>
<li>Uwzględnianie znaczenia praktycznego, a nie tylko statystycznego.</li>
<li>Branie pod uwagę potencjalnych braków danych.</li>
</ul></li>
<li><strong>Przedrejestracja</strong>
<ul>
<li>Definiowanie planu analizy przed rozpoczęciem badań.</li>
<li>Określenie głównych wyników i metod.</li>
<li>Dokumentowanie wszelkich odstępstw od planu.</li>
</ul></li>
<li><strong>Przejrzystość</strong>
<ul>
<li>Udostępnianie danych i metod.</li>
<li>Jasna dokumentacja decyzji analitycznych.</li>
</ul></li>
<li><strong>Replikacja</strong>
<ul>
<li>Zachęcanie do niezależnej weryfikacji wyników.</li>
<li>Wspieranie powtórzeń badań.</li>
</ul></li>
<li><strong>Ciągłe kształcenie</strong>
<ul>
<li>Śledzenie najlepszych praktyk.</li>
<li>Przestrzeganie wytycznych danej dziedziny.</li>
<li>Angażowanie się w innowacje metodologiczne.</li>
</ul></li>
</ol>
<p>Zrozumienie i minimalizowanie błędów statystycznych zwiększa wiarygodność wyników badań, zapobiegając błędnym decyzjom w dziedzinach takich jak medycyna, polityka, edukacja i biznes.</p>
<hr>
</section>
<section id="appendices-additional-topics-in-statistics-and-data-science" class="level2" data-number="2.30">
<h2 data-number="2.30" class="anchored" data-anchor-id="appendices-additional-topics-in-statistics-and-data-science"><span class="header-section-number">2.30</span> Appendices: Additional Topics in Statistics and Data Science (*)</h2>
</section>
<section id="appendix-a-r-for-social-science-data-analysis" class="level2" data-number="2.31">
<h2 data-number="2.31" class="anchored" data-anchor-id="appendix-a-r-for-social-science-data-analysis"><span class="header-section-number">2.31</span> Appendix A: R for Social Science Data Analysis</h2>
<p>R offers powerful capabilities for social science research, from data manipulation to advanced statistical modeling.</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ lubridate 1.9.3     ✔ tibble    3.2.1
✔ purrr     1.0.2     ✔ tidyr     1.3.1
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate example data with a Simpson's Paradox</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_group =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Young"</span>, <span class="st">"Middle"</span>, <span class="st">"Old"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>)),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">education_years =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Young"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Middle"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">13</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Old"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">16</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">income =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Young"</span> <span class="sc">~</span> <span class="dv">70000</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> education_years <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5000</span>),</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Middle"</span> <span class="sc">~</span> <span class="dv">50000</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> education_years <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5000</span>),</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Old"</span> <span class="sc">~</span> <span class="dv">30000</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> education_years <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5000</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic data summary</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  age_group         education_years      income     
 Length:1000        Min.   : 6.628   Min.   :34068  
 Class :character   1st Qu.:10.913   1st Qu.:51508  
 Mode  :character   Median :13.004   Median :63376  
                    Mean   :12.986   Mean   :63307  
                    3rd Qu.:14.934   3rd Qu.:75023  
                    Max.   :18.861   Max.   :96620  </code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation analysis</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(data <span class="sc">%&gt;%</span> <span class="fu">select</span>(education_years, income))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                education_years     income
education_years       1.0000000 -0.8152477
income               -0.8152477  1.0000000</code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Overall trend (Simpson's Paradox)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>overall_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> education_years, <span class="at">y =</span> income)) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Overall Relationship between Education and Income"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Simpson's Paradox: Appears negative"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Years of Education"</span>, <span class="at">y =</span> <span class="st">"Income"</span>) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Trend by age group (Resolving Simpson's Paradox)</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>grouped_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> education_years, <span class="at">y =</span> income, <span class="at">color =</span> age_group)) <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relationship between Education and Income by Age Group"</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Resolving Simpson's Paradox: Positive relationship within groups"</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Years of Education"</span>, <span class="at">y =</span> <span class="st">"Income"</span>) <span class="sc">+</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(overall_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(grouped_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This example demonstrates Simpson’s Paradox, where the overall relationship between education and income appears negative, but when grouped by age, the relationship within each group is positive. This illustrates how critical it is to consider confounding variables in your analysis.</p>
</section>
<section id="appendix-b-causal-inference-vs.-observational-studies" class="level2" data-number="2.32">
<h2 data-number="2.32" class="anchored" data-anchor-id="appendix-b-causal-inference-vs.-observational-studies"><span class="header-section-number">2.32</span> Appendix B: Causal Inference vs.&nbsp;Observational Studies</h2>
<p>Understanding the relationship between variables is crucial in social sciences. Two key approaches are causal inference and observational studies, each with distinct strengths and limitations.</p>
<section id="causal-inference" class="level3" data-number="2.32.1">
<h3 data-number="2.32.1" class="anchored" data-anchor-id="causal-inference"><span class="header-section-number">2.32.1</span> Causal Inference</h3>
<ul>
<li>Aims to establish cause-and-effect relationships</li>
<li>Often involves experimental designs or advanced statistical techniques</li>
<li>Seeks to answer “What if?” questions and determine the impact of interventions</li>
<li>Examples: Randomized controlled trials, quasi-experimental designs, instrumental variables</li>
</ul>
</section>
<section id="observational-studies" class="level3" data-number="2.32.2">
<h3 data-number="2.32.2" class="anchored" data-anchor-id="observational-studies"><span class="header-section-number">2.32.2</span> Observational Studies</h3>
<ul>
<li>Examine relationships between variables without direct intervention</li>
<li>Rely on data collected from natural settings or existing datasets</li>
<li>Can identify correlations and patterns but struggle to establish causation</li>
<li>Examples: Cohort studies, case-control studies, cross-sectional surveys</li>
</ul>
<blockquote class="blockquote">
<p><strong>Important: Correlation Does Not Imply Causation</strong></p>
<ul>
<li><strong>Correlation</strong>: Measures the strength and direction of a relationship between variables</li>
<li><strong>Causation</strong>: Indicates that changes in one variable directly cause changes in another</li>
</ul>
<p>While strong correlations can suggest potential causal links, additional evidence and rigorous methods are required to establish causality.</p>
</blockquote>
</section>
<section id="challenges-in-establishing-causality" class="level3" data-number="2.32.3">
<h3 data-number="2.32.3" class="anchored" data-anchor-id="challenges-in-establishing-causality"><span class="header-section-number">2.32.3</span> Challenges in Establishing Causality</h3>
<ul>
<li><strong>Confounding variables</strong>: Unmeasured factors that affect both the presumed cause and effect</li>
<li><strong>Reverse causality</strong>: The presumed effect might actually be causing the presumed cause</li>
<li><strong>Selection bias</strong>: Non-random selection of subjects into study groups</li>
</ul>
</section>
<section id="methods-to-strengthen-causal-claims" class="level3" data-number="2.32.4">
<h3 data-number="2.32.4" class="anchored" data-anchor-id="methods-to-strengthen-causal-claims"><span class="header-section-number">2.32.4</span> Methods to Strengthen Causal Claims</h3>
<ol type="1">
<li>Randomized controlled trials (when ethical and feasible)</li>
<li>Natural experiments or quasi-experimental designs</li>
<li>Propensity score matching</li>
<li>Difference-in-differences analysis</li>
<li>Instrumental variable approaches</li>
<li>Directed acyclic graphs (DAGs) for visualizing causal relationships</li>
</ol>
<p>Understanding these distinctions is crucial in social sciences, where ethical considerations often limit experimental manipulation.</p>
</section>
</section>
<section id="appendix-c-understanding-spurious-correlations-confounders-and-colliders" class="level2" data-number="2.33">
<h2 data-number="2.33" class="anchored" data-anchor-id="appendix-c-understanding-spurious-correlations-confounders-and-colliders"><span class="header-section-number">2.33</span> Appendix C: Understanding Spurious Correlations, Confounders, and Colliders</h2>
<p>These concepts are essential for avoiding misinterpretations in statistical analysis. Let’s explore them with R examples.</p>
<div class="cell">
<details class="code-fold">
<summary>Load required libraries</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># for reproducibility</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="spurious-correlations" class="level3" data-number="2.33.1">
<h3 data-number="2.33.1" class="anchored" data-anchor-id="spurious-correlations"><span class="header-section-number">2.33.1</span> Spurious Correlations</h3>
<p>Spurious correlations are relationships between variables that appear to be causal but are actually coincidental or caused by an unseen third factor.</p>
<p><strong>Example: Ice Cream Sales and Drowning Incidents</strong></p>
<div class="cell">
<details class="code-fold">
<summary>R code for spurious correlation example</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>spurious_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ice_cream_sales =</span> <span class="dv">100</span> <span class="sc">+</span> <span class="dv">5</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">drowning_incidents =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the apparent correlation</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(spurious_data, <span class="fu">aes</span>(<span class="at">x =</span> ice_cream_sales, <span class="at">y =</span> drowning_incidents)) <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Spurious Correlation: Ice Cream Sales vs. Drowning"</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Ice Cream Sales"</span>, </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Drowning Incidents"</span>) <span class="sc">+</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the common cause</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(spurious_data, <span class="fu">aes</span>(<span class="at">x =</span> temperature)) <span class="sc">+</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> ice_cream_sales), <span class="at">color =</span> <span class="st">"#D55E00"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> drowning_incidents <span class="sc">*</span> <span class="dv">10</span>), <span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> ice_cream_sales), <span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#D55E00"</span>) <span class="sc">+</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> drowning_incidents <span class="sc">*</span> <span class="dv">10</span>), <span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Ice Cream Sales"</span>,</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="dv">10</span>, <span class="at">name =</span> <span class="st">"Drowning Incidents"</span>)</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Temperature as the Common Cause"</span>,</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Temperature (°C)"</span>) <span class="sc">+</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y.left =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#D55E00"</span>),</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y.right =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>)</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlation</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>cor_value <span class="ot">&lt;-</span> <span class="fu">cor</span>(spurious_data<span class="sc">$</span>ice_cream_sales, spurious_data<span class="sc">$</span>drowning_incidents)</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>R code for spurious correlation example</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>R code for spurious correlation example</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Correlation between ice cream sales and drowning incidents:"</span>, <span class="fu">round</span>(cor_value, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Correlation between ice cream sales and drowning incidents: 0.68</code></pre>
</div>
</div>
<p>In this example, temperature is the common cause (confounder) that influences both ice cream sales and drowning incidents. When we plot them against each other, they appear correlated (r ≈ 0.5), but this is spurious. The relationship disappears when we control for temperature.</p>
</section>
<section id="confounders" class="level3" data-number="2.33.2">
<h3 data-number="2.33.2" class="anchored" data-anchor-id="confounders"><span class="header-section-number">2.33.2</span> Confounders</h3>
<p>A confounder is a variable that influences both the dependent variable and independent variable, causing a spurious association.</p>
<p><strong>Example: Education, Income, and Age</strong></p>
<div class="cell">
<details class="code-fold">
<summary>R code for confounder example</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>confounder_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">runif</span>(n, <span class="dv">25</span>, <span class="dv">65</span>),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">education =</span> <span class="fu">round</span>(<span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> age <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">2</span>)),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">income =</span> <span class="dv">20000</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> education <span class="sc">+</span> <span class="dv">500</span> <span class="sc">*</span> age <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">5000</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create age groups for visualization</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>confounder_data <span class="ot">&lt;-</span> confounder_data <span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_group =</span> <span class="fu">cut</span>(age, <span class="at">breaks =</span> <span class="dv">3</span>, </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Young"</span>, <span class="st">"Middle"</span>, <span class="st">"Older"</span>)))</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Models with and without controlling for the confounder</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>model_naive <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> education, <span class="at">data =</span> confounder_data)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>model_adjusted <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> education <span class="sc">+</span> age, <span class="at">data =</span> confounder_data)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(confounder_data, <span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">y =</span> income)) <span class="sc">+</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> age), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> age_group, <span class="at">color =</span> <span class="fu">as.numeric</span>(age_group)), </span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Age"</span>, </span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">45</span>, <span class="dv">60</span>), </span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Young"</span>, <span class="st">"Middle"</span>, <span class="st">"Older"</span>)) <span class="sc">+</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Education vs Income, Confounded by Age"</span>,</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Without controlling for age: effect ="</span>, </span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">coef</span>(model_naive)[<span class="st">"education"</span>], <span class="dv">1</span>),</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"| With age control: effect ="</span>, </span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">coef</span>(model_adjusted)[<span class="st">"education"</span>], <span class="dv">1</span>)),</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Years of Education"</span>, </span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Income"</span>) <span class="sc">+</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this example, age is a confounder in the relationship between education and income. Without controlling for age, we overestimate the effect of education on income (the black line). When we examine the relationship within specific age groups (colored lines), we see a more accurate representation of the true effect.</p>
</section>
<section id="colliders" class="level3" data-number="2.33.3">
<h3 data-number="2.33.3" class="anchored" data-anchor-id="colliders"><span class="header-section-number">2.33.3</span> Colliders</h3>
<p>A collider is a variable that is influenced by both the independent variable and the dependent variable. Controlling for a collider can introduce a spurious correlation.</p>
<p><strong>Example: Job Satisfaction, Salary, and Work-Life Balance</strong></p>
<div class="cell">
<details class="code-fold">
<summary>R code for collider example</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>collider_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">job_satisfaction =</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">salary =</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Both job satisfaction and salary negatively affect work-life balance</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">work_life_balance =</span> <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> job_satisfaction <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> salary <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Without controlling for work-life balance</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>model_correct <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> job_satisfaction, <span class="at">data =</span> collider_data)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Incorrectly controlling for the collider</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>model_collider <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> job_satisfaction <span class="sc">+</span> work_life_balance, <span class="at">data =</span> collider_data)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(collider_data, <span class="fu">aes</span>(<span class="at">x =</span> job_satisfaction, <span class="at">y =</span> salary, </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> work_life_balance)) <span class="sc">+</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Work-Life</span><span class="sc">\n</span><span class="st">Balance"</span>) <span class="sc">+</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Job Satisfaction vs Salary, with Work-Life Balance as Collider"</span>,</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Without controlling: correlation ="</span>, </span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">coef</span>(model_correct)[<span class="st">"job_satisfaction"</span>], <span class="dv">3</span>),</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"| With control: correlation ="</span>, </span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">coef</span>(model_collider)[<span class="st">"job_satisfaction"</span>], <span class="dv">3</span>)),</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Job Satisfaction"</span>, </span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Salary"</span>) <span class="sc">+</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this example, there’s no inherent relationship between job satisfaction and salary (the black line shows near-zero correlation). However, both variables negatively impact work-life balance. If we control for work-life balance (the collider), we introduce a positive correlation between job satisfaction and salary that doesn’t actually exist.</p>
</section>
<section id="simpsons-paradox" class="level3" data-number="2.33.4">
<h3 data-number="2.33.4" class="anchored" data-anchor-id="simpsons-paradox"><span class="header-section-number">2.33.4</span> Simpson’s Paradox</h3>
<p>Simpson’s paradox occurs when a trend appears in different groups of data but disappears or reverses when these groups are combined.</p>
<p><strong>Example: Treatment Effectiveness Across Age Groups</strong></p>
<div class="cell">
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create example dataset</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>simpson_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_group =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Young"</span>, <span class="st">"Older"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.3</span>)),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Treatment A"</span>, <span class="st">"Treatment B"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Different recovery rates based on age and treatment</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovery_prob =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Young"</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">"Treatment A"</span> <span class="sc">~</span> <span class="fl">0.70</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Young"</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">"Treatment B"</span> <span class="sc">~</span> <span class="fl">0.80</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Older"</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">"Treatment A"</span> <span class="sc">~</span> <span class="fl">0.50</span>,</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Older"</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">"Treatment B"</span> <span class="sc">~</span> <span class="fl">0.40</span>,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># More older people get Treatment A</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="fu">if_else</span>(</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Older"</span> <span class="sc">&amp;</span> <span class="fu">runif</span>(n) <span class="sc">&lt;</span> <span class="fl">0.7</span>, </span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Treatment A"</span>, </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>      treatment</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate recovery outcomes</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovered =</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, recovery_prob)</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate data</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>overall_rates <span class="ot">&lt;-</span> simpson_data <span class="sc">%&gt;%</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_patients =</span> <span class="fu">n</span>(),</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovered_patients =</span> <span class="fu">sum</span>(recovered),</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovery_rate =</span> <span class="fu">mean</span>(recovered)</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>by_age_rates <span class="ot">&lt;-</span> simpson_data <span class="sc">%&gt;%</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment, age_group) <span class="sc">%&gt;%</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_patients =</span> <span class="fu">n</span>(),</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovered_patients =</span> <span class="fu">sum</span>(recovered),</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovery_rate =</span> <span class="fu">mean</span>(recovered)</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'treatment'. You can override using the
`.groups` argument.</code></pre>
</div>
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualization</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>overall_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(overall_rates, </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> recovery_rate, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(recovery_rate<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%"</span>)), </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Overall Recovery Rates"</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Simpson's Paradox: Treatment B appears worse overall"</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Recovery Rate"</span>) <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>by_age_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(by_age_rates, </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> recovery_rate, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(recovery_rate<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%"</span>)), </span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Recovery Rates by Age Group"</span>,</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Within each age group, Treatment B is actually better"</span>,</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Recovery Rate"</span>) <span class="sc">+</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>age_group) <span class="sc">+</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Display tables and plots</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(overall_rates, <span class="at">caption =</span> <span class="st">"Overall Recovery Rates by Treatment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Overall Recovery Rates by Treatment</caption>
<thead>
<tr class="header">
<th style="text-align: left;">treatment</th>
<th style="text-align: right;">total_patients</th>
<th style="text-align: right;">recovered_patients</th>
<th style="text-align: right;">recovery_rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Treatment A</td>
<td style="text-align: right;">594</td>
<td style="text-align: right;">356</td>
<td style="text-align: right;">0.5993266</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment B</td>
<td style="text-align: right;">406</td>
<td style="text-align: right;">297</td>
<td style="text-align: right;">0.7315271</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(by_age_rates, <span class="at">caption =</span> <span class="st">"Recovery Rates by Treatment and Age Group"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Recovery Rates by Treatment and Age Group</caption>
<colgroup>
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 21%">
<col style="width: 27%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">treatment</th>
<th style="text-align: left;">age_group</th>
<th style="text-align: right;">total_patients</th>
<th style="text-align: right;">recovered_patients</th>
<th style="text-align: right;">recovery_rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Treatment A</td>
<td style="text-align: left;">Older</td>
<td style="text-align: right;">240</td>
<td style="text-align: right;">116</td>
<td style="text-align: right;">0.4833333</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment A</td>
<td style="text-align: left;">Young</td>
<td style="text-align: right;">354</td>
<td style="text-align: right;">240</td>
<td style="text-align: right;">0.6779661</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Treatment B</td>
<td style="text-align: left;">Older</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0.4181818</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment B</td>
<td style="text-align: left;">Young</td>
<td style="text-align: right;">351</td>
<td style="text-align: right;">274</td>
<td style="text-align: right;">0.7806268</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(overall_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(by_age_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Simpson’s paradox is occurring here because:</p>
<ol type="1">
<li><strong>Within each age group</strong>: Treatment B has a higher recovery rate than Treatment A</li>
<li><strong>Overall</strong>: Treatment A appears to have a higher recovery rate than Treatment B</li>
</ol>
<p>This paradox happens because: - Treatment A is given more frequently to older patients - Older patients have lower recovery rates regardless of treatment - This skews the overall average to make Treatment A look better, even though Treatment B is better for both young and older patients</p>
</section>
<section id="directed-acyclic-graphs-dags" class="level3" data-number="2.33.5">
<h3 data-number="2.33.5" class="anchored" data-anchor-id="directed-acyclic-graphs-dags"><span class="header-section-number">2.33.5</span> Directed Acyclic Graphs (DAGs)</h3>
<p>DAGs are powerful tools for visualizing causal relationships and identifying potential biases in statistical analyses.</p>
<div class="cell">
<details class="code-fold">
<summary>R code for DAG examples</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Try to load dagitty and ggdag if available</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">"dagitty"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="sc">&amp;&amp;</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">requireNamespace</span>(<span class="st">"ggdag"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dagitty)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggdag)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example 1: Confounder</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  confounder_dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag {</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="st">    X -&gt; Y</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="st">    Z -&gt; X</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="st">    Z -&gt; Y</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="st">  }'</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example 2: Collider</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  collider_dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag {</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="st">    X -&gt; Z</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="st">    Y -&gt; Z</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="st">    X -- Y [unobserved]</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="st">  }'</span>)</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example 3: Simpson's Paradox</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>  simpson_dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag {</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="st">    Treatment -&gt; Recovery</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a><span class="st">    Age -&gt; Treatment</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="st">    Age -&gt; Recovery</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="st">  }'</span>)</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot the DAGs</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggdag</span>(confounder_dag) <span class="sc">+</span> </span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_dag</span>() <span class="sc">+</span> </span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Confounder (Z)"</span>)</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggdag</span>(collider_dag) <span class="sc">+</span> </span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_dag</span>() <span class="sc">+</span> </span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Collider (Z)"</span>)</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">ggdag</span>(simpson_dag) <span class="sc">+</span> </span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_dag</span>() <span class="sc">+</span> </span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Simpson's Paradox Structure"</span>)</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p1)</span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p2)</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p3)</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"DAG visualization packages not installed. Install dagitty and ggdag packages for these examples."</span>)</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggdag'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>DAGs help us visualize different causal structures:</p>
<ol type="1">
<li><strong>Confounder</strong>: A variable (Z) that affects both the exposure (X) and outcome (Y)</li>
<li><strong>Collider</strong>: A variable (Z) that is affected by both the exposure (X) and another variable (Y)</li>
<li><strong>Simpson’s Paradox</strong>: Often involves a confounder that influences both the treatment/exposure and the outcome</li>
</ol>
<p>Understanding these structures helps us decide which variables to control for in our analyses and which to leave out.</p>
</section>
</section>
<section id="appendix-d-models-in-science-from-deterministic-to-stochastic" class="level2" data-number="2.34">
<h2 data-number="2.34" class="anchored" data-anchor-id="appendix-d-models-in-science-from-deterministic-to-stochastic"><span class="header-section-number">2.34</span> Appendix D: Models in Science: From Deterministic to Stochastic</h2>
<p>Models are essential tools in scientific research, helping scientists to represent, understand, and predict complex phenomena.</p>
<section id="types-of-models" class="level3" data-number="2.34.1">
<h3 data-number="2.34.1" class="anchored" data-anchor-id="types-of-models"><span class="header-section-number">2.34.1</span> Types of Models</h3>
<section id="mathematical-models" class="level4" data-number="2.34.1.1">
<h4 data-number="2.34.1.1" class="anchored" data-anchor-id="mathematical-models"><span class="header-section-number">2.34.1.1</span> Mathematical Models</h4>
<p>Mathematical models use equations to describe and analyze systems. They can be divided into:</p>
<section id="deterministic-models" class="level5" data-number="2.34.1.1.1">
<h5 data-number="2.34.1.1.1" class="anchored" data-anchor-id="deterministic-models"><span class="header-section-number">2.34.1.1.1</span> Deterministic Models</h5>
<p>Deterministic models provide precise predictions based on a set of variables, without incorporating randomness.</p>
<p><strong>Example:</strong> Newton’s laws of motion, which can precisely predict the motion of objects under known forces:</p>
<p><span class="math display">x(t) = x_0 + v_0t + \frac{1}{2}at^2</span></p>
<p>Where <span class="math inline">x(t)</span> is the position at time <span class="math inline">t</span>, <span class="math inline">x_0</span> is the initial position, <span class="math inline">v_0</span> is the initial velocity, and <span class="math inline">a</span> is the acceleration.</p>
</section>
<section id="stochastic-models" class="level5" data-number="2.34.1.1.2">
<h5 data-number="2.34.1.1.2" class="anchored" data-anchor-id="stochastic-models"><span class="header-section-number">2.34.1.1.2</span> Stochastic Models</h5>
<p>Stochastic models incorporate randomness and probability. They come in two fundamentally different types:</p>
<p><strong>Classical Stochastic Models</strong>: Deal with randomness arising from incomplete information or complex interactions in classical systems. The underlying system is deterministic, but practical limitations lead to probabilistic descriptions.</p>
<p><strong>Example:</strong> Regression models in statistics, where the randomness represents unexplained variation:</p>
<p><span class="math display">y = \beta_0 + \beta_1x + \varepsilon</span></p>
<p>Where <span class="math inline">y</span> is the dependent variable, <span class="math inline">x</span> is the independent variable, <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1</span> are parameters, and <span class="math inline">\varepsilon</span> is the error term.</p>
<p><strong>Quantum Stochastic Models</strong>: Deal with the fundamental, irreducible randomness inherent in quantum mechanical systems.</p>
<p><strong>Example:</strong> The decay of a radioactive particle follows a probability distribution:</p>
<p><span class="math display">P(t) = e^{-t/\tau}</span></p>
<p>Where <span class="math inline">P(t)</span> is the probability that the particle has not decayed after time <span class="math inline">t</span>, and <span class="math inline">\tau</span> is the mean lifetime of the particle.</p>
</section>
</section>
<section id="other-model-types" class="level4" data-number="2.34.1.2">
<h4 data-number="2.34.1.2" class="anchored" data-anchor-id="other-model-types"><span class="header-section-number">2.34.1.2</span> Other Model Types</h4>
<ul>
<li><strong>Computer Simulation Models</strong>: Use algorithms to simulate complex systems</li>
<li><strong>Conceptual Models</strong>: Abstract representations using diagrams or flowcharts</li>
<li><strong>Physical Models</strong>: Tangible representations like scale models</li>
<li><strong>Theoretical Models</strong>: Abstract frameworks based on fundamental principles</li>
</ul>
</section>
</section>
<section id="model-error-and-bias-variance-tradeoff" class="level3" data-number="2.34.2">
<h3 data-number="2.34.2" class="anchored" data-anchor-id="model-error-and-bias-variance-tradeoff"><span class="header-section-number">2.34.2</span> Model Error and Bias-Variance Tradeoff</h3>
<p>All models involve some degree of error. Understanding the balance between bias and variance is crucial:</p>
<ul>
<li><strong>Bias</strong>: Systematic error from simplifying assumptions</li>
<li><strong>Variance</strong>: Error from sensitivity to small fluctuations in the training data</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/ModelError.png" class="img-fluid figure-img"></p>
<figcaption>Bias-Variance Tradeoff in Models</figcaption>
</figure>
</div>
<p>The ideal model balances complexity to minimize both bias and variance, leading to the best predictive performance.</p>
</section>
</section>
<section id="appendix-e-classical-vs-quantum-randomness" class="level2" data-number="2.35">
<h2 data-number="2.35" class="anchored" data-anchor-id="appendix-e-classical-vs-quantum-randomness"><span class="header-section-number">2.35</span> Appendix E: Classical vs Quantum Randomness</h2>
<p>To understand how randomness differs across scientific disciplines, we need to examine the origins and implications of different types of uncertainty.</p>
<section id="origin-of-randomness" class="level3" data-number="2.35.1">
<h3 data-number="2.35.1" class="anchored" data-anchor-id="origin-of-randomness"><span class="header-section-number">2.35.1</span> Origin of Randomness</h3>
<section id="classical-randomness-e.g.-regression-models" class="level4" data-number="2.35.1.1">
<h4 data-number="2.35.1.1" class="anchored" data-anchor-id="classical-randomness-e.g.-regression-models"><span class="header-section-number">2.35.1.1</span> Classical Randomness (e.g., Regression Models)</h4>
<ul>
<li><strong>Source</strong>: Incomplete information or complex interactions in an otherwise deterministic system</li>
<li><strong>Nature</strong>: Epistemic uncertainty (due to lack of knowledge)</li>
<li><strong>Example</strong>: In a regression model, the error term represents unexplained variation</li>
</ul>
</section>
<section id="quantum-randomness" class="level4" data-number="2.35.1.2">
<h4 data-number="2.35.1.2" class="anchored" data-anchor-id="quantum-randomness"><span class="header-section-number">2.35.1.2</span> Quantum Randomness</h4>
<ul>
<li><strong>Source</strong>: Fundamental property of quantum systems</li>
<li><strong>Nature</strong>: Ontic uncertainty (inherent to the system, not due to lack of knowledge)</li>
<li><strong>Example</strong>: The exact time of decay of a radioactive atom cannot be predicted</li>
</ul>
</section>
</section>
<section id="philosophical-implications" class="level3" data-number="2.35.2">
<h3 data-number="2.35.2" class="anchored" data-anchor-id="philosophical-implications"><span class="header-section-number">2.35.2</span> Philosophical Implications</h3>
<section id="classical-randomness" class="level4" data-number="2.35.2.1">
<h4 data-number="2.35.2.1" class="anchored" data-anchor-id="classical-randomness"><span class="header-section-number">2.35.2.1</span> Classical Randomness</h4>
<ul>
<li><strong>Determinism</strong>: Underlying reality is deterministic; randomness reflects our ignorance</li>
<li><strong>Hidden Variables</strong>: In principle, with complete information, we could predict outcomes precisely</li>
</ul>
</section>
<section id="quantum-randomness-1" class="level4" data-number="2.35.2.2">
<h4 data-number="2.35.2.2" class="anchored" data-anchor-id="quantum-randomness-1"><span class="header-section-number">2.35.2.2</span> Quantum Randomness</h4>
<ul>
<li><strong>Indeterminism</strong>: Randomness is a fundamental feature of reality</li>
<li><strong>No Hidden Variables</strong>: Even with complete information, some outcomes remain unpredictable (as suggested by Bell’s theorem)</li>
</ul>
</section>
</section>
<section id="practical-implications" class="level3" data-number="2.35.3">
<h3 data-number="2.35.3" class="anchored" data-anchor-id="practical-implications"><span class="header-section-number">2.35.3</span> Practical Implications</h3>
<section id="classical-randomness-1" class="level4" data-number="2.35.3.1">
<h4 data-number="2.35.3.1" class="anchored" data-anchor-id="classical-randomness-1"><span class="header-section-number">2.35.3.1</span> Classical Randomness</h4>
<ul>
<li><strong>Reducible</strong>: Can be reduced by gathering more data or improving measurement precision</li>
<li><strong>Controllable</strong>: Systematic errors can be identified and corrected</li>
</ul>
</section>
<section id="quantum-randomness-2" class="level4" data-number="2.35.3.2">
<h4 data-number="2.35.3.2" class="anchored" data-anchor-id="quantum-randomness-2"><span class="header-section-number">2.35.3.2</span> Quantum Randomness</h4>
<ul>
<li><strong>Irreducible</strong>: Cannot be eliminated even with perfect measurements</li>
<li><strong>Fundamentally Uncontrollable</strong>: The act of measurement itself affects the system</li>
</ul>
<p>Understanding these differences is crucial for correctly interpreting statistical models in different scientific contexts.</p>
</section>
</section>
</section>
<section id="appendix-f-ethical-considerations-in-social-science-data-analysis" class="level2" data-number="2.36">
<h2 data-number="2.36" class="anchored" data-anchor-id="appendix-f-ethical-considerations-in-social-science-data-analysis"><span class="header-section-number">2.36</span> Appendix F: Ethical Considerations in Social Science Data Analysis</h2>
<p>Ethics play a vital role in social science research. Key considerations include:</p>
<section id="privacy-and-consent" class="level3" data-number="2.36.1">
<h3 data-number="2.36.1" class="anchored" data-anchor-id="privacy-and-consent"><span class="header-section-number">2.36.1</span> 1. Privacy and Consent</h3>
<ul>
<li>Ensure participants understand how their data will be used</li>
<li>Obtain informed consent before collecting data</li>
<li>Protect personally identifiable information</li>
<li>Consider cultural differences in privacy expectations</li>
</ul>
</section>
<section id="data-protection" class="level3" data-number="2.36.2">
<h3 data-number="2.36.2" class="anchored" data-anchor-id="data-protection"><span class="header-section-number">2.36.2</span> 2. Data Protection</h3>
<ul>
<li>Securely store sensitive data</li>
<li>Implement appropriate access controls</li>
<li>Follow relevant regulations (e.g., GDPR, HIPAA)</li>
<li>Have a data management plan that includes secure disposal</li>
</ul>
</section>
<section id="bias-and-representation" class="level3" data-number="2.36.3">
<h3 data-number="2.36.3" class="anchored" data-anchor-id="bias-and-representation"><span class="header-section-number">2.36.3</span> 3. Bias and Representation</h3>
<ul>
<li>Address sampling bias that could exclude marginalized groups</li>
<li>Ensure diverse representation in research</li>
<li>Consider how variable definitions might reflect social biases</li>
<li>Be transparent about limitations in population coverage</li>
</ul>
</section>
<section id="transparency-and-reproducibility" class="level3" data-number="2.36.4">
<h3 data-number="2.36.4" class="anchored" data-anchor-id="transparency-and-reproducibility"><span class="header-section-number">2.36.4</span> 4. Transparency and Reproducibility</h3>
<ul>
<li>Clearly document research methods</li>
<li>Share code and data when possible</li>
<li>Pre-register studies when appropriate</li>
<li>Acknowledge limitations and potential biases</li>
</ul>
</section>
<section id="social-impact" class="level3" data-number="2.36.5">
<h3 data-number="2.36.5" class="anchored" data-anchor-id="social-impact"><span class="header-section-number">2.36.5</span> 5. Social Impact</h3>
<ul>
<li>Consider the potential societal implications of research findings</li>
<li>Avoid reinforcing harmful stereotypes</li>
<li>Think about how results might be misinterpreted or misused</li>
<li>Engage with communities being studied</li>
</ul>
<p>Ethical considerations should be integrated throughout the research process, from study design to data collection, analysis, and reporting of results.</p>
</section>
</section>
<section id="appendix-g-introduction-to-rstudio-and-the-tidyverse" class="level2" data-number="2.37">
<h2 data-number="2.37" class="anchored" data-anchor-id="appendix-g-introduction-to-rstudio-and-the-tidyverse"><span class="header-section-number">2.37</span> Appendix G: Introduction to RStudio and the tidyverse</h2>
<p>R is a powerful programming language for statistical computing and graphics. RStudio provides an integrated development environment that makes working with R easier.</p>
<section id="getting-started-with-rstudio" class="level3" data-number="2.37.1">
<h3 data-number="2.37.1" class="anchored" data-anchor-id="getting-started-with-rstudio"><span class="header-section-number">2.37.1</span> Getting Started with RStudio</h3>
<p>RStudio has four main panes:</p>
<ol type="1">
<li><strong>Source Editor</strong>: Where you write and edit your R scripts</li>
<li><strong>Console</strong>: Where you run R commands and see output</li>
<li><strong>Environment/History</strong>: Shows your workspace objects and command history</li>
<li><strong>Files/Plots/Packages/Help</strong>: For file management, viewing plots, managing packages, and accessing help</li>
</ol>
</section>
<section id="the-tidyverse-ecosystem" class="level3" data-number="2.37.2">
<h3 data-number="2.37.2" class="anchored" data-anchor-id="the-tidyverse-ecosystem"><span class="header-section-number">2.37.2</span> The tidyverse Ecosystem</h3>
<p>The tidyverse is a collection of R packages designed for data science with a consistent design philosophy.</p>
<p>Key packages include:</p>
<ul>
<li><strong>ggplot2</strong>: Data visualization</li>
<li><strong>dplyr</strong>: Data manipulation</li>
<li><strong>tidyr</strong>: Data tidying</li>
<li><strong>readr</strong>: Data import</li>
<li><strong>purrr</strong>: Functional programming</li>
<li><strong>tibble</strong>: Modern data frames</li>
</ul>
</section>
<section id="basic-tidyverse-workflow" class="level3" data-number="2.37.3">
<h3 data-number="2.37.3" class="anchored" data-anchor-id="basic-tidyverse-workflow"><span class="header-section-number">2.37.3</span> Basic tidyverse Workflow</h3>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load tidyverse</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"my_data.csv"</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean and transform</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(important_variable)) <span class="sc">%&gt;%</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(var1, var2, var3) <span class="sc">%&gt;%</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_var =</span> var1 <span class="sc">/</span> var2)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Group and summarize</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> cleaned_data <span class="sc">%&gt;%</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(category) <span class="sc">%&gt;%</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_val =</span> <span class="fu">mean</span>(var3),</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>()</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cleaned_data, <span class="fu">aes</span>(<span class="at">x =</span> var1, <span class="at">y =</span> var2, <span class="at">color =</span> category)) <span class="sc">+</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relationship between Variables"</span>,</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Variable 1"</span>,</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Variable 2"</span>) <span class="sc">+</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This workflow demonstrates the power of the tidyverse’s pipe operator (<code>%&gt;%</code>), which allows you to chain operations together in a readable way.</p>
</section>
<section id="resources-for-learning-r" class="level3" data-number="2.37.4">
<h3 data-number="2.37.4" class="anchored" data-anchor-id="resources-for-learning-r"><span class="header-section-number">2.37.4</span> Resources for Learning R</h3>
<ul>
<li><a href="https://r4ds.had.co.nz/">R for Data Science</a></li>
<li><a href="https://www.tidyverse.org/">tidyverse documentation</a></li>
<li><a href="https://www.rstudio.com/resources/cheatsheets/">RStudio Cheat Sheets</a></li>
<li><a href="https://quarto.org/docs/guide/">Quarto Guide</a></li>
</ul>
<p>The best way to learn R is through practice. Start with small, manageable projects and gradually build your skills.</p>
</section>
</section>
<section id="appendix-h-symulacja-centralnego-twierdzenia-granicznego" class="level2" data-number="2.38">
<h2 data-number="2.38" class="anchored" data-anchor-id="appendix-h-symulacja-centralnego-twierdzenia-granicznego"><span class="header-section-number">2.38</span> Appendix H: Symulacja Centralnego Twierdzenia Granicznego</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Załadowanie bibliotek</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ustawienie ziarna dla powtarzalności</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="czym-jest-centralne-twierdzenie-graniczne" class="level3" data-number="2.38.1">
<h3 data-number="2.38.1" class="anchored" data-anchor-id="czym-jest-centralne-twierdzenie-graniczne"><span class="header-section-number">2.38.1</span> Czym jest Centralne Twierdzenie Graniczne?</h3>
<p>Centralne Twierdzenie Graniczne (CTG) mówi, że <strong>średnie z prób losowych zbliżają się do rozkładu normalnego</strong> niezależnie od rozkładu populacji, gdy wielkość próby jest wystarczająco duża.</p>
</section>
<section id="prosty-eksperyment" class="level3" data-number="2.38.2">
<h3 data-number="2.38.2" class="anchored" data-anchor-id="prosty-eksperyment"><span class="header-section-number">2.38.2</span> Prosty eksperyment</h3>
<p>Zbadamy trzy różne rozkłady i zobaczymy, jak średnie z próby zbiegają do rozkładu normalnego.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parametry symulacji</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>wielkosci_prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">30</span>)  <span class="co"># Wielkości próby</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>liczba_symulacji <span class="ot">&lt;-</span> <span class="dv">1000</span>       <span class="co"># Liczba powtórzeń dla każdej wielkości próby</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie pustych ramek danych</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>dane_jednostajne <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>dane_wykladnicze <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>dane_dwupunktowe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Przeprowadzanie symulacji</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> wielkosci_prob) {</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rozkład jednostajny (0-1)</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  srednie_jedn <span class="ot">&lt;-</span> <span class="fu">replicate</span>(liczba_symulacji, <span class="fu">mean</span>(<span class="fu">runif</span>(n)))</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  dane_jednostajne <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dane_jednostajne, </span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">data.frame</span>(<span class="at">srednia =</span> srednie_jedn, </span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">wielkosc_proby =</span> <span class="fu">as.factor</span>(n)))</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rozkład wykładniczy (lambda=1)</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  srednie_wykl <span class="ot">&lt;-</span> <span class="fu">replicate</span>(liczba_symulacji, <span class="fu">mean</span>(<span class="fu">rexp</span>(n)))</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  dane_wykladnicze <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dane_wykladnicze, </span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">data.frame</span>(<span class="at">srednia =</span> srednie_wykl, </span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">wielkosc_proby =</span> <span class="fu">as.factor</span>(n)))</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rozkład dwupunktowy (0-1 z p=0.3)</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  srednie_dwup <span class="ot">&lt;-</span> <span class="fu">replicate</span>(liczba_symulacji, <span class="fu">mean</span>(<span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.3</span>)))</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  dane_dwupunktowe <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dane_dwupunktowe, </span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">data.frame</span>(<span class="at">srednia =</span> srednie_dwup, </span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">wielkosc_proby =</span> <span class="fu">as.factor</span>(n)))</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Funkcja do rysowania wykresów rozkładu populacji</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>rysuj_populacje <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rozkład jednostajny</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">runif</span>(<span class="dv">1000</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Rozkład Jednostajny"</span>, <span class="at">x =</span> <span class="st">"Wartość"</span>, <span class="at">y =</span> <span class="st">"Liczebność"</span>) <span class="sc">+</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rozkład wykładniczy</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rexp</span>(<span class="dv">1000</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"salmon"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Rozkład Wykładniczy"</span>, <span class="at">x =</span> <span class="st">"Wartość"</span>, <span class="at">y =</span> <span class="st">"Liczebność"</span>) <span class="sc">+</span></span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rozkład dwupunktowy</span></span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rbinom</span>(<span class="dv">1000</span>, <span class="dv">1</span>, <span class="fl">0.3</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"lightgreen"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Rozkład Dwupunktowy"</span>, <span class="at">x =</span> <span class="st">"Wartość"</span>, <span class="at">y =</span> <span class="st">"Liczebność"</span>) <span class="sc">+</span></span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Łączenie wykresów</span></span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>  p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Funkcja do rysowania wykresów rozkładu średnich</span></span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a>rysuj_srednie <span class="ot">&lt;-</span> <span class="cf">function</span>(dane, tytul, kolor) {</span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> srednia)) <span class="sc">+</span></span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">fill =</span> kolor, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>wielkosc_proby, <span class="at">scales =</span> <span class="st">"free_y"</span>, </span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">wielkosc_proby =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">"n ="</span>, x))) <span class="sc">+</span></span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> tytul, <span class="at">x =</span> <span class="st">"Średnia z próby"</span>, <span class="at">y =</span> <span class="st">"Liczebność"</span>) <span class="sc">+</span></span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="jak-wyglądają-nasze-populacje" class="level3" data-number="2.38.3">
<h3 data-number="2.38.3" class="anchored" data-anchor-id="jak-wyglądają-nasze-populacje"><span class="header-section-number">2.38.3</span> Jak wyglądają nasze populacje?</h3>
<p>Poniżej przedstawione są rozkłady trzech populacji, z których będziemy losować próby:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rysuj_populacje</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/populations-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Te trzy rozkłady są bardzo różne: - <strong>Rozkład jednostajny</strong>: wszystkie wartości między 0 a 1 są równie prawdopodobne - <strong>Rozkład wykładniczy</strong>: skośny, z długim “ogonem” po prawej stronie - <strong>Rozkład dwupunktowy</strong>: tylko dwie możliwe wartości (0 i 1)</p>
</section>
<section id="jak-zmieniają-się-rozkłady-średnich-z-próby" class="level3" data-number="2.38.4">
<h3 data-number="2.38.4" class="anchored" data-anchor-id="jak-zmieniają-się-rozkłady-średnich-z-próby"><span class="header-section-number">2.38.4</span> Jak zmieniają się rozkłady średnich z próby?</h3>
<section id="rozkład-jednostajny" class="level4" data-number="2.38.4.1">
<h4 data-number="2.38.4.1" class="anchored" data-anchor-id="rozkład-jednostajny"><span class="header-section-number">2.38.4.1</span> Rozkład Jednostajny</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rysuj_srednie</span>(dane_jednostajne, <span class="st">"Średnie z Rozkładu Jednostajnego"</span>, <span class="st">"skyblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/uniform_means-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rozkład-wykładniczy" class="level4" data-number="2.38.4.2">
<h4 data-number="2.38.4.2" class="anchored" data-anchor-id="rozkład-wykładniczy"><span class="header-section-number">2.38.4.2</span> Rozkład Wykładniczy</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rysuj_srednie</span>(dane_wykladnicze, <span class="st">"Średnie z Rozkładu Wykładniczego"</span>, <span class="st">"salmon"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/exponential_means-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rozkład-dwupunktowy" class="level4" data-number="2.38.4.3">
<h4 data-number="2.38.4.3" class="anchored" data-anchor-id="rozkład-dwupunktowy"><span class="header-section-number">2.38.4.3</span> Rozkład Dwupunktowy</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rysuj_srednie</span>(dane_dwupunktowe, <span class="st">"Średnie z Rozkładu Dwupunktowego"</span>, <span class="st">"lightgreen"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/binomial_means-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="porównanie-wszystkich-trzech-rozkładów-dla-n30" class="level3" data-number="2.38.5">
<h3 data-number="2.38.5" class="anchored" data-anchor-id="porównanie-wszystkich-trzech-rozkładów-dla-n30"><span class="header-section-number">2.38.5</span> Porównanie wszystkich trzech rozkładów dla n=30</h3>
<p>Zobaczmy teraz, jak wyglądają rozkłady średnich dla próby wielkości n=30 dla wszystkich trzech populacji:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Łączenie danych dla n=30</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>dane_30 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  dane_jednostajne <span class="sc">%&gt;%</span> <span class="fu">filter</span>(wielkosc_proby <span class="sc">==</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">rozklad =</span> <span class="st">"Jednostajny"</span>),</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  dane_wykladnicze <span class="sc">%&gt;%</span> <span class="fu">filter</span>(wielkosc_proby <span class="sc">==</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">rozklad =</span> <span class="st">"Wykładniczy"</span>),</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  dane_dwupunktowe <span class="sc">%&gt;%</span> <span class="fu">filter</span>(wielkosc_proby <span class="sc">==</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">rozklad =</span> <span class="st">"Dwupunktowy"</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Standaryzacja średnich</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>dane_30 <span class="ot">&lt;-</span> dane_30 <span class="sc">%&gt;%</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(rozklad) <span class="sc">%&gt;%</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">srednia_stand =</span> <span class="fu">case_when</span>(</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>      rozklad <span class="sc">==</span> <span class="st">"Jednostajny"</span> <span class="sc">~</span> (srednia <span class="sc">-</span> <span class="fl">0.5</span>) <span class="sc">/</span> (<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">12</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">30</span>)),</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>      rozklad <span class="sc">==</span> <span class="st">"Wykładniczy"</span> <span class="sc">~</span> (srednia <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">30</span>)),</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>      rozklad <span class="sc">==</span> <span class="st">"Dwupunktowy"</span> <span class="sc">~</span> (srednia <span class="sc">-</span> <span class="fl">0.3</span>) <span class="sc">/</span> (<span class="fu">sqrt</span>(<span class="fl">0.3</span><span class="sc">*</span><span class="fl">0.7</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">30</span>))</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres porównawczy</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane_30, <span class="fu">aes</span>(<span class="at">x =</span> srednia, <span class="at">fill =</span> rozklad)) <span class="sc">+</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">position =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>rozklad, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Porównanie Rozkładów Średnich dla n=30"</span>,</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Wszystkie rozkłady średnich zbliżają się do normalnego"</span>,</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Średnia z próby"</span>, <span class="at">y =</span> <span class="st">"Liczebność"</span>) <span class="sc">+</span></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Jednostajny"</span> <span class="ot">=</span> <span class="st">"skyblue"</span>, </span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Wykładniczy"</span> <span class="ot">=</span> <span class="st">"salmon"</span>, </span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Dwupunktowy"</span> <span class="ot">=</span> <span class="st">"lightgreen"</span>)) <span class="sc">+</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/comparison-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres po standaryzacji</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane_30, <span class="fu">aes</span>(<span class="at">x =</span> srednia_stand, <span class="at">fill =</span> rozklad)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>rozklad) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Standaryzowane Rozkłady Średnich"</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Po standaryzacji wszystkie rozkłady zbiegają do standardowego rozkładu normalnego N(0,1)"</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Standaryzowana średnia"</span>, <span class="at">y =</span> <span class="st">"Liczebność"</span>) <span class="sc">+</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Jednostajny"</span> <span class="ot">=</span> <span class="st">"skyblue"</span>, </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Wykładniczy"</span> <span class="ot">=</span> <span class="st">"salmon"</span>, </span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Dwupunktowy"</span> <span class="ot">=</span> <span class="st">"lightgreen"</span>)) <span class="sc">+</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/comparison-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="kluczowe-wnioski-1" class="level3" data-number="2.38.6">
<h3 data-number="2.38.6" class="anchored" data-anchor-id="kluczowe-wnioski-1"><span class="header-section-number">2.38.6</span> Kluczowe wnioski</h3>
<ol type="1">
<li><p><strong>Gdy n=1</strong>, rozkład średnich jest identyczny z rozkładem populacji.</p></li>
<li><p><strong>Gdy n rośnie</strong>, rozkład średnich:</p>
<ul>
<li>Staje się coraz bardziej normalny (dzwonowaty)</li>
<li>Skupia się wokół wartości oczekiwanej populacji</li>
<li>Ma coraz mniejszą wariancję</li>
</ul></li>
<li><p><strong>Niezależnie od rozkładu populacji</strong>, średnie z próby zbiegają do rozkładu normalnego.</p></li>
<li><p><strong>Po standaryzacji</strong> wszystkie rozkłady średnich zbiegają do standardowego rozkładu normalnego N(0,1).</p></li>
</ol>
<p>Ten efekt jest fundamentem wielu metod statystycznych, w tym: - Estymacji przedziałowej - Testów statystycznych - Kontroli jakości - Badań próbkowych</p>
</section>
</section>
<section id="appendix-i-symulacja-prawa-wielkich-liczb" class="level2" data-number="2.39">
<h2 data-number="2.39" class="anchored" data-anchor-id="appendix-i-symulacja-prawa-wielkich-liczb"><span class="header-section-number">2.39</span> Appendix I: Symulacja Prawa Wielkich Liczb</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Załadowanie wymaganych bibliotek</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ustawienie ziarna dla powtarzalności wyników</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="prawo-wielkich-liczb" class="level3" data-number="2.39.1">
<h3 data-number="2.39.1" class="anchored" data-anchor-id="prawo-wielkich-liczb"><span class="header-section-number">2.39.1</span> Prawo Wielkich Liczb</h3>
<p>Prawo Wielkich Liczb stwierdza, że wraz ze wzrostem liczby prób, średnia z próby zbiega do wartości oczekiwanej.</p>
<p><strong>Kluczowe pojęcia:</strong></p>
<ul>
<li><p><strong>Wartość oczekiwana:</strong> Teoretyczna średnia wyników, której spodziewamy się w losowym eksperymencie (0,5 dla uczciwej monety, 3,5 dla uczciwej kostki)</p></li>
<li><p><strong>Średnia z próby:</strong> Średnia z zaobserwowanych wyników z ograniczonej liczby prób</p></li>
<li><p><strong>Skumulowana proporcja/średnia:</strong> Bieżąca średnia liczona po każdej nowej obserwacji. Na przykład, po 3 rzutach monetą dających Orzeł, Reszka, Orzeł, skumulowane proporcje wynosiłyby:</p>
<ul>
<li>Po 1 rzucie: 1/1 = 1,0</li>
<li>Po 2 rzutach: (1+0)/2 = 0,5</li>
<li>Po 3 rzutach: (1+0+1)/3 = 0,67</li>
</ul></li>
</ul>
<p>Ta bieżąca średnia początkowo silnie się waha, ale stopniowo stabilizuje się wokół wartości oczekiwanej wraz z dodawaniem kolejnych obserwacji.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Zdefiniowanie parametrów symulacji</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>liczebnosci_prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>liczba_powtorzen <span class="ot">&lt;-</span> <span class="dv">20</span>  <span class="co"># Zmniejszona ze 100, aby pokazać większą zmienność</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="symulacja-rzutów-monetą" class="level3" data-number="2.39.2">
<h3 data-number="2.39.2" class="anchored" data-anchor-id="symulacja-rzutów-monetą"><span class="header-section-number">2.39.2</span> Symulacja Rzutów Monetą</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generowanie danych zarówno dla średnich z próby, jak i indywidualnych eksperymentów</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>wyniki_danych <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>indywidualne_eksperymenty <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Funkcja do wykonywania rzutów monetą</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>eksperyment_moneta <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  rzuty <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(rzuty)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Uruchomienie symulacji dla wszystkich liczebności prób</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (liczebnosc <span class="cf">in</span> liczebnosci_prob) {</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Dla każdej liczebności próby wykonaj wiele powtórzeń</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (powt <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>liczba_powtorzen) {</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Uruchomienie eksperymentu</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>    wynik <span class="ot">&lt;-</span> <span class="fu">eksperyment_moneta</span>(liczebnosc)</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Zapisanie wyniku</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    wyniki_danych <span class="ot">&lt;-</span> <span class="fu">rbind</span>(wyniki_danych, <span class="fu">data.frame</span>(</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">liczebnosc_proby =</span> liczebnosc,</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">proporcja =</span> wynik,</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">powtorzenie =</span> powt</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Utworzenie danych średniej skumulowanej dla 3 określonych liczebności próby</span></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (liczebnosc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)) {</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {  <span class="co"># Tylko 3 trajektorie dla zachowania czytelności</span></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set.seed</span>(i <span class="sc">*</span> <span class="dv">100</span> <span class="sc">+</span> liczebnosc)  <span class="co"># Różne ziarno dla każdej trajektorii</span></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>      rzuty <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">size =</span> liczebnosc, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>      srednie_skumulowane <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(rzuty) <span class="sc">/</span> <span class="fu">seq_along</span>(rzuty)</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>      indywidualne_eksperymenty <span class="ot">&lt;-</span> <span class="fu">rbind</span>(indywidualne_eksperymenty, <span class="fu">data.frame</span>(</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">numer_rzutu =</span> <span class="dv">1</span><span class="sc">:</span>liczebnosc,</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">srednia_skumulowana =</span> srednie_skumulowane,</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">liczebnosc_proby =</span> liczebnosc,</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">eksperyment =</span> <span class="fu">paste</span>(<span class="st">"Eksp"</span>, i)</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie średniego wyniku dla każdej liczebności próby</span></span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>dane_podsumowujace <span class="ot">&lt;-</span> wyniki_danych <span class="sc">%&gt;%</span></span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(liczebnosc_proby) <span class="sc">%&gt;%</span></span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">srednia_proporcja =</span> <span class="fu">mean</span>(proporcja),</span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_proporcja =</span> <span class="fu">min</span>(proporcja),</span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_proporcja =</span> <span class="fu">max</span>(proporcja)</span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="wizualizacja-zbieżności-do-wartości-oczekiwanej" class="level4" data-number="2.39.2.1">
<h4 data-number="2.39.2.1" class="anchored" data-anchor-id="wizualizacja-zbieżności-do-wartości-oczekiwanej"><span class="header-section-number">2.39.2.1</span> Wizualizacja Zbieżności do Wartości Oczekiwanej</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Utworzenie wykresu punktowego indywidualnych prób i linii średniej</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Wyniki indywidualnych eksperymentów (rozrzucone punkty)</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> wyniki_danych, </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> liczebnosc_proby, <span class="at">y =</span> proporcja),</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.05</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Linia średniej</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dane_podsumowujace, </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> liczebnosc_proby, <span class="at">y =</span> srednia_proporcja),</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> dane_podsumowujace, </span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> liczebnosc_proby, <span class="at">y =</span> srednia_proporcja),</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Wartość oczekiwana</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Teoretyczne granice (1/√n jest w przybliżeniu błędem standardowym dla rzutów monetą)</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> dane_podsumowujace,</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> liczebnosc_proby, </span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin =</span> <span class="fl">0.5</span> <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(liczebnosc_proby),</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> <span class="fl">0.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(liczebnosc_proby)),</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Formatowanie</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">breaks =</span> liczebnosci_prob) <span class="sc">+</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Symulacja Rzutów Monetą: Zbieżność do Wartości Oczekiwanej (0,5)"</span>,</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Każdy niebieski punkt to pojedynczy eksperyment; czerwona linia pokazuje średnią z eksperymentów"</span>,</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Liczba Rzutów Monetą (skala logarytmiczna)"</span>,</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proporcja Orłów"</span>) <span class="sc">+</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Powyższy wykres pokazuje:</p>
<ul>
<li><strong>Niebieskie punkty</strong>: Indywidualne eksperymenty (każdy z różną liczebnością próby)</li>
<li><strong>Czerwona linia</strong>: Średnia z eksperymentów dla każdej liczebności próby</li>
<li><strong>Czarna przerywana linia</strong>: Wartość oczekiwana (0,5)</li>
<li><strong>Szary obszar</strong>: Teoretyczne granice (±1/√n) - reprezentuje oczekiwany zakres wyników</li>
</ul>
<p>Zwróć uwagę, jak:</p>
<ol type="1">
<li>Indywidualne wyniki (niebieskie punkty) wykazują dużą zmienność przy małych próbach</li>
<li>Zmienność maleje wraz ze wzrostem liczebności próby</li>
<li>Średnia (czerwona linia) zbiega do wartości oczekiwanej</li>
<li>Większość wyników mieści się w teoretycznych granicach (szary obszar), które zwężają się wraz ze wzrostem liczebności próby</li>
</ol>
</section>
<section id="średnia-skumulowana-w-indywidualnych-eksperymentach" class="level4" data-number="2.39.2.2">
<h4 data-number="2.39.2.2" class="anchored" data-anchor-id="średnia-skumulowana-w-indywidualnych-eksperymentach"><span class="header-section-number">2.39.2.2</span> Średnia Skumulowana w Indywidualnych Eksperymentach</h4>
<p>Przyjrzyjmy się, jak zmienia się bieżąca średnia w ramach indywidualnych eksperymentów:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Utworzenie wykresu średnich skumulowanych</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(indywidualne_eksperymenty <span class="sc">%&gt;%</span> <span class="fu">filter</span>(liczebnosc_proby <span class="sc">==</span> <span class="dv">1000</span>), </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> numer_rzutu, <span class="at">y =</span> srednia_skumulowana, <span class="at">color =</span> eksperyment)) <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bieżąca Średnia dla 1000 Rzutów Monetą"</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Jak ewoluuje średnia rzut po rzucie"</span>,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Liczba Rzutów"</span>,</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Skumulowana Proporcja Orłów"</span>) <span class="sc">+</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Utworzenie przybliżonego widoku początkowych rzutów</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(indywidualne_eksperymenty <span class="sc">%&gt;%</span> <span class="fu">filter</span>(liczebnosc_proby <span class="sc">==</span> <span class="dv">1000</span>, numer_rzutu <span class="sc">&lt;=</span> <span class="dv">100</span>), </span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> numer_rzutu, <span class="at">y =</span> srednia_skumulowana, <span class="at">color =</span> eksperyment)) <span class="sc">+</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pierwsze 100 Rzutów (Przybliżony Widok)"</span>,</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Liczba Rzutów"</span>,</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Skumulowana Proporcja Orłów"</span>) <span class="sc">+</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">/</span> p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="symulacja-rzutów-kostką" class="level3" data-number="2.39.3">
<h3 data-number="2.39.3" class="anchored" data-anchor-id="symulacja-rzutów-kostką"><span class="header-section-number">2.39.3</span> Symulacja Rzutów Kostką</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Zresetowanie ramek danych</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>wyniki_danych <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>indywidualne_eksperymenty <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Funkcja do wykonywania rzutów kostką</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>eksperyment_kostka <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  rzuty <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(rzuty)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Uruchomienie symulacji dla wszystkich liczebności prób</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (liczebnosc <span class="cf">in</span> liczebnosci_prob) {</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Dla każdej liczebności próby wykonaj wiele powtórzeń</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (powt <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>liczba_powtorzen) {</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Uruchomienie eksperymentu</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    wynik <span class="ot">&lt;-</span> <span class="fu">eksperyment_kostka</span>(liczebnosc)</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Zapisanie wyniku</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    wyniki_danych <span class="ot">&lt;-</span> <span class="fu">rbind</span>(wyniki_danych, <span class="fu">data.frame</span>(</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">liczebnosc_proby =</span> liczebnosc,</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">srednia_wartosc =</span> wynik,</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">powtorzenie =</span> powt</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Utworzenie danych średniej skumulowanej tylko dla największej liczebności próby</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (liczebnosc <span class="sc">==</span> <span class="dv">1000</span>) {</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {  <span class="co"># Tylko 3 trajektorie</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set.seed</span>(i <span class="sc">*</span> <span class="dv">200</span> <span class="sc">+</span> liczebnosc)  <span class="co"># Różne ziarno dla każdej trajektorii</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>      rzuty <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> liczebnosc, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>      srednie_skumulowane <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(rzuty) <span class="sc">/</span> <span class="fu">seq_along</span>(rzuty)</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>      indywidualne_eksperymenty <span class="ot">&lt;-</span> <span class="fu">rbind</span>(indywidualne_eksperymenty, <span class="fu">data.frame</span>(</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">numer_rzutu =</span> <span class="dv">1</span><span class="sc">:</span>liczebnosc,</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">srednia_skumulowana =</span> srednie_skumulowane,</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">eksperyment =</span> <span class="fu">paste</span>(<span class="st">"Eksp"</span>, i)</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie średniego wyniku dla każdej liczebności próby</span></span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>dane_podsumowujace <span class="ot">&lt;-</span> wyniki_danych <span class="sc">%&gt;%</span></span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(liczebnosc_proby) <span class="sc">%&gt;%</span></span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">srednia_wartosc =</span> <span class="fu">mean</span>(srednia_wartosc),</span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_wartosc =</span> <span class="fu">min</span>(srednia_wartosc),</span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_wartosc =</span> <span class="fu">max</span>(srednia_wartosc)</span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="wizualizacja-zbieżności-rzutów-kostką" class="level4" data-number="2.39.3.1">
<h4 data-number="2.39.3.1" class="anchored" data-anchor-id="wizualizacja-zbieżności-rzutów-kostką"><span class="header-section-number">2.39.3.1</span> Wizualizacja Zbieżności Rzutów Kostką</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Utworzenie wykresu punktowego i linii średniej dla kostki</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Wyniki indywidualnych eksperymentów</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> wyniki_danych, </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> liczebnosc_proby, <span class="at">y =</span> srednia_wartosc),</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.05</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"tomato"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Linia średniej</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dane_podsumowujace, </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> liczebnosc_proby, <span class="at">y =</span> srednia_wartosc),</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> dane_podsumowujace, </span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> liczebnosc_proby, <span class="at">y =</span> srednia_wartosc),</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Wartość oczekiwana</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">3.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Formatowanie</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">breaks =</span> liczebnosci_prob) <span class="sc">+</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Symulacja Rzutów Kostką: Zbieżność do Wartości Oczekiwanej (3,5)"</span>,</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Każdy czerwony punkt to pojedynczy eksperyment; niebieska linia pokazuje średnią"</span>,</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Liczba Rzutów Kostką (skala logarytmiczna)"</span>,</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Średnia Wartość Kostki"</span>) <span class="sc">+</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Utworzenie wykresu średnich skumulowanych dla kostki</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(indywidualne_eksperymenty, </span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> numer_rzutu, <span class="at">y =</span> srednia_skumulowana, <span class="at">color =</span> eksperyment)) <span class="sc">+</span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">3.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bieżąca Średnia dla 1000 Rzutów Kostką"</span>,</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Liczba Rzutów"</span>,</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Skumulowana Średnia Wartość"</span>) <span class="sc">+</span></span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>p4 <span class="sc">/</span> p5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="kluczowe-wnioski-2" class="level3" data-number="2.39.4">
<h3 data-number="2.39.4" class="anchored" data-anchor-id="kluczowe-wnioski-2"><span class="header-section-number">2.39.4</span> Kluczowe Wnioski</h3>
<ol type="1">
<li>Indywidualne eksperymenty wykazują dużą zmienność przy małych liczebnościach próby</li>
<li>Średnia z eksperymentów zbiega do wartości oczekiwanej wraz ze wzrostem liczebności próby</li>
<li>W ramach każdego eksperymentu, bieżąca średnia ostatecznie stabilizuje się w pobliżu wartości oczekiwanej</li>
<li>Prawo wielkich liczb zapewnia zbieżność, ale nie gwarantuje dokładnej równości</li>
<li>Wczesne obserwacje mają nieproporcjonalnie duży wpływ na bieżącą średnią</li>
</ol>
</section>
<section id="zrozumienie-teoretycznych-granic-1n" class="level3" data-number="2.39.5">
<h3 data-number="2.39.5" class="anchored" data-anchor-id="zrozumienie-teoretycznych-granic-1n"><span class="header-section-number">2.39.5</span> Zrozumienie Teoretycznych Granic (±1/√n)</h3>
<p>Szary obszar na pierwszym wykresie reprezentuje teoretyczne granice (±1/√n), które pokazują oczekiwany zakres, w którym powinna znaleźć się większość wyników eksperymentalnych:</p>
<p><strong>Co reprezentują te granice:</strong></p>
<ul>
<li>Wywodzą się z Centralnego Twierdzenia Granicznego i przybliżają ±2 błędy standardowe</li>
<li>Dla uczciwej monety, błąd standardowy proporcji wynosi √[0,5×(1-0,5)/n] = 0,5/√n</li>
<li>Granice ±1/√n są uproszczeniem, które dobrze ilustruje zbieżność</li>
</ul>
<p><strong>Jak interpretować te granice:</strong></p>
<ul>
<li>Około 95% wyników eksperymentalnych powinno mieścić się w tych granicach</li>
<li>Wraz ze wzrostem liczebności próby (n), granice te przewidywalnie się zwężają:
<ul>
<li>Przy n=100: granice wynoszą 0,5 ± 0,1 (między 0,4 a 0,6)</li>
<li>Przy n=1000: granice wynoszą 0,5 ± 0,032 (między 0,468 a 0,532)</li>
<li>Przy n=10000: granice wynoszą 0,5 ± 0,01 (między 0,49 a 0,51)</li>
</ul></li>
</ul>
<p><strong>Dlaczego są ważne:</strong></p>
<ul>
<li>Stanowią wizualną reprezentację tego, jak zmienność maleje wraz z liczebnością próby</li>
<li>Ilustrują matematyczny aspekt Prawa Wielkich Liczb dotyczący tempa zbieżności</li>
<li>Pomagają przewidzieć, jakiej pewności możemy oczekiwać przy różnych liczebnościach próby</li>
</ul>
</section>
</section>
<section id="appendix-j-sample-size-determination-for-proportions" class="level2" data-number="2.40">
<h2 data-number="2.40" class="anchored" data-anchor-id="appendix-j-sample-size-determination-for-proportions"><span class="header-section-number">2.40</span> Appendix J: Sample Size Determination for Proportions</h2>
<p>When conducting research involving proportions (e.g., prevalence studies, opinion polls, or quality control), determining the appropriate sample size is crucial. This chapter explains how to calculate the sample size needed to estimate a population proportion with a specified margin of error.</p>
<section id="understanding-margin-of-error" class="level3" data-number="2.40.1">
<h3 data-number="2.40.1" class="anchored" data-anchor-id="understanding-margin-of-error"><span class="header-section-number">2.40.1</span> Understanding Margin of Error</h3>
<p>The margin of error (MOE) represents the maximum difference expected between the sample proportion and the true population proportion. It is typically expressed in percentage points (p.p.). For example, a margin of error of 5 p.p. means that if the sample proportion is 60%, we can be confident that the true population proportion is between 55% and 65%.</p>
</section>
<section id="the-sample-size-formula-for-proportions" class="level3" data-number="2.40.2">
<h3 data-number="2.40.2" class="anchored" data-anchor-id="the-sample-size-formula-for-proportions"><span class="header-section-number">2.40.2</span> The Sample Size Formula for Proportions</h3>
<p>To determine the required sample size for estimating a proportion with a specified margin of error, we use the following formula:</p>
<p><span class="math display">
n = \frac{z^2 \cdot p \cdot (1-p)}{E^2}
</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">n</span> is the required sample size</li>
<li><span class="math inline">z</span> is the z-score corresponding to the desired confidence level</li>
<li><span class="math inline">p</span> is the expected proportion</li>
<li><span class="math inline">E</span> is the margin of error in decimal form (e.g., 0.05 for 5 p.p.)</li>
</ul>
</section>
<section id="derivation-of-the-sample-size-formula" class="level3" data-number="2.40.3">
<h3 data-number="2.40.3" class="anchored" data-anchor-id="derivation-of-the-sample-size-formula"><span class="header-section-number">2.40.3</span> Derivation of the Sample Size Formula</h3>
<p>The formula for calculating sample size for a proportion is derived from the properties of the sampling distribution of a proportion and the structure of confidence intervals. Let’s derive this step-by-step:</p>
<section id="understanding-the-sampling-distribution" class="level4" data-number="2.40.3.1">
<h4 data-number="2.40.3.1" class="anchored" data-anchor-id="understanding-the-sampling-distribution"><span class="header-section-number">2.40.3.1</span> 1. Understanding the Sampling Distribution</h4>
<p>When we take random samples from a population and calculate the proportion <span class="math inline">\hat{p}</span> for each sample, these sample proportions follow a sampling distribution with:</p>
<ul>
<li>Mean equal to the true population proportion <span class="math inline">p</span></li>
<li>Standard error given by <span class="math inline">\sigma_{\hat{p}} = \sqrt{\frac{p(1-p)}{n}}</span></li>
</ul>
<p>For sufficiently large samples, this sampling distribution approximates a normal distribution (by the Central Limit Theorem).</p>
</section>
<section id="constructing-a-confidence-interval" class="level4" data-number="2.40.3.2">
<h4 data-number="2.40.3.2" class="anchored" data-anchor-id="constructing-a-confidence-interval"><span class="header-section-number">2.40.3.2</span> 2. Constructing a Confidence Interval</h4>
<p>A confidence interval for a proportion takes the form:</p>
<p><span class="math inline">\hat{p} \pm z \cdot \sigma_{\hat{p}}</span></p>
<p>Where <span class="math inline">z</span> is the critical value from the standard normal distribution corresponding to our desired confidence level.</p>
<p>Substituting the standard error formula:</p>
<p><span class="math inline">\hat{p} \pm z \cdot \sqrt{\frac{p(1-p)}{n}}</span></p>
</section>
<section id="defining-the-margin-of-error" class="level4" data-number="2.40.3.3">
<h4 data-number="2.40.3.3" class="anchored" data-anchor-id="defining-the-margin-of-error"><span class="header-section-number">2.40.3.3</span> 3. Defining the Margin of Error</h4>
<p>The margin of error <span class="math inline">E</span> is the second part of this expression:</p>
<p><span class="math inline">E = z \cdot \sqrt{\frac{p(1-p)}{n}}</span></p>
</section>
<section id="solving-for-sample-size" class="level4" data-number="2.40.3.4">
<h4 data-number="2.40.3.4" class="anchored" data-anchor-id="solving-for-sample-size"><span class="header-section-number">2.40.3.4</span> 4. Solving for Sample Size</h4>
<p>To find the required sample size, we rearrange this equation to solve for <span class="math inline">n</span>:</p>
<p><span class="math display">
\begin{align}
E &amp;= z \cdot \sqrt{\frac{p(1-p)}{n}} \\
E^2 &amp;= z^2 \cdot \frac{p(1-p)}{n} \\
n \cdot E^2 &amp;= z^2 \cdot p(1-p) \\
n &amp;= \frac{z^2 \cdot p(1-p)}{E^2}
\end{align}
</span></p>
<p>This gives us our sample size formula. The formula tells us how many observations we need to estimate a population proportion with a specified margin of error at a given confidence level.</p>
</section>
<section id="assumptions-and-considerations" class="level4" data-number="2.40.3.5">
<h4 data-number="2.40.3.5" class="anchored" data-anchor-id="assumptions-and-considerations"><span class="header-section-number">2.40.3.5</span> 5. Assumptions and Considerations</h4>
<p>This derivation assumes: - Simple random sampling - The population is large relative to the sample (when this is not true, we need the finite population correction) - The sample size is large enough for the normal approximation to be valid (<span class="math inline">np \geq 5</span> and <span class="math inline">n(1-p) \geq 5</span>)</p>
<p>If these assumptions are met, the formula provides a reliable estimate of the sample size needed to achieve the desired precision.</p>
</section>
</section>
<section id="selecting-the-confidence-level" class="level3" data-number="2.40.4">
<h3 data-number="2.40.4" class="anchored" data-anchor-id="selecting-the-confidence-level"><span class="header-section-number">2.40.4</span> Selecting the Confidence Level</h3>
<p>The confidence level represents how confident we want to be that our interval contains the true population parameter. Common confidence levels include:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Confidence Level</th>
<th>Z-score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>90%</td>
<td>1.645</td>
</tr>
<tr class="even">
<td>95%</td>
<td>1.96</td>
</tr>
<tr class="odd">
<td>99%</td>
<td>2.576</td>
</tr>
</tbody>
</table>
<p>For most applications, a 95% confidence level is standard, giving us a z-score of 1.96.</p>
</section>
<section id="estimating-the-expected-proportion" class="level3" data-number="2.40.5">
<h3 data-number="2.40.5" class="anchored" data-anchor-id="estimating-the-expected-proportion"><span class="header-section-number">2.40.5</span> Estimating the Expected Proportion</h3>
<p>The expected proportion <span class="math inline">p</span> is our best guess of the population proportion before collecting data. There are several approaches to determining this value:</p>
<ol type="1">
<li><strong>Use prior studies</strong>: If similar research exists, use the proportion found in those studies.</li>
<li><strong>Conduct a pilot study</strong>: Collect data from a small initial sample to estimate the proportion.</li>
<li><strong>Use 0.5 if unknown</strong>: When no information is available, using <span class="math inline">p = 0.5</span> provides the most conservative estimate (largest sample size).</li>
</ol>
</section>
<section id="step-by-step-example-calculating-sample-size-with-5-p.p.-error" class="level3" data-number="2.40.6">
<h3 data-number="2.40.6" class="anchored" data-anchor-id="step-by-step-example-calculating-sample-size-with-5-p.p.-error"><span class="header-section-number">2.40.6</span> Step-by-Step Example: Calculating Sample Size with 5 p.p. Error</h3>
<p>Let’s work through an example to estimate the sample size needed for a survey with a 5 percentage point margin of error:</p>
<p><strong>Example</strong>: A researcher wants to estimate the proportion of adults who support a new public policy. How many people should be surveyed to estimate this proportion with a margin of error of 5 percentage points at a 95% confidence level?</p>
<p><strong>Step 1</strong>: Define the parameters. - Margin of error (<span class="math inline">E</span>) = 0.05 (5 p.p.) - Confidence level = 95%, so <span class="math inline">z = 1.96</span> - Expected proportion (<span class="math inline">p</span>) = 0.5 (conservative estimate as we don’t have prior information)</p>
<p><strong>Step 2</strong>: Apply the formula.</p>
<p><span class="math display">
\begin{align}
n &amp;= \frac{z^2 \cdot p \cdot (1-p)}{E^2} \\
&amp;= \frac{1.96^2 \cdot 0.5 \cdot (1-0.5)}{0.05^2} \\
&amp;= \frac{1.96^2 \cdot 0.5 \cdot 0.5}{0.0025} \\
&amp;= \frac{3.8416 \cdot 0.25}{0.0025} \\
&amp;= \frac{0.9604}{0.0025} \\
&amp;= 384.16
\end{align}
</span></p>
<p><strong>Step 3</strong>: Round up to the nearest whole number.</p>
<p><span class="math display">n = 385</span></p>
<p>Therefore, the researcher should survey at least 385 adults to estimate the proportion with the desired precision.</p>
</section>
<section id="sample-size-for-different-precision-levels" class="level3" data-number="2.40.7">
<h3 data-number="2.40.7" class="anchored" data-anchor-id="sample-size-for-different-precision-levels"><span class="header-section-number">2.40.7</span> Sample Size for Different Precision Levels</h3>
<p>The following table shows the required sample size for various margins of error, assuming a 95% confidence level and the most conservative estimate of <span class="math inline">p = 0.5</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Margin of Error (p.p.)</th>
<th>Required Sample Size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>9,604</td>
</tr>
<tr class="even">
<td>2</td>
<td>2,401</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1,068</td>
</tr>
<tr class="even">
<td>4</td>
<td>601</td>
</tr>
<tr class="odd">
<td>5</td>
<td>385</td>
</tr>
<tr class="even">
<td>6</td>
<td>267</td>
</tr>
<tr class="odd">
<td>7</td>
<td>196</td>
</tr>
<tr class="even">
<td>8</td>
<td>150</td>
</tr>
<tr class="odd">
<td>9</td>
<td>119</td>
</tr>
<tr class="even">
<td>10</td>
<td>97</td>
</tr>
</tbody>
</table>
</section>
<section id="adjusting-for-known-expected-proportions" class="level3" data-number="2.40.8">
<h3 data-number="2.40.8" class="anchored" data-anchor-id="adjusting-for-known-expected-proportions"><span class="header-section-number">2.40.8</span> Adjusting for Known Expected Proportions</h3>
<p>If you have a more precise estimate for the expected proportion, you can often reduce the required sample size. For example, if you expect the proportion to be around 20% (or 80%), the calculation would be:</p>
<p><span class="math display">
\begin{align}
n &amp;= \frac{1.96^2 \cdot 0.2 \cdot (1-0.2)}{0.05^2} \\
&amp;= \frac{3.8416 \cdot 0.2 \cdot 0.8}{0.0025} \\
&amp;= \frac{0.614656}{0.0025} \\
&amp;= 246
\end{align}
</span></p>
<p>This represents a substantial reduction from the 385 required when using <span class="math inline">p = 0.5</span>.</p>
</section>
<section id="adjusting-for-finite-populations" class="level3" data-number="2.40.9">
<h3 data-number="2.40.9" class="anchored" data-anchor-id="adjusting-for-finite-populations"><span class="header-section-number">2.40.9</span> Adjusting for Finite Populations</h3>
<p>The formula provided assumes an infinite or very large population. If the population is small relative to the sample size, we can apply a finite population correction:</p>
<p><span class="math display">
n_{adjusted} = \frac{n}{1 + \frac{n-1}{N}}
</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">n_{adjusted}</span> is the adjusted sample size</li>
<li><span class="math inline">n</span> is the sample size calculated using the standard formula</li>
<li><span class="math inline">N</span> is the population size</li>
</ul>
<p><strong>Example</strong>: If the population of interest consists of 1,000 individuals and our calculated sample size is 385, the adjusted sample size would be:</p>
<p><span class="math display">
\begin{align}
n_{adjusted} &amp;= \frac{385}{1 + \frac{385-1}{1000}} \\
&amp;= \frac{385}{1 + \frac{384}{1000}} \\
&amp;= \frac{385}{1 + 0.384} \\
&amp;= \frac{385}{1.384} \\
&amp;= 278
\end{align}
</span></p>
</section>
<section id="practical-considerations" class="level3" data-number="2.40.10">
<h3 data-number="2.40.10" class="anchored" data-anchor-id="practical-considerations"><span class="header-section-number">2.40.10</span> Practical Considerations</h3>
<ol type="1">
<li><p><strong>Non-response adjustment</strong>: In practice, not everyone will respond to your survey. If you expect a response rate of 70%, divide your calculated sample size by 0.7 to determine how many people to contact.</p></li>
<li><p><strong>Stratified sampling</strong>: If your population has distinct subgroups that you want to analyze separately, you may need to calculate the sample size for each stratum.</p></li>
<li><p><strong>Budget constraints</strong>: If the calculated sample size exceeds your resources, consider:</p>
<ul>
<li>Accepting a larger margin of error</li>
<li>Reducing the confidence level</li>
<li>Using stratified sampling to focus on key subgroups</li>
</ul></li>
</ol>
</section>
<section id="implementing-in-r" class="level3" data-number="2.40.11">
<h3 data-number="2.40.11" class="anchored" data-anchor-id="implementing-in-r"><span class="header-section-number">2.40.11</span> Implementing in R</h3>
<p>The following R code calculates the required sample size for estimating a proportion:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate sample size for a proportion</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>proportion_sample_size <span class="ot">&lt;-</span> <span class="cf">function</span>(margin_error, <span class="at">conf_level =</span> <span class="fl">0.95</span>, <span class="at">p =</span> <span class="fl">0.5</span>, <span class="at">pop_size =</span> <span class="cn">NULL</span>) {</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert margin of error from percentage points to proportion</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  E <span class="ot">&lt;-</span> margin_error<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get z-score for the confidence level</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> conf_level)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate initial sample size</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> (z<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> p <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>p)) <span class="sc">/</span> E<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply finite population correction if population size is provided</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(pop_size)) {</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> n <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> (n<span class="dv">-1</span>)<span class="sc">/</span>pop_size)</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Round up to the nearest whole number</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ceiling</span>(n))</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="fu">proportion_sample_size</span>(<span class="at">margin_error =</span> <span class="dv">5</span>, <span class="at">conf_level =</span> <span class="fl">0.95</span>)</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Required sample size:"</span>, sample_size))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Required sample size: 385"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a table of sample sizes for different margins of error</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>margins <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>sizes <span class="ot">&lt;-</span> <span class="fu">sapply</span>(margins, proportion_sample_size, <span class="at">conf_level =</span> <span class="fl">0.95</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>sample_size_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Margin of Error (p.p.)"</span> <span class="ot">=</span> margins,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Required Sample Size"</span> <span class="ot">=</span> sizes</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sample_size_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Margin.of.Error..p.p.. Required.Sample.Size
1                       1                 9604
2                       2                 2401
3                       3                 1068
4                       4                  601
5                       5                  385
6                       6                  267
7                       7                  196
8                       8                  151
9                       9                  119
10                     10                   97</code></pre>
</div>
</div>
</section>
<section id="conclusion" class="level3" data-number="2.40.12">
<h3 data-number="2.40.12" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">2.40.12</span> Conclusion</h3>
<p>Determining the appropriate sample size is a critical step in research design. By using the formulas and methods described in this chapter, you can ensure that your study has sufficient statistical power to draw meaningful conclusions about population proportions.</p>
<p>Remember that while this chapter focuses on the statistical aspects of sample size determination, practical considerations such as budget, time constraints, and feasibility are also important factors to consider in research planning.</p>
</section>
<section id="exercises" class="level3" data-number="2.40.13">
<h3 data-number="2.40.13" class="anchored" data-anchor-id="exercises"><span class="header-section-number">2.40.13</span> Exercises</h3>
<ol type="1">
<li><p>Calculate the sample size needed to estimate the proportion of voters who favor a particular candidate with a margin of error of 3 p.p. at a 99% confidence level.</p></li>
<li><p>A researcher wants to estimate the prevalence of a disease in a population of 5,000 people. If the expected prevalence is about 15% and the desired margin of error is 4 p.p. with 95% confidence, what sample size should be used?</p></li>
<li><p>How does the required sample size change if the expected proportion changes from 0.5 to 0.1? Calculate and compare the sample sizes for a 5 p.p. margin of error at 95% confidence.</p></li>
<li><p>Create a plot showing how sample size requirements change as the margin of error decreases from 10 p.p. to 1 p.p.</p></li>
</ol>
<hr>
</section>
</section>
<section id="appendix-g-treści-uzupełniające" class="level2" data-number="2.41">
<h2 data-number="2.41" class="anchored" data-anchor-id="appendix-g-treści-uzupełniające"><span class="header-section-number">2.41</span> Appendix G: Treści uzupełniające (*)</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Popularne Symbole Stosowane w Statystyce
</div>
</div>
<div class="callout-body-container callout-body">
<p>Oto tabela referencyjna często używanych symboli:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 41%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th>Symbol</th>
<th>Opis</th>
<th>Przykład</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">n</span></td>
<td>Liczebność próby (liczba obserwacji w próbie)</td>
<td>“Zebraliśmy dane od <span class="math inline">n = 30</span> uczestników”</td>
</tr>
<tr class="even">
<td><span class="math inline">N</span></td>
<td>Liczebność populacji (całkowita liczba jednostek w populacji)</td>
<td>“Miasto ma <span class="math inline">N = 5000</span> mieszkańców”</td>
</tr>
<tr class="odd">
<td><span class="math inline">\bar{x}</span></td>
<td>Średnia z próby (średnia obserwacji w próbie)</td>
<td>“<span class="math inline">\bar{x} = 25,3</span> lat”</td>
</tr>
<tr class="even">
<td><span class="math inline">\mu</span></td>
<td>Średnia populacji (średnia wartość w całej populacji)</td>
<td>“Średni wzrost w populacji to <span class="math inline">\mu = 175</span> cm”</td>
</tr>
<tr class="odd">
<td><span class="math inline">s</span></td>
<td>Odchylenie standardowe z próby</td>
<td>“Odchylenie standardowe w próbie wynosi <span class="math inline">s = 4,2</span> punktu”</td>
</tr>
<tr class="even">
<td><span class="math inline">s^2</span></td>
<td>Wariancja z próby</td>
<td>“Wariancja w próbie wynosi <span class="math inline">s^2 = 17,64</span> kwadratu punktu”</td>
</tr>
<tr class="odd">
<td><span class="math inline">\sigma</span></td>
<td>Odchylenie standardowe populacji</td>
<td>“Odchylenie standardowe populacji wynosi <span class="math inline">\sigma = 15</span> minut”</td>
</tr>
<tr class="even">
<td><span class="math inline">\sigma^2</span></td>
<td>Wariancja populacji</td>
<td>“Wariancja populacji wynosi <span class="math inline">\sigma^2 = 225</span> kwadratów minut”</td>
</tr>
<tr class="odd">
<td><span class="math inline">\hat{p}</span></td>
<td>Frakcja w próbie</td>
<td>“<span class="math inline">\hat{p} = 0,35</span> respondentów zgodziło się”</td>
</tr>
<tr class="even">
<td><span class="math inline">p</span></td>
<td>Frakcja w populacji</td>
<td>“Prawdziwa proporcja <span class="math inline">p</span> osób leworęcznych”</td>
</tr>
<tr class="odd">
<td><span class="math inline">H_0</span></td>
<td>Hipoteza zerowa</td>
<td>“<span class="math inline">H_0: \mu = 100</span>”</td>
</tr>
<tr class="even">
<td><span class="math inline">H_1</span> lub <span class="math inline">H_a</span></td>
<td>Hipoteza alternatywna</td>
<td>“<span class="math inline">H_1: \mu \neq 100</span>”</td>
</tr>
<tr class="odd">
<td><span class="math inline">\alpha</span></td>
<td>Poziom istotności (prawdopodobieństwo błędu I rodzaju)</td>
<td>“Zastosowaliśmy <span class="math inline">\alpha = 0,05</span> w naszym teście”</td>
</tr>
<tr class="even">
<td><span class="math inline">\beta</span></td>
<td>Prawdopodobieństwo błędu II rodzaju</td>
<td>“Test miał <span class="math inline">\beta = 0,2</span>”</td>
</tr>
<tr class="odd">
<td><span class="math inline">1-\beta</span></td>
<td>Moc statystyczna</td>
<td>“Test miał moc <span class="math inline">1-\beta = 0,8</span>”</td>
</tr>
<tr class="even">
<td><span class="math inline">\sum</span></td>
<td>Suma</td>
<td>“<span class="math inline">\sum_{i=1}^{n} x_i</span> oznacza dodanie wszystkich wartości od <span class="math inline">x_1</span> do <span class="math inline">x_n</span>”</td>
</tr>
<tr class="odd">
<td><span class="math inline">\rho</span></td>
<td>Współczynnik korelacji w populacji</td>
<td>“Korelacja w populacji wynosi <span class="math inline">\rho = 0,75</span>”</td>
</tr>
<tr class="even">
<td><span class="math inline">r</span></td>
<td>Współczynnik korelacji w próbie</td>
<td>“Korelacja w próbie wynosi <span class="math inline">r = 0,72</span>”</td>
</tr>
<tr class="odd">
<td><span class="math inline">df</span></td>
<td>Stopnie swobody</td>
<td>“Test <span class="math inline">t</span> miał <span class="math inline">df = 29</span>”</td>
</tr>
<tr class="even">
<td><span class="math inline">SE</span></td>
<td>Błąd standardowy</td>
<td>“<span class="math inline">SE(\bar{x}) = \frac{s}{\sqrt{n}}</span>”</td>
</tr>
<tr class="odd">
<td><span class="math inline">CI</span></td>
<td>Przedział ufności</td>
<td>“95% <span class="math inline">CI = [42,1, 45,7]</span>”</td>
</tr>
<tr class="even">
<td><span class="math inline">\hat{\theta}</span></td>
<td>Ogólna notacja dla estymatora parametru <span class="math inline">\theta</span></td>
<td>“<span class="math inline">\hat{\theta}</span> to nasz estymator”</td>
</tr>
</tbody>
</table>
<p>Przy czytaniu wzorów i pojęć statystycznych zwracaj zawsze uwagę na rozróżnienie między:</p>
<ul>
<li><strong>Statystykami z próby</strong> (zazwyczaj litery łacińskie: <span class="math inline">\bar{x}</span>, <span class="math inline">s</span>, <span class="math inline">r</span>)</li>
<li><strong>Parametrami populacji</strong> (zazwyczaj litery greckie: <span class="math inline">\mu</span>, <span class="math inline">\sigma</span>, <span class="math inline">\rho</span>)</li>
</ul>
<p>Ta konwencja pomaga wyjaśnić, czy mówimy o wartości obliczonej z naszych danych z próby, czy o prawdziwej (zwykle nieznanej) charakterystyce całej populacji.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Jak przechowywane są dane w Data Science?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Data scientists (analitycy danych) korzystają z różnych sposobów przechowywania danych. Oto najpopularniejsze z nich:</p>
<hr>
<section id="pliki-csv" class="level3" data-number="2.41.1">
<h3 data-number="2.41.1" class="anchored" data-anchor-id="pliki-csv"><span class="header-section-number">2.41.1</span> <strong>Pliki CSV</strong></h3>
<p>To proste pliki tekstowe, w których dane są zapisane w wierszach, a wartości oddzielone przecinkami.</p>
<ul>
<li><strong>Plusy</strong>:
<ul>
<li>Łatwe do otwarcia i edycji nawet w zwykłym notatniku.</li>
<li>Działają z większością programów do analizy danych.</li>
<li>Proste do udostępniania innym.</li>
</ul></li>
<li><strong>Minusy</strong>:
<ul>
<li>Nie nadają się do przechowywania skomplikowanych danych (np. zdjęć czy filmów).</li>
<li>Mogą być wolne w pracy z bardzo dużymi zbiorami danych.</li>
<li>Czasem pojawiają się problemy z polskimi znakami.</li>
</ul></li>
</ul>
<hr>
</section>
<section id="bazy-danych-sql" class="level3" data-number="2.41.2">
<h3 data-number="2.41.2" class="anchored" data-anchor-id="bazy-danych-sql"><span class="header-section-number">2.41.2</span> <strong>Bazy Danych SQL</strong></h3>
<p>To zaawansowane systemy do przechowywania danych w tabelach, które mogą być ze sobą powiązane.</p>
<ul>
<li><strong>Plusy</strong>:
<ul>
<li>Idealne do zarządzania skomplikowanymi danymi (np. zamówieniami i klientami).</li>
<li>Szybkie wyszukiwanie i analiza danych.</li>
<li>Bezpieczeństwo i niezawodność.</li>
</ul></li>
<li><strong>Minusy</strong>:
<ul>
<li>Wymagają więcej wiedzy do zarządzania.</li>
<li>Trudniejsze w dostosowaniu do zmian w strukturze danych.</li>
<li>Mogą być kosztowne w utrzymaniu.</li>
</ul></li>
</ul>
<hr>
</section>
<section id="inne-formaty" class="level3" data-number="2.41.3">
<h3 data-number="2.41.3" class="anchored" data-anchor-id="inne-formaty"><span class="header-section-number">2.41.3</span> <strong>Inne formaty</strong></h3>
<section id="parquet" class="level4" data-number="2.41.3.1">
<h4 data-number="2.41.3.1" class="anchored" data-anchor-id="parquet"><span class="header-section-number">2.41.3.1</span> <strong>Parquet</strong></h4>
<ul>
<li><strong>Plusy</strong>:
<ul>
<li>Szybki i wydajny, szczególnie do dużych zbiorów danych.</li>
<li>Oszczędza miejsce dzięki kompresji.</li>
</ul></li>
<li><strong>Minusy</strong>:
<ul>
<li>Trudniejszy do bezpośredniego przeglądania przez człowieka.</li>
</ul></li>
</ul>
</section>
<section id="json" class="level4" data-number="2.41.3.2">
<h4 data-number="2.41.3.2" class="anchored" data-anchor-id="json"><span class="header-section-number">2.41.3.2</span> <strong>JSON</strong></h4>
<ul>
<li><strong>Plusy</strong>:
<ul>
<li>Elastyczny, idealny do przechowywania danych o złożonej strukturze (np. zagnieżdżonych).</li>
<li>Czytelny dla człowieka.</li>
</ul></li>
<li><strong>Minusy</strong>:
<ul>
<li>Zajmuje więcej miejsca niż CSV.</li>
<li>Wolniejszy w przetwarzaniu.</li>
</ul></li>
</ul>
</section>
<section id="nosql" class="level4" data-number="2.41.3.3">
<h4 data-number="2.41.3.3" class="anchored" data-anchor-id="nosql"><span class="header-section-number">2.41.3.3</span> <strong>NoSQL</strong></h4>
<ul>
<li><strong>Plusy</strong>:
<ul>
<li>Bardzo elastyczny, nie wymaga ustalonej struktury danych.</li>
<li>Skalowalny, nadaje się do ogromnych zbiorów danych.</li>
</ul></li>
<li><strong>Minusy</strong>:
<ul>
<li>Mniej odpowiedni do złożonych relacji między danymi.</li>
</ul></li>
</ul>
</section>
</section>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<section id="proces-generowania-danych-superpopulacja-populacja-i-próba" class="level2 callout-body-container callout-body" data-number="2.42">
<h2 data-number="2.42" class="anchored" data-anchor-id="proces-generowania-danych-superpopulacja-populacja-i-próba"><span class="header-section-number">2.42</span> Proces Generowania Danych, Superpopulacja, Populacja i Próba</h2>
<p>Aby zrozumieć wnioskowanie statystyczne, musimy rozróżnić cztery kluczowe pojęcia: <strong>Proces Generowania Danych (DGP)</strong>, <strong>superpopulacja</strong>, <strong>populacja</strong> i <strong>próba</strong>. Posłużymy się przykładem zarobków pracowników, aby zilustrować te koncepcje.</p>
<hr>
<section id="proces-generowania-danych-dgp" class="level3" data-number="2.42.1">
<h3 data-number="2.42.1" class="anchored" data-anchor-id="proces-generowania-danych-dgp"><span class="header-section-number">2.42.1</span> Proces Generowania Danych (DGP)</h3>
<p>DGP to “prawdziwy” mechanizm, który generuje obserwowane dane. Składa się z:<br>
- Składników systematycznych (np. zależności między zmiennymi)<br>
- Składników losowych (np. błędy pomiaru, nieobserwowane czynniki)</p>
<p><strong>Przykład</strong>: Załóżmy, że godzinowa stawka pracownika (<span class="math inline">Y</span>) zależy od liczby lat edukacji (<span class="math inline">X</span>) oraz nieobserwowanych czynników (<span class="math inline">\epsilon</span>):<br>
<span class="math display"> Y = 20 + 2.5X + \epsilon \quad \text{gdzie } \epsilon \sim N(0, 5^2) </span></p>
<p>Możemy zasymulować ten DGP w R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Symulacja DGP dla edukacji (X) i zarobków (Y)</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>n_superpopulacja <span class="ot">&lt;-</span> <span class="dv">100000</span>  <span class="co"># Rozmiar superpopulacji</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>dgp_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">edukacja =</span> <span class="fu">rpois</span>(n_superpopulacja, <span class="at">lambda =</span> <span class="dv">10</span>),  <span class="co"># Lata edukacji (~Poisson)</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">epsilon =</span> <span class="fu">rnorm</span>(n_superpopulacja, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">zarobki =</span> <span class="dv">20</span> <span class="sc">+</span> <span class="fl">2.5</span> <span class="sc">*</span> edukacja <span class="sc">+</span> epsilon</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres zależności</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dgp_data, <span class="fu">aes</span>(<span class="at">x =</span> edukacja, <span class="at">y =</span> zarobki)) <span class="sc">+</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DGP: Prawdziwa zależność między edukacją a zarobkami"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="superpopulacja" class="level3" data-number="2.42.2">
<h3 data-number="2.42.2" class="anchored" data-anchor-id="superpopulacja"><span class="header-section-number">2.42.2</span> Superpopulacja</h3>
<p>Superpopulacja to hipotetyczny, często nieskończony zbiór potencjalnych obserwacji, z których nasza <em>obserwowana</em> populacja jest losowo wybrana. Jest ona określona przez DGP.</p>
<p><strong>Przykład</strong>:<br>
- <strong>Superpopulacja</strong>: Wszyscy potencjalni pracownicy (przeszli, obecni, przyszli), których zarobki są zgodne z powyższym DGP.<br>
- <strong>Obserwowana populacja</strong>: Skończony podzbiór (np. wszyscy pracownicy w 2024 roku).</p>
<hr>
</section>
<section id="populacja" class="level3" data-number="2.42.3">
<h3 data-number="2.42.3" class="anchored" data-anchor-id="populacja"><span class="header-section-number">2.42.3</span> Populacja</h3>
<p>Populacja to skończony zbiór jednostek, które chcemy zbadać. Jej parametry (np. średnie zarobki) są stałe, ale nieznane.</p>
<p><strong>Przykład</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generujemy naszą "populację" (skończony podzbiór superpopulacji)</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>populacja <span class="ot">&lt;-</span> dgp_data <span class="sc">%&gt;%</span> <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">5000</span>)  <span class="co"># 5,000 pracowników</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Prawdziwa średnia zarobków w populacji (nieznana w praktyce)</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>pop_srednia_zarobki <span class="ot">&lt;-</span> <span class="fu">mean</span>(populacja<span class="sc">$</span>zarobki)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>pop_srednia_zarobki  <span class="co"># Wyświetl wartość</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 45.08406</code></pre>
</div>
</div>
<hr>
</section>
<section id="próba" class="level3" data-number="2.42.4">
<h3 data-number="2.42.4" class="anchored" data-anchor-id="próba"><span class="header-section-number">2.42.4</span> Próba</h3>
<p>Próba to podzbiór populacji, używany do oszacowania parametrów populacji.</p>
<p><strong>Przykład</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pobieramy losową próbę z populacji</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>rozmiar_proby <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>probka <span class="ot">&lt;-</span> populacja <span class="sc">%&gt;%</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> rozmiar_proby)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Szacujemy średnie zarobki z próby</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>probka_srednia_zarobki <span class="ot">&lt;-</span> <span class="fu">mean</span>(probka<span class="sc">$</span>zarobki)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>probka_srednia_zarobki  <span class="co"># Porównaj z pop_srednia_zarobki</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 44.647</code></pre>
</div>
</div>
<hr>
</section>
<section id="schemat-koncepcyjny" class="level3" data-number="2.42.5">
<h3 data-number="2.42.5" class="anchored" data-anchor-id="schemat-koncepcyjny"><span class="header-section-number">2.42.5</span> Schemat koncepcyjny</h3>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TD
  A[DGP&lt;br&gt;Prawdziwy model zarobków] --&gt; B[Superpopulacja&lt;br&gt;Wszyscy potencjalni pracownicy]
  B --&gt; C[Populacja&lt;br&gt;Wszyscy pracownicy w 2024]
  C --&gt; D[Próba&lt;br&gt;200 ankietowanych pracowników]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<hr>
</section>
<section id="dlaczego-to-ważne" class="level3" data-number="2.42.6">
<h3 data-number="2.42.6" class="anchored" data-anchor-id="dlaczego-to-ważne"><span class="header-section-number">2.42.6</span> Dlaczego to ważne?</h3>
<ul>
<li><strong>Wnioskowanie statystyczne</strong> wykorzystuje próbę do oszacowania parametrów populacji (np. średnich zarobków).<br>
</li>
<li><strong>Superpopulacja</strong> pozwala na uogólnienie wyników poza obserwowaną populację.<br>
</li>
<li><strong>DGP</strong> przypomina nam, że nasze modele są przybliżeniami rzeczywistości.</li>
</ul>
<p><strong>Pytanie do dyskusji</strong>: Jeśli DGP obejmuje <code>edukację</code> i <code>epsilon</code>, co może reprezentować <code>epsilon</code> w kontekście zarobków?</p>
<hr>
</section>
<section id="przykłady-ze-studiów-wyborczych" class="level3" data-number="2.42.7">
<h3 data-number="2.42.7" class="anchored" data-anchor-id="przykłady-ze-studiów-wyborczych"><span class="header-section-number">2.42.7</span> Przykłady ze studiów wyborczych</h3>
<p><strong>Przykład 1: Frekwencja wyborcza</strong></p>
<ul>
<li><strong>DGP</strong>: <span class="math inline">Frekwencja_i = \beta_0 + \beta_1 Wiek_i + \beta_2 Wykształcenie_i + \beta_3 Dochód_i + \varepsilon_i</span></li>
<li><strong>Superpopulacja</strong>: Wszystkie możliwe decyzje o udziale w wyborach, które mogliby podjąć wyborcy o różnych cechach społeczno-demograficznych w różnych warunkach</li>
<li><strong>Populacja</strong>: Wszyscy uprawnieni do głosowania w wyborach prezydenckich 2020</li>
<li><strong>Próba</strong>: 1500 respondentów ankiety exit poll po wyborach</li>
</ul>
<p><strong>Przykład 2: Poparcie dla partii politycznych</strong></p>
<ul>
<li><strong>DGP</strong>: <span class="math inline">Poparcie_{ij} = \beta_0 + \beta_1 Ideologia_i + \beta_2 SytuacjaEkonomiczna_i + \beta_3 Wiek_i + \varepsilon_i</span></li>
<li><strong>Superpopulacja</strong>: Wszystkie możliwe preferencje wyborcze osób o różnych cechach w różnych warunkach społeczno-ekonomicznych</li>
<li><strong>Populacja</strong>: Wszyscy wyborcy w Polsce w 2023 roku</li>
<li><strong>Próba</strong>: Respondenci sondażu przedwyborczego (n=1000)</li>
</ul>
</section>
<section id="symulacja-i-estymacja-funkcji-popytu-jako-dgp-w-r" class="level3" data-number="2.42.8">
<h3 data-number="2.42.8" class="anchored" data-anchor-id="symulacja-i-estymacja-funkcji-popytu-jako-dgp-w-r"><span class="header-section-number">2.42.8</span> Symulacja i estymacja funkcji popytu jako DGP w R</h3>
<p>Poniższy kod ilustruje, jak można zasymulować funkcję popytu z wieloma predyktorami jako DGP i estymować jej parametry za pomocą regresji OLS:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Załadowanie potrzebnych pakietów</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ustawienie ziarna losowości dla powtarzalnych wyników</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Zdefiniowanie "prawdziwego" DGP: Funkcja popytu na produkt</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Model: Q = beta0 + beta1*P + beta2*I + beta3*P_sub + beta4*P_comp + beta5*A + epsilon</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Gdzie:</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Q = ilość popytu na produkt</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="co"># P = cena produktu</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="co"># I = dochód konsumentów</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co"># P_sub = cena dobra substytucyjnego</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="co"># P_comp = cena dobra komplementarnego</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="co"># A = wydatki na reklamę</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Prawdziwe wartości parametrów (zgodne z teorią ekonomiczną)</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>beta0_true <span class="ot">&lt;-</span> <span class="dv">100</span>      <span class="co"># Stała</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>beta1_true <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.5</span>     <span class="co"># Efekt własnej ceny (ujemny - zgodnie z prawem popytu)</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>beta2_true <span class="ot">&lt;-</span> <span class="fl">0.8</span>      <span class="co"># Efekt dochodu (dodatni - dobro normalne)</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>beta3_true <span class="ot">&lt;-</span> <span class="fl">1.2</span>      <span class="co"># Efekt ceny substytutu (dodatni)</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>beta4_true <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.7</span>     <span class="co"># Efekt ceny dobra komplementarnego (ujemny)</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>beta5_true <span class="ot">&lt;-</span> <span class="fl">0.5</span>      <span class="co"># Efekt reklamy (dodatni)</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>sigma_true <span class="ot">&lt;-</span> <span class="dv">5</span>        <span class="co"># Odchylenie standardowe błędu losowego</span></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Symulacja superpopulacji (5000 potencjalnych rynków/okresów)</span></span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>n_super <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Generowanie predyktorów</span></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>cena <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_super, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)               <span class="co"># Cena produktu (zł)</span></span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>dochod <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_super, <span class="at">mean =</span> <span class="dv">3000</span>, <span class="at">sd =</span> <span class="dv">500</span>)         <span class="co"># Średni dochód (zł)</span></span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>cena_substytutu <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_super, <span class="at">min =</span> <span class="dv">4</span>, <span class="at">max =</span> <span class="dv">16</span>)    <span class="co"># Cena substytutu (zł)</span></span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>cena_komplementu <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_super, <span class="at">min =</span> <span class="dv">2</span>, <span class="at">max =</span> <span class="dv">8</span>)    <span class="co"># Cena komplementu (zł)</span></span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>reklama <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_super, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">100</span>)           <span class="co"># Wydatki na reklamę (tys. zł)</span></span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Dodanie korelacji między zmiennymi (np. cena i cena substytutu)</span></span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a>cena_substytutu <span class="ot">&lt;-</span> cena_substytutu <span class="sc">+</span> <span class="fu">rnorm</span>(n_super, <span class="at">mean =</span> <span class="fl">0.2</span> <span class="sc">*</span> cena, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Generowanie popytu zgodnie z DGP</span></span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_super, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma_true)  <span class="co"># Składnik losowy</span></span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>popyt <span class="ot">&lt;-</span> beta0_true <span class="sc">+</span> </span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a>         beta1_true <span class="sc">*</span> cena <span class="sc">+</span> </span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>         beta2_true <span class="sc">*</span> (dochod<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">+</span>  <span class="co"># skalowanie dochodu dla lepszej interpretacji</span></span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>         beta3_true <span class="sc">*</span> cena_substytutu <span class="sc">+</span> </span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a>         beta4_true <span class="sc">*</span> cena_komplementu <span class="sc">+</span> </span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a>         beta5_true <span class="sc">*</span> (reklama<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span>    <span class="co"># skalowanie reklamy dla lepszej interpretacji</span></span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a>         epsilon</span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie ramki danych superpopulacji</span></span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a>superpopulacja <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n_super,</span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">cena =</span> cena,</span>
<span id="cb60-53"><a href="#cb60-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">dochod =</span> dochod,</span>
<span id="cb60-54"><a href="#cb60-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">cena_substytutu =</span> cena_substytutu,</span>
<span id="cb60-55"><a href="#cb60-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">cena_komplementu =</span> cena_komplementu,</span>
<span id="cb60-56"><a href="#cb60-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">reklama =</span> reklama,</span>
<span id="cb60-57"><a href="#cb60-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">popyt =</span> popyt</span>
<span id="cb60-58"><a href="#cb60-58" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-59"><a href="#cb60-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-60"><a href="#cb60-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Pokaż kilka pierwszych obserwacji</span></span>
<span id="cb60-61"><a href="#cb60-61" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(superpopulacja)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
     id  cena dochod cena_substytutu cena_komplementu reklama popyt
  &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1     1  7.88  2661.           11.9              7.95    50.4  89.5
2     2 12.9   3287.            7.10             3.81    88.5  79.6
3     3  9.09  2648.           14.5              4.60    94.1  87.7
4     4 13.8   2733.           19.0              2.96    80.3  84.1
5     5 14.4   3387.           11.1              6.94    66.0  73.0
6     6  5.46  2762.           13.2              3.25    32.8  95.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Pobieranie próby z superpopulacji (np. 200 obserwacji)</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>n_sample <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>indeksy_proby <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n_super, n_sample)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>proba <span class="ot">&lt;-</span> superpopulacja[indeksy_proby, ]</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Estymacja modelu OLS na podstawie próby</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>model_ols <span class="ot">&lt;-</span> <span class="fu">lm</span>(popyt <span class="sc">~</span> cena <span class="sc">+</span> <span class="fu">I</span>(dochod<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">+</span> cena_substytutu <span class="sc">+</span> </span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>                cena_komplementu <span class="sc">+</span> <span class="fu">I</span>(reklama<span class="sc">/</span><span class="dv">10</span>), <span class="at">data =</span> proba)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Wyświetlenie podsumowania modelu</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_ols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = popyt ~ cena + I(dochod/1000) + cena_substytutu + 
    cena_komplementu + I(reklama/10), data = proba)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.5705  -2.8401   0.1072   2.9881  14.1873 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       99.8079     2.7949  35.711  &lt; 2e-16 ***
cena              -2.3571     0.1196 -19.711  &lt; 2e-16 ***
I(dochod/1000)     0.5259     0.6850   0.768 0.443582    
cena_substytutu    1.1635     0.0918  12.674  &lt; 2e-16 ***
cena_komplementu  -0.7483     0.1933  -3.871 0.000148 ***
I(reklama/10)      0.5600     0.1170   4.785 3.38e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.843 on 194 degrees of freedom
Multiple R-squared:  0.7377,    Adjusted R-squared:  0.7309 
F-statistic: 109.1 on 5 and 194 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Porównanie prawdziwych parametrów z estymowanymi</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>parametry_prawdziwe <span class="ot">&lt;-</span> <span class="fu">c</span>(beta0_true, beta1_true, beta2_true, </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                         beta3_true, beta4_true, beta5_true)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>parametry_estymowane <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_ols)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>porownanie <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">parametr =</span> <span class="fu">c</span>(<span class="st">"Stała"</span>, <span class="st">"Cena"</span>, <span class="st">"Dochód (tys.)"</span>, <span class="st">"Cena substytutu"</span>, </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Cena komplementu"</span>, <span class="st">"Reklama (10 tys.)"</span>),</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  prawdziwa_wartość <span class="ot">=</span> parametry_prawdziwe,</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  estymowana_wartość <span class="ot">=</span> parametry_estymowane,</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  różnica <span class="ot">=</span> estymowana_wartość <span class="sc">-</span> prawdziwa_wartość,</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  błąd<span class="at">_procentowy =</span> <span class="fu">abs</span>(różnica <span class="sc">/</span> prawdziwa_wartość) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Wyświetlenie porównania</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(porownanie)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  parametr          prawdziwa_wartość estymowana_wartość różnica błąd_procentowy
  &lt;chr&gt;                         &lt;dbl&gt;              &lt;dbl&gt;   &lt;dbl&gt;           &lt;dbl&gt;
1 Stała                         100               99.8   -0.192            0.192
2 Cena                           -2.5             -2.36   0.143            5.72 
3 Dochód (tys.)                   0.8              0.526 -0.274           34.3  
4 Cena substytutu                 1.2              1.16  -0.0365           3.04 
5 Cena komplementu               -0.7             -0.748 -0.0483           6.90 
6 Reklama (10 tys.)               0.5              0.560  0.0600          12.0  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Wizualizacja porównania prawdziwych i estymowanych parametrów</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(porownanie, <span class="fu">aes</span>(<span class="at">x =</span> parametr, <span class="at">y =</span> prawdziwa_wartość)) <span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> estymowana_wartość), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> parametr, <span class="at">y =</span> prawdziwa_wartość, </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> estymowana_wartość), <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Porównanie prawdziwego DGP z estymowanym modelem"</span>,</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Niebieskie punkty: prawdziwe wartości, czerwone punkty: estymowane wartości"</span>,</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Parametr"</span>, <span class="at">y =</span> <span class="st">"Wartość"</span>) <span class="sc">+</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. Sprawdzenie zdolności predykcyjnej modelu na nowych danych</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Pobieramy nowe dane z superpopulacji (nie używane w estymacji)</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>nowe_indeksy <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n_super, indeksy_proby), <span class="dv">100</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>nowe_dane <span class="ot">&lt;-</span> superpopulacja[nowe_indeksy, ]</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Predykcja na nowych danych</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>nowe_dane<span class="sc">$</span>przewidywany_popyt <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_ols, <span class="at">newdata =</span> nowe_dane)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie błędu średniokwadratowego (MSE) predykcji</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((nowe_dane<span class="sc">$</span>popyt <span class="sc">-</span> nowe_dane<span class="sc">$</span>przewidywany_popyt)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mse)</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pierwiastek błędu średniokwadratowego (RMSE):"</span>, <span class="fu">round</span>(rmse, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pierwiastek błędu średniokwadratowego (RMSE): 5.47 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. Wizualizacja relacji między ceną a popytem</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (efekt ceteris paribus - przy kontroli innych zmiennych)</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>ceteris_paribus <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cena =</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">dochod =</span> <span class="fu">mean</span>(proba<span class="sc">$</span>dochod),</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cena_substytutu =</span> <span class="fu">mean</span>(proba<span class="sc">$</span>cena_substytutu),</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cena_komplementu =</span> <span class="fu">mean</span>(proba<span class="sc">$</span>cena_komplementu),</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">reklama =</span> <span class="fu">mean</span>(proba<span class="sc">$</span>reklama)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie przewidywanego popytu według prawdziwego DGP</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>ceteris_paribus<span class="sc">$</span>popyt_prawdziwy <span class="ot">&lt;-</span> beta0_true <span class="sc">+</span> </span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>                                 beta1_true <span class="sc">*</span> ceteris_paribus<span class="sc">$</span>cena <span class="sc">+</span> </span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>                                 beta2_true <span class="sc">*</span> (ceteris_paribus<span class="sc">$</span>dochod<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">+</span> </span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>                                 beta3_true <span class="sc">*</span> ceteris_paribus<span class="sc">$</span>cena_substytutu <span class="sc">+</span> </span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>                                 beta4_true <span class="sc">*</span> ceteris_paribus<span class="sc">$</span>cena_komplementu <span class="sc">+</span> </span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>                                 beta5_true <span class="sc">*</span> (ceteris_paribus<span class="sc">$</span>reklama<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie przewidywanego popytu według estymowanego modelu</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>ceteris_paribus<span class="sc">$</span>popyt_estymowany <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_ols, <span class="at">newdata =</span> ceteris_paribus)</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Wizualizacja</span></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ceteris_paribus, <span class="fu">aes</span>(<span class="at">x =</span> cena)) <span class="sc">+</span></span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> popyt_prawdziwy, <span class="at">color =</span> <span class="st">"Prawdziwy DGP"</span>), <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> popyt_estymowany, <span class="at">color =</span> <span class="st">"Estymowany model"</span>), <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Prawdziwy DGP"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Estymowany model"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Krzywa popytu: Prawdziwy DGP vs. Estymowany model"</span>,</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Efekt ceteris paribus (przy stałych wartościach innych zmiennych)"</span>,</span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Cena produktu (zł)"</span>,</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Popyt (ilość)"</span>,</span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Model"</span>) <span class="sc">+</span></span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ten kod pokazuje:</p>
<ol type="1">
<li>Definiowanie złożonego DGP dla funkcji popytu z wieloma predyktorami zgodnej z teorią ekonomiczną</li>
<li>Symulowanie superpopulacji zgodnie z tym DGP</li>
<li>Pobieranie próby z superpopulacji</li>
<li>Estymację parametrów modelu za pomocą regresji OLS</li>
<li>Porównanie estymowanych parametrów z ich prawdziwymi wartościami</li>
<li>Wizualizację porównania prawdziwych i estymowanych parametrów</li>
<li>Sprawdzenie zdolności predykcyjnej modelu na nowych danych</li>
<li>Wizualizację relacji między ceną a popytem z efektem ceteris paribus</li>
</ol>
<p>Przykład ten pokazuje, jak można symulować złożone zależności ekonomiczne, a następnie używać metod ekonometrycznych do odkrywania tych zależności na podstawie próby danych. Jest to doskonała ilustracja, jak teoria ekonomiczna, DGP i metody statystyczne są ze sobą powiązane.</p>
<p>W rzeczywistości nigdy nie znamy prawdziwego DGP - to właśnie próbujemy odkryć za pomocą analizy statystycznej. Symulacje tego typu pozwalają jednak zrozumieć konceptualnie, jak wnioskowanie statystyczne łączy się z pojęciem DGP i superpopulacji.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TD
    DGP[Data Generating Process] --&gt;|Generates| SP[Superpopulation]
    SP --&gt;|Single finite realization| A[Population]
    A --&gt;|Random Selection| B[Sample]
    B --&gt;|Statistical Inference| C[Estimates &amp; Conclusions]
    C --&gt;|Generalize back to| A
    C -.-&gt;|Infer parameters of| SP
    C -.-&gt;|Ultimate goal: estimate parameters of| DGP
    
    style DGP fill:#1E90FF,stroke:#000,stroke-width:4px,color:#FFF
    style SP fill:#9932CC,stroke:#000,stroke-width:4px,color:#FFF
    style A fill:#DC143C,stroke:#000,stroke-width:4px,color:#FFF
    style B fill:#228B22,stroke:#000,stroke-width:2px,color:#FFF
    style C fill:#8B4513,stroke:#000,stroke-width:2px,color:#FFF
    
    classDef note fill:#F0F0F0,stroke:#000,stroke-width:1px;
    H[["Superpopulation:
    All possible outcomes
    generated by the DGP
    (infinite, hypothetical)"]]
    D[["DGP:
    True mechanism with
    unknown parameters
    that generates data"]]
    E[["Population:
    Single, specific, finite
    realization from the
    superpopulation"]]
    F[["Sample:
    Observed subset
    of the population"]]
    G[["Inference:
    Drawing conclusions about
    population, superpopulation,
    and ultimately the DGP"]]
    
    class D,E,F,G,H note
    
    H --&gt; SP
    D --&gt; DGP
    E --&gt; A
    F --&gt; B
    G --&gt; C
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="przykłady-pomocnicze" class="level3" data-number="2.42.9">
<h3 data-number="2.42.9" class="anchored" data-anchor-id="przykłady-pomocnicze"><span class="header-section-number">2.42.9</span> Przykłady pomocnicze</h3>
<section id="przykład-1-badanie-opinii-wyborców" class="level4" data-number="2.42.9.1">
<h4 data-number="2.42.9.1" class="anchored" data-anchor-id="przykład-1-badanie-opinii-wyborców"><span class="header-section-number">2.42.9.1</span> Przykład 1: Badanie opinii wyborców</h4>
<ul>
<li><strong>Populacja</strong>: Wszyscy zarejestrowani wyborcy w Polsce w 2023 roku (ok. 30 milionów osób).</li>
<li><strong>Próba</strong>: 1000 losowo wybranych wyborców ankietowanych w sondażu.</li>
<li><strong>Superpopulacja</strong>: Wszyscy potencjalni wyborcy (obecni, przyszli i hipotetyczni) oraz wszystkie możliwe scenariusze głosowania.</li>
<li><strong>DGP</strong> (Data Generating Process): Złożony mechanizm kształtujący opinie i decyzje wyborcze, w tym:
<ul>
<li>Czynniki demograficzne (wiek, wykształcenie, miejsce zamieszkania).</li>
<li>Warunki ekonomiczne (dochód, status zawodowy).</li>
<li>Wpływ mediów i debaty publicznej.</li>
<li>Doświadczenia osobiste.</li>
<li>Historyczne uwarunkowania polityczne.</li>
</ul></li>
</ul>
</section>
<section id="przykład-2-badanie-efektów-leku-przeciwcukrzycowego" class="level4" data-number="2.42.9.2">
<h4 data-number="2.42.9.2" class="anchored" data-anchor-id="przykład-2-badanie-efektów-leku-przeciwcukrzycowego"><span class="header-section-number">2.42.9.2</span> Przykład 2: Badanie efektów leku przeciwcukrzycowego</h4>
<ul>
<li><strong>Populacja</strong>: Wszyscy pacjenci z cukrzycą typu 2 w danym kraju (np. 2 miliony osób).</li>
<li><strong>Próba</strong>: 500 pacjentów uczestniczących w badaniu klinicznym.</li>
<li><strong>Superpopulacja</strong>: Wszyscy potencjalni pacjenci z cukrzycą typu 2 (obecni i przyszli) z różnymi profilami genetycznymi i środowiskowymi.</li>
<li><strong>DGP</strong>: Biologiczny mechanizm obejmujący:
<ul>
<li>Interakcje leku z receptorami w organizmie.</li>
<li>Indywidualne uwarunkowania genetyczne.</li>
<li>Czynniki środowiskowe (dieta, aktywność fizyczna).</li>
<li>Interakcje z innymi lekami.</li>
<li>Mechanizmy metaboliczne organizmu.</li>
</ul></li>
</ul>
</section>
<section id="przykład-3-gdy-próba-równa-się-populacji" class="level4" data-number="2.42.9.3">
<h4 data-number="2.42.9.3" class="anchored" data-anchor-id="przykład-3-gdy-próba-równa-się-populacji"><span class="header-section-number">2.42.9.3</span> Przykład 3: Gdy próba równa się populacji</h4>
<p>Badanie wszystkich 50 stanów USA:</p>
<ul>
<li><strong>Tradycyjne podejście</strong>: Nie ma rozróżnienia między próbą a populacją (badamy wszystkie stany).</li>
<li><strong>Podejście superpopulacyjne</strong>:
<ul>
<li><strong>Populacja/Próba</strong>: 50 istniejących stanów USA.</li>
<li><strong>Superpopulacja</strong>: Teoretyczny zbiór wszystkich możliwych jednostek terytorialnych typu “stan” w różnych warunkach historycznych, politycznych i społecznych.</li>
<li><strong>DGP</strong>: Fundamentalne mechanizmy geograficzne, historyczne, polityczne i społeczno-ekonomiczne kształtujące charakterystyki stanów.</li>
</ul></li>
</ul>
</section>
<section id="przykład-4-jakość-pizzy-w-nowym-jorku" class="level4" data-number="2.42.9.4">
<h4 data-number="2.42.9.4" class="anchored" data-anchor-id="przykład-4-jakość-pizzy-w-nowym-jorku"><span class="header-section-number">2.42.9.4</span> Przykład 4: Jakość pizzy w Nowym Jorku</h4>
<ul>
<li><strong>Populacja</strong>: Wszystkie obecnie działające pizzerie w Nowym Jorku (np. 2000 lokali).</li>
<li><strong>Próba</strong>: 50 losowo wybranych pizzerii z różnych dzielnic.</li>
<li><strong>Superpopulacja</strong>: Wszystkie możliwe pizzerie, które mogłyby istnieć w Nowym Jorku:
<ul>
<li>Obecnie działające.</li>
<li>Przyszłe (jeszcze nieotwarte).</li>
<li>Historyczne (już zamknięte).</li>
<li>Hipotetyczne (w alternatywnych warunkach ekonomicznych czy kulturowych).</li>
</ul></li>
<li><strong>DGP</strong>: Czynniki wpływające na jakość pizzy:
<ul>
<li>Składniki i ich jakość.</li>
<li>Umiejętności i doświadczenie szefów kuchni.</li>
<li>Sprzęt i infrastruktura kuchenna.</li>
<li>Metody przygotowania i przepisy.</li>
<li>Czynniki środowiskowe (np. jakość lokalnej wody).</li>
<li>Wpływy kulturowe i tradycje kulinarne.</li>
<li>Uwarunkowania ekonomiczne (koszty operacyjne, czynsze).</li>
</ul></li>
</ul>
<p>DGP jest jak “przepis na jakość pizzy”, który determinuje rezultaty dla wszystkich potencjalnych pizzerii w superpopulacji, nie tylko dla obecnie istniejących lokali.</p>
</section>
</section>
</section>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zagadnienia dotyczące wielkości próby
</div>
</div>
<div class="callout-body-container callout-body">
<p>Określenie odpowiedniej wielkości próby jest kluczowe dla wiarygodnej analizy statystycznej. Wymagana wielkość próby zależy od trzech głównych czynników:</p>
<ol type="1">
<li><strong>Rodzaj szacowanego parametru</strong>
<ul>
<li>Co chcesz oszacować? (np. proporcja, średnia, parametr regresji itp.)</li>
</ul></li>
<li><strong>Pożądana dokładność</strong>
<ul>
<li>Wyższa dokładność wymaga większej próby.<br>
</li>
<li>Przykład: Szacowanie z dokładnością ±1% wymaga około 9 razy więcej obserwacji niż szacowanie z dokładnością ±3%.</li>
</ul></li>
<li><strong>Zmienność populacji</strong>
<ul>
<li>Dla <strong>proporcji</strong>: Maksymalna zmienność występuje przy 50%, a zmienność maleje, gdy proporcje zbliżają się do 0% lub 100%.<br>
</li>
<li>Dla <strong>średnich</strong>: Zmienność zależy od wariancji pomiarów.<br>
</li>
<li>Dla <strong>modeli regresji</strong>: Należy uwzględnić wariancję predyktorów i zmiennych wynikowych.</li>
</ul></li>
</ol>
<hr>
<section id="problem-małych-populacji" class="level3" data-number="2.42.10">
<h3 data-number="2.42.10" class="anchored" data-anchor-id="problem-małych-populacji"><span class="header-section-number">2.42.10</span> Problem małych populacji</h3>
<p>Podczas pracy z małymi populacjami (np. mniej niż 1000 osób) należy wziąć pod uwagę specjalne kwestie:</p>
<ul>
<li><strong>Metody pobierania próby</strong>:
<ul>
<li>Proste losowanie próby tradycyjnie zakłada pobieranie <strong>z zamianą</strong>.<br>
</li>
<li>W praktyce częściej stosuje się pobieranie <strong>bez zamiany</strong>.<br>
</li>
<li>Różnica między tymi metodami staje się istotna w małych populacjach.</li>
</ul></li>
<li><strong>Poprawka na skończoną populację (FPC)</strong>:
<ul>
<li>Niezbędna przy pobieraniu próby większej niż 5-10% populacji.<br>
</li>
<li>Dostosowuje obliczenia błędu standardowego, uwzględniając zmniejszoną zmienność w małych populacjach.</li>
</ul></li>
</ul>
<section id="praktyczne-zalecenia-dla-małych-populacji" class="level4" data-number="2.42.10.1">
<h4 data-number="2.42.10.1" class="anchored" data-anchor-id="praktyczne-zalecenia-dla-małych-populacji"><span class="header-section-number">2.42.10.1</span> Praktyczne zalecenia dla małych populacji:</h4>
<ul>
<li>Dla populacji poniżej 200 osób rozważ przeprowadzenie <strong>pełnego spisu</strong>.<br>
</li>
<li>Używaj wzorów statystycznych przeznaczonych do pobierania próby bez zamiany.<br>
</li>
<li>Standardowe wzory (oparte na pobieraniu z zamianą) zawyżają błąd w małych populacjach.<br>
</li>
<li>Jasno dokumentuj metodologię pobierania próby w raportach badawczych.</li>
</ul>
</section>
<section id="kluczowe-różnice-między-metodami-pobierania-próby" class="level4" data-number="2.42.10.2">
<h4 data-number="2.42.10.2" class="anchored" data-anchor-id="kluczowe-różnice-między-metodami-pobierania-próby"><span class="header-section-number">2.42.10.2</span> Kluczowe różnice między metodami pobierania próby:</h4>
<ul>
<li><strong>Pobieranie z zamianą</strong>: Każda jednostka ma stałe prawdopodobieństwo wyboru (np. 1/N) w każdym losowaniu.<br>
</li>
<li><strong>Pobieranie bez zamiany</strong>: Prawdopodobieństwo wyboru zmienia się w kolejnych losowaniach (np. 1/N, 1/(N-1), 1/(N-2) itd.).<br>
</li>
<li>W dużych populacjach różnica jest nieznaczna; w małych populacjach jest istotna.<br>
</li>
<li>Pobieranie bez zamiany zazwyczaj skutkuje mniejszą wariancją estymatora.</li>
</ul>
<hr>
</section>
</section>
<section id="estymacja-statystyczna-a-wielkość-próby" class="level3" data-number="2.42.11">
<h3 data-number="2.42.11" class="anchored" data-anchor-id="estymacja-statystyczna-a-wielkość-próby"><span class="header-section-number">2.42.11</span> Estymacja statystyczna a wielkość próby</h3>
<section id="proporcje-procenty" class="level4" data-number="2.42.11.1">
<h4 data-number="2.42.11.1" class="anchored" data-anchor-id="proporcje-procenty"><span class="header-section-number">2.42.11.1</span> Proporcje (procenty)</h4>
<p>Przy szacowaniu proporcji (np. odsetek wyborców popierających kandydata) wymagana wielkość próby zależy od tego, jak blisko proporcja jest wartości 50%.</p>
<p><strong>Dlaczego proporcje bliskie 50% wymagają większych prób</strong>:<br>
Proporcje podlegają rozkładowi dwumianowemu, gdzie wariancja jest maksymalna przy 50% i minimalna przy 0% lub 100%. Oznacza to większą niepewność i konieczność użycia większych prób dla proporcji bliskich 50%.</p>
<p><strong>Przykład</strong>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Prawdziwa proporcja populacji</th>
<th>Wielkość próby</th>
<th>Margines błędu</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>50%</td>
<td>100</td>
<td>±10%</td>
</tr>
<tr class="even">
<td>50%</td>
<td>400</td>
<td>±5%</td>
</tr>
<tr class="odd">
<td>50%</td>
<td>1000</td>
<td>±3%</td>
</tr>
<tr class="even">
<td>10%</td>
<td>100</td>
<td>±6%</td>
</tr>
<tr class="odd">
<td>10%</td>
<td>400</td>
<td>±3%</td>
</tr>
<tr class="even">
<td>10%</td>
<td>1000</td>
<td>±2%</td>
</tr>
</tbody>
</table>
<p><strong>Kluczowe obserwacje</strong>:<br>
1. <strong>Większe próby zmniejszają margines błędu</strong>.<br>
2. <strong>Proporcje bliskie 50% mają większy margines błędu</strong> niż te bliskie 0% lub 100%.</p>
<p><strong>Wpływ wielkości populacji</strong>:<br>
Dla proporcji bliskich 50%, próba o wielkości ~1000 zapewnia margines błędu ±3%, niezależnie od tego, czy populacja liczy 30 000 czy 30 milionów. To wyjaśnia, dlaczego sondaże ogólnokrajowe mogą być dokładne przy stosunkowo małych próbach.</p>
<hr>
</section>
<section id="średnie" class="level4" data-number="2.42.11.2">
<h4 data-number="2.42.11.2" class="anchored" data-anchor-id="średnie"><span class="header-section-number">2.42.11.2</span> Średnie</h4>
<p>Przy szacowaniu średniej (np. średni dochód gospodarstwa domowego lub wzrost):</p>
<ul>
<li>Wielkość próby zależy od <strong>wariancji</strong> pomiarów.<br>
</li>
<li>Populacje o większej zmienności wymagają większych prób.<br>
</li>
<li>W przeciwieństwie do proporcji, nie ma „maksymalnej niepewności” przy konkretnej wartości.<br>
</li>
<li>Wielkość próby jest wprost proporcjonalna do wariancji zmiennej.</li>
</ul>
<p><strong>Przykład</strong>:<br>
Szacowanie średniego dochodu zazwyczaj wymaga większej próby niż szacowanie średniego wzrostu, ponieważ dochody są bardziej zróżnicowane.</p>
<hr>
</section>
<section id="parametry-modeli-i-złożona-estymacja" class="level4" data-number="2.42.11.3">
<h4 data-number="2.42.11.3" class="anchored" data-anchor-id="parametry-modeli-i-złożona-estymacja"><span class="header-section-number">2.42.11.3</span> Parametry modeli i złożona estymacja</h4>
<p>Modelowanie statystyczne (np. regresja) obejmuje szacowanie zależności między zmiennymi. Wymagania dotyczące wielkości próby stają się bardziej złożone w tych kontekstach.</p>
<p><strong>Kluczowe czynniki dla modeli regresji</strong>:<br>
1. <strong>Liczba parametrów</strong>:<br>
- Każda zmienna predykcyjna i interakcja zużywa stopnie swobody.<br>
- Zasada ogólna: 10-20 obserwacji na zmienną (minimum).<br>
- Do wykrywania subtelnych efektów: może być potrzebne 50-100+ obserwacji na zmienną.</p>
<ol start="2" type="1">
<li><strong>Wielkość efektu</strong>:
<ul>
<li>Mniejsze efekty wymagają większych prób do ich wykrycia.<br>
</li>
<li>Należy przeprowadzić analizę mocy na podstawie oczekiwanych wielkości efektów.</li>
</ul></li>
<li><strong>Złożoność modelu</strong>:
<ul>
<li>Zależności liniowe vs.&nbsp;nieliniowe.<br>
</li>
<li>Efekty interakcji, struktury danych hierarchicznych.<br>
</li>
<li>Rozkłady nienormalne lub heteroskedastyczność.</li>
</ul></li>
<li><strong>Wyjaśniona zmienność</strong>:
<ul>
<li>Wyższe wartości (R^2) mogą zmniejszyć wymaganą wielkość próby.<br>
</li>
<li>Większa wariancja resztowa zwiększa wymagania dotyczące próby.</li>
</ul></li>
</ol>
<hr>
</section>
</section>
<section id="planowanie-wielkości-próby-w-praktyce" class="level3" data-number="2.42.12">
<h3 data-number="2.42.12" class="anchored" data-anchor-id="planowanie-wielkości-próby-w-praktyce"><span class="header-section-number">2.42.12</span> Planowanie wielkości próby w praktyce</h3>
<p>Planując badanie, należy wziąć pod uwagę:</p>
<ol type="1">
<li><strong>Moc statystyczna</strong>:
<ul>
<li>Celuj w co najmniej 80% mocy do wykrycia efektów.<br>
</li>
<li>Przeprowadź formalną analizę mocy, aby określić wielkość próby.</li>
</ul></li>
<li><strong>Dokładność</strong>:
<ul>
<li>Określ pożądaną szerokość przedziałów ufności.<br>
</li>
<li>Większa dokładność wymaga większych prób.</li>
</ul></li>
<li><strong>Ograniczenia zasobów</strong>:
<ul>
<li>Zrównoważ wymagania statystyczne z budżetem, czasem i dostępnością uczestników.<br>
</li>
<li>Rozważ sekwencyjne lub adaptacyjne plany pobierania próby.</li>
</ul></li>
<li><strong>Kwestie etyczne</strong>:
<ul>
<li>Zbierz wystarczającą ilość danych, aby odpowiedzieć na pytania badawcze w sposób wiarygodny.<br>
</li>
<li>Unikaj niepotrzebnego obciążania uczestników lub marnowania zasobów.</li>
</ul></li>
</ol>
<hr>
</section>
<section id="dlaczego-50-oznacza-maksymalną-niepewność-dla-proporcji" class="level3" data-number="2.42.13">
<h3 data-number="2.42.13" class="anchored" data-anchor-id="dlaczego-50-oznacza-maksymalną-niepewność-dla-proporcji"><span class="header-section-number">2.42.13</span> Dlaczego 50% oznacza maksymalną niepewność dla proporcji</h3>
<p><strong>Przykład symulacji</strong>:<br>
Wyobraź sobie worek z 100 monetami (złote lub srebrne). Chcesz oszacować odsetek złotych monet, losując 20 monet wielokrotnie.</p>
<p><strong>Scenariusz A: 50% złotych (maksymalna niepewność)</strong><br>
- Wyniki wahają się znacznie (35% do 70%), ze średnim błędem 10 punktów procentowych.</p>
<p><strong>Scenariusz B: 10% złotych (mniejsza niepewność)</strong><br>
- Wyniki są bliższe prawdziwej wartości (0% do 15%), ze średnim błędem 4 punktów procentowych.</p>
<p><strong>Wniosek</strong>:<br>
Proporcje bliskie 50% charakteryzują się większą naturalną zmiennością, co wymaga większych prób do dokładnego oszacowania.</p>
<hr>
</section>
<section id="przykład-sondażu-popularni-vs.-niszowi-kandydaci" class="level3" data-number="2.42.14">
<h3 data-number="2.42.14" class="anchored" data-anchor-id="przykład-sondażu-popularni-vs.-niszowi-kandydaci"><span class="header-section-number">2.42.14</span> Przykład sondażu: Popularni vs.&nbsp;niszowi kandydaci</h3>
<p>W sondażu na 1000 osób:<br>
- <strong>Popularny kandydat z poparciem 40%</strong>: Dokładność ±3% (poparcie między 37% a 43%).<br>
- <strong>Niszowy kandydat z poparciem 3%</strong>: Dokładność ±1% (poparcie między 2% a 4%).</p>
<p><strong>Kluczowe spostrzeżenie</strong>:<br>
- <strong>Dokładność bezwzględna</strong> zależy od proporcji.<br>
- <strong>Dokładność względna</strong> (jako procent oszacowania) jest wyższa dla niszowych kandydatów.</p>
<hr>
</section>
<section id="podsumowanie-kluczowe-wnioski" class="level3" data-number="2.42.15">
<h3 data-number="2.42.15" class="anchored" data-anchor-id="podsumowanie-kluczowe-wnioski"><span class="header-section-number">2.42.15</span> Podsumowanie: Kluczowe wnioski</h3>
<ol type="1">
<li><strong>Wielkość próby zależy od</strong>:
<ul>
<li>Rodzaju szacowanego parametru (proporcja, średnia, parametr regresji).<br>
</li>
<li>Pożądanej dokładności i zmienności populacji.<br>
</li>
<li>Dla proporcji wartości bliskie 50% wymagają większych prób.</li>
</ul></li>
<li><strong>Małe populacje wymagają specjalnych rozwiązań</strong>:
<ul>
<li>Używaj poprawki na skończoną populację.<br>
</li>
<li>Rozważ pełne spisy dla bardzo małych populacji.</li>
</ul></li>
<li><strong>Moc statystyczna i dokładność</strong>:
<ul>
<li>Zapewnij wystarczającą moc i dokładność, uwzględniając ograniczenia zasobów.</li>
</ul></li>
<li><strong>Równowaga etyczna i praktyczna</strong>:
<ul>
<li>Zapewnij wiarygodne wyniki bez nadmiernego obciążania uczestników lub zasobów.</li>
</ul></li>
</ol>
<p>Zrozumienie tych zasad pozwala na projektowanie badań, które dostarczają dokładnych i wartościowych wniosków.</p>
</section>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chapter1.html" class="pagination-link" aria-label="Introduction to Data Science and Statistics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Science and Statistics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chapter2.html" class="pagination-link" aria-label="Understanding Data Types in Social Sciences">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>