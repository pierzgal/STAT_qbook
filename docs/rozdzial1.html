<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Wprowadzenie do Nauki o Danych i Statystyki – Social Data Analysis: An Introduction (Wprowadzenie do analizy danych społecznych)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chapter2.html" rel="next">
<link href="./chapter1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./rozdzial1.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wprowadzenie do Nauki o Danych i Statystyki</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Social Data Analysis: An Introduction (Wprowadzenie do analizy danych społecznych)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Science and Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wprowadzenie do Nauki o Danych i Statystyki</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Zrozumienie Typów Danych w Naukach Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">From Sample to Population - Understanding Randomness, Sampling, and Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Od Próby do Populacji - Zrozumienie Losowości, Próbkowania i Wnioskowania</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reliability and Validity in Data Science Research</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Rzetelność i Trafność w Badaniach Nauk o Danych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Research Designs: Experimental and Non-Experimental Approaches</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Projekty Badawcze: Podejścia Eksperymentalne i Nieeksperymentalne</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fundamentals of Univariate Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Podstawy Jednowymiarowej Statystyki Opisowej</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data Visualization: with examples in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Wizualizacja Danych: z przykładami w R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction to (Discrete) Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Wprowadzenie do Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rv_pdf_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Random Variables and Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rv_pdf_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Zmienna Losowa i Rozkład Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Statistical Hypothesis Testing: A Fundamental Logic</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Wprowadzenie do Wnioskowania Statystycznego: Logika Testowania Hipotez Statystycznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#czym-są-statystyka-i-nauka-o-danych" id="toc-czym-są-statystyka-i-nauka-o-danych" class="nav-link active" data-scroll-target="#czym-są-statystyka-i-nauka-o-danych"><span class="header-section-number">2.1</span> Czym są Statystyka i Nauka o Danych?</a></li>
  <li><a href="#związek-między-statystyką-a-nauką-o-danych" id="toc-związek-między-statystyką-a-nauką-o-danych" class="nav-link" data-scroll-target="#związek-między-statystyką-a-nauką-o-danych"><span class="header-section-number">2.2</span> Związek między Statystyką a Nauką o Danych</a></li>
  <li><a href="#podstawowe-pojęcia-w-nauce-o-danych-i-statystyce" id="toc-podstawowe-pojęcia-w-nauce-o-danych-i-statystyce" class="nav-link" data-scroll-target="#podstawowe-pojęcia-w-nauce-o-danych-i-statystyce"><span class="header-section-number">2.3</span> Podstawowe Pojęcia w Nauce o Danych i Statystyce</a>
  <ul class="collapse">
  <li><a href="#dane-i-populacje" id="toc-dane-i-populacje" class="nav-link" data-scroll-target="#dane-i-populacje"><span class="header-section-number">2.3.1</span> Dane i Populacje</a></li>
  <li><a href="#wnioskowanie-statystyczne-jak-mała-próba-może-reprezentować-dużą-populację" id="toc-wnioskowanie-statystyczne-jak-mała-próba-może-reprezentować-dużą-populację" class="nav-link" data-scroll-target="#wnioskowanie-statystyczne-jak-mała-próba-może-reprezentować-dużą-populację"><span class="header-section-number">2.3.2</span> Wnioskowanie Statystyczne: Jak Mała Próba Może Reprezentować Dużą Populację?</a></li>
  <li><a href="#zrozumienie-błędu-statystycznego" id="toc-zrozumienie-błędu-statystycznego" class="nav-link" data-scroll-target="#zrozumienie-błędu-statystycznego"><span class="header-section-number">2.3.3</span> Zrozumienie Błędu Statystycznego</a></li>
  <li><a href="#zagadnienia-doboru-wielkości-próby" id="toc-zagadnienia-doboru-wielkości-próby" class="nav-link" data-scroll-target="#zagadnienia-doboru-wielkości-próby"><span class="header-section-number">2.3.11</span> Zagadnienia Doboru Wielkości Próby</a></li>
  <li><a href="#aspekty-estymacji-statystycznej" id="toc-aspekty-estymacji-statystycznej" class="nav-link" data-scroll-target="#aspekty-estymacji-statystycznej"><span class="header-section-number">2.3.12</span> Aspekty Estymacji Statystycznej</a></li>
  <li><a href="#przykład-maksymalnej-niepewności-dla-proporcji-dlaczego-50-to-najgorszy-przypadek" id="toc-przykład-maksymalnej-niepewności-dla-proporcji-dlaczego-50-to-najgorszy-przypadek" class="nav-link" data-scroll-target="#przykład-maksymalnej-niepewności-dla-proporcji-dlaczego-50-to-najgorszy-przypadek"><span class="header-section-number">2.3.13</span> Przykład Maksymalnej Niepewności dla Proporcji: Dlaczego 50% to “Najgorszy Przypadek”</a></li>
  <li><a href="#podsumowanie-kluczowe-punkty-do-zapamiętania" id="toc-podsumowanie-kluczowe-punkty-do-zapamiętania" class="nav-link" data-scroll-target="#podsumowanie-kluczowe-punkty-do-zapamiętania"><span class="header-section-number">2.3.14</span> Podsumowanie: Kluczowe Punkty do Zapamiętania</a></li>
  </ul></li>
  <li><a href="#parametry-populacji" id="toc-parametry-populacji" class="nav-link" data-scroll-target="#parametry-populacji"><span class="header-section-number">2.4</span> Parametry Populacji</a></li>
  <li><a href="#rozkład-statystyk-z-próby" id="toc-rozkład-statystyk-z-próby" class="nav-link" data-scroll-target="#rozkład-statystyk-z-próby"><span class="header-section-number">2.5</span> Rozkład Statystyk z Próby</a></li>
  <li><a href="#wartość-oczekiwana-statystyki-z-próby" id="toc-wartość-oczekiwana-statystyki-z-próby" class="nav-link" data-scroll-target="#wartość-oczekiwana-statystyki-z-próby"><span class="header-section-number">2.6</span> Wartość Oczekiwana Statystyki z Próby</a></li>
  <li><a href="#rozkład-normalny---krzywa-dzwonowa" id="toc-rozkład-normalny---krzywa-dzwonowa" class="nav-link" data-scroll-target="#rozkład-normalny---krzywa-dzwonowa"><span class="header-section-number">2.7</span> Rozkład Normalny - Krzywa Dzwonowa</a>
  <ul class="collapse">
  <li><a href="#reprezentacja-matematyczna" id="toc-reprezentacja-matematyczna" class="nav-link" data-scroll-target="#reprezentacja-matematyczna"><span class="header-section-number">2.7.1</span> Reprezentacja Matematyczna</a></li>
  <li><a href="#praktyczne-znaczenie-1" id="toc-praktyczne-znaczenie-1" class="nav-link" data-scroll-target="#praktyczne-znaczenie-1"><span class="header-section-number">2.7.2</span> Praktyczne Znaczenie</a></li>
  </ul></li>
  <li><a href="#popularna-notacja-statystyczna" id="toc-popularna-notacja-statystyczna" class="nav-link" data-scroll-target="#popularna-notacja-statystyczna"><span class="header-section-number">2.8</span> Popularna Notacja Statystyczna</a></li>
  <li><a href="#rodzaje-danych-i-zmiennych" id="toc-rodzaje-danych-i-zmiennych" class="nav-link" data-scroll-target="#rodzaje-danych-i-zmiennych"><span class="header-section-number">2.9</span> Rodzaje Danych i Zmiennych</a>
  <ul class="collapse">
  <li><a href="#źródła-danych" id="toc-źródła-danych" class="nav-link" data-scroll-target="#źródła-danych"><span class="header-section-number">2.9.1</span> Źródła Danych</a></li>
  <li><a href="#zmienne-i-stałe" id="toc-zmienne-i-stałe" class="nav-link" data-scroll-target="#zmienne-i-stałe"><span class="header-section-number">2.9.2</span> Zmienne i Stałe</a></li>
  </ul></li>
  <li><a href="#pojęcia-związane-z-estymacją-statystyczną" id="toc-pojęcia-związane-z-estymacją-statystyczną" class="nav-link" data-scroll-target="#pojęcia-związane-z-estymacją-statystyczną"><span class="header-section-number">2.10</span> Pojęcia Związane z Estymacją Statystyczną</a>
  <ul class="collapse">
  <li><a href="#parametr-populacji-estymand" id="toc-parametr-populacji-estymand" class="nav-link" data-scroll-target="#parametr-populacji-estymand"><span class="header-section-number">2.10.1</span> Parametr Populacji (Estymand)</a></li>
  <li><a href="#estymator-statystyka" id="toc-estymator-statystyka" class="nav-link" data-scroll-target="#estymator-statystyka"><span class="header-section-number">2.10.2</span> Estymator (Statystyka)</a></li>
  <li><a href="#oszacowanie-estymata" id="toc-oszacowanie-estymata" class="nav-link" data-scroll-target="#oszacowanie-estymata"><span class="header-section-number">2.10.3</span> Oszacowanie (Estymata)</a></li>
  <li><a href="#właściwości-dobrych-estymatorów" id="toc-właściwości-dobrych-estymatorów" class="nav-link" data-scroll-target="#właściwości-dobrych-estymatorów"><span class="header-section-number">2.10.4</span> Właściwości Dobrych Estymatorów</a></li>
  </ul></li>
  <li><a href="#modele-statystyczne-i-wnioskowanie" id="toc-modele-statystyczne-i-wnioskowanie" class="nav-link" data-scroll-target="#modele-statystyczne-i-wnioskowanie"><span class="header-section-number">2.11</span> Modele Statystyczne i Wnioskowanie</a>
  <ul class="collapse">
  <li><a href="#modele-statystyczne" id="toc-modele-statystyczne" class="nav-link" data-scroll-target="#modele-statystyczne"><span class="header-section-number">2.11.1</span> Modele Statystyczne</a></li>
  <li><a href="#wnioskowanie-przyczynowe-a-predykcyjne-korelacyjne" id="toc-wnioskowanie-przyczynowe-a-predykcyjne-korelacyjne" class="nav-link" data-scroll-target="#wnioskowanie-przyczynowe-a-predykcyjne-korelacyjne"><span class="header-section-number">2.11.2</span> Wnioskowanie Przyczynowe a Predykcyjne (korelacyjne)</a></li>
  <li><a href="#wyzwania-wnioskowania-przyczynowego" id="toc-wyzwania-wnioskowania-przyczynowego" class="nav-link" data-scroll-target="#wyzwania-wnioskowania-przyczynowego"><span class="header-section-number">2.11.3</span> Wyzwania Wnioskowania Przyczynowego</a></li>
  </ul></li>
  <li><a href="#wnioskowanie-statystyczne" id="toc-wnioskowanie-statystyczne" class="nav-link" data-scroll-target="#wnioskowanie-statystyczne"><span class="header-section-number">2.12</span> Wnioskowanie Statystyczne</a>
  <ul class="collapse">
  <li><a href="#estymacja" id="toc-estymacja" class="nav-link" data-scroll-target="#estymacja"><span class="header-section-number">2.12.1</span> Estymacja</a></li>
  <li><a href="#testowanie-hipotez" id="toc-testowanie-hipotez" class="nav-link" data-scroll-target="#testowanie-hipotez"><span class="header-section-number">2.12.2</span> Testowanie Hipotez</a></li>
  <li><a href="#rodzaje-błędów-w-testowaniu-hipotez" id="toc-rodzaje-błędów-w-testowaniu-hipotez" class="nav-link" data-scroll-target="#rodzaje-błędów-w-testowaniu-hipotez"><span class="header-section-number">2.12.3</span> Rodzaje Błędów w Testowaniu Hipotez</a></li>
  </ul></li>
  <li><a href="#podstawy-dobrego-badania-statystycznego" id="toc-podstawy-dobrego-badania-statystycznego" class="nav-link" data-scroll-target="#podstawy-dobrego-badania-statystycznego"><span class="header-section-number">2.13</span> Podstawy Dobrego Badania Statystycznego</a>
  <ul class="collapse">
  <li><a href="#podsumowanie-kluczowych-pojęć" id="toc-podsumowanie-kluczowych-pojęć" class="nav-link" data-scroll-target="#podsumowanie-kluczowych-pojęć"><span class="header-section-number">2.13.1</span> Podsumowanie Kluczowych Pojęć</a></li>
  </ul></li>
  <li><a href="#appendices-additional-topics-in-statistics-and-data-science" id="toc-appendices-additional-topics-in-statistics-and-data-science" class="nav-link" data-scroll-target="#appendices-additional-topics-in-statistics-and-data-science"><span class="header-section-number">2.14</span> Appendices: Additional Topics in Statistics and Data Science (*)</a></li>
  <li><a href="#appendix-a-r-for-social-science-data-analysis" id="toc-appendix-a-r-for-social-science-data-analysis" class="nav-link" data-scroll-target="#appendix-a-r-for-social-science-data-analysis"><span class="header-section-number">2.15</span> Appendix A: R for Social Science Data Analysis</a></li>
  <li><a href="#appendix-b-causal-inference-vs.-observational-studies" id="toc-appendix-b-causal-inference-vs.-observational-studies" class="nav-link" data-scroll-target="#appendix-b-causal-inference-vs.-observational-studies"><span class="header-section-number">2.16</span> Appendix B: Causal Inference vs.&nbsp;Observational Studies</a>
  <ul class="collapse">
  <li><a href="#causal-inference" id="toc-causal-inference" class="nav-link" data-scroll-target="#causal-inference"><span class="header-section-number">2.16.1</span> Causal Inference</a></li>
  <li><a href="#observational-studies" id="toc-observational-studies" class="nav-link" data-scroll-target="#observational-studies"><span class="header-section-number">2.16.2</span> Observational Studies</a></li>
  <li><a href="#challenges-in-establishing-causality" id="toc-challenges-in-establishing-causality" class="nav-link" data-scroll-target="#challenges-in-establishing-causality"><span class="header-section-number">2.16.3</span> Challenges in Establishing Causality</a></li>
  <li><a href="#methods-to-strengthen-causal-claims" id="toc-methods-to-strengthen-causal-claims" class="nav-link" data-scroll-target="#methods-to-strengthen-causal-claims"><span class="header-section-number">2.16.4</span> Methods to Strengthen Causal Claims</a></li>
  </ul></li>
  <li><a href="#appendix-c-understanding-spurious-correlations-confounders-and-colliders" id="toc-appendix-c-understanding-spurious-correlations-confounders-and-colliders" class="nav-link" data-scroll-target="#appendix-c-understanding-spurious-correlations-confounders-and-colliders"><span class="header-section-number">2.17</span> Appendix C: Understanding Spurious Correlations, Confounders, and Colliders</a>
  <ul class="collapse">
  <li><a href="#spurious-correlations" id="toc-spurious-correlations" class="nav-link" data-scroll-target="#spurious-correlations"><span class="header-section-number">2.17.1</span> Spurious Correlations</a></li>
  <li><a href="#confounders" id="toc-confounders" class="nav-link" data-scroll-target="#confounders"><span class="header-section-number">2.17.2</span> Confounders</a></li>
  <li><a href="#colliders" id="toc-colliders" class="nav-link" data-scroll-target="#colliders"><span class="header-section-number">2.17.3</span> Colliders</a></li>
  <li><a href="#simpsons-paradox" id="toc-simpsons-paradox" class="nav-link" data-scroll-target="#simpsons-paradox"><span class="header-section-number">2.17.4</span> Simpson’s Paradox</a></li>
  <li><a href="#directed-acyclic-graphs-dags" id="toc-directed-acyclic-graphs-dags" class="nav-link" data-scroll-target="#directed-acyclic-graphs-dags"><span class="header-section-number">2.17.5</span> Directed Acyclic Graphs (DAGs)</a></li>
  </ul></li>
  <li><a href="#appendix-d-models-in-science-from-deterministic-to-stochastic" id="toc-appendix-d-models-in-science-from-deterministic-to-stochastic" class="nav-link" data-scroll-target="#appendix-d-models-in-science-from-deterministic-to-stochastic"><span class="header-section-number">2.18</span> Appendix D: Models in Science: From Deterministic to Stochastic</a>
  <ul class="collapse">
  <li><a href="#types-of-models" id="toc-types-of-models" class="nav-link" data-scroll-target="#types-of-models"><span class="header-section-number">2.18.1</span> Types of Models</a></li>
  <li><a href="#model-error-and-bias-variance-tradeoff" id="toc-model-error-and-bias-variance-tradeoff" class="nav-link" data-scroll-target="#model-error-and-bias-variance-tradeoff"><span class="header-section-number">2.18.2</span> Model Error and Bias-Variance Tradeoff</a></li>
  </ul></li>
  <li><a href="#appendix-e-classical-vs-quantum-randomness" id="toc-appendix-e-classical-vs-quantum-randomness" class="nav-link" data-scroll-target="#appendix-e-classical-vs-quantum-randomness"><span class="header-section-number">2.19</span> Appendix E: Classical vs Quantum Randomness</a>
  <ul class="collapse">
  <li><a href="#origin-of-randomness" id="toc-origin-of-randomness" class="nav-link" data-scroll-target="#origin-of-randomness"><span class="header-section-number">2.19.1</span> Origin of Randomness</a></li>
  <li><a href="#philosophical-implications" id="toc-philosophical-implications" class="nav-link" data-scroll-target="#philosophical-implications"><span class="header-section-number">2.19.2</span> Philosophical Implications</a></li>
  <li><a href="#practical-implications" id="toc-practical-implications" class="nav-link" data-scroll-target="#practical-implications"><span class="header-section-number">2.19.3</span> Practical Implications</a></li>
  </ul></li>
  <li><a href="#appendix-f-ethical-considerations-in-social-science-data-analysis" id="toc-appendix-f-ethical-considerations-in-social-science-data-analysis" class="nav-link" data-scroll-target="#appendix-f-ethical-considerations-in-social-science-data-analysis"><span class="header-section-number">2.20</span> Appendix F: Ethical Considerations in Social Science Data Analysis</a>
  <ul class="collapse">
  <li><a href="#privacy-and-consent" id="toc-privacy-and-consent" class="nav-link" data-scroll-target="#privacy-and-consent"><span class="header-section-number">2.20.1</span> 1. Privacy and Consent</a></li>
  <li><a href="#data-protection" id="toc-data-protection" class="nav-link" data-scroll-target="#data-protection"><span class="header-section-number">2.20.2</span> 2. Data Protection</a></li>
  <li><a href="#bias-and-representation" id="toc-bias-and-representation" class="nav-link" data-scroll-target="#bias-and-representation"><span class="header-section-number">2.20.3</span> 3. Bias and Representation</a></li>
  <li><a href="#transparency-and-reproducibility" id="toc-transparency-and-reproducibility" class="nav-link" data-scroll-target="#transparency-and-reproducibility"><span class="header-section-number">2.20.4</span> 4. Transparency and Reproducibility</a></li>
  <li><a href="#social-impact" id="toc-social-impact" class="nav-link" data-scroll-target="#social-impact"><span class="header-section-number">2.20.5</span> 5. Social Impact</a></li>
  </ul></li>
  <li><a href="#appendix-g-introduction-to-rstudio-and-the-tidyverse" id="toc-appendix-g-introduction-to-rstudio-and-the-tidyverse" class="nav-link" data-scroll-target="#appendix-g-introduction-to-rstudio-and-the-tidyverse"><span class="header-section-number">2.21</span> Appendix G: Introduction to RStudio and the tidyverse</a>
  <ul class="collapse">
  <li><a href="#getting-started-with-rstudio" id="toc-getting-started-with-rstudio" class="nav-link" data-scroll-target="#getting-started-with-rstudio"><span class="header-section-number">2.21.1</span> Getting Started with RStudio</a></li>
  <li><a href="#the-tidyverse-ecosystem" id="toc-the-tidyverse-ecosystem" class="nav-link" data-scroll-target="#the-tidyverse-ecosystem"><span class="header-section-number">2.21.2</span> The tidyverse Ecosystem</a></li>
  <li><a href="#basic-tidyverse-workflow" id="toc-basic-tidyverse-workflow" class="nav-link" data-scroll-target="#basic-tidyverse-workflow"><span class="header-section-number">2.21.3</span> Basic tidyverse Workflow</a></li>
  <li><a href="#resources-for-learning-r" id="toc-resources-for-learning-r" class="nav-link" data-scroll-target="#resources-for-learning-r"><span class="header-section-number">2.21.4</span> Resources for Learning R</a></li>
  </ul></li>
  <li><a href="#appendix-h-symulacja-centralnego-twierdzenia-granicznego" id="toc-appendix-h-symulacja-centralnego-twierdzenia-granicznego" class="nav-link" data-scroll-target="#appendix-h-symulacja-centralnego-twierdzenia-granicznego"><span class="header-section-number">2.22</span> Appendix H: Symulacja Centralnego Twierdzenia Granicznego</a>
  <ul class="collapse">
  <li><a href="#czym-jest-centralne-twierdzenie-graniczne" id="toc-czym-jest-centralne-twierdzenie-graniczne" class="nav-link" data-scroll-target="#czym-jest-centralne-twierdzenie-graniczne"><span class="header-section-number">2.22.1</span> Czym jest Centralne Twierdzenie Graniczne?</a></li>
  <li><a href="#prosty-eksperyment" id="toc-prosty-eksperyment" class="nav-link" data-scroll-target="#prosty-eksperyment"><span class="header-section-number">2.22.2</span> Prosty eksperyment</a></li>
  <li><a href="#jak-wyglądają-nasze-populacje" id="toc-jak-wyglądają-nasze-populacje" class="nav-link" data-scroll-target="#jak-wyglądają-nasze-populacje"><span class="header-section-number">2.22.3</span> Jak wyglądają nasze populacje?</a></li>
  <li><a href="#jak-zmieniają-się-rozkłady-średnich-z-próby" id="toc-jak-zmieniają-się-rozkłady-średnich-z-próby" class="nav-link" data-scroll-target="#jak-zmieniają-się-rozkłady-średnich-z-próby"><span class="header-section-number">2.22.4</span> Jak zmieniają się rozkłady średnich z próby?</a></li>
  <li><a href="#porównanie-wszystkich-trzech-rozkładów-dla-n30" id="toc-porównanie-wszystkich-trzech-rozkładów-dla-n30" class="nav-link" data-scroll-target="#porównanie-wszystkich-trzech-rozkładów-dla-n30"><span class="header-section-number">2.22.5</span> Porównanie wszystkich trzech rozkładów dla n=30</a></li>
  <li><a href="#kluczowe-wnioski" id="toc-kluczowe-wnioski" class="nav-link" data-scroll-target="#kluczowe-wnioski"><span class="header-section-number">2.22.6</span> Kluczowe wnioski</a></li>
  </ul></li>
  <li><a href="#appendix-i-symulacja-prawa-wielkich-liczb" id="toc-appendix-i-symulacja-prawa-wielkich-liczb" class="nav-link" data-scroll-target="#appendix-i-symulacja-prawa-wielkich-liczb"><span class="header-section-number">2.23</span> Appendix I: Symulacja Prawa Wielkich Liczb</a>
  <ul class="collapse">
  <li><a href="#prawo-wielkich-liczb" id="toc-prawo-wielkich-liczb" class="nav-link" data-scroll-target="#prawo-wielkich-liczb"><span class="header-section-number">2.23.1</span> Prawo Wielkich Liczb</a></li>
  <li><a href="#symulacja-rzutów-monetą" id="toc-symulacja-rzutów-monetą" class="nav-link" data-scroll-target="#symulacja-rzutów-monetą"><span class="header-section-number">2.23.2</span> Symulacja Rzutów Monetą</a></li>
  <li><a href="#symulacja-rzutów-kostką" id="toc-symulacja-rzutów-kostką" class="nav-link" data-scroll-target="#symulacja-rzutów-kostką"><span class="header-section-number">2.23.3</span> Symulacja Rzutów Kostką</a></li>
  <li><a href="#kluczowe-wnioski-1" id="toc-kluczowe-wnioski-1" class="nav-link" data-scroll-target="#kluczowe-wnioski-1"><span class="header-section-number">2.23.4</span> Kluczowe Wnioski</a></li>
  <li><a href="#zrozumienie-teoretycznych-granic-1n" id="toc-zrozumienie-teoretycznych-granic-1n" class="nav-link" data-scroll-target="#zrozumienie-teoretycznych-granic-1n"><span class="header-section-number">2.23.5</span> Zrozumienie Teoretycznych Granic (±1/√n)</a></li>
  </ul></li>
  <li><a href="#appendix-j-sample-size-determination-for-proportions" id="toc-appendix-j-sample-size-determination-for-proportions" class="nav-link" data-scroll-target="#appendix-j-sample-size-determination-for-proportions"><span class="header-section-number">2.24</span> Appendix J: Sample Size Determination for Proportions</a>
  <ul class="collapse">
  <li><a href="#understanding-margin-of-error" id="toc-understanding-margin-of-error" class="nav-link" data-scroll-target="#understanding-margin-of-error"><span class="header-section-number">2.24.1</span> Understanding Margin of Error</a></li>
  <li><a href="#the-sample-size-formula-for-proportions" id="toc-the-sample-size-formula-for-proportions" class="nav-link" data-scroll-target="#the-sample-size-formula-for-proportions"><span class="header-section-number">2.24.2</span> The Sample Size Formula for Proportions</a></li>
  <li><a href="#derivation-of-the-sample-size-formula" id="toc-derivation-of-the-sample-size-formula" class="nav-link" data-scroll-target="#derivation-of-the-sample-size-formula"><span class="header-section-number">2.24.3</span> Derivation of the Sample Size Formula</a></li>
  <li><a href="#selecting-the-confidence-level" id="toc-selecting-the-confidence-level" class="nav-link" data-scroll-target="#selecting-the-confidence-level"><span class="header-section-number">2.24.4</span> Selecting the Confidence Level</a></li>
  <li><a href="#estimating-the-expected-proportion" id="toc-estimating-the-expected-proportion" class="nav-link" data-scroll-target="#estimating-the-expected-proportion"><span class="header-section-number">2.24.5</span> Estimating the Expected Proportion</a></li>
  <li><a href="#step-by-step-example-calculating-sample-size-with-5-p.p.-error" id="toc-step-by-step-example-calculating-sample-size-with-5-p.p.-error" class="nav-link" data-scroll-target="#step-by-step-example-calculating-sample-size-with-5-p.p.-error"><span class="header-section-number">2.24.6</span> Step-by-Step Example: Calculating Sample Size with 5 p.p. Error</a></li>
  <li><a href="#sample-size-for-different-precision-levels" id="toc-sample-size-for-different-precision-levels" class="nav-link" data-scroll-target="#sample-size-for-different-precision-levels"><span class="header-section-number">2.24.7</span> Sample Size for Different Precision Levels</a></li>
  <li><a href="#adjusting-for-known-expected-proportions" id="toc-adjusting-for-known-expected-proportions" class="nav-link" data-scroll-target="#adjusting-for-known-expected-proportions"><span class="header-section-number">2.24.8</span> Adjusting for Known Expected Proportions</a></li>
  <li><a href="#adjusting-for-finite-populations" id="toc-adjusting-for-finite-populations" class="nav-link" data-scroll-target="#adjusting-for-finite-populations"><span class="header-section-number">2.24.9</span> Adjusting for Finite Populations</a></li>
  <li><a href="#practical-considerations" id="toc-practical-considerations" class="nav-link" data-scroll-target="#practical-considerations"><span class="header-section-number">2.24.10</span> Practical Considerations</a></li>
  <li><a href="#implementing-in-r" id="toc-implementing-in-r" class="nav-link" data-scroll-target="#implementing-in-r"><span class="header-section-number">2.24.11</span> Implementing in R</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">2.24.12</span> Conclusion</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">2.24.13</span> Exercises</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wprowadzenie do Nauki o Danych i Statystyki</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="czym-są-statystyka-i-nauka-o-danych" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="czym-są-statystyka-i-nauka-o-danych"><span class="header-section-number">2.1</span> Czym są Statystyka i Nauka o Danych?</h2>
<blockquote class="blockquote">
<p><strong>Ważne</strong></p>
<p>Statystyka i nauka o danych to zarówno sztuka, jak i nauka wydobywania wiedzy z danych – pomagają nam zrozumieć świat poprzez metodyczną analizę zebranych informacji.</p>
</blockquote>
<p>Statystyka i nauka o danych dostarczają niezbędnych narzędzi dla badaczy nauk społecznych, niezależnie od specjalizacji. Bez względu na to, czy studiujesz nauki polityczne, ekonomię, socjologię czy inną dziedzinę nauk społecznych, narzędzia te umożliwiają:</p>
<ul>
<li>Analizę trendów i zachowań społecznych</li>
<li>Mierzenie skutków różnych polityk</li>
<li>Formułowanie wniosków w oparciu o dowody empiryczne, a nie intuicję</li>
</ul>
<p>Statystyka dostarcza matematycznych podstaw do analizy danych, w tym projektowania badań, syntezy informacji i testowania hipotez. Nauka o danych rozszerza te możliwości, łącząc statystykę z umiejętnościami programowania i wiedzą dziedzinową, umożliwiając pracę ze złożonymi zbiorami danych.</p>
<p>W dzisiejszej erze cyfrowej, wraz z szybko rosnącą ilością dostępnych danych, kompetencje analityczne stały się niezbędne dla współczesnych badaczy i specjalistów nauk społecznych.</p>
<blockquote class="blockquote">
<p><strong>Uwaga</strong></p>
<p>W naukach społecznych nauka o danych stanowi zestaw metod do rozwiązywania złożonych problemów badawczych – łącząc podejścia statystyczne, narzędzia obliczeniowe i specjalistyczną wiedzę w celu skuteczniejszej analizy procesów społecznych.</p>
</blockquote>
</section>
<section id="związek-między-statystyką-a-nauką-o-danych" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="związek-między-statystyką-a-nauką-o-danych"><span class="header-section-number">2.2</span> Związek między Statystyką a Nauką o Danych</h2>
<p>Zamiast traktować statystykę i naukę o danych jako odrębne dyscypliny, korzystniej jest postrzegać je jako podejścia uzupełniające się w ramach spektrum metod analizy danych. Naukę o danych można rozumieć jako współczesne rozszerzenie tradycyjnej statystyki, które ewoluowało w odpowiedzi na:</p>
<ul>
<li>Nowe możliwości technologiczne</li>
<li>Potrzebę analizy coraz bardziej złożonych danych społecznych</li>
<li>Dostępność narzędzi obliczeniowych do przetwarzania dużych zbiorów danych</li>
</ul>
</section>
<section id="podstawowe-pojęcia-w-nauce-o-danych-i-statystyce" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="podstawowe-pojęcia-w-nauce-o-danych-i-statystyce"><span class="header-section-number">2.3</span> Podstawowe Pojęcia w Nauce o Danych i Statystyce</h2>
<section id="dane-i-populacje" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="dane-i-populacje"><span class="header-section-number">2.3.1</span> Dane i Populacje</h3>
<ol type="1">
<li><p><strong>Dane</strong>: Informacje zebrane podczas badania – obejmują odpowiedzi z ankiet, wyniki eksperymentów, wskaźniki ekonomiczne, treści z mediów społecznościowych lub wszelkie inne mierzalne obserwacje.</p></li>
<li><p><strong>Populacja</strong>: Pełny zbiór jednostek (osób, instytucji, zdarzeń), których dotyczy badanie – cała grupa, na temat której badacz chce wyciągnąć wnioski.</p>
<ul>
<li><em>Przykład</em>: W badaniu preferencji wyborczych populację stanowią wszyscy obywatele uprawnieni do głosowania w danym kraju.</li>
</ul></li>
<li><p><strong>Próba</strong>: Podzbiór populacji wybrany do badania. <strong>Reprezentatywna</strong> próba odzwierciedla kluczowe cechy populacji docelowej we właściwych proporcjach.</p>
<ul>
<li><em>Przykład</em>: Zamiast badać wszystkich uprawnionych do głosowania, badacze mogą analizować 1500 losowo wybranych osób, uwzględniając odpowiedni rozkład wieku, płci, wykształcenia i regionu zamieszkania.</li>
</ul>
<p>Właściwie dobrana próba umożliwia wnioskowanie o całej populacji przy jednoczesnym znacznym zmniejszeniu kosztów i czasu badań.</p></li>
<li><p><strong>Dobór próby</strong>: Procedura wybierania jednostek z populacji do badania. Nieobciążona metoda doboru próby daje każdej jednostce w populacji równą szansę wyboru, zapewniając reprezentatywne wyniki.</p></li>
<li><p><strong>Wnioskowanie statystyczne</strong>: Proces wyciągania wniosków o populacji na podstawie danych z próby. Obejmuje:</p>
<ul>
<li>Obliczanie oszacowań parametrów populacji</li>
<li>Ocenę wiarygodności tych oszacowań</li>
<li>Testowanie hipotez dotyczących cech populacji</li>
</ul></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/population_vs_sample.png" class="img-fluid figure-img"></p>
<figcaption>Proces wykorzystania próby do oszacowania parametru populacji. W tym przykładzie, w próbie 10 osób stwierdzono, że 6 posiada iPhone’a, co daje szacowaną proporcję w populacji na poziomie 60%. Rzeczywista proporcja w populacji wynosi 53,8%.</figcaption>
</figure>
</div>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TD
    DGP[Data Generating Process] --&gt;|Generates| A[Population]
    A --&gt;|Random Selection| B[Sample]
    B --&gt;|Statistical Inference| C[Estimates &amp; Conclusions]
    C --&gt;|Generalize back to| A
    C -.-&gt;|Attempt to understand| DGP

    style DGP fill:#1E90FF,stroke:#000,stroke-width:4px,color:#FFF
    style A fill:#DC143C,stroke:#000,stroke-width:4px,color:#FFF
    style B fill:#228B22,stroke:#000,stroke-width:2px,color:#FFF
    style C fill:#8B4513,stroke:#000,stroke-width:2px,color:#FFF
    
    classDef note fill:#F0F0F0,stroke:#000,stroke-width:1px;
    D[["DGP:
    Underlying process
    that generates data"]]
    E[["Population:
    Entire group of interest"]]
    F[["Sample:
    Subset of population"]]
    G[["Inference:
    Drawing conclusions
    about population
    and DGP"]]
    
    class D,E,F,G note
    
    D --&gt; DGP
    E --&gt; A
    F --&gt; B
    G --&gt; C
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Metody przechowywania danych w Data Science
</div>
</div>
<div class="callout-body-container callout-body">
<p>Naukowcy danych najczęściej pracują z następującymi formatami przechowywania:</p>
<ul>
<li><strong>CSV (Comma-Separated Values)</strong>: Simple text files where values are separated by commas.
<ul>
<li><strong>Zalety</strong>: Przenośne, czytelne dla człowieka, obsługiwane przez wszystkie narzędzia analityczne, łatwe w udostępnianiu.</li>
<li><strong>Wady</strong>: Brak wsparcia dla złożonych typów danych, ograniczona skalowalność dla dużych zbiorów danych, brak obsługi relacji, problemy z kodowaniem znaków.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reading CSV in R</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"dataset.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reading CSV in Python</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">"dataset.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>SQL Databases</strong>: Relacyjne bazy danych przechowujące dane w tabelach z zdefiniowanymi relacjami.
<ul>
<li><strong>Zalety</strong>: Doskonała obsługa złożonych relacji, wsparcie dla transakcji, współbieżności i integralności danych, zoptymalizowane zapytania, skalowalność.</li>
<li><strong>Wady</strong>: Większa złożoność obsługi, sztywna struktura danych, wyższe koszty utrzymania, problemy z horyzontalnymi skalowaniem.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Connecting to SQL database in R</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), <span class="st">"database.db"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"SELECT * FROM table_name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Connecting to SQL database in Python</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>conn <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"database.db"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * FROM table_name"</span>, conn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>Inne formaty</strong>:
<ul>
<li><strong>Parquet</strong>:
<ul>
<li><strong>Zalety</strong>: Kolumnowe przechowywanie zwiększające wydajność zapytań, kompresja, efektywna obsługa dużych zbiorów danych.</li>
<li><strong>Wady</strong>: Mniejsza elastyczność modyfikacji, ograniczona czytelność dla człowieka.</li>
</ul></li>
<li><strong>JSON</strong>:
<ul>
<li><strong>Zalety</strong>: Elastyczność dla danych zagnieżdżonych, powszechne wsparcie, czytelność dla człowieka.</li>
<li><strong>Wady</strong>: Większy rozmiar plików, wolniejsze parsowanie, brak standaryzacji typów.</li>
</ul></li>
<li><strong>NoSQL</strong>:
<ul>
<li><strong>Zalety</strong>: Elastyczność schematów, doskonała skalowalność horyzontalna, wydajność dla określonych przypadków użycia.</li>
<li><strong>Wady</strong>: Ograniczona spójność danych, mniej zaawansowane zapytania, mniejsze wsparcie dla złożonych relacji.</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="wnioskowanie-statystyczne-jak-mała-próba-może-reprezentować-dużą-populację" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="wnioskowanie-statystyczne-jak-mała-próba-może-reprezentować-dużą-populację"><span class="header-section-number">2.3.2</span> Wnioskowanie Statystyczne: Jak Mała Próba Może Reprezentować Dużą Populację?</h3>
<p>Kiedy ankieterzy badają tylko 1000 wyborców, aby przewidzieć wynik wyborów z 30 000 000 uprawnionych do głosowania (zaledwie 0,003% populacji), może się to wydawać zagadkowe. Jak tak niewielki ułamek może powiedzieć nam coś o całości?</p>
<p>To podobne do próbowania zupy. Gdy gotujesz duży garnek zupy i dokładnie ją mieszasz, nie musisz zjeść całego garnka, aby wiedzieć, jak smakuje. Wystarczy jedna łyżka – o ile zupa jest dobrze wymieszana.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>The Soup Analogy: A Taste of Statistics</strong></p>
<p><img src="stat_imgs/soup-svgrepo-com.svg" class="img-fluid" style="width:30.0%"></p>
<ul>
<li>When you taste a spoonful of soup and decide it isn’t salty enough, that’s exploratory/descriptive analysis.</li>
<li>If you generalize and conclude that your entire pot of soup needs salt, that’s an inference.</li>
<li>For your inference to be valid, the spoonful you tasted (the sample) needs to be representative of the entire pot (the population).</li>
<li>If the soup is not well stirred (heterogeneous population), it doesn’t matter how large a spoon you have (sample size), it will still not accurately represent the whole. If the soup is well stirred (homogeneous population), even a small spoon will suffice to test the soup.</li>
</ul>
</div>
</div>
<section id="dlaczego-losowy-dobór-próby-działa" class="level4" data-number="2.3.2.1">
<h4 data-number="2.3.2.1" class="anchored" data-anchor-id="dlaczego-losowy-dobór-próby-działa"><span class="header-section-number">2.3.2.1</span> Dlaczego Losowy Dobór Próby Działa</h4>
<p>Losowy dobór próby działa dzięki trzem kluczowym zasadom:</p>
<ol type="1">
<li><p><strong>Równe szanse</strong>: Każda osoba w populacji ma taką samą szansę na wybór, co zapobiega systematycznemu błędowi.</p></li>
<li><p><strong>Reprezentatywna różnorodność</strong>: Gdy każdy ma równą szansę, naturalnie otrzymujesz osoby ze wszystkich różnych grup w mniej więcej takich samych proporcjach, w jakich występują w populacji.</p>
<p><em>Przykład</em>: Jeśli 51% wyborców to kobiety, to około 51% twojej losowej próby prawdopodobnie będą stanowić kobiety (plus minus pewne losowe wahania).</p></li>
<li><p><strong>Prawo wielkich liczb</strong>: Wraz ze wzrostem wielkości próby (n), losowe wahania stają się mniej istotne, a statystyki próby zbliżają się do prawdziwych wartości populacji.</p>
<p><em>Przykład</em>: Jeśli rzucisz monetą 10 razy, możesz otrzymać 7 orłów (70%). Ale jeśli rzucisz nią 1000 razy, jest znacznie bardziej prawdopodobne, że otrzymasz około 500 orłów (50%).</p></li>
</ol>
<p>Bez właściwego losowego doboru próby można łatwo uzyskać próbę obciążoną. Na przykład, gdybyś przeprowadzał ankiety tylko wśród osób w centrum handlowym w dni powszednie rano, pominąłbyś większość pracujących osób i studentów, co dałoby zniekształcony obraz populacji.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Losowość jako fundamentalne prawo natury
</div>
</div>
<div class="callout-body-container callout-body">
<p>Losowość można postrzegać jako jedno z podstawowych praw natury, które kształtuje rzeczywistość na wielu poziomach:</p>
<ul>
<li><p><strong>W mechanice kwantowej</strong>: Zasada nieoznaczoności Heisenberga i probabilistyczna natura zjawisk kwantowych wskazują, że losowość jest wbudowana w fundamentalną strukturę rzeczywistości, a nie wynika jedynie z niedoskonałości naszych pomiarów czy wiedzy</p></li>
<li><p><strong>W genetyce</strong>: Losowe mutacje i rekombinacje genetyczne stanowią podstawowy mechanizm ewolucji i różnorodności biologicznej</p></li>
<li><p><strong>W teorii chaosu</strong>: Systemy deterministyczne mogą wykazywać nieprzewidywalne zachowania ze względu na wrażliwość na warunki początkowe (tzw. “efekt motyla”)</p></li>
<li><p><strong>W badaniach statystycznych</strong>: Losowy dobór próby jest podstawą wnioskowania o populacji - bez tej własności natury, nie bylibyśmy w stanie formułować wiarygodnych uogólnień z ograniczonych zbiorów danych</p></li>
</ul>
<p>Ta naturalna losowość staje się fundamentem metodologii nauk empirycznych, szczególnie widocznym w dwóch kluczowych aspektach:</p>
<p><strong>1. Randomizacja w eksperymentach</strong></p>
<p>Randomizacja to proces losowego przydzielania jednostek badawczych do grup eksperymentalnych. Jest to kluczowy element metodologii eksperymentalnej, który:</p>
<ul>
<li>Minimalizuje wpływ zmiennych zakłócających</li>
<li>Równoważy nieznane czynniki między grupami</li>
<li>Zmniejsza ryzyko błędu systematycznego</li>
<li>Umożliwia stosowanie testów statystycznych do analizy wyników</li>
</ul>
<p>Przykład w R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomizacja w eksperymencie</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>) <span class="co"># dla odtwarzalności</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>uczestnicy <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>  <span class="co"># 30 uczestników badania</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>grupy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Kontrolna"</span>, <span class="dv">15</span>), <span class="fu">rep</span>(<span class="st">"Eksperymentalna"</span>, <span class="dv">15</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>przydział_losowy <span class="ot">&lt;-</span> <span class="fu">sample</span>(grupy)  <span class="co"># losowy przydział do grup</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">data.frame</span>(<span class="at">ID =</span> uczestnicy[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">Grupa =</span> przydział_losowy[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ID           Grupa
1  1 Eksperymentalna
2  2       Kontrolna
3  3       Kontrolna
4  4 Eksperymentalna
5  5       Kontrolna
6  6       Kontrolna</code></pre>
</div>
</div>
<p><strong>2. Prosta próba losowa</strong></p>
<p>Prosta próba losowa to podstawowa metoda pobierania próby, w której każdy element populacji ma taką samą szansę na włączenie do próby. Ta własność losowości:</p>
<ul>
<li>Zapewnia reprezentatywność próby</li>
<li>Umożliwia wnioskowanie o parametrach populacji</li>
<li>Pozwala na obliczanie błędów losowych i konstruowanie przedziałów ufności</li>
</ul>
<p>Przykład w R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Losowanie prostej próby losowej z populacji</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>populacja <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>  <span class="co"># populacja 1000 elementów</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>próba <span class="ot">&lt;-</span> <span class="fu">sample</span>(populacja, <span class="dv">50</span>)  <span class="co"># losowa próba 50 elementów</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(próba)  <span class="co"># podstawowe statystyki wylosowanej próby</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    3.0   249.2   405.5   473.7   719.8   993.0 </code></pre>
</div>
</div>
<p>Uznanie losowości za prawo natury zmienia nasze postrzeganie rzeczywistości - z deterministycznego poglądu, gdzie wszystko jest teoretycznie przewidywalne przy wystarczającej wiedzy, na stochastyczny, gdzie niepewność i zmienność są nieodłącznymi cechami świata. Dzięki temu możemy projektować badania, które wykorzystują tę naturalną własność do wiarygodnego poznawania otaczającej nas rzeczywistości.</p>
</div>
</div>
</section>
</section>
<section id="zrozumienie-błędu-statystycznego" class="level3" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="zrozumienie-błędu-statystycznego"><span class="header-section-number">2.3.3</span> Zrozumienie Błędu Statystycznego</h3>
<p>Korzystając z próby do poznania populacji, nieuchronnie napotykamy błąd statystyczny:</p>
<p><strong>Błąd statystyczny</strong> to różnica między naszym oszacowaniem z próby a prawdziwą wartością w populacji.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Kompletna klasyfikacja błędów statystycznych
</div>
</div>
<div class="callout-body-container callout-body">
<p>Błędy statystyczne mogą podważyć wiarygodność i rzetelność wyników badań. Zrozumienie tych błędów jest kluczowe dla projektowania dobrych badań, prawidłowej analizy danych i wyciągania właściwych wniosków. Oto kompleksowa klasyfikacja błędów statystycznych:</p>
<section id="błędy-pobierania-próby" class="level3" data-number="2.3.4">
<h3 data-number="2.3.4" class="anchored" data-anchor-id="błędy-pobierania-próby"><span class="header-section-number">2.3.4</span> Błędy pobierania próby</h3>
<p><strong>Losowe błędy próbkowania</strong></p>
<ul>
<li>Możesz o nich myśleć jako o naturalnym “szczęściu w losowaniu” przy wyborze próby</li>
<li>Przykład: Jeśli losowo wybierzesz 30 studentów z uniwersytetu, aby zmierzyć średni wzrost, prawdopodobnie otrzymasz nieco inny wynik za każdym razem, gdy pobierzesz próbę</li>
<li>Te błędy zmniejszają się wraz ze zwiększaniem liczebności próby</li>
<li>Nie można ich całkowicie wyeliminować, ale można je oszacować za pomocą “marginesu błędu”</li>
</ul>
<p><strong>Nielosowe (systematyczne) błędy próbkowania</strong></p>
<ul>
<li><strong>Błąd doboru próby</strong>: Gdy próba nie reprezentuje uczciwie wszystkich, których powinna
<ul>
<li>Przykład: Przeprowadzenie ankiety telefonicznej docierającej tylko do osób posiadających telefony stacjonarne, pomijając tych, którzy korzystają wyłącznie z telefonów komórkowych</li>
</ul></li>
<li><strong>Niepełne pokrycie</strong>: Gdy niektóre grupy są pomijane w próbie
<ul>
<li>Przykład: Ankieta przeprowadzona tylko podczas zajęć dziennych pominie studentów studiów wieczorowych</li>
</ul></li>
<li><strong>Błąd samoselekcji</strong>: Gdy ludzie sami decydują, czy wziąć udział w badaniu, potencjalnie zniekształcając wyniki
<ul>
<li>Przykład: Tylko osoby z silnymi opiniami odpowiadają na ankietę zadowolenia klienta</li>
</ul></li>
<li><strong>Błąd braku odpowiedzi</strong>: Gdy określone typy osób zwykle nie odpowiadają na ankiety
<ul>
<li>Przykład: Bardzo zajęci ludzie mogą nie wypełnić kwestionariusza, co daje wyniki nadreprezentujące osoby z większą ilością wolnego czasu</li>
</ul></li>
</ul>
<p>Na przykład, jeśli obliczamy średni wzrost z próby, błąd standardowy mówi nam, jak bardzo ta średnia mogłaby się różnić, gdybyśmy wielokrotnie pobierali różne losowe próby. Jednak jeśli nasze urządzenie pomiarowe jest wadliwe i zawsze dodaje 2,5 cm do każdego pomiaru, mamy błąd systematyczny, którego zwiększenie wielkości próby nie naprawi.</p>
</section>
<section id="błędy-pomiaru" class="level3" data-number="2.3.5">
<h3 data-number="2.3.5" class="anchored" data-anchor-id="błędy-pomiaru"><span class="header-section-number">2.3.5</span> Błędy pomiaru</h3>
<p><strong>Losowe błędy pomiaru</strong></p>
<ul>
<li>Nieprzewidywalny “szum” podczas mierzenia czegokolwiek</li>
<li>Przykład: Lekko drżąca ręka przy pomiarze ciśnienia krwi daje nieco inne odczyty za każdym razem</li>
<li>Te błędy zazwyczaj równoważą się przy wielokrotnych pomiarach</li>
</ul>
<p><strong>Systematyczne błędy pomiaru</strong></p>
<ul>
<li><strong>Błędy kalibracji</strong>: Gdy narzędzie pomiarowe jest konsekwentnie niedokładne
<ul>
<li>Przykład: Waga, która zawsze dodaje 1 kg do wagi każdego</li>
</ul></li>
<li><strong>Błąd obserwatora</strong>: Gdy osoba zbierająca dane wpływa na pomiary
<ul>
<li>Przykład: Badacz nieświadomie zapisuje dane w sposób potwierdzający jego hipotezę</li>
</ul></li>
<li><strong>Błąd społecznej poprawności</strong>: Gdy ludzie odpowiadają tak, jak myślą, że “powinni”, a nie zgodnie z prawdą
<ul>
<li>Przykład: Zaniżanie ilości spożywanego fast foodu w badaniu żywieniowym</li>
</ul></li>
</ul>
</section>
<section id="błędy-wnioskowania" class="level3" data-number="2.3.6">
<h3 data-number="2.3.6" class="anchored" data-anchor-id="błędy-wnioskowania"><span class="header-section-number">2.3.6</span> Błędy wnioskowania</h3>
<p><strong>Błędy testowania hipotez</strong> (wyjaśnienie uproszczone)</p>
<ul>
<li><strong>Błąd I rodzaju</strong>: Dostrzeganie efektu lub związku, który tak naprawdę nie istnieje (fałszywy alarm)
<ul>
<li>Przykład: Wyciągnięcie wniosku, że lek działa, gdy jego korzyści wynikały tylko z przypadku</li>
</ul></li>
<li><strong>Błąd II rodzaju</strong>: Przeoczenie efektu lub związku, który faktycznie istnieje (przeoczenie)
<ul>
<li>Przykład: Wyciągnięcie wniosku, że lek nie działa, gdy w rzeczywistości pomaga pacjentom</li>
</ul></li>
<li><strong>Błąd III rodzaju</strong>: Rozwiązywanie niewłaściwego problemu lub zadawanie złego pytania
<ul>
<li>Przykład: Badanie, czy metoda nauczania poprawia wyniki testów, gdy prawdziwe pytanie powinno dotyczyć długoterminowego zrozumienia materiału</li>
</ul></li>
</ul>
<p><strong>Problemy z mocą statystyczną</strong></p>
<ul>
<li><strong>Badania z niedostateczną mocą</strong>: Nieuwzględnienie wystarczającej liczby uczestników, aby wiarygodnie wykryć efekty
<ul>
<li>Przykład: Próba przetestowania programu odchudzającego z udziałem tylko 5 osób — zbyt mało, aby wyciągnąć wiarygodne wnioski</li>
</ul></li>
</ul>
</section>
<section id="błędy-specyfikacji-modelu" class="level3" data-number="2.3.7">
<h3 data-number="2.3.7" class="anchored" data-anchor-id="błędy-specyfikacji-modelu"><span class="header-section-number">2.3.7</span> Błędy specyfikacji modelu</h3>
<p><strong>Błędy wyboru zmiennych</strong></p>
<ul>
<li><strong>Błąd pominięcia zmiennej</strong>: Pominięcie ważnych czynników wpływających na wyniki
<ul>
<li>Przykład: Badanie związku między ćwiczeniami a utratą wagi bez uwzględnienia diety uczestników</li>
</ul></li>
<li><strong>Błąd zmiennej zakłócającej</strong>: Gdy zewnętrzny czynnik wpływa zarówno na to, co testujesz, jak i na wynik
<ul>
<li>Przykład: Osoby, które ćwiczą (zmienna 1), mogą również mieć tendencję do zdrowszego odżywiania się (ukryty czynnik), co wpływa na utratę wagi (wynik)</li>
</ul></li>
</ul>
<p><strong>Błędy założeń</strong></p>
<ul>
<li>Gdy stosowany test statystyczny nie pasuje do twoich danych
<ul>
<li>Przykład: Używanie testu, który zakłada, że dane mają rozkład normalny (przypominający krzywą dzwonową), gdy w rzeczywistości tak nie jest</li>
</ul></li>
</ul>
</section>
<section id="błędy-przetwarzania-i-analizy-danych" class="level3" data-number="2.3.8">
<h3 data-number="2.3.8" class="anchored" data-anchor-id="błędy-przetwarzania-i-analizy-danych"><span class="header-section-number">2.3.8</span> Błędy przetwarzania i analizy danych</h3>
<p><strong>Błędy obsługi danych</strong></p>
<ul>
<li><strong>Błędy wprowadzania danych</strong>: Proste pomyłki przy zapisywaniu informacji
<ul>
<li>Przykład: Wpisanie “105” zamiast “15” jako wieku kogoś</li>
</ul></li>
<li><strong>Problemy z brakującymi danymi</strong>: Niewłaściwe uwzględnienie niekompletnych informacji
<ul>
<li>Przykład: Obliczanie średniego wyniku testu przy ignorowaniu nieobecnych uczniów</li>
</ul></li>
</ul>
<p><strong>Błędy wykonania analizy</strong></p>
<ul>
<li><strong>Błędy oprogramowania lub użytkownika</strong>: Pomyłki w korzystaniu z programów statystycznych
<ul>
<li>Przykład: Wybranie niewłaściwego rodzaju testu w oprogramowaniu statystycznym</li>
</ul></li>
</ul>
</section>
<section id="błędy-interpretacji-i-raportowania" class="level3" data-number="2.3.9">
<h3 data-number="2.3.9" class="anchored" data-anchor-id="błędy-interpretacji-i-raportowania"><span class="header-section-number">2.3.9</span> Błędy interpretacji i raportowania</h3>
<p><strong>Błędy wnioskowania przyczynowego</strong></p>
<ul>
<li><strong>Błąd mylenia korelacji z przyczynowością</strong>: Założenie, że gdy dwie rzeczy występują razem, jedna musi powodować drugą
<ul>
<li>Przykład: Zauważenie, że kraje z większym spożyciem czekolady mają więcej laureatów Nagrody Nobla i błędne wnioskowanie, że czekolada zwiększa inteligencję</li>
</ul></li>
</ul>
<p><strong>Błędy raportowania i komunikacji</strong></p>
<ul>
<li><strong>p-hacking (manipulacja wartością p)</strong>: Próbowanie wielu różnych analiz, aż znajdziesz coś “istotnego”
<ul>
<li>Przykład: Analizowanie danych na 20 różnych sposobów i raportowanie tylko tej analizy, która pokazała pożądany wynik</li>
</ul></li>
<li><strong>Wybiórcze raportowanie</strong>: Dzielenie się tylko wynikami potwierdzającymi hipotezę
<ul>
<li>Przykład: Firma produkująca tabletki odchudzające publikuje tylko badania, w których ich produkt działał, ukrywając badania, w których nie działał</li>
</ul></li>
</ul>
</section>
<section id="strategie-naprawcze" class="level3" data-number="2.3.10">
<h3 data-number="2.3.10" class="anchored" data-anchor-id="strategie-naprawcze"><span class="header-section-number">2.3.10</span> Strategie naprawcze</h3>
<p>Sposoby na zmniejszenie tych błędów:</p>
<ul>
<li><strong>Właściwe projektowanie badań</strong>: Staranne planowanie badań przed zebraniem danych</li>
<li><strong>Odpowiednia wielkość próby</strong>: Uwzględnienie wystarczającej liczby uczestników na podstawie obliczeń statystycznych</li>
<li><strong>Prerejestracja</strong>: Zadeklarowanie, co będziesz analizować, zanim zobaczysz dane</li>
<li><strong>Przejrzystość</strong>: Dzielenie się danymi i metodami analizy z innymi</li>
<li><strong>Replikacja</strong>: Powtórzenie badania przez innych badaczy, aby sprawdzić, czy otrzymają podobne wyniki</li>
</ul>
<p>Zrozumienie tych błędów pomaga zapewnić, że wyniki badań są wiarygodne i że nie wyciągamy fałszywych wniosków, które mogłyby prowadzić do złych decyzji w dziedzinach takich jak medycyna, polityka publiczna, edukacja i biznes.</p>
</section>
</div>
</div>
</section>
<section id="zagadnienia-doboru-wielkości-próby" class="level3" data-number="2.3.11">
<h3 data-number="2.3.11" class="anchored" data-anchor-id="zagadnienia-doboru-wielkości-próby"><span class="header-section-number">2.3.11</span> Zagadnienia Doboru Wielkości Próby</h3>
<p>Niezbędna wielkość próby zależy od trzech głównych czynników:</p>
<ol type="1">
<li><p><strong>Jaki rodzaj estymacji przeprowadzasz?</strong> (proporcje, średnie, parametry regresji, itp.)</p></li>
<li><p><strong>Jak dokładny ma być Twój szacunek?</strong></p>
<ul>
<li>Większa dokładność = większa próba</li>
<li>Przykład: Oszacowanie z dokładnością ±1% wymaga około 9 razy więcej osób niż szacowanie z dokładnością ±3%</li>
</ul></li>
<li><p><strong>Jak zróżnicowana jest Twoja populacja?</strong></p>
<ul>
<li>Dla proporcji: Maksymalna zmienność występuje przy 50%, minimalna przy 0% lub 100%</li>
<li>Dla średnich: Sprawdź, jak bardzo pomiary różnią się między sobą (wariancja)</li>
<li>Dla modeli regresji: Weź pod uwagę wariancję predyktorów i zmiennych wynikowych</li>
</ul></li>
</ol>
<section id="uwagi-dotyczące-małych-populacji" class="level4" data-number="2.3.11.1">
<h4 data-number="2.3.11.1" class="anchored" data-anchor-id="uwagi-dotyczące-małych-populacji"><span class="header-section-number">2.3.11.1</span> Uwagi dotyczące małych populacji</h4>
<p>Pracując z małymi populacjami (np. 1000 osób lub mniej):</p>
<ul>
<li>Istnieją znaczące różnice metodologiczne w porównaniu do dużych populacji</li>
<li>Prosta próba losowa tradycyjnie zakłada losowanie ze zwracaniem</li>
<li>W praktyce badawczej zwykle stosuje się losowanie bez zwracania</li>
<li>Im mniejsza populacja, tym większa różnica między tymi podejściami</li>
<li><strong>Współczynnik korekty dla populacji skończonej</strong> staje się niezbędny przy badaniu ponad 5-10% populacji</li>
</ul>
<p><strong>Praktyczne zalecenia dla małych populacji:</strong></p>
<ul>
<li>Dla populacji poniżej 200 jednostek, rozważ pełny spis (census)</li>
<li>Stosuj odpowiednie formuły statystyczne uwzględniające losowanie bez zwracania</li>
<li>Standardowe formuły dla błędów standardowych oparte na losowaniu ze zwracaniem przeszacują błąd w małych populacjach</li>
<li>Jasno dokumentuj mechanizm doboru próby w raportach badawczych</li>
</ul>
<p><strong>Wyjaśnienie różnicy:</strong></p>
<ul>
<li>Losowanie ze zwracaniem: każda jednostka ma stałe prawdopodobieństwo wyboru w każdym losowaniu (np. 1/N)</li>
<li>Losowanie bez zwracania: prawdopodobieństwo wyboru zmienia się w kolejnych losowaniach (od 1/N do 1/(N-1), 1/(N-2), itd.)</li>
<li>W dużych populacjach różnica jest minimalna; w małych - fundamentalna</li>
<li>Schematy losowania bez zwracania często mają niższą wariancję estymatora niż losowanie ze zwracaniem</li>
</ul>
</section>
</section>
<section id="aspekty-estymacji-statystycznej" class="level3" data-number="2.3.12">
<h3 data-number="2.3.12" class="anchored" data-anchor-id="aspekty-estymacji-statystycznej"><span class="header-section-number">2.3.12</span> Aspekty Estymacji Statystycznej</h3>
<section id="proporcje-odsetki" class="level4" data-number="2.3.12.1">
<h4 data-number="2.3.12.1" class="anchored" data-anchor-id="proporcje-odsetki"><span class="header-section-number">2.3.12.1</span> Proporcje (odsetki)</h4>
<p>Przy szacowaniu proporcji (np. odsetka wyborców popierających kandydata), wymagana wielkość próby zależy w dużej mierze od tego, jak blisko ta proporcja jest 50%.</p>
<p><strong>Dlaczego proporcje bliskie 50% wymagają większych prób:</strong></p>
<p>Posłużmy się konkretnym przykładem z różnymi wielkościami próby:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 46%">
<col style="width: 21%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th>Rzeczywista Proporcja w Populacji</th>
<th>Wielkość Próby</th>
<th>Typowy Margines Błędu</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>50% (maksymalna niepewność)</td>
<td>100</td>
<td>±10 punktów procentowych</td>
</tr>
<tr class="even">
<td>50% (maksymalna niepewność)</td>
<td>400</td>
<td>±5 punktów procentowych</td>
</tr>
<tr class="odd">
<td>50% (maksymalna niepewność)</td>
<td>1 000</td>
<td>±3 punktów procentowych</td>
</tr>
<tr class="even">
<td>10% (mniejsza niepewność)</td>
<td>100</td>
<td>±6 punktów procentowych</td>
</tr>
<tr class="odd">
<td>10% (mniejsza niepewność)</td>
<td>400</td>
<td>±3 punktów procentowych</td>
</tr>
<tr class="even">
<td>10% (mniejsza niepewność)</td>
<td>1 000</td>
<td>±2 punktów procentowych</td>
</tr>
</tbody>
</table>
<p>Te liczby pokazują dwa ważne wzorce: 1. <strong>Wraz ze wzrostem wielkości próby, margines błędu maleje</strong> (porównując wiersze) 2. <strong>Przy tej samej wielkości próby, proporcje bliskie 50% mają większe marginesy błędu</strong> niż proporcje bliskie 0% lub 100% (porównując 50% vs 10%)</p>
<p>Dzieje się tak, ponieważ proporcje podlegają rozkładowi dwumianowemu, gdzie wariancja jest maksymalna przy p=0,5 (50%) i minimalna przy p=0 lub p=1 (0% lub 100%).</p>
<p><strong>Wielkość populacji ma minimalny wpływ:</strong></p>
<p>W typowym sondażu wyborczym, gdzie proporcje są bliskie 50%, około 1000 losowo wybranych osób zapewnia dokładność około ±3 punktów procentowych. Co zaskakujące, ta wielkość próby pozostaje w przybliżeniu taka sama, niezależnie od tego, czy badana populacja liczy 30 000 czy 30 milionów osób. Ten nieintuicyjny fakt wyjaśnia, dlaczego ogólnokrajowe sondaże mogą być dokładne przy stosunkowo małych próbach.</p>
</section>
<section id="średnie" class="level4" data-number="2.3.12.2">
<h4 data-number="2.3.12.2" class="anchored" data-anchor-id="średnie"><span class="header-section-number">2.3.12.2</span> Średnie</h4>
<p>Przy szacowaniu średniej (np. typowego dochodu gospodarstwa domowego czy wzrostu):</p>
<ul>
<li>Średnia podsumowuje ciągłe pomiary, które mogą przyjmować wiele różnych wartości</li>
<li>Wielkość próby zależy głównie od tego, jak bardzo te pomiary różnią się między osobami</li>
<li>Kluczowe aspekty:
<ul>
<li>Populacje z bardziej zróżnicowanymi pomiarami wymagają większych prób</li>
<li>Bardziej precyzyjne oszacowania wymagają większych prób</li>
<li>W przeciwieństwie do proporcji, nie ma “maksymalnej niepewności” przy określonej wartości</li>
<li>Niezbędna wielkość próby jest wprost proporcjonalna do wariancji zmiennej</li>
</ul></li>
<li>Na przykład, oszacowanie średniego dochodu może wymagać większej próby niż oszacowanie średniego wzrostu, ponieważ dochody zazwyczaj różnią się bardziej niż wzrost</li>
</ul>
</section>
<section id="parametry-modeli-i-złożona-estymacja" class="level4" data-number="2.3.12.3">
<h4 data-number="2.3.12.3" class="anchored" data-anchor-id="parametry-modeli-i-złożona-estymacja"><span class="header-section-number">2.3.12.3</span> Parametry Modeli i Złożona Estymacja</h4>
<p>Modelowanie statystyczne wykracza poza proste proporcje i średnie, badając relacje między zmiennymi i tworząc prognozy. Wymagania dotyczące wielkości próby stają się bardziej złożone w tych kontekstach.</p>
<section id="parametry-modeli-regresji" class="level5" data-number="2.3.12.3.1">
<h5 data-number="2.3.12.3.1" class="anchored" data-anchor-id="parametry-modeli-regresji"><span class="header-section-number">2.3.12.3.1</span> Parametry Modeli Regresji</h5>
<p>Modele regresji opisują, jak jedna zmienna (zmienna zależna) odnosi się do jednej lub więcej innych zmiennych (zmiennych niezależnych). Aspekty dotyczące wielkości próby w regresji obejmują:</p>
<p><strong>Kluczowe czynniki wpływające na wymaganą wielkość próby:</strong></p>
<ul>
<li><strong>Liczba parametrów</strong>: Każda zmienna predykcyjna i termin interakcji zużywa “stopnie swobody”
<ul>
<li>Więcej zmiennych = potrzebna większa próba</li>
<li>Praktyczna zasada: 10-20 obserwacji na zmienną to minimalna wartość wyjściowa</li>
<li>Do wykrywania subtelnych efektów: może być potrzebne 50-100+ obserwacji na zmienną</li>
</ul></li>
<li><strong>Wielkość efektu</strong>: Siła badanych zależności
<ul>
<li>Mniejsze efekty wymagają większych prób, aby je wiarygodnie wykryć</li>
<li>Analiza mocy powinna być przeprowadzona w oparciu o spodziewane wielkości efektów</li>
</ul></li>
<li><strong>Wyjaśnienia zmienności</strong>:
<ul>
<li>Wartości <span class="math inline">R^2</span> - wyższe wartości wskazują na modele, które wyjaśniają więcej wariancji, potencjalnie wymagając mniejszych prób</li>
<li>Wariancja resztowa - większa niewyjaśniona zmienność wymaga większych prób</li>
</ul></li>
<li><strong>Złożoność modelu</strong>:
<ul>
<li>Relacje liniowe vs.&nbsp;nieliniowe</li>
<li>Efekty interakcji</li>
<li>Zagnieżdżone lub hierarchiczne struktury danych</li>
<li>Rozkłady nienormalne lub heteroskedastyczność</li>
</ul></li>
</ul>
</section>
<section id="zaawansowane-aspekty-modelowania" class="level5" data-number="2.3.12.3.2">
<h5 data-number="2.3.12.3.2" class="anchored" data-anchor-id="zaawansowane-aspekty-modelowania"><span class="header-section-number">2.3.12.3.2</span> Zaawansowane Aspekty Modelowania</h5>
<p><strong>Modele Wielopoziomowe i Hierarchiczne:</strong></p>
<ul>
<li>Te modele obsługują zagnieżdżone struktury danych (np. uczniowie w klasach w szkołach)</li>
<li>Wymagania wielkości próby działają na wielu poziomach:
<ul>
<li>Poziom 1: Indywidualne obserwacje (np. uczniowie)</li>
<li>Poziom 2: Czynniki grupujące (np. klasy)</li>
<li>Poziom 3: Grupy wyższego poziomu (np. szkoły)</li>
</ul></li>
<li>Praktyczna zasada: Potrzeba co najmniej 30+ grup na wyższych poziomach dla wiarygodnej estymacji</li>
<li>Moc zależy bardziej od liczby jednostek wyższego poziomu niż od całkowitej wielkości próby</li>
</ul>
<p><strong>Modele Równań Strukturalnych (SEM):</strong></p>
<ul>
<li>Złożone modele badające relacje między zmiennymi latentnymi</li>
<li>Wymagania dotyczące wielkości próby zazwyczaj większe niż przy prostej regresji</li>
<li>Zalecenia wahają się od minimum 200 do 10-20 obserwacji na szacowany parametr</li>
<li>Złożoność modelu i oczekiwane wielkości efektów mocno wpływają na wymagane wielkości prób</li>
</ul>
<p><strong>Podejścia Bayesowskie:</strong></p>
<ul>
<li>Wcześniejsze informacje mogą czasami kompensować mniejsze wielkości prób</li>
<li>Jednakże nadal wymagają wystarczających danych, szczególnie dla złożonych modeli</li>
<li>Kontrole predykcyjne a posteriori pomagają ocenić, czy wielkość próby jest odpowiednia</li>
</ul>
</section>
</section>
<section id="planowanie-wielkości-próby-w-praktyce" class="level4" data-number="2.3.12.4">
<h4 data-number="2.3.12.4" class="anchored" data-anchor-id="planowanie-wielkości-próby-w-praktyce"><span class="header-section-number">2.3.12.4</span> Planowanie Wielkości Próby w Praktyce</h4>
<p>Przy planowaniu badań należy wziąć pod uwagę:</p>
<ol type="1">
<li><strong>Moc statystyczna</strong>: Zdolność do wykrywania efektów, gdy rzeczywiście istnieją
<ul>
<li>Zazwyczaj dąży się do 80% mocy (lub wyższej dla krytycznych decyzji)</li>
<li>Przeprowadź formalne analizy mocy, gdy to możliwe</li>
</ul></li>
<li><strong>Precyzja</strong>: Jak wąskie muszą być przedziały ufności
<ul>
<li>Rozważ praktyczne znaczenie precyzji w swojej dziedzinie</li>
<li>Większa precyzja wymaga większych prób</li>
</ul></li>
<li><strong>Ograniczenia zasobów</strong>: Zrównoważ ideały statystyczne z praktycznymi ograniczeniami
<ul>
<li>Budżet, czas, dostępność uczestników</li>
<li>Rozważ sekwencyjne lub adaptacyjne pobieranie próbek, gdy jest to właściwe</li>
</ul></li>
<li><strong>Względy etyczne</strong>: Zbieraj wystarczająco dużo danych, aby wiarygodnie odpowiedzieć na pytania, ale nie marnuj zasobów ani nie obciążaj niepotrzebnie uczestników</li>
</ol>
<p>Pamiętaj, że są to wytyczne, a konkretne pytania badawcze mogą wymagać konsultacji ze statystykiem w celu optymalnego określenia wielkości próby.</p>
</section>
</section>
<section id="przykład-maksymalnej-niepewności-dla-proporcji-dlaczego-50-to-najgorszy-przypadek" class="level3" data-number="2.3.13">
<h3 data-number="2.3.13" class="anchored" data-anchor-id="przykład-maksymalnej-niepewności-dla-proporcji-dlaczego-50-to-najgorszy-przypadek"><span class="header-section-number">2.3.13</span> Przykład Maksymalnej Niepewności dla Proporcji: Dlaczego 50% to “Najgorszy Przypadek”</h3>
<p>Aby zrozumieć, dlaczego proporcje bliskie 50% wymagają większych prób, przyjrzyjmy się symulacji:</p>
<p>Wyobraź sobie, że masz 100 monet w torbie, które są albo złote, albo srebrne. Chcesz oszacować, jaki procent stanowią złote monety, losowo wybierając 20 monet.</p>
<p><strong>Scenariusz A: 50% Złotych (Maksymalna Niepewność)</strong></p>
<ul>
<li>Torba zawiera 50 złotych i 50 srebrnych monet (50% złotych)</li>
<li>Zasymulujmy losowanie 20 monet 10 różnych razy:
<ul>
<li>Losowanie 1: 8 złotych monet (40% - błąd o 10%)</li>
<li>Losowanie 2: 12 złotych monet (60% - błąd o 10%)</li>
<li>Losowanie 3: 9 złotych monet (45% - błąd o 5%)</li>
<li>Losowanie 4: 7 złotych monet (35% - błąd o 15%)</li>
<li>Losowanie 5: 11 złotych monet (55% - błąd o 5%)</li>
<li>Losowanie 6: 14 złotych monet (70% - błąd o 20%)</li>
<li>Losowanie 7: 8 złotych monet (40% - błąd o 10%)</li>
<li>Losowanie 8: 10 złotych monet (50% - idealnie!)</li>
<li>Losowanie 9: 7 złotych monet (35% - błąd o 15%)</li>
<li>Losowanie 10: 12 złotych monet (60% - błąd o 10%)</li>
</ul></li>
</ul>
<p>Te wyniki różnią się znacznie, od 35% do 70%, ze średnim błędem wynoszącym 10 punktów procentowych!</p>
<p><strong>Scenariusz B: 10% Złotych (Mniejsza Niepewność)</strong></p>
<ul>
<li>Torba zawiera 10 złotych i 90 srebrnych monet (10% złotych)</li>
<li>Zasymulujmy losowanie 20 monet 10 różnych razy:
<ul>
<li>Losowanie 1: 1 złota moneta (5% - błąd o 5%)</li>
<li>Losowanie 2: 2 złote monety (10% - idealnie!)</li>
<li>Losowanie 3: 3 złote monety (15% - błąd o 5%)</li>
<li>Losowanie 4: 1 złota moneta (5% - błąd o 5%)</li>
<li>Losowanie 5: 2 złote monety (10% - idealnie!)</li>
<li>Losowanie 6: 0 złotych monet (0% - błąd o 10%)</li>
<li>Losowanie 7: 3 złote monety (15% - błąd o 5%)</li>
<li>Losowanie 8: 2 złote monety (10% - idealnie!)</li>
<li>Losowanie 9: 1 złota moneta (5% - błąd o 5%)</li>
<li>Losowanie 10: 2 złote monety (10% - idealnie!)</li>
</ul></li>
</ul>
<p>Te wyniki pozostają znacznie bliżej prawdziwych 10%, wahając się od 0% do 15%, ze średnim błędem wynoszącym tylko 4 punkty procentowe.</p>
<p>To pokazuje, dlaczego potrzebujemy większych prób, gdy proporcja jest bliska 50% - naturalna zmienność jest znacznie większa. Gdy prawdziwa proporcja wynosi 50%, każde odchylenie od tej idealnej równowagi jest równie prawdopodobne w dowolnym kierunku, tworząc maksymalną niepewność.</p>
<section id="przykład-sondażu-opinii-popularni-a-niepopularni-kandydaci" class="level4" data-number="2.3.13.1">
<h4 data-number="2.3.13.1" class="anchored" data-anchor-id="przykład-sondażu-opinii-popularni-a-niepopularni-kandydaci"><span class="header-section-number">2.3.13.1</span> Przykład Sondażu Opinii: Popularni a Niepopularni Kandydaci</h4>
<p>W sondażu wyborczym z 1000 osób:</p>
<p><strong>Dla głównego kandydata z poparciem 40%:</strong></p>
<ul>
<li>Nasza dokładność wyniosłaby około ±3 punktów procentowych</li>
<li>Możemy oszacować jego poparcie między 37% a 43%</li>
</ul>
<p><strong>Dla kandydata z mniejszym poparciem 3%:</strong></p>
<ul>
<li>Nasza dokładność wyniosłaby około ±1 punkt procentowy</li>
<li>Możemy oszacować jego poparcie między 2% a 4%</li>
</ul>
<p><strong>Ważne wyjaśnienie dotyczące dokładności:</strong></p>
<ol type="1">
<li><p><strong>Dokładność bezwzględna (w punktach procentowych):</strong></p>
<ul>
<li>Dla kandydata z mniejszym poparciem (3%): ±1 punkt procentowy (mniejszy błąd bezwzględny)</li>
<li>Dla głównego kandydata (40%): ±3 punkty procentowe (większy błąd bezwzględny)</li>
</ul></li>
<li><p><strong>Dokładność względna (jako proporcja oszacowania):</strong></p>
<ul>
<li>Dla kandydata z mniejszym poparciem (3%): ±1 punkt procentowy to 33% jego poziomu poparcia</li>
<li>Dla głównego kandydata (40%): ±3 punkty procentowe to tylko 7,5% jego poziomu poparcia</li>
</ul></li>
</ol>
<p>To wyjaśnia, dlaczego sondaże mogą wiarygodnie wykrywać obecność kandydatów z mniejszym poparciem, ale mogą mieć trudności z precyzyjnym mierzeniem małych zmian w ich poziomach poparcia. Ta sama wielkość próby daje różne dokładności bezwzględne w zależności od tego, jak blisko proporcja jest 50%.</p>
</section>
</section>
<section id="podsumowanie-kluczowe-punkty-do-zapamiętania" class="level3" data-number="2.3.14">
<h3 data-number="2.3.14" class="anchored" data-anchor-id="podsumowanie-kluczowe-punkty-do-zapamiętania"><span class="header-section-number">2.3.14</span> Podsumowanie: Kluczowe Punkty do Zapamiętania</h3>
<ol type="1">
<li><p><strong>Statystyka i nauka o danych</strong> dostarczają niezbędnych narzędzi do zrozumienia zjawisk społecznych poprzez analizę danych.</p></li>
<li><p><strong>Właściwie dobrane próby</strong> pozwalają na wiarygodne wnioskowanie o całych populacjach bez badania wszystkich.</p></li>
<li><p><strong>Błąd statystyczny</strong> występuje w dwóch formach:</p>
<ul>
<li>Błąd losowy (zmniejszany przez większe próby)</li>
<li>Błąd systematyczny (zmniejszany przez lepszą metodologię)</li>
</ul></li>
<li><p><strong>Potrzebna wielkość próby</strong> zależy od:</p>
<ul>
<li>Co mierzysz (proporcje czy średnie)</li>
<li>Pożądanej dokładności</li>
<li>Zmienności w populacji</li>
<li>W przypadku proporcji, wartości bliskie 50% wymagają większych prób</li>
</ul></li>
<li><p><strong>Małe populacje</strong> wymagają specjalnych rozważań dotyczących doboru próby i mogą korzystać z współczynnika korekty dla populacji skończonej.</p></li>
</ol>
<p>Zrozumienie tych podstawowych pojęć pozwoli ci lepiej projektować i interpretować badania w naukach społecznych.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">SRS</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Dobór warstwowy</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Dobór grupowy</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p><strong>Prosty Dobór Losowy</strong>: Każda jednostka ma równe prawdopodobieństwo wyboru. Cała populacja jest losowo próbkowana bez żadnego z góry ustalonego wzorca.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/Simple_Random_Sampling2.svg" class="img-fluid figure-img"></p>
<figcaption>Prosty Dobór Losowy. Źródło: https://app.passyourmath.com/courses/theory/116/1750/26640/en</figcaption>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p><strong>Dobór Warstwowy</strong>: Populacja jest podzielona na odrębne podgrupy (warstwy) przed losowym pobraniem próbek z każdej warstwy proporcjonalnie.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/Stratified2.svg" class="img-fluid figure-img"></p>
<figcaption>Dobór Warstwowy. Źródło: https://app.passyourmath.com/courses/theory/116/1750/26640/en</figcaption>
</figure>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p><strong>Dobór Grupowy</strong>: Populacja jest podzielona na skupiska (klastry), a całe skupiska są losowo wybierane do analizy zamiast pojedynczych jednostek.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/Cluster2.svg" class="img-fluid figure-img"></p>
<figcaption>Dobór Grupowy. Źródło: https://app.passyourmath.com/courses/theory/116/1750/26640/en</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data Generating Process i Superpopulacja w kontekście badań statystycznych
</div>
</div>
<div class="callout-body-container callout-body">
<p>W statystyce i ekonometrii często posługujemy się pojęciami populacji i próby. Jednak dla pełnego zrozumienia statystycznych modeli warto wprowadzić dwa dodatkowe koncepty: <strong>data generating process (DGP)</strong> oraz <strong>superpopulację</strong>. Pojęcia te pomogą lepiej zrozumieć, w jaki sposób powstają dane, które analizujemy.</p>
<section id="podstawowe-pojęcia" class="level3" data-number="2.3.15">
<h3 data-number="2.3.15" class="anchored" data-anchor-id="podstawowe-pojęcia"><span class="header-section-number">2.3.15</span> Podstawowe pojęcia</h3>
<p><strong>Populacja</strong>: Zbiór wszystkich jednostek (osób, firm, krajów itp.), które są przedmiotem naszego badania. Przykładowo, wszystkie gospodarstwa domowe w Polsce.</p>
<p><strong>Próba</strong>: Podzbiór populacji, który badamy, aby wyciągnąć wnioski o całej populacji. Przykładowo, 1000 losowo wybranych gospodarstw domowych w Polsce.</p>
</section>
<section id="data-generating-process-dgp" class="level3" data-number="2.3.16">
<h3 data-number="2.3.16" class="anchored" data-anchor-id="data-generating-process-dgp"><span class="header-section-number">2.3.16</span> Data Generating Process (DGP)</h3>
<p><strong>Data Generating Process</strong> (proces generujący dane) to mechanizm lub model stochastyczny (losowy), który określa, w jaki sposób powstają wartości zmiennych, które obserwujemy.</p>
<p>Kluczowe cechy DGP:</p>
<ul>
<li>Jest to abstrakcyjny, matematyczny model opisujący, jak zmienne są ze sobą powiązane</li>
<li>Zawiera zarówno element deterministyczny (przewidywalny), jak i losowy (nieprzewidywalny)</li>
<li>Zwykle wyrażany za pomocą równań i rozkładów prawdopodobieństwa</li>
</ul>
<section id="przykład-dgp" class="level4" data-number="2.3.16.1">
<h4 data-number="2.3.16.1" class="anchored" data-anchor-id="przykład-dgp"><span class="header-section-number">2.3.16.1</span> Przykład DGP:</h4>
<p>Załóżmy, że badamy dochody gospodarstw domowych. Model DGP (równanie matematyczne) mógłby wyglądać tak:</p>
<p><span class="math inline">Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \varepsilon_i</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">Y_i</span> to dochód gospodarstwa domowego <span class="math inline">i</span></li>
<li><span class="math inline">X_{1i}</span> to liczba osób pracujących w gospodarstwie <span class="math inline">i</span></li>
<li><span class="math inline">X_{2i}</span> to poziom wykształcenia głównego żywiciela gospodarstwa <span class="math inline">i</span></li>
<li><span class="math inline">\varepsilon_i</span> to czynnik losowy (błąd)</li>
<li><span class="math inline">\beta_0, \beta_1, \beta_2</span> to parametry modelu</li>
</ul>
<p>W tym przykładzie DGP określa, jak dochód zależy od liczby pracujących osób i wykształcenia, plus element losowy.</p>
</section>
</section>
<section id="superpopulacja" class="level3" data-number="2.3.17">
<h3 data-number="2.3.17" class="anchored" data-anchor-id="superpopulacja"><span class="header-section-number">2.3.17</span> Superpopulacja</h3>
<p><strong>Superpopulacja</strong> to hipotetyczna, nieskończona populacja, z której nasza rzeczywista populacja może być traktowana jako próba.</p>
<p>Kluczowe cechy superpopulacji:</p>
<ul>
<li>Jest konceptualnym rozszerzeniem pojęcia populacji</li>
<li>Reprezentuje wszystkie możliwe realizacje procesu generującego dane (DGP)</li>
<li>Pozwala na wnioskowanie nie tylko o aktualnej populacji, ale o ogólnych prawidłowościach</li>
</ul>
<section id="przykłady-superpopulacji" class="level4" data-number="2.3.17.1">
<h4 data-number="2.3.17.1" class="anchored" data-anchor-id="przykłady-superpopulacji"><span class="header-section-number">2.3.17.1</span> Przykłady superpopulacji:</h4>
<ol type="1">
<li><p>Badamy wyniki matur w Polsce w 2024 roku (populacja). Superpopulacja to hipotetyczne wyniki matur wszystkich możliwych uczniów, którzy mogliby zdawać maturę w podobnych warunkach, w dowolnym roku.</p></li>
<li><p>Analizujemy PKB krajów europejskich w 2023 roku (populacja). Superpopulacja to wszystkie możliwe realizacje PKB tych krajów w różnych warunkach gospodarczych.</p></li>
</ol>
</section>
</section>
<section id="relacje-między-pojęciami" class="level3" data-number="2.3.18">
<h3 data-number="2.3.18" class="anchored" data-anchor-id="relacje-między-pojęciami"><span class="header-section-number">2.3.18</span> Relacje między pojęciami</h3>
<pre><code>DGP → Superpopulacja → Populacja → Próba</code></pre>
<ul>
<li><strong>DGP</strong> definiuje mechanizm generowania danych</li>
<li><strong>Superpopulacja</strong> to wszystkie możliwe realizacje DGP</li>
<li><strong>Populacja</strong> to konkretna, skończona realizacja z superpopulacji</li>
<li><strong>Próba</strong> to podzbiór populacji, który faktycznie obserwujemy i analizujemy</li>
</ul>
</section>
<section id="praktyczne-znaczenie" class="level3" data-number="2.3.19">
<h3 data-number="2.3.19" class="anchored" data-anchor-id="praktyczne-znaczenie"><span class="header-section-number">2.3.19</span> Praktyczne znaczenie</h3>
<section id="dlaczego-te-pojęcia-są-ważne" class="level4" data-number="2.3.19.1">
<h4 data-number="2.3.19.1" class="anchored" data-anchor-id="dlaczego-te-pojęcia-są-ważne"><span class="header-section-number">2.3.19.1</span> Dlaczego te pojęcia są ważne?</h4>
<ol type="1">
<li><p><strong>Modelowanie ekonometryczne</strong> - DGP jest fundamentem modelowania ekonometrycznego, pozwala zrozumieć, jak zmienne ekonomiczne wpływają na siebie nawzajem.</p></li>
<li><p><strong>Wnioskowanie statystyczne</strong> - Koncepcja superpopulacji pozwala na formułowanie wniosków ogólnych, wykraczających poza konkretny moment czasowy czy grupę.</p></li>
<li><p><strong>Prognozowanie</strong> - Zrozumienie DGP umożliwia lepsze prognozowanie przyszłych wartości zmiennych ekonomicznych.</p></li>
<li><p><strong>Weryfikacja hipotez</strong> - Pozwala lepiej określić, czy zaobserwowane zależności są dziełem przypadku, czy odzwierciedlają rzeczywiste prawidłowości.</p></li>
</ol>
</section>
</section>
<section id="przykład-zastosowania-w-ekonomii" class="level3" data-number="2.3.20">
<h3 data-number="2.3.20" class="anchored" data-anchor-id="przykład-zastosowania-w-ekonomii"><span class="header-section-number">2.3.20</span> Przykład zastosowania w ekonomii</h3>
<p>Załóżmy, że ekonomista bada wpływ stóp procentowych na inflację:</p>
<ul>
<li><strong>DGP</strong>: Równanie opisujące, jak stopa procentowa i inne czynniki wpływają na inflację</li>
<li><strong>Superpopulacja</strong>: Wszystkie możliwe wartości inflacji przy różnych poziomach stóp procentowych i innych czynników</li>
<li><strong>Populacja</strong>: Faktyczne wartości inflacji we wszystkich krajach w danym okresie</li>
<li><strong>Próba</strong>: Dane o inflacji z 30 wybranych krajów, które badamy</li>
</ul>
</section>
<section id="przykłady-ze-studiów-wyborczych" class="level3" data-number="2.3.21">
<h3 data-number="2.3.21" class="anchored" data-anchor-id="przykłady-ze-studiów-wyborczych"><span class="header-section-number">2.3.21</span> Przykłady ze studiów wyborczych</h3>
<p><strong>Przykład 1: Frekwencja wyborcza</strong></p>
<ul>
<li><strong>DGP</strong>: <span class="math inline">Frekwencja_i = \beta_0 + \beta_1 Wiek_i + \beta_2 Wykształcenie_i + \beta_3 Dochód_i + \varepsilon_i</span></li>
<li><strong>Superpopulacja</strong>: Wszystkie możliwe decyzje o udziale w wyborach, które mogliby podjąć wyborcy o różnych cechach społeczno-demograficznych w różnych warunkach</li>
<li><strong>Populacja</strong>: Wszyscy uprawnieni do głosowania w wyborach prezydenckich 2020</li>
<li><strong>Próba</strong>: 1500 respondentów ankiety exit poll po wyborach</li>
</ul>
<p><strong>Przykład 2: Poparcie dla partii politycznych</strong></p>
<ul>
<li><strong>DGP</strong>: <span class="math inline">Poparcie_{ij} = \beta_0 + \beta_1 Ideologia_i + \beta_2 SytuacjaEkonomiczna_i + \beta_3 Wiek_i + \varepsilon_i</span></li>
<li><strong>Superpopulacja</strong>: Wszystkie możliwe preferencje wyborcze osób o różnych cechach w różnych warunkach społeczno-ekonomicznych</li>
<li><strong>Populacja</strong>: Wszyscy wyborcy w Polsce w 2023 roku</li>
<li><strong>Próba</strong>: Respondenci sondażu przedwyborczego (n=1000)</li>
</ul>
</section>
<section id="symulacja-i-estymacja-funkcji-popytu-jako-dgp-w-r" class="level3" data-number="2.3.22">
<h3 data-number="2.3.22" class="anchored" data-anchor-id="symulacja-i-estymacja-funkcji-popytu-jako-dgp-w-r"><span class="header-section-number">2.3.22</span> Symulacja i estymacja funkcji popytu jako DGP w R</h3>
<p>Poniższy kod ilustruje, jak można zasymulować funkcję popytu z wieloma predyktorami jako DGP i estymować jej parametry za pomocą regresji OLS:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Załadowanie potrzebnych pakietów</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ustawienie ziarna losowości dla powtarzalnych wyników</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Zdefiniowanie "prawdziwego" DGP: Funkcja popytu na produkt</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Model: Q = beta0 + beta1*P + beta2*I + beta3*P_sub + beta4*P_comp + beta5*A + epsilon</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Gdzie:</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Q = ilość popytu na produkt</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># P = cena produktu</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co"># I = dochód konsumentów</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># P_sub = cena dobra substytucyjnego</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># P_comp = cena dobra komplementarnego</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co"># A = wydatki na reklamę</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Prawdziwe wartości parametrów (zgodne z teorią ekonomiczną)</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>beta0_true <span class="ot">&lt;-</span> <span class="dv">100</span>      <span class="co"># Stała</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>beta1_true <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.5</span>     <span class="co"># Efekt własnej ceny (ujemny - zgodnie z prawem popytu)</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>beta2_true <span class="ot">&lt;-</span> <span class="fl">0.8</span>      <span class="co"># Efekt dochodu (dodatni - dobro normalne)</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>beta3_true <span class="ot">&lt;-</span> <span class="fl">1.2</span>      <span class="co"># Efekt ceny substytutu (dodatni)</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>beta4_true <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.7</span>     <span class="co"># Efekt ceny dobra komplementarnego (ujemny)</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>beta5_true <span class="ot">&lt;-</span> <span class="fl">0.5</span>      <span class="co"># Efekt reklamy (dodatni)</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>sigma_true <span class="ot">&lt;-</span> <span class="dv">5</span>        <span class="co"># Odchylenie standardowe błędu losowego</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Symulacja superpopulacji (5000 potencjalnych rynków/okresów)</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>n_super <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Generowanie predyktorów</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>cena <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_super, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)               <span class="co"># Cena produktu (zł)</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>dochod <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_super, <span class="at">mean =</span> <span class="dv">3000</span>, <span class="at">sd =</span> <span class="dv">500</span>)         <span class="co"># Średni dochód (zł)</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>cena_substytutu <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_super, <span class="at">min =</span> <span class="dv">4</span>, <span class="at">max =</span> <span class="dv">16</span>)    <span class="co"># Cena substytutu (zł)</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>cena_komplementu <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_super, <span class="at">min =</span> <span class="dv">2</span>, <span class="at">max =</span> <span class="dv">8</span>)    <span class="co"># Cena komplementu (zł)</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>reklama <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_super, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">100</span>)           <span class="co"># Wydatki na reklamę (tys. zł)</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Dodanie korelacji między zmiennymi (np. cena i cena substytutu)</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>cena_substytutu <span class="ot">&lt;-</span> cena_substytutu <span class="sc">+</span> <span class="fu">rnorm</span>(n_super, <span class="at">mean =</span> <span class="fl">0.2</span> <span class="sc">*</span> cena, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Generowanie popytu zgodnie z DGP</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_super, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma_true)  <span class="co"># Składnik losowy</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>popyt <span class="ot">&lt;-</span> beta0_true <span class="sc">+</span> </span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>         beta1_true <span class="sc">*</span> cena <span class="sc">+</span> </span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>         beta2_true <span class="sc">*</span> (dochod<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">+</span>  <span class="co"># skalowanie dochodu dla lepszej interpretacji</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>         beta3_true <span class="sc">*</span> cena_substytutu <span class="sc">+</span> </span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>         beta4_true <span class="sc">*</span> cena_komplementu <span class="sc">+</span> </span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>         beta5_true <span class="sc">*</span> (reklama<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span>    <span class="co"># skalowanie reklamy dla lepszej interpretacji</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>         epsilon</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie ramki danych superpopulacji</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>superpopulacja <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n_super,</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">cena =</span> cena,</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">dochod =</span> dochod,</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">cena_substytutu =</span> cena_substytutu,</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">cena_komplementu =</span> cena_komplementu,</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">reklama =</span> reklama,</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">popyt =</span> popyt</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Pokaż kilka pierwszych obserwacji</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(superpopulacja)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
     id  cena dochod cena_substytutu cena_komplementu reklama popyt
  &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1     1  7.88  2661.           11.9              7.95    50.4  89.5
2     2 12.9   3287.            7.10             3.81    88.5  79.6
3     3  9.09  2648.           14.5              4.60    94.1  87.7
4     4 13.8   2733.           19.0              2.96    80.3  84.1
5     5 14.4   3387.           11.1              6.94    66.0  73.0
6     6  5.46  2762.           13.2              3.25    32.8  95.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Pobieranie próby z superpopulacji (np. 200 obserwacji)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>n_sample <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>indeksy_proby <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n_super, n_sample)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>proba <span class="ot">&lt;-</span> superpopulacja[indeksy_proby, ]</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Estymacja modelu OLS na podstawie próby</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>model_ols <span class="ot">&lt;-</span> <span class="fu">lm</span>(popyt <span class="sc">~</span> cena <span class="sc">+</span> <span class="fu">I</span>(dochod<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">+</span> cena_substytutu <span class="sc">+</span> </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                cena_komplementu <span class="sc">+</span> <span class="fu">I</span>(reklama<span class="sc">/</span><span class="dv">10</span>), <span class="at">data =</span> proba)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Wyświetlenie podsumowania modelu</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_ols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = popyt ~ cena + I(dochod/1000) + cena_substytutu + 
    cena_komplementu + I(reklama/10), data = proba)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.5705  -2.8401   0.1072   2.9881  14.1873 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       99.8079     2.7949  35.711  &lt; 2e-16 ***
cena              -2.3571     0.1196 -19.711  &lt; 2e-16 ***
I(dochod/1000)     0.5259     0.6850   0.768 0.443582    
cena_substytutu    1.1635     0.0918  12.674  &lt; 2e-16 ***
cena_komplementu  -0.7483     0.1933  -3.871 0.000148 ***
I(reklama/10)      0.5600     0.1170   4.785 3.38e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.843 on 194 degrees of freedom
Multiple R-squared:  0.7377,    Adjusted R-squared:  0.7309 
F-statistic: 109.1 on 5 and 194 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Porównanie prawdziwych parametrów z estymowanymi</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>parametry_prawdziwe <span class="ot">&lt;-</span> <span class="fu">c</span>(beta0_true, beta1_true, beta2_true, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                         beta3_true, beta4_true, beta5_true)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>parametry_estymowane <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_ols)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>porownanie <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">parametr =</span> <span class="fu">c</span>(<span class="st">"Stała"</span>, <span class="st">"Cena"</span>, <span class="st">"Dochód (tys.)"</span>, <span class="st">"Cena substytutu"</span>, </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Cena komplementu"</span>, <span class="st">"Reklama (10 tys.)"</span>),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  prawdziwa_wartość <span class="ot">=</span> parametry_prawdziwe,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  estymowana_wartość <span class="ot">=</span> parametry_estymowane,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  różnica <span class="ot">=</span> estymowana_wartość <span class="sc">-</span> prawdziwa_wartość,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  błąd<span class="at">_procentowy =</span> <span class="fu">abs</span>(różnica <span class="sc">/</span> prawdziwa_wartość) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Wyświetlenie porównania</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(porownanie)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  parametr          prawdziwa_wartość estymowana_wartość różnica błąd_procentowy
  &lt;chr&gt;                         &lt;dbl&gt;              &lt;dbl&gt;   &lt;dbl&gt;           &lt;dbl&gt;
1 Stała                         100               99.8   -0.192            0.192
2 Cena                           -2.5             -2.36   0.143            5.72 
3 Dochód (tys.)                   0.8              0.526 -0.274           34.3  
4 Cena substytutu                 1.2              1.16  -0.0365           3.04 
5 Cena komplementu               -0.7             -0.748 -0.0483           6.90 
6 Reklama (10 tys.)               0.5              0.560  0.0600          12.0  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Wizualizacja porównania prawdziwych i estymowanych parametrów</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(porownanie, <span class="fu">aes</span>(<span class="at">x =</span> parametr, <span class="at">y =</span> prawdziwa_wartość)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> estymowana_wartość), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> parametr, <span class="at">y =</span> prawdziwa_wartość, </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> estymowana_wartość), <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Porównanie prawdziwego DGP z estymowanym modelem"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Niebieskie punkty: prawdziwe wartości, czerwone punkty: estymowane wartości"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Parametr"</span>, <span class="at">y =</span> <span class="st">"Wartość"</span>) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. Sprawdzenie zdolności predykcyjnej modelu na nowych danych</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Pobieramy nowe dane z superpopulacji (nie używane w estymacji)</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>nowe_indeksy <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n_super, indeksy_proby), <span class="dv">100</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>nowe_dane <span class="ot">&lt;-</span> superpopulacja[nowe_indeksy, ]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Predykcja na nowych danych</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>nowe_dane<span class="sc">$</span>przewidywany_popyt <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_ols, <span class="at">newdata =</span> nowe_dane)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie błędu średniokwadratowego (MSE) predykcji</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((nowe_dane<span class="sc">$</span>popyt <span class="sc">-</span> nowe_dane<span class="sc">$</span>przewidywany_popyt)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mse)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pierwiastek błędu średniokwadratowego (RMSE):"</span>, <span class="fu">round</span>(rmse, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pierwiastek błędu średniokwadratowego (RMSE): 5.47 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. Wizualizacja relacji między ceną a popytem</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (efekt ceteris paribus - przy kontroli innych zmiennych)</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>ceteris_paribus <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cena =</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">dochod =</span> <span class="fu">mean</span>(proba<span class="sc">$</span>dochod),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cena_substytutu =</span> <span class="fu">mean</span>(proba<span class="sc">$</span>cena_substytutu),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cena_komplementu =</span> <span class="fu">mean</span>(proba<span class="sc">$</span>cena_komplementu),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">reklama =</span> <span class="fu">mean</span>(proba<span class="sc">$</span>reklama)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie przewidywanego popytu według prawdziwego DGP</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>ceteris_paribus<span class="sc">$</span>popyt_prawdziwy <span class="ot">&lt;-</span> beta0_true <span class="sc">+</span> </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>                                 beta1_true <span class="sc">*</span> ceteris_paribus<span class="sc">$</span>cena <span class="sc">+</span> </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>                                 beta2_true <span class="sc">*</span> (ceteris_paribus<span class="sc">$</span>dochod<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">+</span> </span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>                                 beta3_true <span class="sc">*</span> ceteris_paribus<span class="sc">$</span>cena_substytutu <span class="sc">+</span> </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>                                 beta4_true <span class="sc">*</span> ceteris_paribus<span class="sc">$</span>cena_komplementu <span class="sc">+</span> </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>                                 beta5_true <span class="sc">*</span> (ceteris_paribus<span class="sc">$</span>reklama<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie przewidywanego popytu według estymowanego modelu</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>ceteris_paribus<span class="sc">$</span>popyt_estymowany <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_ols, <span class="at">newdata =</span> ceteris_paribus)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Wizualizacja</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ceteris_paribus, <span class="fu">aes</span>(<span class="at">x =</span> cena)) <span class="sc">+</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> popyt_prawdziwy, <span class="at">color =</span> <span class="st">"Prawdziwy DGP"</span>), <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> popyt_estymowany, <span class="at">color =</span> <span class="st">"Estymowany model"</span>), <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Prawdziwy DGP"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Estymowany model"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Krzywa popytu: Prawdziwy DGP vs. Estymowany model"</span>,</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Efekt ceteris paribus (przy stałych wartościach innych zmiennych)"</span>,</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Cena produktu (zł)"</span>,</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Popyt (ilość)"</span>,</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Model"</span>) <span class="sc">+</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ten kod pokazuje:</p>
<ol type="1">
<li>Definiowanie złożonego DGP dla funkcji popytu z wieloma predyktorami zgodnej z teorią ekonomiczną</li>
<li>Symulowanie superpopulacji zgodnie z tym DGP</li>
<li>Pobieranie próby z superpopulacji</li>
<li>Estymację parametrów modelu za pomocą regresji OLS</li>
<li>Porównanie estymowanych parametrów z ich prawdziwymi wartościami</li>
<li>Wizualizację porównania prawdziwych i estymowanych parametrów</li>
<li>Sprawdzenie zdolności predykcyjnej modelu na nowych danych</li>
<li>Wizualizację relacji między ceną a popytem z efektem ceteris paribus</li>
</ol>
<p>Przykład ten pokazuje, jak można symulować złożone zależności ekonomiczne, a następnie używać metod ekonometrycznych do odkrywania tych zależności na podstawie próby danych. Jest to doskonała ilustracja, jak teoria ekonomiczna, DGP i metody statystyczne są ze sobą powiązane.</p>
<p>W rzeczywistości nigdy nie znamy prawdziwego DGP - to właśnie próbujemy odkryć za pomocą analizy statystycznej. Symulacje tego typu pozwalają jednak zrozumieć konceptualnie, jak wnioskowanie statystyczne łączy się z pojęciem DGP i superpopulacji.</p>
</section>
<section id="przykłady-pomocnicze" class="level3" data-number="2.3.23">
<h3 data-number="2.3.23" class="anchored" data-anchor-id="przykłady-pomocnicze"><span class="header-section-number">2.3.23</span> Przykłady pomocnicze</h3>
<section id="przykład-1-badanie-opinii-wyborców" class="level4" data-number="2.3.23.1">
<h4 data-number="2.3.23.1" class="anchored" data-anchor-id="przykład-1-badanie-opinii-wyborców"><span class="header-section-number">2.3.23.1</span> Przykład 1: Badanie opinii wyborców</h4>
<ul>
<li><strong>Populacja</strong>: Wszyscy zarejestrowani wyborcy w Polsce w 2023 roku (ok. 30 milionów osób)</li>
<li><strong>Próba</strong>: 1000 losowo wybranych wyborców ankietowanych w sondażu</li>
<li><strong>Superpopulacja</strong>: Wszyscy możliwi wyborcy (obecni, przyszli i hipotetyczni) oraz wszystkie możliwe scenariusze głosowania</li>
<li><strong>DGP</strong> (Data Generating Process): Złożony mechanizm kształtujący opinie i decyzje wyborcze, w tym:
<ul>
<li>Czynniki demograficzne (wiek, wykształcenie, miejsce zamieszkania)</li>
<li>Warunki ekonomiczne (dochód, status zawodowy)</li>
<li>Wpływ mediów i debaty publicznej</li>
<li>Doświadczenia osobiste</li>
<li>Historyczne uwarunkowania polityczne</li>
</ul></li>
</ul>
</section>
<section id="przykład-2-badanie-efektów-leku-przeciwcukrzycowego" class="level4" data-number="2.3.23.2">
<h4 data-number="2.3.23.2" class="anchored" data-anchor-id="przykład-2-badanie-efektów-leku-przeciwcukrzycowego"><span class="header-section-number">2.3.23.2</span> Przykład 2: Badanie efektów leku przeciwcukrzycowego</h4>
<ul>
<li><strong>Populacja</strong>: Wszyscy pacjenci z cukrzycą typu 2 w danym kraju (np. 2 miliony osób)</li>
<li><strong>Próba</strong>: 500 pacjentów uczestniczących w badaniu klinicznym</li>
<li><strong>Superpopulacja</strong>: Wszyscy możliwi pacjenci z cukrzycą typu 2 (obecni i przyszli) z różnymi profilami genetycznymi i środowiskowymi</li>
<li><strong>DGP</strong>: Biologiczny mechanizm obejmujący:
<ul>
<li>Interakcje leku z receptorami w organizmie</li>
<li>Indywidualne uwarunkowania genetyczne</li>
<li>Czynniki środowiskowe (dieta, aktywność fizyczna)</li>
<li>Interakcje z innymi lekami</li>
<li>Mechanizmy metaboliczne organizmu</li>
</ul></li>
</ul>
</section>
<section id="przykład-3-gdy-próba-równa-się-populacji" class="level4" data-number="2.3.23.3">
<h4 data-number="2.3.23.3" class="anchored" data-anchor-id="przykład-3-gdy-próba-równa-się-populacji"><span class="header-section-number">2.3.23.3</span> Przykład 3: Gdy próba równa się populacji</h4>
<p>Badanie wszystkich 50 stanów USA:</p>
<ul>
<li><strong>Tradycyjne podejście</strong>: Nie ma rozróżnienia między próbą a populacją (badamy wszystkie stany)</li>
<li><strong>Podejście superpopulacyjne</strong>:
<ul>
<li><strong>Populacja/Próba</strong>: 50 istniejących stanów USA</li>
<li><strong>Superpopulacja</strong>: Teoretyczny zbiór wszystkich możliwych jednostek terytorialnych typu “stan” w różnych warunkach historycznych, politycznych i społecznych</li>
<li><strong>DGP</strong>: Fundamentalne mechanizmy geograficzne, historyczne, polityczne i społeczno-ekonomiczne kształtujące charakterystyki stanów</li>
</ul></li>
</ul>
</section>
<section id="przykład-4-jakość-pizzy-w-nowym-jorku" class="level4" data-number="2.3.23.4">
<h4 data-number="2.3.23.4" class="anchored" data-anchor-id="przykład-4-jakość-pizzy-w-nowym-jorku"><span class="header-section-number">2.3.23.4</span> Przykład 4: Jakość pizzy w Nowym Jorku</h4>
<ul>
<li><strong>Populacja</strong>: Wszystkie obecnie działające pizzerie w Nowym Jorku (np. 2000 lokali)</li>
<li><strong>Próba</strong>: 50 losowo wybranych pizzerii z różnych dzielnic</li>
<li><strong>Superpopulacja</strong>: Wszystkie możliwe pizzerie, które mogłyby istnieć w Nowym Jorku:
<ul>
<li>Obecnie działające</li>
<li>Przyszłe (jeszcze nieotwarte)</li>
<li>Historyczne (już zamknięte)</li>
<li>Hipotetyczne (w alternatywnych warunkach ekonomicznych czy kulturowych)</li>
</ul></li>
<li><strong>DGP</strong>: Czynniki wpływające na jakość pizzy:
<ul>
<li>Składniki i ich jakość</li>
<li>Umiejętności i doświadczenie szefów kuchni</li>
<li>Sprzęt i infrastruktura kuchenna</li>
<li>Metody przygotowania i przepisy</li>
<li>Czynniki środowiskowe (np. jakość lokalnej wody)</li>
<li>Wpływy kulturowe i tradycje kulinarne</li>
<li>Uwarunkowania ekonomiczne (koszty operacyjne, czynsze)</li>
</ul></li>
</ul>
<p>DGP jest jak “przepis na jakość pizzy”, który determinuje rezultaty dla wszystkich potencjalnych pizzerii w superpopulacji, nie tylko dla obecnie istniejących lokali.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TD
    A[Data Generating Process DGP]
    S(Superpopulacja)
    B(Populacja)
    C[Próba]
    A --&gt;|Generuje| S
    S --&gt;|Jedna realizacja| B
    B --&gt;|Pobieranie próby| C
    C -.-&gt;|Wnioskowanie| B
    C -.-&gt;|Wnioskowanie| S
    C -.-&gt;|Wnioskowanie| A
    B -.-&gt;|Wnioskowanie| S
    B -.-&gt;|Wnioskowanie| A
    S -.-&gt;|Wnioskowanie| A
    
    classDef dgp fill:#f9f,stroke:#333,stroke-width:4px;
    classDef superpop fill:#fce,stroke:#333,stroke-width:3px;
    classDef pop fill:#bbf,stroke:#333,stroke-width:2px;
    classDef sam fill:#bfb,stroke:#333,stroke-width:2px;
    
    class A dgp;
    class S superpop;
    class B pop;
    class C sam;
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
</section>
</div>
</div>
</section>
</section>
<section id="parametry-populacji" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="parametry-populacji"><span class="header-section-number">2.4</span> Parametry Populacji</h2>
<blockquote class="blockquote">
<p><strong>Ważne</strong></p>
<p><strong>Parametr populacji</strong> (<span class="math inline">\theta</span>) to wartość liczbowa charakteryzująca określoną cechę całej populacji. Parametry populacji są zwykle nieznane i stanowią przedmiot estymacji na podstawie próby.</p>
</blockquote>
<p>Typowe parametry populacji obejmują:</p>
<ul>
<li><span class="math inline">\mu</span> (średnia populacji): Przeciętna wartość w populacji</li>
<li><span class="math inline">\sigma^2</span> (wariancja populacji): Przeciętne kwadratowe odchylenie od średniej</li>
<li><span class="math inline">\sigma</span> (odchylenie standardowe populacji): Pierwiastek kwadratowy z wariancji</li>
<li><span class="math inline">p</span> (proporcja w populacji): Udział jednostek w populacji posiadających określoną cechę</li>
</ul>
<p>Ponieważ badanie całej populacji jest zazwyczaj niepraktyczne, używamy prób do szacowania tych parametrów.</p>
</section>
<section id="rozkład-statystyk-z-próby" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="rozkład-statystyk-z-próby"><span class="header-section-number">2.5</span> Rozkład Statystyk z Próby</h2>
<p><strong>Statystyka z próby</strong> (<span class="math inline">\hat{\theta}</span>) to wartość obliczona na podstawie obserwacji w próbie, służąca do oszacowania parametru populacji <span class="math inline">\theta</span>.</p>
<p>Rozkład statystyki opisuje, jak jej wartości zmieniają się przy wielokrotnym pobieraniu prób tej samej wielkości <span class="math inline">n</span> z tej samej populacji. Zrozumienie tego pojęcia jest kluczowe dla wnioskowania statystycznego.</p>
<p>Wyobraźmy to sobie tak: Gdy pobieramy próbę i obliczamy statystykę (np. średnią z próby), otrzymujemy jedną konkretną wartość. Gdybyśmy jednak powtórzyli ten proces wielokrotnie – pobierając różne losowe próby tej samej wielkości z tej samej populacji – otrzymywalibyśmy za każdym razem inne wartości. Rozkład statystyki opisuje właśnie ten wzorzec zmienności.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/sampling-estimators.svg" class="img-fluid figure-img"></p>
<figcaption>Różne losowe próby tej samej wielkości i ich statystyki. Retrieved from: https://allmodelsarewrong.github.io/mse.html</figcaption>
</figure>
</div>
<p>Kluczowe aspekty rozkładu statystyki:</p>
<ol type="1">
<li>Pokazuje, jak statystyka zmienia się między próbami</li>
<li>Pomaga zrozumieć błąd próbkowania i niepewność</li>
<li>Pozwala formułować stwierdzenia probabilistyczne o tym, jak blisko nasze oszacowanie jest rzeczywistego parametru populacji</li>
<li>Stanowi fundament wnioskowania statystycznego</li>
</ol>
<p>Przykład: Jeśli interesuje nas średnia populacji <span class="math inline">\mu</span>, jej estymatorem jest średnia z próby <span class="math inline">\bar{x}</span>, obliczana jako:</p>
<p><span class="math display">\bar{x} = \frac{1}{n}\sum_{i=1}^{n}x_i</span></p>
<p>gdzie <span class="math inline">x_1, x_2, ..., x_n</span> to obserwacje w losowej próbie.</p>
</section>
<section id="wartość-oczekiwana-statystyki-z-próby" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="wartość-oczekiwana-statystyki-z-próby"><span class="header-section-number">2.6</span> Wartość Oczekiwana Statystyki z Próby</h2>
<p>Zanim pójdziemy dalej, wyjaśnijmy krótko, co oznacza “wartość oczekiwana”:</p>
<p><strong>Wartość oczekiwana</strong> (lub średnia) zmiennej losowej to przeciętna wartość, jaką zaobserwowalibyśmy, gdybyśmy mogli powtarzać doświadczenie losowe nieskończenie wiele razy. To w zasadzie “środek ciężkości” rozkładu prawdopodobieństwa - punkt, wokół którego rozkład się równoważy.</p>
<p>Dla dyskretnej zmiennej losowej X, wartość oczekiwana jest obliczana jako:</p>
<p><span class="math display">E(X) = \sum_i x_i \cdot P(X = x_i)</span></p>
<p>Gdzie <span class="math inline">x_i</span> to możliwe wartości, a <span class="math inline">P(X = x_i)</span> to ich prawdopodobieństwa.</p>
<p>Mając to na uwadze, wartość oczekiwana statystyki z próby <span class="math inline">E(\hat{\theta})</span> to średnia wartość, jaką przyjmuje ta statystyka przy wielokrotnym pobieraniu prób z populacji.</p>
<p>Dla dobrze skonstruowanych estymatorów wartość oczekiwana jest równa parametrowi, który staramy się oszacować:</p>
<p><span class="math display">E(\hat{\theta}) = \theta</span></p>
<p>Oznacza to, że “dobry” estymator będzie, średnio rzecz biorąc, dawał właściwą odpowiedź. Taki estymator nazywamy <strong>nieobciążonym</strong>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Opcjonalnie: Dowód, że średnia z próby jest nieobciążonym estymatorem
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dla średniej z próby <span class="math inline">\bar{x}</span> możemy udowodnić, że jest nieobciążonym estymatorem średniej populacji <span class="math inline">\mu</span> w następujący sposób:</p>
<p><span class="math display">E(\bar{x}) = E\left(\frac{1}{n}\sum_{i=1}^{n}x_i\right)</span></p>
<p>Korzystając z liniowości wartości oczekiwanej (wartość oczekiwana sumy równa się sumie wartości oczekiwanych):</p>
<p><span class="math display">E(\bar{x}) = \frac{1}{n}\sum_{i=1}^{n}E(x_i)</span></p>
<p>Ponieważ każde <span class="math inline">x_i</span> jest losową obserwacją z populacji o średniej <span class="math inline">\mu</span>:</p>
<p><span class="math display">E(x_i) = \mu \text{ dla wszystkich } i</span></p>
<p>Zatem:</p>
<p><span class="math display">E(\bar{x}) = \frac{1}{n}\sum_{i=1}^{n}\mu = \frac{1}{n} \cdot n \cdot \mu = \mu</span></p>
<p>To dowodzi, że średnia z próby jest nieobciążonym estymatorem średniej populacji.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Opcjonalnie: Dlaczego w mianowniku wariancji z próby używamy n-1
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wariancja z próby jest powszechnie definiowana jako:</p>
<p><span class="math display">s^2 = \frac{1}{n-1}\sum_{i=1}^n (x_i - \bar{x})^2</span></p>
<p>Dlaczego używamy <span class="math inline">n-1</span> w mianowniku zamiast <span class="math inline">n</span>?</p>
<p>Zastanówmy się, co by się stało, gdybyśmy użyli <span class="math inline">n</span>:</p>
<p><span class="math display">\tilde{s}^2 = \frac{1}{n}\sum_{i=1}^n (x_i - \bar{x})^2</span></p>
<p>Aby sprawdzić, czy jest to estymator nieobciążony, musimy znaleźć <span class="math inline">E(\tilde{s}^2)</span> i sprawdzić, czy równa się <span class="math inline">\sigma^2</span>.</p>
<p>Pomijając wszystkie kroki matematyczne, kluczowym spostrzeżeniem jest: 1. Gdy obliczamy <span class="math inline">(x_i - \bar{x})^2</span>, używamy <span class="math inline">\bar{x}</span> (średniej z próby) zamiast <span class="math inline">\mu</span> (średniej populacji) 2. Średnia z próby <span class="math inline">\bar{x}</span> jest sama w sobie oszacowana z tych samych danych 3. Wprowadza to zależność, która powoduje, że nasz estymator wariancji systematycznie niedoszacowuje prawdziwą wariancję 4. Konkretnie, <span class="math inline">E(\tilde{s}^2) = \frac{n-1}{n}\sigma^2</span>, co oznacza, że jest obciążony o czynnik <span class="math inline">\frac{n-1}{n}</span> 5. Aby skorygować to obciążenie, dzielimy przez <span class="math inline">n-1</span> zamiast <span class="math inline">n</span>, otrzymując: <span class="math display">E(s^2) = E\left(\frac{n}{n-1}\tilde{s}^2\right) = \frac{n}{n-1}E(\tilde{s}^2) = \frac{n}{n-1}\frac{n-1}{n}\sigma^2 = \sigma^2</span></p>
<p>Intuicyjnie, używamy <span class="math inline">n-1</span>, ponieważ “zużyliśmy” już jeden stopień swobody przy szacowaniu średniej. Mianownik <span class="math inline">n-1</span> nazywany jest “stopniami swobody” - liczbą niezależnych informacji dostępnych do oszacowania wariancji po oszacowaniu średniej.</p>
</div>
</div>
<p>Nie wszystkie estymatory są nieobciążone. Na przykład, jak właśnie zobaczyliśmy, prosty estymator wariancji wymaga korekty (<span class="math inline">\frac{1}{n-1}</span> zamiast <span class="math inline">\frac{1}{n}</span>), aby był nieobciążony.</p>
</section>
<section id="rozkład-normalny---krzywa-dzwonowa" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="rozkład-normalny---krzywa-dzwonowa"><span class="header-section-number">2.7</span> Rozkład Normalny - Krzywa Dzwonowa</h2>
<blockquote class="blockquote">
<p><strong>Uwaga</strong></p>
<p>Rozkład normalny (znany również jako rozkład Gaussa lub krzywa dzwonowa) jest jednym z najważniejszych rozkładów prawdopodobieństwa w statystyce. Ma symetryczny dzwonowaty kształt i jest w pełni opisany przez dwa parametry:</p>
<ul>
<li>Średnią <span class="math inline">\mu</span> (określającą środek rozkładu)</li>
<li>Odchylenie standardowe <span class="math inline">\sigma</span> (określające szerokość “dzwonu”)</li>
</ul>
<p>Rozkład normalny występuje często w przyrodzie i systemach ludzkich (wysokość, błędy pomiarowe, wyniki testów).</p>
</blockquote>
<section id="reprezentacja-matematyczna" class="level3" data-number="2.7.1">
<h3 data-number="2.7.1" class="anchored" data-anchor-id="reprezentacja-matematyczna"><span class="header-section-number">2.7.1</span> Reprezentacja Matematyczna</h3>
<p>Funkcja gęstości prawdopodobieństwa (PDF) rozkładu normalnego to:</p>
<p><span class="math display">f(x) = \frac{1}{\sigma\sqrt{2\pi}} e^{-\frac{1}{2}(\frac{x-\mu}{\sigma})^2}</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">x</span> to zmienna losowa</li>
<li><span class="math inline">\mu</span> to średnia (parametr położenia)</li>
<li><span class="math inline">\sigma</span> to odchylenie standardowe (parametr skali)</li>
<li><span class="math inline">e</span> to liczba Eulera (około 2,71828)</li>
<li><span class="math inline">\pi</span> to stała matematyczna pi (około 3,14159)</li>
</ul>
</section>
<section id="praktyczne-znaczenie-1" class="level3" data-number="2.7.2">
<h3 data-number="2.7.2" class="anchored" data-anchor-id="praktyczne-znaczenie-1"><span class="header-section-number">2.7.2</span> Praktyczne Znaczenie</h3>
<p>Rozkład normalny jest szczególnie ważny ze względu na:</p>
<ol type="1">
<li><p><strong>Regułę 68-95-99,7</strong>: Około 68% wartości mieści się w odległości jednego odchylenia standardowego od średniej, 95% w odległości dwóch odchyleń standardowych, a 99,7% w odległości trzech odchyleń standardowych.</p></li>
<li><p><strong>Centralne Twierdzenie Graniczne</strong>: Średnie z próby mają tendencję do podążania za rozkładem normalnym niezależnie od kształtu oryginalnego rozkładu (przy wystarczająco dużej wielkości próby).</p></li>
<li><p><strong>Wnioskowanie Statystyczne</strong>: Rozkład normalny stanowi podstawę dla wielu testów statystycznych i przedziałów ufności.</p></li>
</ol>
</section>
</section>
<section id="popularna-notacja-statystyczna" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="popularna-notacja-statystyczna"><span class="header-section-number">2.8</span> Popularna Notacja Statystyczna</h2>
<p>Zrozumienie symboli używanych w statystyce jest niezbędne do śledzenia pojęć i wzorów statystycznych. Oto tabela referencyjna najczęściej używanej notacji:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 41%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th>Symbol</th>
<th>Opis</th>
<th>Przykład</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">n</span></td>
<td>Liczebność próby (liczba obserwacji w próbie)</td>
<td>“Zebraliśmy dane od <span class="math inline">n = 30</span> uczestników”</td>
</tr>
<tr class="even">
<td><span class="math inline">N</span></td>
<td>Liczebność populacji (całkowita liczba jednostek w populacji)</td>
<td>“Miasto ma <span class="math inline">N = 5000</span> mieszkańców”</td>
</tr>
<tr class="odd">
<td><span class="math inline">\bar{x}</span></td>
<td>Średnia z próby (średnia obserwacji w próbie)</td>
<td>“<span class="math inline">\bar{x} = 25,3</span> lat”</td>
</tr>
<tr class="even">
<td><span class="math inline">\mu</span></td>
<td>Średnia populacji (średnia wartość w całej populacji)</td>
<td>“Średni wzrost w populacji to <span class="math inline">\mu = 175</span> cm”</td>
</tr>
<tr class="odd">
<td><span class="math inline">s</span></td>
<td>Odchylenie standardowe z próby</td>
<td>“Odchylenie standardowe w próbie wynosi <span class="math inline">s = 4,2</span> punktu”</td>
</tr>
<tr class="even">
<td><span class="math inline">s^2</span></td>
<td>Wariancja z próby</td>
<td>“Wariancja w próbie wynosi <span class="math inline">s^2 = 17,64</span> kwadratu punktu”</td>
</tr>
<tr class="odd">
<td><span class="math inline">\sigma</span></td>
<td>Odchylenie standardowe populacji</td>
<td>“Odchylenie standardowe populacji wynosi <span class="math inline">\sigma = 15</span> minut”</td>
</tr>
<tr class="even">
<td><span class="math inline">\sigma^2</span></td>
<td>Wariancja populacji</td>
<td>“Wariancja populacji wynosi <span class="math inline">\sigma^2 = 225</span> kwadratów minut”</td>
</tr>
<tr class="odd">
<td><span class="math inline">\hat{p}</span></td>
<td>Frakcja w próbie</td>
<td>“<span class="math inline">\hat{p} = 0,35</span> respondentów zgodziło się”</td>
</tr>
<tr class="even">
<td><span class="math inline">p</span></td>
<td>Frakcja w populacji</td>
<td>“Prawdziwa proporcja <span class="math inline">p</span> osób leworęcznych”</td>
</tr>
<tr class="odd">
<td><span class="math inline">H_0</span></td>
<td>Hipoteza zerowa</td>
<td>“<span class="math inline">H_0: \mu = 100</span>”</td>
</tr>
<tr class="even">
<td><span class="math inline">H_1</span> lub <span class="math inline">H_a</span></td>
<td>Hipoteza alternatywna</td>
<td>“<span class="math inline">H_1: \mu \neq 100</span>”</td>
</tr>
<tr class="odd">
<td><span class="math inline">\alpha</span></td>
<td>Poziom istotności (prawdopodobieństwo błędu I rodzaju)</td>
<td>“Zastosowaliśmy <span class="math inline">\alpha = 0,05</span> w naszym teście”</td>
</tr>
<tr class="even">
<td><span class="math inline">\beta</span></td>
<td>Prawdopodobieństwo błędu II rodzaju</td>
<td>“Test miał <span class="math inline">\beta = 0,2</span>”</td>
</tr>
<tr class="odd">
<td><span class="math inline">1-\beta</span></td>
<td>Moc statystyczna</td>
<td>“Test miał moc <span class="math inline">1-\beta = 0,8</span>”</td>
</tr>
<tr class="even">
<td><span class="math inline">\sum</span></td>
<td>Suma</td>
<td>“<span class="math inline">\sum_{i=1}^{n} x_i</span> oznacza dodanie wszystkich wartości od <span class="math inline">x_1</span> do <span class="math inline">x_n</span>”</td>
</tr>
<tr class="odd">
<td><span class="math inline">\rho</span></td>
<td>Współczynnik korelacji w populacji</td>
<td>“Korelacja w populacji wynosi <span class="math inline">\rho = 0,75</span>”</td>
</tr>
<tr class="even">
<td><span class="math inline">r</span></td>
<td>Współczynnik korelacji w próbie</td>
<td>“Korelacja w próbie wynosi <span class="math inline">r = 0,72</span>”</td>
</tr>
<tr class="odd">
<td><span class="math inline">df</span></td>
<td>Stopnie swobody</td>
<td>“Test <span class="math inline">t</span> miał <span class="math inline">df = 29</span>”</td>
</tr>
<tr class="even">
<td><span class="math inline">SE</span></td>
<td>Błąd standardowy</td>
<td>“<span class="math inline">SE(\bar{x}) = \frac{s}{\sqrt{n}}</span>”</td>
</tr>
<tr class="odd">
<td><span class="math inline">CI</span></td>
<td>Przedział ufności</td>
<td>“95% <span class="math inline">CI = [42,1, 45,7]</span>”</td>
</tr>
<tr class="even">
<td><span class="math inline">\hat{\theta}</span></td>
<td>Ogólna notacja dla estymatora parametru <span class="math inline">\theta</span></td>
<td>“<span class="math inline">\hat{\theta}</span> to nasz estymator”</td>
</tr>
</tbody>
</table>
<p>Przy czytaniu wzorów i pojęć statystycznych zwracaj zawsze uwagę na rozróżnienie między: - <strong>Statystykami z próby</strong> (zazwyczaj litery łacińskie: <span class="math inline">\bar{x}</span>, <span class="math inline">s</span>, <span class="math inline">r</span>) - <strong>Parametrami populacji</strong> (zazwyczaj litery greckie: <span class="math inline">\mu</span>, <span class="math inline">\sigma</span>, <span class="math inline">\rho</span>)</p>
<p>Ta konwencja pomaga wyjaśnić, czy mówimy o wartości obliczonej z naszych danych z próby, czy o prawdziwej (zwykle nieznanej) charakterystyce całej populacji.</p>
</section>
<section id="rodzaje-danych-i-zmiennych" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="rodzaje-danych-i-zmiennych"><span class="header-section-number">2.9</span> Rodzaje Danych i Zmiennych</h2>
<p>Dane stanowią fundament analizy statystycznej. Aby lepiej zrozumieć ich rolę, warto zapoznać się z kluczowymi pojęciami.</p>
<section id="źródła-danych" class="level3" data-number="2.9.1">
<h3 data-number="2.9.1" class="anchored" data-anchor-id="źródła-danych"><span class="header-section-number">2.9.1</span> Źródła Danych</h3>
<ul>
<li><strong>Dane pierwotne</strong>: Zebrane bezpośrednio do konkretnego celu badawczego (np. prowadzenie własnej ankiety)</li>
<li><strong>Dane wtórne</strong>: Pozyskane z istniejących źródeł (np. bazy danych czy statystyki rządowe)</li>
</ul>
</section>
<section id="zmienne-i-stałe" class="level3" data-number="2.9.2">
<h3 data-number="2.9.2" class="anchored" data-anchor-id="zmienne-i-stałe"><span class="header-section-number">2.9.2</span> Zmienne i Stałe</h3>
<p><strong>Zmienne</strong> to cechy, które mogą przyjmować różne wartości w zbiorze danych. Są one przedmiotem naszych badań i analiz.</p>
<section id="klasyfikacja-zmiennych" class="level4" data-number="2.9.2.1">
<h4 data-number="2.9.2.1" class="anchored" data-anchor-id="klasyfikacja-zmiennych"><span class="header-section-number">2.9.2.1</span> Klasyfikacja Zmiennych</h4>
<ol type="1">
<li><strong>Zmienne Ilościowe</strong> (reprezentują ilości lub pomiary):
<ul>
<li><strong>Ciągłe</strong>: Mogą przyjmować dowolną wartość w określonym zakresie (np. wzrost, waga, temperatura)</li>
<li><strong>Dyskretne</strong>: Przyjmują tylko określone wartości, zwykle liczby całkowite (np. liczba dzieci, błędów)</li>
</ul></li>
<li><strong>Zmienne Jakościowe</strong> (reprezentują kategorie lub cechy):
<ul>
<li><strong>Nominalne</strong>: Kategorie bez naturalnego porządku (np. grupa krwi, płeć, region)</li>
<li><strong>Porządkowe</strong>: Kategorie z naturalnym porządkiem (np. poziom wykształcenia, oceny zadowolenia)</li>
</ul></li>
</ol>
<p><strong>Stałe</strong> to wartości, które pozostają niezmienione w całej analizie i często służą jako punkty odniesienia.</p>
</section>
</section>
</section>
<section id="pojęcia-związane-z-estymacją-statystyczną" class="level2" data-number="2.10">
<h2 data-number="2.10" class="anchored" data-anchor-id="pojęcia-związane-z-estymacją-statystyczną"><span class="header-section-number">2.10</span> Pojęcia Związane z Estymacją Statystyczną</h2>
<p>W statystyce często myli się ze sobą kilka podobnie brzmiących pojęć. Oto wyraźne rozróżnienie między tymi kluczowymi terminami:</p>
<section id="parametr-populacji-estymand" class="level3" data-number="2.10.1">
<h3 data-number="2.10.1" class="anchored" data-anchor-id="parametr-populacji-estymand"><span class="header-section-number">2.10.1</span> Parametr Populacji (Estymand)</h3>
<p><strong>Parametr populacji</strong> to wartość liczbowa opisująca charakterystykę całej populacji:</p>
<ol type="1">
<li>Dotyczy <em>całej</em> populacji, nie tylko próby</li>
<li>Zwykle oznaczany literami greckimi (μ, σ, π, ρ)</li>
<li>W większości przypadków pozostaje <strong>nieznany</strong> (nie możemy zbadać całej populacji)</li>
<li>Jest determinowany przez rzeczywisty proces generowania danych (ang. Data Generating Process, DGP)</li>
</ol>
<p><strong>Estymand</strong> to konkretny parametr populacji lub funkcja parametrów, którą chcemy oszacować. Jest to <em>cel naszej estymacji</em>.</p>
<blockquote class="blockquote">
<p><strong>Ważne rozróżnienie!</strong></p>
<p>Estymand (parametr populacji) to wartość w populacji, którą chcemy poznać, ale która pozostaje dla nas nieznana. Jest to nasz cel badawczy.</p>
</blockquote>
</section>
<section id="estymator-statystyka" class="level3" data-number="2.10.2">
<h3 data-number="2.10.2" class="anchored" data-anchor-id="estymator-statystyka"><span class="header-section-number">2.10.2</span> Estymator (Statystyka)</h3>
<p><strong>Estymator</strong> to funkcja matematyczna (formuła, procedura), która dostarcza oszacowania parametru populacji na podstawie danych z próby. <strong>Estymator jest zmienną losową</strong>, ponieważ jego wartość zależy od konkretnej próby.</p>
<p><strong>Statystyka</strong> to dowolna miara obliczona z danych z próby. Gdy statystyka jest używana do oszacowania parametru populacji, nazywamy ją estymatorem.</p>
<p>Przykłady estymatorów:</p>
<ul>
<li>Średnia z próby: <span class="math inline">\bar{x} = \frac{1}{n}\sum_{i=1}^n x_i</span> (estymator średniej populacji μ)</li>
<li>Wariancja z próby: <span class="math inline">s^2 = \frac{1}{n-1}\sum_{i=1}^n (x_i - \bar{x})^2</span> (estymator wariancji populacji σ²)</li>
<li>Frakcja w próbie: <span class="math inline">\hat{p} = \frac{x}{n}</span> (estymator frakcji w populacji p)</li>
</ul>
<blockquote class="blockquote">
<p><strong>Uwaga: Estymator jako procedura</strong></p>
<p>Estymator należy rozumieć jako <strong>przepis</strong> na obliczenie wartości na podstawie próby. Ten sam estymator zastosowany do różnych prób będzie dawał różne wyniki.</p>
<p>Przykład: Estymator średniej <span class="math inline">\bar{x} = \frac{1}{n}\sum_{i=1}^n x_i</span> to procedura “zsumuj wszystkie wartości i podziel przez ich liczbę”.</p>
</blockquote>
</section>
<section id="oszacowanie-estymata" class="level3" data-number="2.10.3">
<h3 data-number="2.10.3" class="anchored" data-anchor-id="oszacowanie-estymata"><span class="header-section-number">2.10.3</span> Oszacowanie (Estymata)</h3>
<p><strong>Oszacowanie</strong> to konkretna wartość liczbowa uzyskana po zastosowaniu estymatora do konkretnej próby. Jest to pojedyncza liczba, będąca realizacją zmiennej losowej, jaką jest estymator.</p>
<blockquote class="blockquote">
<p><strong>Przykład rozróżniający te pojęcia</strong></p>
<ul>
<li><strong>Estymand</strong>: Średni wzrost wszystkich dorosłych w kraju (μ) - nieznana wartość</li>
<li><strong>Estymator</strong>: Wzór na średnią z próby <span class="math inline">\bar{x} = \frac{1}{n}\sum_{i=1}^n x_i</span> - procedura obliczeniowa</li>
<li><strong>Oszacowanie</strong>: 173,5 cm - konkretna wartość uzyskana z próby</li>
</ul>
<p>Różne próby dadzą różne oszacowania tego samego estymanda przy użyciu tego samego estymatora.</p>
</blockquote>
</section>
<section id="właściwości-dobrych-estymatorów" class="level3" data-number="2.10.4">
<h3 data-number="2.10.4" class="anchored" data-anchor-id="właściwości-dobrych-estymatorów"><span class="header-section-number">2.10.4</span> Właściwości Dobrych Estymatorów</h3>
<p>Dobry estymator powinien mieć korzystne właściwości statystyczne:</p>
<ol type="1">
<li><p><strong>Nieobciążoność</strong>: Estymator jest nieobciążony, jeśli jego wartość oczekiwana równa się parametrowi, który szacuje. Formalnie: E(<span class="math inline">\hat{\theta}</span>) = <span class="math inline">\theta</span></p></li>
<li><p><strong>Efektywność</strong>: Estymator jest efektywny, jeśli ma najmniejszą możliwą wariancję spośród wszystkich nieobciążonych estymatorów</p></li>
<li><p><strong>Zgodność</strong>: Estymator jest zgodny, jeśli wraz ze wzrostem wielkości próby jego wartość zbliża się do prawdziwej wartości parametru</p></li>
<li><p><strong>Dostateczność</strong>: Estymator jest dostateczny, jeśli wykorzystuje wszystkie dostępne informacje z próby dotyczące szacowanego parametru</p></li>
</ol>
</section>
</section>
<section id="modele-statystyczne-i-wnioskowanie" class="level2" data-number="2.11">
<h2 data-number="2.11" class="anchored" data-anchor-id="modele-statystyczne-i-wnioskowanie"><span class="header-section-number">2.11</span> Modele Statystyczne i Wnioskowanie</h2>
<section id="modele-statystyczne" class="level3" data-number="2.11.1">
<h3 data-number="2.11.1" class="anchored" data-anchor-id="modele-statystyczne"><span class="header-section-number">2.11.1</span> Modele Statystyczne</h3>
<p>Model statystyczny to matematyczna reprezentacja rzeczywistości, która opisuje relacje między zmiennymi i strukturę danych. Pozwala on na opisanie procesu generowania danych i wnioskowanie o parametrach.</p>
<blockquote class="blockquote">
<p><strong>Komponenty Modelu Statystycznego</strong></p>
<p>Pełny model statystyczny składa się z:</p>
<ol type="1">
<li><strong>Formy funkcyjnej</strong>: Matematycznej struktury definiującej relację między zmiennymi (np. liniową, kwadratową)</li>
<li><strong>Zmiennych</strong>:
<ul>
<li>Zmiennej zależnej (zależnych): To, co staramy się przewidzieć lub wyjaśnić</li>
<li>Zmiennych niezależnych/objaśniających: Czynniki, które mogą wpływać na zmienną zależną</li>
</ul></li>
<li><strong>Parametrów</strong>: Nieznanych wartości, które szacujemy z danych (np. współczynniki regresji)</li>
<li><strong>Komponentu losowego</strong>: Członu błędu uwzględniającego niewyjaśnioną zmienność</li>
<li><strong>Założeń o rozkładzie prawdopodobieństwa</strong>: Specyfikacji dotyczących rozkładu komponentu losowego</li>
</ol>
</blockquote>
<p>Przykład modelu regresji liniowej: <span class="math inline">y = \beta_0 + \beta_1x + \epsilon</span>, gdzie <span class="math inline">\epsilon \sim N(0, \sigma^2)</span></p>
<p>W tym modelu:</p>
<ul>
<li><span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span> to parametry, które chcemy oszacować</li>
<li><span class="math inline">\epsilon</span> to komponent losowy reprezentujący niewyjaśnioną zmienność</li>
<li>Zakładamy normalność rozkładu błędów</li>
</ul>
</section>
<section id="wnioskowanie-przyczynowe-a-predykcyjne-korelacyjne" class="level3" data-number="2.11.2">
<h3 data-number="2.11.2" class="anchored" data-anchor-id="wnioskowanie-przyczynowe-a-predykcyjne-korelacyjne"><span class="header-section-number">2.11.2</span> Wnioskowanie Przyczynowe a Predykcyjne (korelacyjne)</h3>
<p>W analizie statystycznej możemy mieć dwa główne cele:</p>
<ol type="1">
<li><strong>Wnioskowanie przyczynowe</strong>: Określenie, czy zmienna X <em>powoduje</em> zmianę w zmiennej Y
<ul>
<li>Wymaga dodatkowych założeń lub specjalnych projektów badawczych</li>
<li>Umożliwia przewidywanie skutków interwencji</li>
</ul></li>
<li><strong>Wnioskowanie predykcyjne (korelacyjne)</strong>: Przewidywanie wartości Y na podstawie X
<ul>
<li>Nie musi zakładać związku przyczynowego</li>
<li>Koncentruje się na dokładności przewidywań</li>
</ul></li>
</ol>
<blockquote class="blockquote">
<p><strong>Ostrzeżenie: Korelacja ≠ Przyczynowość</strong></p>
<p>Pozorna zależność lub korelacja pozorna występuje, gdy dwie lub więcej zmiennych są ze sobą powiązane, ale nie przyczynowo.</p>
<p>Dwie zmienne mogą być silnie skorelowane z powodu:</p>
<ol type="1">
<li>Zmiennej zakłócającej, która wpływa na obie zmienne</li>
<li>Odwrotnej przyczynowości (Y wpływa na X, a nie odwrotnie)</li>
<li>Przypadku (korelacja pozorna)</li>
</ol>
</blockquote>
</section>
<section id="wyzwania-wnioskowania-przyczynowego" class="level3" data-number="2.11.3">
<h3 data-number="2.11.3" class="anchored" data-anchor-id="wyzwania-wnioskowania-przyczynowego"><span class="header-section-number">2.11.3</span> Wyzwania Wnioskowania Przyczynowego</h3>
<p>Fundamentalnym problemem wnioskowania przyczynowego jest niemożność zaobserwowania <strong>stanów kontrfaktycznych</strong> (alternatywnych scenariuszy). Dla danej jednostki możemy zaobserwować tylko jeden potencjalny wynik.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/meme_horse.svg" class="img-fluid figure-img"></p>
<figcaption>Fundamentalny problem wnioskowania przyczynowego: Możemy myśleć o wnioskowaniu przyczynowym jako o problemie PRZEWIDYWANIA. Jak możemy przewidzieć stan kontrfaktyczny, skoro nigdy go nie obserwujemy?</figcaption>
</figure>
</div>
<p>Przykład:</p>
<ul>
<li>Obserwujemy osobę, która ukończyła studia i zarabia 8000 zł miesięcznie</li>
<li>Nie możemy zaobserwować, ile ta sama osoba zarabiałaby, gdyby nie ukończyła studiów</li>
</ul>
<p>Metody przyczynowe próbują rozwiązać ten problem poprzez:</p>
<ol type="1">
<li>Eksperymenty randomizowane</li>
<li>Zmienne instrumentalne</li>
<li>Metody dopasowania (matching)</li>
<li>Analizę nieciągłości regresji (ang. regression discontinuity)</li>
<li>Różnicę w różnicach (ang. difference-in-differences)</li>
</ol>
<p>Typowe problemy we wnioskowaniu przyczynowym:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/IMG_4337.jpg" class="img-fluid figure-img"></p>
<figcaption>Błąd zmiennej zakłócającej: picie alkoholu poprzedniego wieczoru jest wspólną przyczyną spania w butach i budzenia się z bólem głowy</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/ff13-23.png" class="img-fluid figure-img"></p>
<figcaption>Odwrotna przyczynowość</figcaption>
</figure>
</div>
</section>
</section>
<section id="wnioskowanie-statystyczne" class="level2" data-number="2.12">
<h2 data-number="2.12" class="anchored" data-anchor-id="wnioskowanie-statystyczne"><span class="header-section-number">2.12</span> Wnioskowanie Statystyczne</h2>
<p>Wnioskowanie statystyczne to proces wyciągania wniosków o populacji na podstawie danych z próby. Obejmuje dwa główne obszary:</p>
<section id="estymacja" class="level3" data-number="2.12.1">
<h3 data-number="2.12.1" class="anchored" data-anchor-id="estymacja"><span class="header-section-number">2.12.1</span> Estymacja</h3>
<p>Estymacja to proces wykorzystywania danych z próby do oszacowania nieznanych parametrów populacji. Rozróżniamy:</p>
<ul>
<li><strong>Estymację punktową</strong>: Podanie pojedynczej wartości jako najlepszego przybliżenia parametru</li>
<li><strong>Estymację przedziałową</strong>: Skonstruowanie przedziału ufności, który wskazuje zakres możliwych wartości parametru zgodnych z naszymi danymi</li>
</ul>
<p>Przykład przedziału ufności: “95% przedział ufności dla średniego wzrostu dorosłych wynosi (173 cm, 175 cm)”.</p>
<p><strong>Poprawna interpretacja przedziału ufności</strong>: Gdybyśmy wielokrotnie pobierali próby z tej samej populacji i dla każdej z nich konstruowali 95% przedział ufności tą samą metodą, około 95% tak skonstruowanych przedziałów zawierałoby prawdziwą wartość parametru populacji.</p>
<p><strong>Błędna interpretacja</strong>: “Istnieje 95% szans, że prawdziwa średnia znajduje się w przedziale (173 cm, 175 cm)” – jest to niepoprawne, ponieważ parametr populacji jest stałą (choć nieznaną) wartością, a nie zmienną losową.</p>
</section>
<section id="testowanie-hipotez" class="level3" data-number="2.12.2">
<h3 data-number="2.12.2" class="anchored" data-anchor-id="testowanie-hipotez"><span class="header-section-number">2.12.2</span> Testowanie Hipotez</h3>
<p>Testowanie hipotez to formalna procedura weryfikacji przypuszczeń dotyczących parametrów populacji.</p>
<blockquote class="blockquote">
<p><strong>Przykład: Test dwumianowy dla monety</strong></p>
<p>Wyobraźmy sobie, że chcemy sprawdzić, czy moneta jest uczciwa.</p>
<ol type="1">
<li><p><strong>Pytanie badawcze</strong>: Czy moneta jest uczciwa (prawdopodobieństwo orła = 0,5)?</p></li>
<li><p><strong>Sformułowanie hipotez</strong>:</p>
<ul>
<li><strong>Hipoteza zerowa (H₀)</strong>: p = 0,5 (moneta jest uczciwa)</li>
<li><strong>Hipoteza alternatywna (H₁)</strong>: p ≠ 0,5 (moneta nie jest uczciwa)</li>
</ul></li>
<li><p><strong>Zebranie danych</strong>: Rzucamy monetą 100 razy i otrzymujemy 65 orłów.</p></li>
<li><p><strong>Analiza</strong>: Czy 65 orłów na 100 rzutów stanowi dowód przeciwko hipotezie, że moneta jest uczciwa?</p></li>
<li><p><strong>Rozumowanie</strong>:</p>
<ul>
<li>Jeśli moneta byłaby uczciwa (p = 0,5), liczba orłów w 100 rzutach powinna podążać za rozkładem dwumianowym B(100, 0,5)</li>
<li>Dla tego rozkładu oczekujemy średnio 50 orłów, z odchyleniem standardowym √(100 × 0,5 × 0,5) = 5</li>
<li>Otrzymanie 65 orłów oznacza odchylenie o 3 odchylenia standardowe od wartości oczekiwanej</li>
<li>Prawdopodobieństwo otrzymania 65 lub więcej orłów przy uczciwej monecie jest bardzo małe (p &lt; 0,01)</li>
</ul></li>
<li><p><strong>Wniosek</strong>: Ponieważ zaobserwowany wynik jest bardzo mało prawdopodobny przy założeniu, że moneta jest uczciwa, odrzucamy hipotezę zerową i wnioskujemy, że moneta najprawdopodobniej nie jest uczciwa.</p></li>
</ol>
</blockquote>
<p>Ogólna procedura testowania hipotez:</p>
<ol type="1">
<li>Sformułuj hipotezę zerową (H₀) i hipotezę alternatywną (H₁)</li>
<li>Wybierz poziom istotności α (zwykle 0,05)</li>
<li>Zbierz dane i oblicz odpowiednią statystykę testową</li>
<li>Oblicz wartość p (prawdopodobieństwo uzyskania naszych danych lub bardziej skrajnych wyników przy założeniu, że H₀ jest prawdziwa)</li>
<li>Podejmij decyzję: jeśli p &lt; α, odrzuć H₀ na korzyść H₁</li>
</ol>
<blockquote class="blockquote">
<p><strong>Uwaga: Intuicja stojąca za testowaniem hipotez</strong></p>
<p>Testowanie hipotez przypomina procedurę sądową:</p>
</blockquote>
<blockquote class="blockquote">
<ul>
<li>H₀ odpowiada zasadzie “niewinny, dopóki nie udowodni się winy”</li>
<li>Dane stanowią “dowód” przeciwko H₀</li>
<li>Wartość p określa, jak silny jest ten dowód</li>
<li>Jeśli dowód jest wystarczająco silny (p &lt; α), “skazujemy” H₀ (odrzucamy ją)</li>
<li>Jeśli dowód nie jest wystarczająco silny, nie odrzucamy H₀ (ale nie udowadniamy jej prawdziwości)</li>
</ul>
</blockquote>
</section>
<section id="rodzaje-błędów-w-testowaniu-hipotez" class="level3" data-number="2.12.3">
<h3 data-number="2.12.3" class="anchored" data-anchor-id="rodzaje-błędów-w-testowaniu-hipotez"><span class="header-section-number">2.12.3</span> Rodzaje Błędów w Testowaniu Hipotez</h3>
<p>W testowaniu hipotez statystycznych możemy popełnić dwa rodzaje błędów:</p>
<ul>
<li><strong>Błąd I rodzaju (α)</strong>: Odrzucenie prawdziwej hipotezy zerowej (“skazanie niewinnego”)
<ul>
<li>Prawdopodobieństwo tego błędu jest kontrolowane przez poziom istotności α</li>
<li>Typowo przyjmuje się α = 0,05, co oznacza, że akceptujemy 5% ryzyko odrzucenia prawdziwej hipotezy zerowej</li>
</ul></li>
<li><strong>Błąd II rodzaju (β)</strong>: Nieodrzucenie fałszywej hipotezy zerowej (“uniewinnienie winnego”)
<ul>
<li>Prawdopodobieństwo uniknięcia tego błędu (1-β) nazywane jest mocą testu</li>
<li>Moc testu wzrasta wraz z wielkością próby i wielkością efektu</li>
</ul></li>
</ul>
<blockquote class="blockquote">
<p><strong>Ważne: Częste błędy w interpretacji wartości p i testów</strong></p>
<ol type="1">
<li>Wartość p to <strong>NIE</strong> prawdopodobieństwo, że hipoteza zerowa jest prawdziwa</li>
<li>Wartość p to <strong>NIE</strong> prawdopodobieństwo popełnienia błędu przy odrzucaniu H₀</li>
<li>Nieodrzucenie H₀ <strong>NIE</strong> oznacza udowodnienia jej prawdziwości (brak dowodów przeciwko oskarżonemu nie dowodzi niewinności)</li>
<li>Bardzo mała wartość p <strong>NIE</strong> wskazuje na duży efekt praktyczny (istotność statystyczna ≠ istotność praktyczna)</li>
<li>Wartość p zależy od wielkości próby - przy bardzo dużych próbach nawet małe, praktycznie nieistotne różnice mogą być statystycznie istotne</li>
</ol>
<p><strong>Definicja wartości p</strong>: Prawdopodobieństwo zaobserwowania wyniku co najmniej tak skrajnego jak uzyskany, przy założeniu, że hipoteza zerowa jest prawdziwa.</p>
</blockquote>
</section>
</section>
<section id="podstawy-dobrego-badania-statystycznego" class="level2" data-number="2.13">
<h2 data-number="2.13" class="anchored" data-anchor-id="podstawy-dobrego-badania-statystycznego"><span class="header-section-number">2.13</span> Podstawy Dobrego Badania Statystycznego</h2>
<p>Aby przeprowadzić rzetelne badanie statystyczne, należy zapewnić:</p>
<ol type="1">
<li><strong>Reprezentatywność próby</strong>: Próba powinna dobrze odzwierciedlać badaną populację</li>
<li><strong>Odpowiednią wielkość próby</strong>: Większe próby zapewniają dokładniejsze oszacowania i większą moc statystyczną</li>
<li><strong>Kontrolę zmiennych zakłócających</strong>: Zarówno w projektowaniu badań, jak i w analizie danych</li>
<li><strong>Odpowiednie metody statystyczne</strong>: Dopasowane do rodzaju danych i pytań badawczych</li>
<li><strong>Jasną interpretację</strong>: Uwzględniającą ograniczenia badania i alternatywne wyjaśnienia</li>
</ol>
<section id="podsumowanie-kluczowych-pojęć" class="level3" data-number="2.13.1">
<h3 data-number="2.13.1" class="anchored" data-anchor-id="podsumowanie-kluczowych-pojęć"><span class="header-section-number">2.13.1</span> Podsumowanie Kluczowych Pojęć</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 36%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Pojęcie</th>
<th>Definicja</th>
<th>Przykład</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Parametr populacji (Estymand)</strong></td>
<td>Wartość charakteryzująca populację, zwykle nieznana</td>
<td>μ (średnia populacji)</td>
</tr>
<tr class="even">
<td><strong>Estymator (Statystyka)</strong></td>
<td>Funkcja/procedura szacowania parametru na podstawie próby</td>
<td><span class="math inline">\bar{x} = \frac{1}{n}\sum_{i=1}^n x_i</span></td>
</tr>
<tr class="odd">
<td><strong>Oszacowanie (Estymata)</strong></td>
<td>Konkretna wartość uzyskana po zastosowaniu estymatora do próby</td>
<td><span class="math inline">\bar{x} = 173,5</span> cm</td>
</tr>
<tr class="even">
<td><strong>Błąd standardowy</strong></td>
<td>Miara zmienności estymatora między próbami</td>
<td><span class="math inline">SE(\bar{x}) = \frac{s}{\sqrt{n}}</span></td>
</tr>
<tr class="odd">
<td><strong>Przedział ufności</strong></td>
<td>Zakres wartości, który z określonym prawdopodobieństwem zawiera parametr</td>
<td>(173 cm, 175 cm)</td>
</tr>
<tr class="even">
<td><strong>Wartość p</strong></td>
<td>Prawdopodobieństwo zaobserwowania danych przy założeniu prawdziwości H₀</td>
<td>p = 0,03</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="appendices-additional-topics-in-statistics-and-data-science" class="level2" data-number="2.14">
<h2 data-number="2.14" class="anchored" data-anchor-id="appendices-additional-topics-in-statistics-and-data-science"><span class="header-section-number">2.14</span> Appendices: Additional Topics in Statistics and Data Science (*)</h2>
</section>
<section id="appendix-a-r-for-social-science-data-analysis" class="level2" data-number="2.15">
<h2 data-number="2.15" class="anchored" data-anchor-id="appendix-a-r-for-social-science-data-analysis"><span class="header-section-number">2.15</span> Appendix A: R for Social Science Data Analysis</h2>
<p>R offers powerful capabilities for social science research, from data manipulation to advanced statistical modeling.</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate example data with a Simpson's Paradox</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_group =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Young"</span>, <span class="st">"Middle"</span>, <span class="st">"Old"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>)),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">education_years =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Young"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Middle"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">13</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Old"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">16</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">income =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Young"</span> <span class="sc">~</span> <span class="dv">70000</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> education_years <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5000</span>),</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Middle"</span> <span class="sc">~</span> <span class="dv">50000</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> education_years <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5000</span>),</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Old"</span> <span class="sc">~</span> <span class="dv">30000</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> education_years <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5000</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic data summary</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  age_group         education_years      income     
 Length:1000        Min.   : 6.628   Min.   :34068  
 Class :character   1st Qu.:10.913   1st Qu.:51508  
 Mode  :character   Median :13.004   Median :63376  
                    Mean   :12.986   Mean   :63307  
                    3rd Qu.:14.934   3rd Qu.:75023  
                    Max.   :18.861   Max.   :96620  </code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation analysis</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(data <span class="sc">%&gt;%</span> <span class="fu">select</span>(education_years, income))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                education_years     income
education_years       1.0000000 -0.8152477
income               -0.8152477  1.0000000</code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Overall trend (Simpson's Paradox)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>overall_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> education_years, <span class="at">y =</span> income)) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Overall Relationship between Education and Income"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Simpson's Paradox: Appears negative"</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Years of Education"</span>, <span class="at">y =</span> <span class="st">"Income"</span>) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Trend by age group (Resolving Simpson's Paradox)</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>grouped_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> education_years, <span class="at">y =</span> income, <span class="at">color =</span> age_group)) <span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relationship between Education and Income by Age Group"</span>,</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Resolving Simpson's Paradox: Positive relationship within groups"</span>,</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Years of Education"</span>, <span class="at">y =</span> <span class="st">"Income"</span>) <span class="sc">+</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(overall_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(grouped_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This example demonstrates Simpson’s Paradox, where the overall relationship between education and income appears negative, but when grouped by age, the relationship within each group is positive. This illustrates how critical it is to consider confounding variables in your analysis.</p>
</section>
<section id="appendix-b-causal-inference-vs.-observational-studies" class="level2" data-number="2.16">
<h2 data-number="2.16" class="anchored" data-anchor-id="appendix-b-causal-inference-vs.-observational-studies"><span class="header-section-number">2.16</span> Appendix B: Causal Inference vs.&nbsp;Observational Studies</h2>
<p>Understanding the relationship between variables is crucial in social sciences. Two key approaches are causal inference and observational studies, each with distinct strengths and limitations.</p>
<section id="causal-inference" class="level3" data-number="2.16.1">
<h3 data-number="2.16.1" class="anchored" data-anchor-id="causal-inference"><span class="header-section-number">2.16.1</span> Causal Inference</h3>
<ul>
<li>Aims to establish cause-and-effect relationships</li>
<li>Often involves experimental designs or advanced statistical techniques</li>
<li>Seeks to answer “What if?” questions and determine the impact of interventions</li>
<li>Examples: Randomized controlled trials, quasi-experimental designs, instrumental variables</li>
</ul>
</section>
<section id="observational-studies" class="level3" data-number="2.16.2">
<h3 data-number="2.16.2" class="anchored" data-anchor-id="observational-studies"><span class="header-section-number">2.16.2</span> Observational Studies</h3>
<ul>
<li>Examine relationships between variables without direct intervention</li>
<li>Rely on data collected from natural settings or existing datasets</li>
<li>Can identify correlations and patterns but struggle to establish causation</li>
<li>Examples: Cohort studies, case-control studies, cross-sectional surveys</li>
</ul>
<blockquote class="blockquote">
<p><strong>Important: Correlation Does Not Imply Causation</strong></p>
<ul>
<li><strong>Correlation</strong>: Measures the strength and direction of a relationship between variables</li>
<li><strong>Causation</strong>: Indicates that changes in one variable directly cause changes in another</li>
</ul>
<p>While strong correlations can suggest potential causal links, additional evidence and rigorous methods are required to establish causality.</p>
</blockquote>
</section>
<section id="challenges-in-establishing-causality" class="level3" data-number="2.16.3">
<h3 data-number="2.16.3" class="anchored" data-anchor-id="challenges-in-establishing-causality"><span class="header-section-number">2.16.3</span> Challenges in Establishing Causality</h3>
<ul>
<li><strong>Confounding variables</strong>: Unmeasured factors that affect both the presumed cause and effect</li>
<li><strong>Reverse causality</strong>: The presumed effect might actually be causing the presumed cause</li>
<li><strong>Selection bias</strong>: Non-random selection of subjects into study groups</li>
</ul>
</section>
<section id="methods-to-strengthen-causal-claims" class="level3" data-number="2.16.4">
<h3 data-number="2.16.4" class="anchored" data-anchor-id="methods-to-strengthen-causal-claims"><span class="header-section-number">2.16.4</span> Methods to Strengthen Causal Claims</h3>
<ol type="1">
<li>Randomized controlled trials (when ethical and feasible)</li>
<li>Natural experiments or quasi-experimental designs</li>
<li>Propensity score matching</li>
<li>Difference-in-differences analysis</li>
<li>Instrumental variable approaches</li>
<li>Directed acyclic graphs (DAGs) for visualizing causal relationships</li>
</ol>
<p>Understanding these distinctions is crucial in social sciences, where ethical considerations often limit experimental manipulation.</p>
</section>
</section>
<section id="appendix-c-understanding-spurious-correlations-confounders-and-colliders" class="level2" data-number="2.17">
<h2 data-number="2.17" class="anchored" data-anchor-id="appendix-c-understanding-spurious-correlations-confounders-and-colliders"><span class="header-section-number">2.17</span> Appendix C: Understanding Spurious Correlations, Confounders, and Colliders</h2>
<p>These concepts are essential for avoiding misinterpretations in statistical analysis. Let’s explore them with R examples.</p>
<div class="cell">
<details class="code-fold">
<summary>Load required libraries</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># for reproducibility</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="spurious-correlations" class="level3" data-number="2.17.1">
<h3 data-number="2.17.1" class="anchored" data-anchor-id="spurious-correlations"><span class="header-section-number">2.17.1</span> Spurious Correlations</h3>
<p>Spurious correlations are relationships between variables that appear to be causal but are actually coincidental or caused by an unseen third factor.</p>
<p><strong>Example: Ice Cream Sales and Drowning Incidents</strong></p>
<div class="cell">
<details class="code-fold">
<summary>R code for spurious correlation example</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>spurious_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ice_cream_sales =</span> <span class="dv">100</span> <span class="sc">+</span> <span class="dv">5</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">drowning_incidents =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the apparent correlation</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(spurious_data, <span class="fu">aes</span>(<span class="at">x =</span> ice_cream_sales, <span class="at">y =</span> drowning_incidents)) <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Spurious Correlation: Ice Cream Sales vs. Drowning"</span>,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Ice Cream Sales"</span>, </span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Drowning Incidents"</span>) <span class="sc">+</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the common cause</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(spurious_data, <span class="fu">aes</span>(<span class="at">x =</span> temperature)) <span class="sc">+</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> ice_cream_sales), <span class="at">color =</span> <span class="st">"#D55E00"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> drowning_incidents <span class="sc">*</span> <span class="dv">10</span>), <span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> ice_cream_sales), <span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#D55E00"</span>) <span class="sc">+</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> drowning_incidents <span class="sc">*</span> <span class="dv">10</span>), <span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Ice Cream Sales"</span>,</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="dv">10</span>, <span class="at">name =</span> <span class="st">"Drowning Incidents"</span>)</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Temperature as the Common Cause"</span>,</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Temperature (°C)"</span>) <span class="sc">+</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y.left =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#D55E00"</span>),</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y.right =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>)</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlation</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>cor_value <span class="ot">&lt;-</span> <span class="fu">cor</span>(spurious_data<span class="sc">$</span>ice_cream_sales, spurious_data<span class="sc">$</span>drowning_incidents)</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>R code for spurious correlation example</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>R code for spurious correlation example</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Correlation between ice cream sales and drowning incidents:"</span>, <span class="fu">round</span>(cor_value, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Correlation between ice cream sales and drowning incidents: 0.68</code></pre>
</div>
</div>
<p>In this example, temperature is the common cause (confounder) that influences both ice cream sales and drowning incidents. When we plot them against each other, they appear correlated (r ≈ 0.5), but this is spurious. The relationship disappears when we control for temperature.</p>
</section>
<section id="confounders" class="level3" data-number="2.17.2">
<h3 data-number="2.17.2" class="anchored" data-anchor-id="confounders"><span class="header-section-number">2.17.2</span> Confounders</h3>
<p>A confounder is a variable that influences both the dependent variable and independent variable, causing a spurious association.</p>
<p><strong>Example: Education, Income, and Age</strong></p>
<div class="cell">
<details class="code-fold">
<summary>R code for confounder example</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>confounder_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">runif</span>(n, <span class="dv">25</span>, <span class="dv">65</span>),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">education =</span> <span class="fu">round</span>(<span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> age <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">2</span>)),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">income =</span> <span class="dv">20000</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> education <span class="sc">+</span> <span class="dv">500</span> <span class="sc">*</span> age <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">5000</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create age groups for visualization</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>confounder_data <span class="ot">&lt;-</span> confounder_data <span class="sc">%&gt;%</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_group =</span> <span class="fu">cut</span>(age, <span class="at">breaks =</span> <span class="dv">3</span>, </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Young"</span>, <span class="st">"Middle"</span>, <span class="st">"Older"</span>)))</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Models with and without controlling for the confounder</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>model_naive <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> education, <span class="at">data =</span> confounder_data)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>model_adjusted <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> education <span class="sc">+</span> age, <span class="at">data =</span> confounder_data)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(confounder_data, <span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">y =</span> income)) <span class="sc">+</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> age), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> age_group, <span class="at">color =</span> <span class="fu">as.numeric</span>(age_group)), </span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Age"</span>, </span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">45</span>, <span class="dv">60</span>), </span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Young"</span>, <span class="st">"Middle"</span>, <span class="st">"Older"</span>)) <span class="sc">+</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Education vs Income, Confounded by Age"</span>,</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Without controlling for age: effect ="</span>, </span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">coef</span>(model_naive)[<span class="st">"education"</span>], <span class="dv">1</span>),</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"| With age control: effect ="</span>, </span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">coef</span>(model_adjusted)[<span class="st">"education"</span>], <span class="dv">1</span>)),</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Years of Education"</span>, </span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Income"</span>) <span class="sc">+</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this example, age is a confounder in the relationship between education and income. Without controlling for age, we overestimate the effect of education on income (the black line). When we examine the relationship within specific age groups (colored lines), we see a more accurate representation of the true effect.</p>
</section>
<section id="colliders" class="level3" data-number="2.17.3">
<h3 data-number="2.17.3" class="anchored" data-anchor-id="colliders"><span class="header-section-number">2.17.3</span> Colliders</h3>
<p>A collider is a variable that is influenced by both the independent variable and the dependent variable. Controlling for a collider can introduce a spurious correlation.</p>
<p><strong>Example: Job Satisfaction, Salary, and Work-Life Balance</strong></p>
<div class="cell">
<details class="code-fold">
<summary>R code for collider example</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>collider_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">job_satisfaction =</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">salary =</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Both job satisfaction and salary negatively affect work-life balance</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">work_life_balance =</span> <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> job_satisfaction <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> salary <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Without controlling for work-life balance</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>model_correct <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> job_satisfaction, <span class="at">data =</span> collider_data)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Incorrectly controlling for the collider</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>model_collider <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> job_satisfaction <span class="sc">+</span> work_life_balance, <span class="at">data =</span> collider_data)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(collider_data, <span class="fu">aes</span>(<span class="at">x =</span> job_satisfaction, <span class="at">y =</span> salary, </span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> work_life_balance)) <span class="sc">+</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Work-Life</span><span class="sc">\n</span><span class="st">Balance"</span>) <span class="sc">+</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Job Satisfaction vs Salary, with Work-Life Balance as Collider"</span>,</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Without controlling: correlation ="</span>, </span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">coef</span>(model_correct)[<span class="st">"job_satisfaction"</span>], <span class="dv">3</span>),</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"| With control: correlation ="</span>, </span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">coef</span>(model_collider)[<span class="st">"job_satisfaction"</span>], <span class="dv">3</span>)),</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Job Satisfaction"</span>, </span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Salary"</span>) <span class="sc">+</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this example, there’s no inherent relationship between job satisfaction and salary (the black line shows near-zero correlation). However, both variables negatively impact work-life balance. If we control for work-life balance (the collider), we introduce a positive correlation between job satisfaction and salary that doesn’t actually exist.</p>
</section>
<section id="simpsons-paradox" class="level3" data-number="2.17.4">
<h3 data-number="2.17.4" class="anchored" data-anchor-id="simpsons-paradox"><span class="header-section-number">2.17.4</span> Simpson’s Paradox</h3>
<p>Simpson’s paradox occurs when a trend appears in different groups of data but disappears or reverses when these groups are combined.</p>
<p><strong>Example: Treatment Effectiveness Across Age Groups</strong></p>
<div class="cell">
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create example dataset</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>simpson_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_group =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Young"</span>, <span class="st">"Older"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.3</span>)),</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Treatment A"</span>, <span class="st">"Treatment B"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Different recovery rates based on age and treatment</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovery_prob =</span> <span class="fu">case_when</span>(</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Young"</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">"Treatment A"</span> <span class="sc">~</span> <span class="fl">0.70</span>,</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Young"</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">"Treatment B"</span> <span class="sc">~</span> <span class="fl">0.80</span>,</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Older"</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">"Treatment A"</span> <span class="sc">~</span> <span class="fl">0.50</span>,</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Older"</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">"Treatment B"</span> <span class="sc">~</span> <span class="fl">0.40</span>,</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># More older people get Treatment A</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="fu">if_else</span>(</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Older"</span> <span class="sc">&amp;</span> <span class="fu">runif</span>(n) <span class="sc">&lt;</span> <span class="fl">0.7</span>, </span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Treatment A"</span>, </span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>      treatment</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate recovery outcomes</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovered =</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, recovery_prob)</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate data</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>overall_rates <span class="ot">&lt;-</span> simpson_data <span class="sc">%&gt;%</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_patients =</span> <span class="fu">n</span>(),</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovered_patients =</span> <span class="fu">sum</span>(recovered),</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovery_rate =</span> <span class="fu">mean</span>(recovered)</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>by_age_rates <span class="ot">&lt;-</span> simpson_data <span class="sc">%&gt;%</span></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment, age_group) <span class="sc">%&gt;%</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_patients =</span> <span class="fu">n</span>(),</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovered_patients =</span> <span class="fu">sum</span>(recovered),</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovery_rate =</span> <span class="fu">mean</span>(recovered)</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'treatment'. You can override using the
`.groups` argument.</code></pre>
</div>
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualization</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>overall_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(overall_rates, </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> recovery_rate, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(recovery_rate<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%"</span>)), </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Overall Recovery Rates"</span>,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Simpson's Paradox: Treatment B appears worse overall"</span>,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Recovery Rate"</span>) <span class="sc">+</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>by_age_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(by_age_rates, </span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> recovery_rate, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(recovery_rate<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%"</span>)), </span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Recovery Rates by Age Group"</span>,</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Within each age group, Treatment B is actually better"</span>,</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Recovery Rate"</span>) <span class="sc">+</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>age_group) <span class="sc">+</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Display tables and plots</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(overall_rates, <span class="at">caption =</span> <span class="st">"Overall Recovery Rates by Treatment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Overall Recovery Rates by Treatment</caption>
<thead>
<tr class="header">
<th style="text-align: left;">treatment</th>
<th style="text-align: right;">total_patients</th>
<th style="text-align: right;">recovered_patients</th>
<th style="text-align: right;">recovery_rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Treatment A</td>
<td style="text-align: right;">594</td>
<td style="text-align: right;">356</td>
<td style="text-align: right;">0.5993266</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment B</td>
<td style="text-align: right;">406</td>
<td style="text-align: right;">297</td>
<td style="text-align: right;">0.7315271</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(by_age_rates, <span class="at">caption =</span> <span class="st">"Recovery Rates by Treatment and Age Group"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Recovery Rates by Treatment and Age Group</caption>
<colgroup>
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 21%">
<col style="width: 27%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">treatment</th>
<th style="text-align: left;">age_group</th>
<th style="text-align: right;">total_patients</th>
<th style="text-align: right;">recovered_patients</th>
<th style="text-align: right;">recovery_rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Treatment A</td>
<td style="text-align: left;">Older</td>
<td style="text-align: right;">240</td>
<td style="text-align: right;">116</td>
<td style="text-align: right;">0.4833333</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment A</td>
<td style="text-align: left;">Young</td>
<td style="text-align: right;">354</td>
<td style="text-align: right;">240</td>
<td style="text-align: right;">0.6779661</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Treatment B</td>
<td style="text-align: left;">Older</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0.4181818</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment B</td>
<td style="text-align: left;">Young</td>
<td style="text-align: right;">351</td>
<td style="text-align: right;">274</td>
<td style="text-align: right;">0.7806268</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(overall_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(by_age_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Simpson’s paradox is occurring here because:</p>
<ol type="1">
<li><strong>Within each age group</strong>: Treatment B has a higher recovery rate than Treatment A</li>
<li><strong>Overall</strong>: Treatment A appears to have a higher recovery rate than Treatment B</li>
</ol>
<p>This paradox happens because: - Treatment A is given more frequently to older patients - Older patients have lower recovery rates regardless of treatment - This skews the overall average to make Treatment A look better, even though Treatment B is better for both young and older patients</p>
</section>
<section id="directed-acyclic-graphs-dags" class="level3" data-number="2.17.5">
<h3 data-number="2.17.5" class="anchored" data-anchor-id="directed-acyclic-graphs-dags"><span class="header-section-number">2.17.5</span> Directed Acyclic Graphs (DAGs)</h3>
<p>DAGs are powerful tools for visualizing causal relationships and identifying potential biases in statistical analyses.</p>
<div class="cell">
<details class="code-fold">
<summary>R code for DAG examples</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Try to load dagitty and ggdag if available</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">"dagitty"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="sc">&amp;&amp;</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">requireNamespace</span>(<span class="st">"ggdag"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dagitty)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggdag)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example 1: Confounder</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  confounder_dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag {</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="st">    X -&gt; Y</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="st">    Z -&gt; X</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="st">    Z -&gt; Y</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="st">  }'</span>)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example 2: Collider</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  collider_dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag {</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="st">    X -&gt; Z</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="st">    Y -&gt; Z</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="st">    X -- Y [unobserved]</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="st">  }'</span>)</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example 3: Simpson's Paradox</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>  simpson_dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag {</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="st">    Treatment -&gt; Recovery</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="st">    Age -&gt; Treatment</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="st">    Age -&gt; Recovery</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="st">  }'</span>)</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot the DAGs</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggdag</span>(confounder_dag) <span class="sc">+</span> </span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_dag</span>() <span class="sc">+</span> </span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Confounder (Z)"</span>)</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggdag</span>(collider_dag) <span class="sc">+</span> </span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_dag</span>() <span class="sc">+</span> </span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Collider (Z)"</span>)</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">ggdag</span>(simpson_dag) <span class="sc">+</span> </span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_dag</span>() <span class="sc">+</span> </span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Simpson's Paradox Structure"</span>)</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p1)</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p2)</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p3)</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"DAG visualization packages not installed. Install dagitty and ggdag packages for these examples."</span>)</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggdag'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>DAGs help us visualize different causal structures:</p>
<ol type="1">
<li><strong>Confounder</strong>: A variable (Z) that affects both the exposure (X) and outcome (Y)</li>
<li><strong>Collider</strong>: A variable (Z) that is affected by both the exposure (X) and another variable (Y)</li>
<li><strong>Simpson’s Paradox</strong>: Often involves a confounder that influences both the treatment/exposure and the outcome</li>
</ol>
<p>Understanding these structures helps us decide which variables to control for in our analyses and which to leave out.</p>
</section>
</section>
<section id="appendix-d-models-in-science-from-deterministic-to-stochastic" class="level2" data-number="2.18">
<h2 data-number="2.18" class="anchored" data-anchor-id="appendix-d-models-in-science-from-deterministic-to-stochastic"><span class="header-section-number">2.18</span> Appendix D: Models in Science: From Deterministic to Stochastic</h2>
<p>Models are essential tools in scientific research, helping scientists to represent, understand, and predict complex phenomena.</p>
<section id="types-of-models" class="level3" data-number="2.18.1">
<h3 data-number="2.18.1" class="anchored" data-anchor-id="types-of-models"><span class="header-section-number">2.18.1</span> Types of Models</h3>
<section id="mathematical-models" class="level4" data-number="2.18.1.1">
<h4 data-number="2.18.1.1" class="anchored" data-anchor-id="mathematical-models"><span class="header-section-number">2.18.1.1</span> Mathematical Models</h4>
<p>Mathematical models use equations to describe and analyze systems. They can be divided into:</p>
<section id="deterministic-models" class="level5" data-number="2.18.1.1.1">
<h5 data-number="2.18.1.1.1" class="anchored" data-anchor-id="deterministic-models"><span class="header-section-number">2.18.1.1.1</span> Deterministic Models</h5>
<p>Deterministic models provide precise predictions based on a set of variables, without incorporating randomness.</p>
<p><strong>Example:</strong> Newton’s laws of motion, which can precisely predict the motion of objects under known forces:</p>
<p><span class="math display">x(t) = x_0 + v_0t + \frac{1}{2}at^2</span></p>
<p>Where <span class="math inline">x(t)</span> is the position at time <span class="math inline">t</span>, <span class="math inline">x_0</span> is the initial position, <span class="math inline">v_0</span> is the initial velocity, and <span class="math inline">a</span> is the acceleration.</p>
</section>
<section id="stochastic-models" class="level5" data-number="2.18.1.1.2">
<h5 data-number="2.18.1.1.2" class="anchored" data-anchor-id="stochastic-models"><span class="header-section-number">2.18.1.1.2</span> Stochastic Models</h5>
<p>Stochastic models incorporate randomness and probability. They come in two fundamentally different types:</p>
<p><strong>Classical Stochastic Models</strong>: Deal with randomness arising from incomplete information or complex interactions in classical systems. The underlying system is deterministic, but practical limitations lead to probabilistic descriptions.</p>
<p><strong>Example:</strong> Regression models in statistics, where the randomness represents unexplained variation:</p>
<p><span class="math display">y = \beta_0 + \beta_1x + \varepsilon</span></p>
<p>Where <span class="math inline">y</span> is the dependent variable, <span class="math inline">x</span> is the independent variable, <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1</span> are parameters, and <span class="math inline">\varepsilon</span> is the error term.</p>
<p><strong>Quantum Stochastic Models</strong>: Deal with the fundamental, irreducible randomness inherent in quantum mechanical systems.</p>
<p><strong>Example:</strong> The decay of a radioactive particle follows a probability distribution:</p>
<p><span class="math display">P(t) = e^{-t/\tau}</span></p>
<p>Where <span class="math inline">P(t)</span> is the probability that the particle has not decayed after time <span class="math inline">t</span>, and <span class="math inline">\tau</span> is the mean lifetime of the particle.</p>
</section>
</section>
<section id="other-model-types" class="level4" data-number="2.18.1.2">
<h4 data-number="2.18.1.2" class="anchored" data-anchor-id="other-model-types"><span class="header-section-number">2.18.1.2</span> Other Model Types</h4>
<ul>
<li><strong>Computer Simulation Models</strong>: Use algorithms to simulate complex systems</li>
<li><strong>Conceptual Models</strong>: Abstract representations using diagrams or flowcharts</li>
<li><strong>Physical Models</strong>: Tangible representations like scale models</li>
<li><strong>Theoretical Models</strong>: Abstract frameworks based on fundamental principles</li>
</ul>
</section>
</section>
<section id="model-error-and-bias-variance-tradeoff" class="level3" data-number="2.18.2">
<h3 data-number="2.18.2" class="anchored" data-anchor-id="model-error-and-bias-variance-tradeoff"><span class="header-section-number">2.18.2</span> Model Error and Bias-Variance Tradeoff</h3>
<p>All models involve some degree of error. Understanding the balance between bias and variance is crucial:</p>
<ul>
<li><strong>Bias</strong>: Systematic error from simplifying assumptions</li>
<li><strong>Variance</strong>: Error from sensitivity to small fluctuations in the training data</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/ModelError.png" class="img-fluid figure-img"></p>
<figcaption>Bias-Variance Tradeoff in Models</figcaption>
</figure>
</div>
<p>The ideal model balances complexity to minimize both bias and variance, leading to the best predictive performance.</p>
</section>
</section>
<section id="appendix-e-classical-vs-quantum-randomness" class="level2" data-number="2.19">
<h2 data-number="2.19" class="anchored" data-anchor-id="appendix-e-classical-vs-quantum-randomness"><span class="header-section-number">2.19</span> Appendix E: Classical vs Quantum Randomness</h2>
<p>To understand how randomness differs across scientific disciplines, we need to examine the origins and implications of different types of uncertainty.</p>
<section id="origin-of-randomness" class="level3" data-number="2.19.1">
<h3 data-number="2.19.1" class="anchored" data-anchor-id="origin-of-randomness"><span class="header-section-number">2.19.1</span> Origin of Randomness</h3>
<section id="classical-randomness-e.g.-regression-models" class="level4" data-number="2.19.1.1">
<h4 data-number="2.19.1.1" class="anchored" data-anchor-id="classical-randomness-e.g.-regression-models"><span class="header-section-number">2.19.1.1</span> Classical Randomness (e.g., Regression Models)</h4>
<ul>
<li><strong>Source</strong>: Incomplete information or complex interactions in an otherwise deterministic system</li>
<li><strong>Nature</strong>: Epistemic uncertainty (due to lack of knowledge)</li>
<li><strong>Example</strong>: In a regression model, the error term represents unexplained variation</li>
</ul>
</section>
<section id="quantum-randomness" class="level4" data-number="2.19.1.2">
<h4 data-number="2.19.1.2" class="anchored" data-anchor-id="quantum-randomness"><span class="header-section-number">2.19.1.2</span> Quantum Randomness</h4>
<ul>
<li><strong>Source</strong>: Fundamental property of quantum systems</li>
<li><strong>Nature</strong>: Ontic uncertainty (inherent to the system, not due to lack of knowledge)</li>
<li><strong>Example</strong>: The exact time of decay of a radioactive atom cannot be predicted</li>
</ul>
</section>
</section>
<section id="philosophical-implications" class="level3" data-number="2.19.2">
<h3 data-number="2.19.2" class="anchored" data-anchor-id="philosophical-implications"><span class="header-section-number">2.19.2</span> Philosophical Implications</h3>
<section id="classical-randomness" class="level4" data-number="2.19.2.1">
<h4 data-number="2.19.2.1" class="anchored" data-anchor-id="classical-randomness"><span class="header-section-number">2.19.2.1</span> Classical Randomness</h4>
<ul>
<li><strong>Determinism</strong>: Underlying reality is deterministic; randomness reflects our ignorance</li>
<li><strong>Hidden Variables</strong>: In principle, with complete information, we could predict outcomes precisely</li>
</ul>
</section>
<section id="quantum-randomness-1" class="level4" data-number="2.19.2.2">
<h4 data-number="2.19.2.2" class="anchored" data-anchor-id="quantum-randomness-1"><span class="header-section-number">2.19.2.2</span> Quantum Randomness</h4>
<ul>
<li><strong>Indeterminism</strong>: Randomness is a fundamental feature of reality</li>
<li><strong>No Hidden Variables</strong>: Even with complete information, some outcomes remain unpredictable (as suggested by Bell’s theorem)</li>
</ul>
</section>
</section>
<section id="practical-implications" class="level3" data-number="2.19.3">
<h3 data-number="2.19.3" class="anchored" data-anchor-id="practical-implications"><span class="header-section-number">2.19.3</span> Practical Implications</h3>
<section id="classical-randomness-1" class="level4" data-number="2.19.3.1">
<h4 data-number="2.19.3.1" class="anchored" data-anchor-id="classical-randomness-1"><span class="header-section-number">2.19.3.1</span> Classical Randomness</h4>
<ul>
<li><strong>Reducible</strong>: Can be reduced by gathering more data or improving measurement precision</li>
<li><strong>Controllable</strong>: Systematic errors can be identified and corrected</li>
</ul>
</section>
<section id="quantum-randomness-2" class="level4" data-number="2.19.3.2">
<h4 data-number="2.19.3.2" class="anchored" data-anchor-id="quantum-randomness-2"><span class="header-section-number">2.19.3.2</span> Quantum Randomness</h4>
<ul>
<li><strong>Irreducible</strong>: Cannot be eliminated even with perfect measurements</li>
<li><strong>Fundamentally Uncontrollable</strong>: The act of measurement itself affects the system</li>
</ul>
<p>Understanding these differences is crucial for correctly interpreting statistical models in different scientific contexts.</p>
</section>
</section>
</section>
<section id="appendix-f-ethical-considerations-in-social-science-data-analysis" class="level2" data-number="2.20">
<h2 data-number="2.20" class="anchored" data-anchor-id="appendix-f-ethical-considerations-in-social-science-data-analysis"><span class="header-section-number">2.20</span> Appendix F: Ethical Considerations in Social Science Data Analysis</h2>
<p>Ethics play a vital role in social science research. Key considerations include:</p>
<section id="privacy-and-consent" class="level3" data-number="2.20.1">
<h3 data-number="2.20.1" class="anchored" data-anchor-id="privacy-and-consent"><span class="header-section-number">2.20.1</span> 1. Privacy and Consent</h3>
<ul>
<li>Ensure participants understand how their data will be used</li>
<li>Obtain informed consent before collecting data</li>
<li>Protect personally identifiable information</li>
<li>Consider cultural differences in privacy expectations</li>
</ul>
</section>
<section id="data-protection" class="level3" data-number="2.20.2">
<h3 data-number="2.20.2" class="anchored" data-anchor-id="data-protection"><span class="header-section-number">2.20.2</span> 2. Data Protection</h3>
<ul>
<li>Securely store sensitive data</li>
<li>Implement appropriate access controls</li>
<li>Follow relevant regulations (e.g., GDPR, HIPAA)</li>
<li>Have a data management plan that includes secure disposal</li>
</ul>
</section>
<section id="bias-and-representation" class="level3" data-number="2.20.3">
<h3 data-number="2.20.3" class="anchored" data-anchor-id="bias-and-representation"><span class="header-section-number">2.20.3</span> 3. Bias and Representation</h3>
<ul>
<li>Address sampling bias that could exclude marginalized groups</li>
<li>Ensure diverse representation in research</li>
<li>Consider how variable definitions might reflect social biases</li>
<li>Be transparent about limitations in population coverage</li>
</ul>
</section>
<section id="transparency-and-reproducibility" class="level3" data-number="2.20.4">
<h3 data-number="2.20.4" class="anchored" data-anchor-id="transparency-and-reproducibility"><span class="header-section-number">2.20.4</span> 4. Transparency and Reproducibility</h3>
<ul>
<li>Clearly document research methods</li>
<li>Share code and data when possible</li>
<li>Pre-register studies when appropriate</li>
<li>Acknowledge limitations and potential biases</li>
</ul>
</section>
<section id="social-impact" class="level3" data-number="2.20.5">
<h3 data-number="2.20.5" class="anchored" data-anchor-id="social-impact"><span class="header-section-number">2.20.5</span> 5. Social Impact</h3>
<ul>
<li>Consider the potential societal implications of research findings</li>
<li>Avoid reinforcing harmful stereotypes</li>
<li>Think about how results might be misinterpreted or misused</li>
<li>Engage with communities being studied</li>
</ul>
<p>Ethical considerations should be integrated throughout the research process, from study design to data collection, analysis, and reporting of results.</p>
</section>
</section>
<section id="appendix-g-introduction-to-rstudio-and-the-tidyverse" class="level2" data-number="2.21">
<h2 data-number="2.21" class="anchored" data-anchor-id="appendix-g-introduction-to-rstudio-and-the-tidyverse"><span class="header-section-number">2.21</span> Appendix G: Introduction to RStudio and the tidyverse</h2>
<p>R is a powerful programming language for statistical computing and graphics. RStudio provides an integrated development environment that makes working with R easier.</p>
<section id="getting-started-with-rstudio" class="level3" data-number="2.21.1">
<h3 data-number="2.21.1" class="anchored" data-anchor-id="getting-started-with-rstudio"><span class="header-section-number">2.21.1</span> Getting Started with RStudio</h3>
<p>RStudio has four main panes:</p>
<ol type="1">
<li><strong>Source Editor</strong>: Where you write and edit your R scripts</li>
<li><strong>Console</strong>: Where you run R commands and see output</li>
<li><strong>Environment/History</strong>: Shows your workspace objects and command history</li>
<li><strong>Files/Plots/Packages/Help</strong>: For file management, viewing plots, managing packages, and accessing help</li>
</ol>
</section>
<section id="the-tidyverse-ecosystem" class="level3" data-number="2.21.2">
<h3 data-number="2.21.2" class="anchored" data-anchor-id="the-tidyverse-ecosystem"><span class="header-section-number">2.21.2</span> The tidyverse Ecosystem</h3>
<p>The tidyverse is a collection of R packages designed for data science with a consistent design philosophy.</p>
<p>Key packages include:</p>
<ul>
<li><strong>ggplot2</strong>: Data visualization</li>
<li><strong>dplyr</strong>: Data manipulation</li>
<li><strong>tidyr</strong>: Data tidying</li>
<li><strong>readr</strong>: Data import</li>
<li><strong>purrr</strong>: Functional programming</li>
<li><strong>tibble</strong>: Modern data frames</li>
</ul>
</section>
<section id="basic-tidyverse-workflow" class="level3" data-number="2.21.3">
<h3 data-number="2.21.3" class="anchored" data-anchor-id="basic-tidyverse-workflow"><span class="header-section-number">2.21.3</span> Basic tidyverse Workflow</h3>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load tidyverse</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"my_data.csv"</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean and transform</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(important_variable)) <span class="sc">%&gt;%</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(var1, var2, var3) <span class="sc">%&gt;%</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_var =</span> var1 <span class="sc">/</span> var2)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Group and summarize</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> cleaned_data <span class="sc">%&gt;%</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(category) <span class="sc">%&gt;%</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_val =</span> <span class="fu">mean</span>(var3),</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>()</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cleaned_data, <span class="fu">aes</span>(<span class="at">x =</span> var1, <span class="at">y =</span> var2, <span class="at">color =</span> category)) <span class="sc">+</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relationship between Variables"</span>,</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Variable 1"</span>,</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Variable 2"</span>) <span class="sc">+</span></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This workflow demonstrates the power of the tidyverse’s pipe operator (<code>%&gt;%</code>), which allows you to chain operations together in a readable way.</p>
</section>
<section id="resources-for-learning-r" class="level3" data-number="2.21.4">
<h3 data-number="2.21.4" class="anchored" data-anchor-id="resources-for-learning-r"><span class="header-section-number">2.21.4</span> Resources for Learning R</h3>
<ul>
<li><a href="https://r4ds.had.co.nz/">R for Data Science</a></li>
<li><a href="https://www.tidyverse.org/">tidyverse documentation</a></li>
<li><a href="https://www.rstudio.com/resources/cheatsheets/">RStudio Cheat Sheets</a></li>
<li><a href="https://quarto.org/docs/guide/">Quarto Guide</a></li>
</ul>
<p>The best way to learn R is through practice. Start with small, manageable projects and gradually build your skills.</p>
</section>
</section>
<section id="appendix-h-symulacja-centralnego-twierdzenia-granicznego" class="level2" data-number="2.22">
<h2 data-number="2.22" class="anchored" data-anchor-id="appendix-h-symulacja-centralnego-twierdzenia-granicznego"><span class="header-section-number">2.22</span> Appendix H: Symulacja Centralnego Twierdzenia Granicznego</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Załadowanie bibliotek</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ustawienie ziarna dla powtarzalności</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="czym-jest-centralne-twierdzenie-graniczne" class="level3" data-number="2.22.1">
<h3 data-number="2.22.1" class="anchored" data-anchor-id="czym-jest-centralne-twierdzenie-graniczne"><span class="header-section-number">2.22.1</span> Czym jest Centralne Twierdzenie Graniczne?</h3>
<p>Centralne Twierdzenie Graniczne (CTG) mówi, że <strong>średnie z prób losowych zbliżają się do rozkładu normalnego</strong> niezależnie od rozkładu populacji, gdy wielkość próby jest wystarczająco duża.</p>
</section>
<section id="prosty-eksperyment" class="level3" data-number="2.22.2">
<h3 data-number="2.22.2" class="anchored" data-anchor-id="prosty-eksperyment"><span class="header-section-number">2.22.2</span> Prosty eksperyment</h3>
<p>Zbadamy trzy różne rozkłady i zobaczymy, jak średnie z próby zbiegają do rozkładu normalnego.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parametry symulacji</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>wielkosci_prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">30</span>)  <span class="co"># Wielkości próby</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>liczba_symulacji <span class="ot">&lt;-</span> <span class="dv">1000</span>       <span class="co"># Liczba powtórzeń dla każdej wielkości próby</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie pustych ramek danych</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>dane_jednostajne <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>dane_wykladnicze <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>dane_dwupunktowe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Przeprowadzanie symulacji</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> wielkosci_prob) {</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rozkład jednostajny (0-1)</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  srednie_jedn <span class="ot">&lt;-</span> <span class="fu">replicate</span>(liczba_symulacji, <span class="fu">mean</span>(<span class="fu">runif</span>(n)))</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  dane_jednostajne <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dane_jednostajne, </span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">data.frame</span>(<span class="at">srednia =</span> srednie_jedn, </span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">wielkosc_proby =</span> <span class="fu">as.factor</span>(n)))</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rozkład wykładniczy (lambda=1)</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>  srednie_wykl <span class="ot">&lt;-</span> <span class="fu">replicate</span>(liczba_symulacji, <span class="fu">mean</span>(<span class="fu">rexp</span>(n)))</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  dane_wykladnicze <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dane_wykladnicze, </span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">data.frame</span>(<span class="at">srednia =</span> srednie_wykl, </span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">wielkosc_proby =</span> <span class="fu">as.factor</span>(n)))</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rozkład dwupunktowy (0-1 z p=0.3)</span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>  srednie_dwup <span class="ot">&lt;-</span> <span class="fu">replicate</span>(liczba_symulacji, <span class="fu">mean</span>(<span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.3</span>)))</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>  dane_dwupunktowe <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dane_dwupunktowe, </span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">data.frame</span>(<span class="at">srednia =</span> srednie_dwup, </span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">wielkosc_proby =</span> <span class="fu">as.factor</span>(n)))</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Funkcja do rysowania wykresów rozkładu populacji</span></span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>rysuj_populacje <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rozkład jednostajny</span></span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">runif</span>(<span class="dv">1000</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Rozkład Jednostajny"</span>, <span class="at">x =</span> <span class="st">"Wartość"</span>, <span class="at">y =</span> <span class="st">"Liczebność"</span>) <span class="sc">+</span></span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rozkład wykładniczy</span></span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rexp</span>(<span class="dv">1000</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"salmon"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Rozkład Wykładniczy"</span>, <span class="at">x =</span> <span class="st">"Wartość"</span>, <span class="at">y =</span> <span class="st">"Liczebność"</span>) <span class="sc">+</span></span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rozkład dwupunktowy</span></span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rbinom</span>(<span class="dv">1000</span>, <span class="dv">1</span>, <span class="fl">0.3</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"lightgreen"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Rozkład Dwupunktowy"</span>, <span class="at">x =</span> <span class="st">"Wartość"</span>, <span class="at">y =</span> <span class="st">"Liczebność"</span>) <span class="sc">+</span></span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Łączenie wykresów</span></span>
<span id="cb50-53"><a href="#cb50-53" aria-hidden="true" tabindex="-1"></a>  p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb50-54"><a href="#cb50-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-55"><a href="#cb50-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-56"><a href="#cb50-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Funkcja do rysowania wykresów rozkładu średnich</span></span>
<span id="cb50-57"><a href="#cb50-57" aria-hidden="true" tabindex="-1"></a>rysuj_srednie <span class="ot">&lt;-</span> <span class="cf">function</span>(dane, tytul, kolor) {</span>
<span id="cb50-58"><a href="#cb50-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> srednia)) <span class="sc">+</span></span>
<span id="cb50-59"><a href="#cb50-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">fill =</span> kolor, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb50-60"><a href="#cb50-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>wielkosc_proby, <span class="at">scales =</span> <span class="st">"free_y"</span>, </span>
<span id="cb50-61"><a href="#cb50-61" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">wielkosc_proby =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">"n ="</span>, x))) <span class="sc">+</span></span>
<span id="cb50-62"><a href="#cb50-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> tytul, <span class="at">x =</span> <span class="st">"Średnia z próby"</span>, <span class="at">y =</span> <span class="st">"Liczebność"</span>) <span class="sc">+</span></span>
<span id="cb50-63"><a href="#cb50-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb50-64"><a href="#cb50-64" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="jak-wyglądają-nasze-populacje" class="level3" data-number="2.22.3">
<h3 data-number="2.22.3" class="anchored" data-anchor-id="jak-wyglądają-nasze-populacje"><span class="header-section-number">2.22.3</span> Jak wyglądają nasze populacje?</h3>
<p>Poniżej przedstawione są rozkłady trzech populacji, z których będziemy losować próby:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rysuj_populacje</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/populations-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Te trzy rozkłady są bardzo różne: - <strong>Rozkład jednostajny</strong>: wszystkie wartości między 0 a 1 są równie prawdopodobne - <strong>Rozkład wykładniczy</strong>: skośny, z długim “ogonem” po prawej stronie - <strong>Rozkład dwupunktowy</strong>: tylko dwie możliwe wartości (0 i 1)</p>
</section>
<section id="jak-zmieniają-się-rozkłady-średnich-z-próby" class="level3" data-number="2.22.4">
<h3 data-number="2.22.4" class="anchored" data-anchor-id="jak-zmieniają-się-rozkłady-średnich-z-próby"><span class="header-section-number">2.22.4</span> Jak zmieniają się rozkłady średnich z próby?</h3>
<section id="rozkład-jednostajny" class="level4" data-number="2.22.4.1">
<h4 data-number="2.22.4.1" class="anchored" data-anchor-id="rozkład-jednostajny"><span class="header-section-number">2.22.4.1</span> Rozkład Jednostajny</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rysuj_srednie</span>(dane_jednostajne, <span class="st">"Średnie z Rozkładu Jednostajnego"</span>, <span class="st">"skyblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/uniform_means-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rozkład-wykładniczy" class="level4" data-number="2.22.4.2">
<h4 data-number="2.22.4.2" class="anchored" data-anchor-id="rozkład-wykładniczy"><span class="header-section-number">2.22.4.2</span> Rozkład Wykładniczy</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rysuj_srednie</span>(dane_wykladnicze, <span class="st">"Średnie z Rozkładu Wykładniczego"</span>, <span class="st">"salmon"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/exponential_means-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rozkład-dwupunktowy" class="level4" data-number="2.22.4.3">
<h4 data-number="2.22.4.3" class="anchored" data-anchor-id="rozkład-dwupunktowy"><span class="header-section-number">2.22.4.3</span> Rozkład Dwupunktowy</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rysuj_srednie</span>(dane_dwupunktowe, <span class="st">"Średnie z Rozkładu Dwupunktowego"</span>, <span class="st">"lightgreen"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/binomial_means-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="porównanie-wszystkich-trzech-rozkładów-dla-n30" class="level3" data-number="2.22.5">
<h3 data-number="2.22.5" class="anchored" data-anchor-id="porównanie-wszystkich-trzech-rozkładów-dla-n30"><span class="header-section-number">2.22.5</span> Porównanie wszystkich trzech rozkładów dla n=30</h3>
<p>Zobaczmy teraz, jak wyglądają rozkłady średnich dla próby wielkości n=30 dla wszystkich trzech populacji:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Łączenie danych dla n=30</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>dane_30 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  dane_jednostajne <span class="sc">%&gt;%</span> <span class="fu">filter</span>(wielkosc_proby <span class="sc">==</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">rozklad =</span> <span class="st">"Jednostajny"</span>),</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  dane_wykladnicze <span class="sc">%&gt;%</span> <span class="fu">filter</span>(wielkosc_proby <span class="sc">==</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">rozklad =</span> <span class="st">"Wykładniczy"</span>),</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  dane_dwupunktowe <span class="sc">%&gt;%</span> <span class="fu">filter</span>(wielkosc_proby <span class="sc">==</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">rozklad =</span> <span class="st">"Dwupunktowy"</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Standaryzacja średnich</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>dane_30 <span class="ot">&lt;-</span> dane_30 <span class="sc">%&gt;%</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(rozklad) <span class="sc">%&gt;%</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">srednia_stand =</span> <span class="fu">case_when</span>(</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>      rozklad <span class="sc">==</span> <span class="st">"Jednostajny"</span> <span class="sc">~</span> (srednia <span class="sc">-</span> <span class="fl">0.5</span>) <span class="sc">/</span> (<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">12</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">30</span>)),</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>      rozklad <span class="sc">==</span> <span class="st">"Wykładniczy"</span> <span class="sc">~</span> (srednia <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">30</span>)),</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>      rozklad <span class="sc">==</span> <span class="st">"Dwupunktowy"</span> <span class="sc">~</span> (srednia <span class="sc">-</span> <span class="fl">0.3</span>) <span class="sc">/</span> (<span class="fu">sqrt</span>(<span class="fl">0.3</span><span class="sc">*</span><span class="fl">0.7</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">30</span>))</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres porównawczy</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane_30, <span class="fu">aes</span>(<span class="at">x =</span> srednia, <span class="at">fill =</span> rozklad)) <span class="sc">+</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">position =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>rozklad, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Porównanie Rozkładów Średnich dla n=30"</span>,</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Wszystkie rozkłady średnich zbliżają się do normalnego"</span>,</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Średnia z próby"</span>, <span class="at">y =</span> <span class="st">"Liczebność"</span>) <span class="sc">+</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Jednostajny"</span> <span class="ot">=</span> <span class="st">"skyblue"</span>, </span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Wykładniczy"</span> <span class="ot">=</span> <span class="st">"salmon"</span>, </span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Dwupunktowy"</span> <span class="ot">=</span> <span class="st">"lightgreen"</span>)) <span class="sc">+</span></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/comparison-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres po standaryzacji</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane_30, <span class="fu">aes</span>(<span class="at">x =</span> srednia_stand, <span class="at">fill =</span> rozklad)) <span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>rozklad) <span class="sc">+</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Standaryzowane Rozkłady Średnich"</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Po standaryzacji wszystkie rozkłady zbiegają do standardowego rozkładu normalnego N(0,1)"</span>,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Standaryzowana średnia"</span>, <span class="at">y =</span> <span class="st">"Liczebność"</span>) <span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Jednostajny"</span> <span class="ot">=</span> <span class="st">"skyblue"</span>, </span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Wykładniczy"</span> <span class="ot">=</span> <span class="st">"salmon"</span>, </span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Dwupunktowy"</span> <span class="ot">=</span> <span class="st">"lightgreen"</span>)) <span class="sc">+</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/comparison-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="kluczowe-wnioski" class="level3" data-number="2.22.6">
<h3 data-number="2.22.6" class="anchored" data-anchor-id="kluczowe-wnioski"><span class="header-section-number">2.22.6</span> Kluczowe wnioski</h3>
<ol type="1">
<li><p><strong>Gdy n=1</strong>, rozkład średnich jest identyczny z rozkładem populacji.</p></li>
<li><p><strong>Gdy n rośnie</strong>, rozkład średnich:</p>
<ul>
<li>Staje się coraz bardziej normalny (dzwonowaty)</li>
<li>Skupia się wokół wartości oczekiwanej populacji</li>
<li>Ma coraz mniejszą wariancję</li>
</ul></li>
<li><p><strong>Niezależnie od rozkładu populacji</strong>, średnie z próby zbiegają do rozkładu normalnego.</p></li>
<li><p><strong>Po standaryzacji</strong> wszystkie rozkłady średnich zbiegają do standardowego rozkładu normalnego N(0,1).</p></li>
</ol>
<p>Ten efekt jest fundamentem wielu metod statystycznych, w tym: - Estymacji przedziałowej - Testów statystycznych - Kontroli jakości - Badań próbkowych</p>
</section>
</section>
<section id="appendix-i-symulacja-prawa-wielkich-liczb" class="level2" data-number="2.23">
<h2 data-number="2.23" class="anchored" data-anchor-id="appendix-i-symulacja-prawa-wielkich-liczb"><span class="header-section-number">2.23</span> Appendix I: Symulacja Prawa Wielkich Liczb</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Załadowanie wymaganych bibliotek</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ustawienie ziarna dla powtarzalności wyników</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="prawo-wielkich-liczb" class="level3" data-number="2.23.1">
<h3 data-number="2.23.1" class="anchored" data-anchor-id="prawo-wielkich-liczb"><span class="header-section-number">2.23.1</span> Prawo Wielkich Liczb</h3>
<p>Prawo Wielkich Liczb stwierdza, że wraz ze wzrostem liczby prób, średnia z próby zbiega do wartości oczekiwanej.</p>
<p><strong>Kluczowe pojęcia:</strong></p>
<ul>
<li><p><strong>Wartość oczekiwana:</strong> Teoretyczna średnia wyników, której spodziewamy się w losowym eksperymencie (0,5 dla uczciwej monety, 3,5 dla uczciwej kostki)</p></li>
<li><p><strong>Średnia z próby:</strong> Średnia z zaobserwowanych wyników z ograniczonej liczby prób</p></li>
<li><p><strong>Skumulowana proporcja/średnia:</strong> Bieżąca średnia liczona po każdej nowej obserwacji. Na przykład, po 3 rzutach monetą dających Orzeł, Reszka, Orzeł, skumulowane proporcje wynosiłyby:</p>
<ul>
<li>Po 1 rzucie: 1/1 = 1,0</li>
<li>Po 2 rzutach: (1+0)/2 = 0,5</li>
<li>Po 3 rzutach: (1+0+1)/3 = 0,67</li>
</ul></li>
</ul>
<p>Ta bieżąca średnia początkowo silnie się waha, ale stopniowo stabilizuje się wokół wartości oczekiwanej wraz z dodawaniem kolejnych obserwacji.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Zdefiniowanie parametrów symulacji</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>liczebnosci_prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>liczba_powtorzen <span class="ot">&lt;-</span> <span class="dv">20</span>  <span class="co"># Zmniejszona ze 100, aby pokazać większą zmienność</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="symulacja-rzutów-monetą" class="level3" data-number="2.23.2">
<h3 data-number="2.23.2" class="anchored" data-anchor-id="symulacja-rzutów-monetą"><span class="header-section-number">2.23.2</span> Symulacja Rzutów Monetą</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generowanie danych zarówno dla średnich z próby, jak i indywidualnych eksperymentów</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>wyniki_danych <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>indywidualne_eksperymenty <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Funkcja do wykonywania rzutów monetą</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>eksperyment_moneta <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  rzuty <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(rzuty)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Uruchomienie symulacji dla wszystkich liczebności prób</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (liczebnosc <span class="cf">in</span> liczebnosci_prob) {</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Dla każdej liczebności próby wykonaj wiele powtórzeń</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (powt <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>liczba_powtorzen) {</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Uruchomienie eksperymentu</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>    wynik <span class="ot">&lt;-</span> <span class="fu">eksperyment_moneta</span>(liczebnosc)</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Zapisanie wyniku</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>    wyniki_danych <span class="ot">&lt;-</span> <span class="fu">rbind</span>(wyniki_danych, <span class="fu">data.frame</span>(</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">liczebnosc_proby =</span> liczebnosc,</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">proporcja =</span> wynik,</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">powtorzenie =</span> powt</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Utworzenie danych średniej skumulowanej dla 3 określonych liczebności próby</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (liczebnosc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)) {</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {  <span class="co"># Tylko 3 trajektorie dla zachowania czytelności</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set.seed</span>(i <span class="sc">*</span> <span class="dv">100</span> <span class="sc">+</span> liczebnosc)  <span class="co"># Różne ziarno dla każdej trajektorii</span></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>      rzuty <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">size =</span> liczebnosc, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>      srednie_skumulowane <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(rzuty) <span class="sc">/</span> <span class="fu">seq_along</span>(rzuty)</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>      indywidualne_eksperymenty <span class="ot">&lt;-</span> <span class="fu">rbind</span>(indywidualne_eksperymenty, <span class="fu">data.frame</span>(</span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">numer_rzutu =</span> <span class="dv">1</span><span class="sc">:</span>liczebnosc,</span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">srednia_skumulowana =</span> srednie_skumulowane,</span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">liczebnosc_proby =</span> liczebnosc,</span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">eksperyment =</span> <span class="fu">paste</span>(<span class="st">"Eksp"</span>, i)</span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie średniego wyniku dla każdej liczebności próby</span></span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>dane_podsumowujace <span class="ot">&lt;-</span> wyniki_danych <span class="sc">%&gt;%</span></span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(liczebnosc_proby) <span class="sc">%&gt;%</span></span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">srednia_proporcja =</span> <span class="fu">mean</span>(proporcja),</span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_proporcja =</span> <span class="fu">min</span>(proporcja),</span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_proporcja =</span> <span class="fu">max</span>(proporcja)</span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="wizualizacja-zbieżności-do-wartości-oczekiwanej" class="level4" data-number="2.23.2.1">
<h4 data-number="2.23.2.1" class="anchored" data-anchor-id="wizualizacja-zbieżności-do-wartości-oczekiwanej"><span class="header-section-number">2.23.2.1</span> Wizualizacja Zbieżności do Wartości Oczekiwanej</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Utworzenie wykresu punktowego indywidualnych prób i linii średniej</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Wyniki indywidualnych eksperymentów (rozrzucone punkty)</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> wyniki_danych, </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> liczebnosc_proby, <span class="at">y =</span> proporcja),</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.05</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Linia średniej</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dane_podsumowujace, </span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> liczebnosc_proby, <span class="at">y =</span> srednia_proporcja),</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> dane_podsumowujace, </span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> liczebnosc_proby, <span class="at">y =</span> srednia_proporcja),</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Wartość oczekiwana</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Teoretyczne granice (1/√n jest w przybliżeniu błędem standardowym dla rzutów monetą)</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> dane_podsumowujace,</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> liczebnosc_proby, </span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin =</span> <span class="fl">0.5</span> <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(liczebnosc_proby),</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> <span class="fl">0.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(liczebnosc_proby)),</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Formatowanie</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">breaks =</span> liczebnosci_prob) <span class="sc">+</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Symulacja Rzutów Monetą: Zbieżność do Wartości Oczekiwanej (0,5)"</span>,</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Każdy niebieski punkt to pojedynczy eksperyment; czerwona linia pokazuje średnią z eksperymentów"</span>,</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Liczba Rzutów Monetą (skala logarytmiczna)"</span>,</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proporcja Orłów"</span>) <span class="sc">+</span></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Powyższy wykres pokazuje:</p>
<ul>
<li><strong>Niebieskie punkty</strong>: Indywidualne eksperymenty (każdy z różną liczebnością próby)</li>
<li><strong>Czerwona linia</strong>: Średnia z eksperymentów dla każdej liczebności próby</li>
<li><strong>Czarna przerywana linia</strong>: Wartość oczekiwana (0,5)</li>
<li><strong>Szary obszar</strong>: Teoretyczne granice (±1/√n) - reprezentuje oczekiwany zakres wyników</li>
</ul>
<p>Zwróć uwagę, jak:</p>
<ol type="1">
<li>Indywidualne wyniki (niebieskie punkty) wykazują dużą zmienność przy małych próbach</li>
<li>Zmienność maleje wraz ze wzrostem liczebności próby</li>
<li>Średnia (czerwona linia) zbiega do wartości oczekiwanej</li>
<li>Większość wyników mieści się w teoretycznych granicach (szary obszar), które zwężają się wraz ze wzrostem liczebności próby</li>
</ol>
</section>
<section id="średnia-skumulowana-w-indywidualnych-eksperymentach" class="level4" data-number="2.23.2.2">
<h4 data-number="2.23.2.2" class="anchored" data-anchor-id="średnia-skumulowana-w-indywidualnych-eksperymentach"><span class="header-section-number">2.23.2.2</span> Średnia Skumulowana w Indywidualnych Eksperymentach</h4>
<p>Przyjrzyjmy się, jak zmienia się bieżąca średnia w ramach indywidualnych eksperymentów:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Utworzenie wykresu średnich skumulowanych</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(indywidualne_eksperymenty <span class="sc">%&gt;%</span> <span class="fu">filter</span>(liczebnosc_proby <span class="sc">==</span> <span class="dv">1000</span>), </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> numer_rzutu, <span class="at">y =</span> srednia_skumulowana, <span class="at">color =</span> eksperyment)) <span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bieżąca Średnia dla 1000 Rzutów Monetą"</span>,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Jak ewoluuje średnia rzut po rzucie"</span>,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Liczba Rzutów"</span>,</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Skumulowana Proporcja Orłów"</span>) <span class="sc">+</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Utworzenie przybliżonego widoku początkowych rzutów</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(indywidualne_eksperymenty <span class="sc">%&gt;%</span> <span class="fu">filter</span>(liczebnosc_proby <span class="sc">==</span> <span class="dv">1000</span>, numer_rzutu <span class="sc">&lt;=</span> <span class="dv">100</span>), </span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> numer_rzutu, <span class="at">y =</span> srednia_skumulowana, <span class="at">color =</span> eksperyment)) <span class="sc">+</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pierwsze 100 Rzutów (Przybliżony Widok)"</span>,</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Liczba Rzutów"</span>,</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Skumulowana Proporcja Orłów"</span>) <span class="sc">+</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">/</span> p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="symulacja-rzutów-kostką" class="level3" data-number="2.23.3">
<h3 data-number="2.23.3" class="anchored" data-anchor-id="symulacja-rzutów-kostką"><span class="header-section-number">2.23.3</span> Symulacja Rzutów Kostką</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Zresetowanie ramek danych</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>wyniki_danych <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>indywidualne_eksperymenty <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Funkcja do wykonywania rzutów kostką</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>eksperyment_kostka <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  rzuty <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(rzuty)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Uruchomienie symulacji dla wszystkich liczebności prób</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (liczebnosc <span class="cf">in</span> liczebnosci_prob) {</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Dla każdej liczebności próby wykonaj wiele powtórzeń</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (powt <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>liczba_powtorzen) {</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Uruchomienie eksperymentu</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>    wynik <span class="ot">&lt;-</span> <span class="fu">eksperyment_kostka</span>(liczebnosc)</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Zapisanie wyniku</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>    wyniki_danych <span class="ot">&lt;-</span> <span class="fu">rbind</span>(wyniki_danych, <span class="fu">data.frame</span>(</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">liczebnosc_proby =</span> liczebnosc,</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">srednia_wartosc =</span> wynik,</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">powtorzenie =</span> powt</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Utworzenie danych średniej skumulowanej tylko dla największej liczebności próby</span></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (liczebnosc <span class="sc">==</span> <span class="dv">1000</span>) {</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {  <span class="co"># Tylko 3 trajektorie</span></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set.seed</span>(i <span class="sc">*</span> <span class="dv">200</span> <span class="sc">+</span> liczebnosc)  <span class="co"># Różne ziarno dla każdej trajektorii</span></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>      rzuty <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> liczebnosc, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>      srednie_skumulowane <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(rzuty) <span class="sc">/</span> <span class="fu">seq_along</span>(rzuty)</span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>      indywidualne_eksperymenty <span class="ot">&lt;-</span> <span class="fu">rbind</span>(indywidualne_eksperymenty, <span class="fu">data.frame</span>(</span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">numer_rzutu =</span> <span class="dv">1</span><span class="sc">:</span>liczebnosc,</span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">srednia_skumulowana =</span> srednie_skumulowane,</span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">eksperyment =</span> <span class="fu">paste</span>(<span class="st">"Eksp"</span>, i)</span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie średniego wyniku dla każdej liczebności próby</span></span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a>dane_podsumowujace <span class="ot">&lt;-</span> wyniki_danych <span class="sc">%&gt;%</span></span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(liczebnosc_proby) <span class="sc">%&gt;%</span></span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">srednia_wartosc =</span> <span class="fu">mean</span>(srednia_wartosc),</span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_wartosc =</span> <span class="fu">min</span>(srednia_wartosc),</span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_wartosc =</span> <span class="fu">max</span>(srednia_wartosc)</span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="wizualizacja-zbieżności-rzutów-kostką" class="level4" data-number="2.23.3.1">
<h4 data-number="2.23.3.1" class="anchored" data-anchor-id="wizualizacja-zbieżności-rzutów-kostką"><span class="header-section-number">2.23.3.1</span> Wizualizacja Zbieżności Rzutów Kostką</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Utworzenie wykresu punktowego i linii średniej dla kostki</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Wyniki indywidualnych eksperymentów</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> wyniki_danych, </span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> liczebnosc_proby, <span class="at">y =</span> srednia_wartosc),</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.05</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"tomato"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Linia średniej</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dane_podsumowujace, </span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> liczebnosc_proby, <span class="at">y =</span> srednia_wartosc),</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> dane_podsumowujace, </span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> liczebnosc_proby, <span class="at">y =</span> srednia_wartosc),</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Wartość oczekiwana</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">3.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Formatowanie</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">breaks =</span> liczebnosci_prob) <span class="sc">+</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Symulacja Rzutów Kostką: Zbieżność do Wartości Oczekiwanej (3,5)"</span>,</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Każdy czerwony punkt to pojedynczy eksperyment; niebieska linia pokazuje średnią"</span>,</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Liczba Rzutów Kostką (skala logarytmiczna)"</span>,</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Średnia Wartość Kostki"</span>) <span class="sc">+</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Utworzenie wykresu średnich skumulowanych dla kostki</span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(indywidualne_eksperymenty, </span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> numer_rzutu, <span class="at">y =</span> srednia_skumulowana, <span class="at">color =</span> eksperyment)) <span class="sc">+</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">3.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bieżąca Średnia dla 1000 Rzutów Kostką"</span>,</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Liczba Rzutów"</span>,</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Skumulowana Średnia Wartość"</span>) <span class="sc">+</span></span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>p4 <span class="sc">/</span> p5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="kluczowe-wnioski-1" class="level3" data-number="2.23.4">
<h3 data-number="2.23.4" class="anchored" data-anchor-id="kluczowe-wnioski-1"><span class="header-section-number">2.23.4</span> Kluczowe Wnioski</h3>
<ol type="1">
<li>Indywidualne eksperymenty wykazują dużą zmienność przy małych liczebnościach próby</li>
<li>Średnia z eksperymentów zbiega do wartości oczekiwanej wraz ze wzrostem liczebności próby</li>
<li>W ramach każdego eksperymentu, bieżąca średnia ostatecznie stabilizuje się w pobliżu wartości oczekiwanej</li>
<li>Prawo wielkich liczb zapewnia zbieżność, ale nie gwarantuje dokładnej równości</li>
<li>Wczesne obserwacje mają nieproporcjonalnie duży wpływ na bieżącą średnią</li>
</ol>
</section>
<section id="zrozumienie-teoretycznych-granic-1n" class="level3" data-number="2.23.5">
<h3 data-number="2.23.5" class="anchored" data-anchor-id="zrozumienie-teoretycznych-granic-1n"><span class="header-section-number">2.23.5</span> Zrozumienie Teoretycznych Granic (±1/√n)</h3>
<p>Szary obszar na pierwszym wykresie reprezentuje teoretyczne granice (±1/√n), które pokazują oczekiwany zakres, w którym powinna znaleźć się większość wyników eksperymentalnych:</p>
<p><strong>Co reprezentują te granice:</strong></p>
<ul>
<li>Wywodzą się z Centralnego Twierdzenia Granicznego i przybliżają ±2 błędy standardowe</li>
<li>Dla uczciwej monety, błąd standardowy proporcji wynosi √[0,5×(1-0,5)/n] = 0,5/√n</li>
<li>Granice ±1/√n są uproszczeniem, które dobrze ilustruje zbieżność</li>
</ul>
<p><strong>Jak interpretować te granice:</strong></p>
<ul>
<li>Około 95% wyników eksperymentalnych powinno mieścić się w tych granicach</li>
<li>Wraz ze wzrostem liczebności próby (n), granice te przewidywalnie się zwężają:
<ul>
<li>Przy n=100: granice wynoszą 0,5 ± 0,1 (między 0,4 a 0,6)</li>
<li>Przy n=1000: granice wynoszą 0,5 ± 0,032 (między 0,468 a 0,532)</li>
<li>Przy n=10000: granice wynoszą 0,5 ± 0,01 (między 0,49 a 0,51)</li>
</ul></li>
</ul>
<p><strong>Dlaczego są ważne:</strong></p>
<ul>
<li>Stanowią wizualną reprezentację tego, jak zmienność maleje wraz z liczebnością próby</li>
<li>Ilustrują matematyczny aspekt Prawa Wielkich Liczb dotyczący tempa zbieżności</li>
<li>Pomagają przewidzieć, jakiej pewności możemy oczekiwać przy różnych liczebnościach próby</li>
</ul>
</section>
</section>
<section id="appendix-j-sample-size-determination-for-proportions" class="level2" data-number="2.24">
<h2 data-number="2.24" class="anchored" data-anchor-id="appendix-j-sample-size-determination-for-proportions"><span class="header-section-number">2.24</span> Appendix J: Sample Size Determination for Proportions</h2>
<p>When conducting research involving proportions (e.g., prevalence studies, opinion polls, or quality control), determining the appropriate sample size is crucial. This chapter explains how to calculate the sample size needed to estimate a population proportion with a specified margin of error.</p>
<section id="understanding-margin-of-error" class="level3" data-number="2.24.1">
<h3 data-number="2.24.1" class="anchored" data-anchor-id="understanding-margin-of-error"><span class="header-section-number">2.24.1</span> Understanding Margin of Error</h3>
<p>The margin of error (MOE) represents the maximum difference expected between the sample proportion and the true population proportion. It is typically expressed in percentage points (p.p.). For example, a margin of error of 5 p.p. means that if the sample proportion is 60%, we can be confident that the true population proportion is between 55% and 65%.</p>
</section>
<section id="the-sample-size-formula-for-proportions" class="level3" data-number="2.24.2">
<h3 data-number="2.24.2" class="anchored" data-anchor-id="the-sample-size-formula-for-proportions"><span class="header-section-number">2.24.2</span> The Sample Size Formula for Proportions</h3>
<p>To determine the required sample size for estimating a proportion with a specified margin of error, we use the following formula:</p>
<p><span class="math display">
n = \frac{z^2 \cdot p \cdot (1-p)}{E^2}
</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">n</span> is the required sample size</li>
<li><span class="math inline">z</span> is the z-score corresponding to the desired confidence level</li>
<li><span class="math inline">p</span> is the expected proportion</li>
<li><span class="math inline">E</span> is the margin of error in decimal form (e.g., 0.05 for 5 p.p.)</li>
</ul>
</section>
<section id="derivation-of-the-sample-size-formula" class="level3" data-number="2.24.3">
<h3 data-number="2.24.3" class="anchored" data-anchor-id="derivation-of-the-sample-size-formula"><span class="header-section-number">2.24.3</span> Derivation of the Sample Size Formula</h3>
<p>The formula for calculating sample size for a proportion is derived from the properties of the sampling distribution of a proportion and the structure of confidence intervals. Let’s derive this step-by-step:</p>
<section id="understanding-the-sampling-distribution" class="level4" data-number="2.24.3.1">
<h4 data-number="2.24.3.1" class="anchored" data-anchor-id="understanding-the-sampling-distribution"><span class="header-section-number">2.24.3.1</span> 1. Understanding the Sampling Distribution</h4>
<p>When we take random samples from a population and calculate the proportion <span class="math inline">\hat{p}</span> for each sample, these sample proportions follow a sampling distribution with:</p>
<ul>
<li>Mean equal to the true population proportion <span class="math inline">p</span></li>
<li>Standard error given by <span class="math inline">\sigma_{\hat{p}} = \sqrt{\frac{p(1-p)}{n}}</span></li>
</ul>
<p>For sufficiently large samples, this sampling distribution approximates a normal distribution (by the Central Limit Theorem).</p>
</section>
<section id="constructing-a-confidence-interval" class="level4" data-number="2.24.3.2">
<h4 data-number="2.24.3.2" class="anchored" data-anchor-id="constructing-a-confidence-interval"><span class="header-section-number">2.24.3.2</span> 2. Constructing a Confidence Interval</h4>
<p>A confidence interval for a proportion takes the form:</p>
<p><span class="math inline">\hat{p} \pm z \cdot \sigma_{\hat{p}}</span></p>
<p>Where <span class="math inline">z</span> is the critical value from the standard normal distribution corresponding to our desired confidence level.</p>
<p>Substituting the standard error formula:</p>
<p><span class="math inline">\hat{p} \pm z \cdot \sqrt{\frac{p(1-p)}{n}}</span></p>
</section>
<section id="defining-the-margin-of-error" class="level4" data-number="2.24.3.3">
<h4 data-number="2.24.3.3" class="anchored" data-anchor-id="defining-the-margin-of-error"><span class="header-section-number">2.24.3.3</span> 3. Defining the Margin of Error</h4>
<p>The margin of error <span class="math inline">E</span> is the second part of this expression:</p>
<p><span class="math inline">E = z \cdot \sqrt{\frac{p(1-p)}{n}}</span></p>
</section>
<section id="solving-for-sample-size" class="level4" data-number="2.24.3.4">
<h4 data-number="2.24.3.4" class="anchored" data-anchor-id="solving-for-sample-size"><span class="header-section-number">2.24.3.4</span> 4. Solving for Sample Size</h4>
<p>To find the required sample size, we rearrange this equation to solve for <span class="math inline">n</span>:</p>
<p><span class="math display">
\begin{align}
E &amp;= z \cdot \sqrt{\frac{p(1-p)}{n}} \\
E^2 &amp;= z^2 \cdot \frac{p(1-p)}{n} \\
n \cdot E^2 &amp;= z^2 \cdot p(1-p) \\
n &amp;= \frac{z^2 \cdot p(1-p)}{E^2}
\end{align}
</span></p>
<p>This gives us our sample size formula. The formula tells us how many observations we need to estimate a population proportion with a specified margin of error at a given confidence level.</p>
</section>
<section id="assumptions-and-considerations" class="level4" data-number="2.24.3.5">
<h4 data-number="2.24.3.5" class="anchored" data-anchor-id="assumptions-and-considerations"><span class="header-section-number">2.24.3.5</span> 5. Assumptions and Considerations</h4>
<p>This derivation assumes: - Simple random sampling - The population is large relative to the sample (when this is not true, we need the finite population correction) - The sample size is large enough for the normal approximation to be valid (<span class="math inline">np \geq 5</span> and <span class="math inline">n(1-p) \geq 5</span>)</p>
<p>If these assumptions are met, the formula provides a reliable estimate of the sample size needed to achieve the desired precision.</p>
</section>
</section>
<section id="selecting-the-confidence-level" class="level3" data-number="2.24.4">
<h3 data-number="2.24.4" class="anchored" data-anchor-id="selecting-the-confidence-level"><span class="header-section-number">2.24.4</span> Selecting the Confidence Level</h3>
<p>The confidence level represents how confident we want to be that our interval contains the true population parameter. Common confidence levels include:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Confidence Level</th>
<th>Z-score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>90%</td>
<td>1.645</td>
</tr>
<tr class="even">
<td>95%</td>
<td>1.96</td>
</tr>
<tr class="odd">
<td>99%</td>
<td>2.576</td>
</tr>
</tbody>
</table>
<p>For most applications, a 95% confidence level is standard, giving us a z-score of 1.96.</p>
</section>
<section id="estimating-the-expected-proportion" class="level3" data-number="2.24.5">
<h3 data-number="2.24.5" class="anchored" data-anchor-id="estimating-the-expected-proportion"><span class="header-section-number">2.24.5</span> Estimating the Expected Proportion</h3>
<p>The expected proportion <span class="math inline">p</span> is our best guess of the population proportion before collecting data. There are several approaches to determining this value:</p>
<ol type="1">
<li><strong>Use prior studies</strong>: If similar research exists, use the proportion found in those studies.</li>
<li><strong>Conduct a pilot study</strong>: Collect data from a small initial sample to estimate the proportion.</li>
<li><strong>Use 0.5 if unknown</strong>: When no information is available, using <span class="math inline">p = 0.5</span> provides the most conservative estimate (largest sample size).</li>
</ol>
</section>
<section id="step-by-step-example-calculating-sample-size-with-5-p.p.-error" class="level3" data-number="2.24.6">
<h3 data-number="2.24.6" class="anchored" data-anchor-id="step-by-step-example-calculating-sample-size-with-5-p.p.-error"><span class="header-section-number">2.24.6</span> Step-by-Step Example: Calculating Sample Size with 5 p.p. Error</h3>
<p>Let’s work through an example to estimate the sample size needed for a survey with a 5 percentage point margin of error:</p>
<p><strong>Example</strong>: A researcher wants to estimate the proportion of adults who support a new public policy. How many people should be surveyed to estimate this proportion with a margin of error of 5 percentage points at a 95% confidence level?</p>
<p><strong>Step 1</strong>: Define the parameters. - Margin of error (<span class="math inline">E</span>) = 0.05 (5 p.p.) - Confidence level = 95%, so <span class="math inline">z = 1.96</span> - Expected proportion (<span class="math inline">p</span>) = 0.5 (conservative estimate as we don’t have prior information)</p>
<p><strong>Step 2</strong>: Apply the formula.</p>
<p><span class="math display">
\begin{align}
n &amp;= \frac{z^2 \cdot p \cdot (1-p)}{E^2} \\
&amp;= \frac{1.96^2 \cdot 0.5 \cdot (1-0.5)}{0.05^2} \\
&amp;= \frac{1.96^2 \cdot 0.5 \cdot 0.5}{0.0025} \\
&amp;= \frac{3.8416 \cdot 0.25}{0.0025} \\
&amp;= \frac{0.9604}{0.0025} \\
&amp;= 384.16
\end{align}
</span></p>
<p><strong>Step 3</strong>: Round up to the nearest whole number.</p>
<p><span class="math display">n = 385</span></p>
<p>Therefore, the researcher should survey at least 385 adults to estimate the proportion with the desired precision.</p>
</section>
<section id="sample-size-for-different-precision-levels" class="level3" data-number="2.24.7">
<h3 data-number="2.24.7" class="anchored" data-anchor-id="sample-size-for-different-precision-levels"><span class="header-section-number">2.24.7</span> Sample Size for Different Precision Levels</h3>
<p>The following table shows the required sample size for various margins of error, assuming a 95% confidence level and the most conservative estimate of <span class="math inline">p = 0.5</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Margin of Error (p.p.)</th>
<th>Required Sample Size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>9,604</td>
</tr>
<tr class="even">
<td>2</td>
<td>2,401</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1,068</td>
</tr>
<tr class="even">
<td>4</td>
<td>601</td>
</tr>
<tr class="odd">
<td>5</td>
<td>385</td>
</tr>
<tr class="even">
<td>6</td>
<td>267</td>
</tr>
<tr class="odd">
<td>7</td>
<td>196</td>
</tr>
<tr class="even">
<td>8</td>
<td>150</td>
</tr>
<tr class="odd">
<td>9</td>
<td>119</td>
</tr>
<tr class="even">
<td>10</td>
<td>97</td>
</tr>
</tbody>
</table>
</section>
<section id="adjusting-for-known-expected-proportions" class="level3" data-number="2.24.8">
<h3 data-number="2.24.8" class="anchored" data-anchor-id="adjusting-for-known-expected-proportions"><span class="header-section-number">2.24.8</span> Adjusting for Known Expected Proportions</h3>
<p>If you have a more precise estimate for the expected proportion, you can often reduce the required sample size. For example, if you expect the proportion to be around 20% (or 80%), the calculation would be:</p>
<p><span class="math display">
\begin{align}
n &amp;= \frac{1.96^2 \cdot 0.2 \cdot (1-0.2)}{0.05^2} \\
&amp;= \frac{3.8416 \cdot 0.2 \cdot 0.8}{0.0025} \\
&amp;= \frac{0.614656}{0.0025} \\
&amp;= 246
\end{align}
</span></p>
<p>This represents a substantial reduction from the 385 required when using <span class="math inline">p = 0.5</span>.</p>
</section>
<section id="adjusting-for-finite-populations" class="level3" data-number="2.24.9">
<h3 data-number="2.24.9" class="anchored" data-anchor-id="adjusting-for-finite-populations"><span class="header-section-number">2.24.9</span> Adjusting for Finite Populations</h3>
<p>The formula provided assumes an infinite or very large population. If the population is small relative to the sample size, we can apply a finite population correction:</p>
<p><span class="math display">
n_{adjusted} = \frac{n}{1 + \frac{n-1}{N}}
</span></p>
<p>Where: - <span class="math inline">n_{adjusted}</span> is the adjusted sample size - <span class="math inline">n</span> is the sample size calculated using the standard formula - <span class="math inline">N</span> is the population size</p>
<p><strong>Example</strong>: If the population of interest consists of 1,000 individuals and our calculated sample size is 385, the adjusted sample size would be:</p>
<p><span class="math display">
\begin{align}
n_{adjusted} &amp;= \frac{385}{1 + \frac{385-1}{1000}} \\
&amp;= \frac{385}{1 + \frac{384}{1000}} \\
&amp;= \frac{385}{1 + 0.384} \\
&amp;= \frac{385}{1.384} \\
&amp;= 278
\end{align}
</span></p>
</section>
<section id="practical-considerations" class="level3" data-number="2.24.10">
<h3 data-number="2.24.10" class="anchored" data-anchor-id="practical-considerations"><span class="header-section-number">2.24.10</span> Practical Considerations</h3>
<ol type="1">
<li><p><strong>Non-response adjustment</strong>: In practice, not everyone will respond to your survey. If you expect a response rate of 70%, divide your calculated sample size by 0.7 to determine how many people to contact.</p></li>
<li><p><strong>Stratified sampling</strong>: If your population has distinct subgroups that you want to analyze separately, you may need to calculate the sample size for each stratum.</p></li>
<li><p><strong>Budget constraints</strong>: If the calculated sample size exceeds your resources, consider:</p>
<ul>
<li>Accepting a larger margin of error</li>
<li>Reducing the confidence level</li>
<li>Using stratified sampling to focus on key subgroups</li>
</ul></li>
</ol>
</section>
<section id="implementing-in-r" class="level3" data-number="2.24.11">
<h3 data-number="2.24.11" class="anchored" data-anchor-id="implementing-in-r"><span class="header-section-number">2.24.11</span> Implementing in R</h3>
<p>The following R code calculates the required sample size for estimating a proportion:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate sample size for a proportion</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>proportion_sample_size <span class="ot">&lt;-</span> <span class="cf">function</span>(margin_error, <span class="at">conf_level =</span> <span class="fl">0.95</span>, <span class="at">p =</span> <span class="fl">0.5</span>, <span class="at">pop_size =</span> <span class="cn">NULL</span>) {</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert margin of error from percentage points to proportion</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  E <span class="ot">&lt;-</span> margin_error<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get z-score for the confidence level</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> conf_level)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate initial sample size</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> (z<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> p <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>p)) <span class="sc">/</span> E<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply finite population correction if population size is provided</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(pop_size)) {</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> n <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> (n<span class="dv">-1</span>)<span class="sc">/</span>pop_size)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Round up to the nearest whole number</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ceiling</span>(n))</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="fu">proportion_sample_size</span>(<span class="at">margin_error =</span> <span class="dv">5</span>, <span class="at">conf_level =</span> <span class="fl">0.95</span>)</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Required sample size:"</span>, sample_size))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Required sample size: 385"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a table of sample sizes for different margins of error</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>margins <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>sizes <span class="ot">&lt;-</span> <span class="fu">sapply</span>(margins, proportion_sample_size, <span class="at">conf_level =</span> <span class="fl">0.95</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>sample_size_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Margin of Error (p.p.)"</span> <span class="ot">=</span> margins,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Required Sample Size"</span> <span class="ot">=</span> sizes</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sample_size_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Margin.of.Error..p.p.. Required.Sample.Size
1                       1                 9604
2                       2                 2401
3                       3                 1068
4                       4                  601
5                       5                  385
6                       6                  267
7                       7                  196
8                       8                  151
9                       9                  119
10                     10                   97</code></pre>
</div>
</div>
</section>
<section id="conclusion" class="level3" data-number="2.24.12">
<h3 data-number="2.24.12" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">2.24.12</span> Conclusion</h3>
<p>Determining the appropriate sample size is a critical step in research design. By using the formulas and methods described in this chapter, you can ensure that your study has sufficient statistical power to draw meaningful conclusions about population proportions.</p>
<p>Remember that while this chapter focuses on the statistical aspects of sample size determination, practical considerations such as budget, time constraints, and feasibility are also important factors to consider in research planning.</p>
</section>
<section id="exercises" class="level3" data-number="2.24.13">
<h3 data-number="2.24.13" class="anchored" data-anchor-id="exercises"><span class="header-section-number">2.24.13</span> Exercises</h3>
<ol type="1">
<li><p>Calculate the sample size needed to estimate the proportion of voters who favor a particular candidate with a margin of error of 3 p.p. at a 99% confidence level.</p></li>
<li><p>A researcher wants to estimate the prevalence of a disease in a population of 5,000 people. If the expected prevalence is about 15% and the desired margin of error is 4 p.p. with 95% confidence, what sample size should be used?</p></li>
<li><p>How does the required sample size change if the expected proportion changes from 0.5 to 0.1? Calculate and compare the sample sizes for a 5 p.p. margin of error at 95% confidence.</p></li>
<li><p>Create a plot showing how sample size requirements change as the margin of error decreases from 10 p.p. to 1 p.p.</p></li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chapter1.html" class="pagination-link" aria-label="Introduction to Data Science and Statistics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Science and Statistics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chapter2.html" class="pagination-link" aria-label="Understanding Data Types in Social Sciences">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>