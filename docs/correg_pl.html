<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>16&nbsp; Wprowadzenie do Analizy Korelacji i Regresji – Social Data Analysis: An Introduction (Wprowadzenie do analizy danych społecznych)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./probability_en.html" rel="next">
<link href="./correg_en.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./correg_pl.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Social Data Analysis: An Introduction (Wprowadzenie do analizy danych społecznych)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Science and Statistics for Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wprowadzenie do Nauki o Danych i Statystyki dla Nauk Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Zrozumienie Typów Danych w Naukach Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">From Sample to Population - Understanding Randomness, Sampling, and Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Od Próby do Populacji - Zrozumienie Losowości, Próbkowania i Wnioskowania</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reliability and Validity in Data Science Research</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Rzetelność i Trafność w Badaniach Nauk o Danych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Research Designs: Experimental and Non-Experimental Approaches</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Projekty Badawcze: Podejścia Eksperymentalne i Nieeksperymentalne</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fundamentals of Univariate Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Podstawy Jednowymiarowej Statystyki Opisowej</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data Visualization: with examples in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Wizualizacja Danych: z przykładami w R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_pl.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction to Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Wprowadzenie do Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Introduction to Statistical Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Wprowadzenie do Wnioskowania Statystycznego</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#statystyki-dwuwymiarowe" id="toc-statystyki-dwuwymiarowe" class="nav-link active" data-scroll-target="#statystyki-dwuwymiarowe"><span class="header-section-number">16.1</span> Statystyki Dwuwymiarowe</a>
  <ul class="collapse">
  <li><a href="#kowariancja" id="toc-kowariancja" class="nav-link" data-scroll-target="#kowariancja"><span class="header-section-number">16.1.1</span> Kowariancja</a></li>
  <li><a href="#korelacja-pearsona" id="toc-korelacja-pearsona" class="nav-link" data-scroll-target="#korelacja-pearsona"><span class="header-section-number">16.1.2</span> Korelacja Pearsona</a></li>
  <li><a href="#korelacja-spearmana" id="toc-korelacja-spearmana" class="nav-link" data-scroll-target="#korelacja-spearmana"><span class="header-section-number">16.1.3</span> Korelacja Spearmana</a></li>
  <li><a href="#tabela-krzyżowa" id="toc-tabela-krzyżowa" class="nav-link" data-scroll-target="#tabela-krzyżowa"><span class="header-section-number">16.1.4</span> Tabela Krzyżowa</a></li>
  <li><a href="#wybór-odpowiedniej-miary" id="toc-wybór-odpowiedniej-miary" class="nav-link" data-scroll-target="#wybór-odpowiedniej-miary"><span class="header-section-number">16.1.5</span> Wybór Odpowiedniej Miary</a></li>
  </ul></li>
  <li><a href="#zrozumienie-korelacji-pearsona-spearmana-i-kendalla" id="toc-zrozumienie-korelacji-pearsona-spearmana-i-kendalla" class="nav-link" data-scroll-target="#zrozumienie-korelacji-pearsona-spearmana-i-kendalla"><span class="header-section-number">16.2</span> Zrozumienie Korelacji Pearsona, Spearmana i Kendalla</a>
  <ul class="collapse">
  <li><a href="#podstawy-matematyczne" id="toc-podstawy-matematyczne" class="nav-link" data-scroll-target="#podstawy-matematyczne"><span class="header-section-number">16.2.1</span> Podstawy Matematyczne</a></li>
  <li><a href="#implementacja-w-r" id="toc-implementacja-w-r" class="nav-link" data-scroll-target="#implementacja-w-r"><span class="header-section-number">16.2.2</span> Implementacja w R</a></li>
  <li><a href="#wizualizacja" id="toc-wizualizacja" class="nav-link" data-scroll-target="#wizualizacja"><span class="header-section-number">16.2.3</span> Wizualizacja</a></li>
  <li><a href="#główne-właściwości" id="toc-główne-właściwości" class="nav-link" data-scroll-target="#główne-właściwości"><span class="header-section-number">16.2.4</span> Główne Właściwości</a></li>
  <li><a href="#kiedy-stosować-poszczególne-miary" id="toc-kiedy-stosować-poszczególne-miary" class="nav-link" data-scroll-target="#kiedy-stosować-poszczególne-miary"><span class="header-section-number">16.2.5</span> Kiedy Stosować Poszczególne Miary</a></li>
  <li><a href="#przykład-analizy" id="toc-przykład-analizy" class="nav-link" data-scroll-target="#przykład-analizy"><span class="header-section-number">16.2.6</span> Przykład Analizy</a></li>
  <li><a href="#praktyczne-uwagi" id="toc-praktyczne-uwagi" class="nav-link" data-scroll-target="#praktyczne-uwagi"><span class="header-section-number">16.2.7</span> Praktyczne Uwagi</a></li>
  <li><a href="#częste-błędy" id="toc-częste-błędy" class="nav-link" data-scroll-target="#częste-błędy"><span class="header-section-number">16.2.8</span> Częste Błędy</a></li>
  </ul></li>
  <li><a href="#wprowadzenie-do-podstawowej-statystyki-wielowymiarowej" id="toc-wprowadzenie-do-podstawowej-statystyki-wielowymiarowej" class="nav-link" data-scroll-target="#wprowadzenie-do-podstawowej-statystyki-wielowymiarowej"><span class="header-section-number">16.3</span> Wprowadzenie do Podstawowej Statystyki Wielowymiarowej</a>
  <ul class="collapse">
  <li><a href="#macierz-korelacji" id="toc-macierz-korelacji" class="nav-link" data-scroll-target="#macierz-korelacji"><span class="header-section-number">16.3.1</span> Macierz Korelacji</a></li>
  <li><a href="#wizualizacja-związków-wielowymiarowych" id="toc-wizualizacja-związków-wielowymiarowych" class="nav-link" data-scroll-target="#wizualizacja-związków-wielowymiarowych"><span class="header-section-number">16.3.2</span> Wizualizacja Związków Wielowymiarowych</a></li>
  <li><a href="#korelacja-cząstkowa" id="toc-korelacja-cząstkowa" class="nav-link" data-scroll-target="#korelacja-cząstkowa"><span class="header-section-number">16.3.3</span> Korelacja Cząstkowa</a></li>
  <li><a href="#korelacja-wielokrotna" id="toc-korelacja-wielokrotna" class="nav-link" data-scroll-target="#korelacja-wielokrotna"><span class="header-section-number">16.3.4</span> Korelacja Wielokrotna</a></li>
  <li><a href="#analiza-czynnikowa" id="toc-analiza-czynnikowa" class="nav-link" data-scroll-target="#analiza-czynnikowa"><span class="header-section-number">16.3.5</span> Analiza Czynnikowa</a></li>
  <li><a href="#uwagi-dotyczące-analizy-wielowymiarowej" id="toc-uwagi-dotyczące-analizy-wielowymiarowej" class="nav-link" data-scroll-target="#uwagi-dotyczące-analizy-wielowymiarowej"><span class="header-section-number">16.3.6</span> Uwagi dotyczące Analizy Wielowymiarowej</a></li>
  <li><a href="#podsumowanie" id="toc-podsumowanie" class="nav-link" data-scroll-target="#podsumowanie"><span class="header-section-number">16.3.7</span> Podsumowanie</a></li>
  </ul></li>
  <li><a href="#dodatek-a.1-obliczanie-kowariancji-oraz-korelacji-pearsona-i-spearmana---przykład-z-obliczeniami" id="toc-dodatek-a.1-obliczanie-kowariancji-oraz-korelacji-pearsona-i-spearmana---przykład-z-obliczeniami" class="nav-link" data-scroll-target="#dodatek-a.1-obliczanie-kowariancji-oraz-korelacji-pearsona-i-spearmana---przykład-z-obliczeniami"><span class="header-section-number">16.4</span> Dodatek A.1: Obliczanie Kowariancji oraz Korelacji Pearsona i Spearmana - przykład z obliczeniami</a>
  <ul class="collapse">
  <li><a href="#krok-1-obliczanie-podstawowych-statystyk" id="toc-krok-1-obliczanie-podstawowych-statystyk" class="nav-link" data-scroll-target="#krok-1-obliczanie-podstawowych-statystyk"><span class="header-section-number">16.4.1</span> Krok 1: Obliczanie Podstawowych Statystyk</a></li>
  <li><a href="#krok-2-szczegółowe-obliczenia-kowariancji" id="toc-krok-2-szczegółowe-obliczenia-kowariancji" class="nav-link" data-scroll-target="#krok-2-szczegółowe-obliczenia-kowariancji"><span class="header-section-number">16.4.2</span> Krok 2: Szczegółowe Obliczenia Kowariancji</a></li>
  <li><a href="#krok-3-obliczanie-odchylenia-standardowego" id="toc-krok-3-obliczanie-odchylenia-standardowego" class="nav-link" data-scroll-target="#krok-3-obliczanie-odchylenia-standardowego"><span class="header-section-number">16.4.3</span> Krok 3: Obliczanie Odchylenia Standardowego</a></li>
  <li><a href="#krok-4-obliczanie-korelacji-pearsona" id="toc-krok-4-obliczanie-korelacji-pearsona" class="nav-link" data-scroll-target="#krok-4-obliczanie-korelacji-pearsona"><span class="header-section-number">16.4.4</span> Krok 4: Obliczanie Korelacji Pearsona</a></li>
  <li><a href="#krok-5-obliczanie-korelacji-rangowej-spearmana" id="toc-krok-5-obliczanie-korelacji-rangowej-spearmana" class="nav-link" data-scroll-target="#krok-5-obliczanie-korelacji-rangowej-spearmana"><span class="header-section-number">16.4.5</span> Krok 5: Obliczanie Korelacji Rangowej Spearmana</a></li>
  <li><a href="#krok-6-weryfikacja-w-r" id="toc-krok-6-weryfikacja-w-r" class="nav-link" data-scroll-target="#krok-6-weryfikacja-w-r"><span class="header-section-number">16.4.6</span> Krok 6: Weryfikacja w R</a></li>
  <li><a href="#krok-7-podstawowa-wizualizacja" id="toc-krok-7-podstawowa-wizualizacja" class="nav-link" data-scroll-target="#krok-7-podstawowa-wizualizacja"><span class="header-section-number">16.4.7</span> Krok 7: Podstawowa Wizualizacja</a></li>
  </ul></li>
  <li><a href="#dodatek-a.2-estymacja-ols-i-miary-dopasowania-modelu" id="toc-dodatek-a.2-estymacja-ols-i-miary-dopasowania-modelu" class="nav-link" data-scroll-target="#dodatek-a.2-estymacja-ols-i-miary-dopasowania-modelu"><span class="header-section-number">16.5</span> Dodatek A.2: Estymacja OLS i Miary Dopasowania Modelu</a>
  <ul class="collapse">
  <li><a href="#krok-1-obliczanie-estymatorów-ols" id="toc-krok-1-obliczanie-estymatorów-ols" class="nav-link" data-scroll-target="#krok-1-obliczanie-estymatorów-ols"><span class="header-section-number">16.5.1</span> Krok 1: Obliczanie Estymatorów OLS</a></li>
  <li><a href="#krok-2-obliczanie-wartości-dopasowanych-i-reszt" id="toc-krok-2-obliczanie-wartości-dopasowanych-i-reszt" class="nav-link" data-scroll-target="#krok-2-obliczanie-wartości-dopasowanych-i-reszt"><span class="header-section-number">16.5.2</span> Krok 2: Obliczanie Wartości Dopasowanych i Reszt</a></li>
  <li><a href="#krok-3-obliczanie-miar-dopasowania" id="toc-krok-3-obliczanie-miar-dopasowania" class="nav-link" data-scroll-target="#krok-3-obliczanie-miar-dopasowania"><span class="header-section-number">16.5.3</span> Krok 3: Obliczanie Miar Dopasowania</a></li>
  <li><a href="#krok-4-weryfikacja-w-r" id="toc-krok-4-weryfikacja-w-r" class="nav-link" data-scroll-target="#krok-4-weryfikacja-w-r"><span class="header-section-number">16.5.4</span> Krok 4: Weryfikacja w R</a></li>
  <li><a href="#krok-5-analiza-reszt" id="toc-krok-5-analiza-reszt" class="nav-link" data-scroll-target="#krok-5-analiza-reszt"><span class="header-section-number">16.5.5</span> Krok 5: Analiza Reszt</a></li>
  <li><a href="#krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych" id="toc-krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych" class="nav-link" data-scroll-target="#krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych"><span class="header-section-number">16.5.6</span> Krok 6: Wykres Wartości Przewidywanych vs Rzeczywistych</a></li>
  </ul></li>
  <li><a href="#dodatek-a.3-modele-z-transformacją-logarytmiczną" id="toc-dodatek-a.3-modele-z-transformacją-logarytmiczną" class="nav-link" data-scroll-target="#dodatek-a.3-modele-z-transformacją-logarytmiczną"><span class="header-section-number">16.6</span> Dodatek A.3: Modele z Transformacją Logarytmiczną</a>
  <ul class="collapse">
  <li><a href="#krok-1-transformacja-danych" id="toc-krok-1-transformacja-danych" class="nav-link" data-scroll-target="#krok-1-transformacja-danych"><span class="header-section-number">16.6.1</span> Krok 1: Transformacja Danych</a></li>
  <li><a href="#krok-2-porównanie-różnych-specyfikacji-modelu" id="toc-krok-2-porównanie-różnych-specyfikacji-modelu" class="nav-link" data-scroll-target="#krok-2-porównanie-różnych-specyfikacji-modelu"><span class="header-section-number">16.6.2</span> Krok 2: Porównanie Różnych Specyfikacji Modelu</a></li>
  <li><a href="#krok-3-porównanie-wizualne" id="toc-krok-3-porównanie-wizualne" class="nav-link" data-scroll-target="#krok-3-porównanie-wizualne"><span class="header-section-number">16.6.3</span> Krok 3: Porównanie Wizualne</a></li>
  <li><a href="#krok-4-analiza-reszt-dla-najlepszego-modelu" id="toc-krok-4-analiza-reszt-dla-najlepszego-modelu" class="nav-link" data-scroll-target="#krok-4-analiza-reszt-dla-najlepszego-modelu"><span class="header-section-number">16.6.4</span> Krok 4: Analiza Reszt dla Najlepszego Modelu</a></li>
  <li><a href="#krok-5-interpretacja-najlepszego-modelu" id="toc-krok-5-interpretacja-najlepszego-modelu" class="nav-link" data-scroll-target="#krok-5-interpretacja-najlepszego-modelu"><span class="header-section-number">16.6.5</span> Krok 5: Interpretacja Najlepszego Modelu</a></li>
  <li><a href="#krok-6-predykcje-modelu" id="toc-krok-6-predykcje-modelu" class="nav-link" data-scroll-target="#krok-6-predykcje-modelu"><span class="header-section-number">16.6.6</span> Krok 6: Predykcje Modelu</a></li>
  <li><a href="#krok-7-analiza-elastyczności" id="toc-krok-7-analiza-elastyczności" class="nav-link" data-scroll-target="#krok-7-analiza-elastyczności"><span class="header-section-number">16.6.7</span> Krok 7: Analiza Elastyczności</a></li>
  </ul></li>
  <li><a href="#dodatek-a.4-porównanie-popularnych-miar-korelacji-pearson-spearman-i-kendall" id="toc-dodatek-a.4-porównanie-popularnych-miar-korelacji-pearson-spearman-i-kendall" class="nav-link" data-scroll-target="#dodatek-a.4-porównanie-popularnych-miar-korelacji-pearson-spearman-i-kendall"><span class="header-section-number">16.7</span> Dodatek A.4: Porównanie Popularnych Miar Korelacji: Pearson, Spearman i Kendall</a>
  <ul class="collapse">
  <li><a href="#zbiór-danych" id="toc-zbiór-danych" class="nav-link" data-scroll-target="#zbiór-danych"><span class="header-section-number">16.7.1</span> Zbiór Danych</a></li>
  <li><a href="#korelacja-pearsona-1" id="toc-korelacja-pearsona-1" class="nav-link" data-scroll-target="#korelacja-pearsona-1"><span class="header-section-number">16.7.2</span> Korelacja Pearsona</a></li>
  <li><a href="#korelacja-spearmana-1" id="toc-korelacja-spearmana-1" class="nav-link" data-scroll-target="#korelacja-spearmana-1"><span class="header-section-number">16.7.3</span> Korelacja Spearmana</a></li>
  <li><a href="#tau-kendalla" id="toc-tau-kendalla" class="nav-link" data-scroll-target="#tau-kendalla"><span class="header-section-number">16.7.4</span> Tau Kendalla</a></li>
  <li><a href="#weryfikacja-w-r" id="toc-weryfikacja-w-r" class="nav-link" data-scroll-target="#weryfikacja-w-r"><span class="header-section-number">16.7.5</span> Weryfikacja w R</a></li>
  <li><a href="#interpretacja-wyników" id="toc-interpretacja-wyników" class="nav-link" data-scroll-target="#interpretacja-wyników"><span class="header-section-number">16.7.6</span> Interpretacja Wyników</a></li>
  <li><a href="#porównanie-miar" id="toc-porównanie-miar" class="nav-link" data-scroll-target="#porównanie-miar"><span class="header-section-number">16.7.7</span> Porównanie Miar</a></li>
  </ul></li>
  <li><a href="#appendix-b." id="toc-appendix-b." class="nav-link" data-scroll-target="#appendix-b."><span class="header-section-number">16.8</span> Appendix B.</a></li>
  <li><a href="#appendix-c.-przykłady-różne" id="toc-appendix-c.-przykłady-różne" class="nav-link" data-scroll-target="#appendix-c.-przykłady-różne"><span class="header-section-number">16.9</span> Appendix C. Przykłady różne</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="statystyki-dwuwymiarowe" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="statystyki-dwuwymiarowe"><span class="header-section-number">16.1</span> Statystyki Dwuwymiarowe</h2>
<p>Statystyki dwuwymiarowe opisują związek między dwiema zmiennymi. Omówimy kilka miar, zaczynając od kowariancji i przechodząc do bardziej zaawansowanych miar korelacji.</p>
<section id="kowariancja" class="level3" data-number="16.1.1">
<h3 data-number="16.1.1" class="anchored" data-anchor-id="kowariancja"><span class="header-section-number">16.1.1</span> Kowariancja</h3>
<p>Kowariancja mierzy, jak dwie zmienne zmieniają się razem.</p>
<p><strong>Wzór:</strong> <span class="math inline">\(cov(X,Y) = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{n - 1}\)</span></p>
<p><strong>Przykład Ręcznego Obliczenia:</strong></p>
<p>Obliczmy kowariancję dla dwóch zmiennych:</p>
<ul>
<li>x: 1, 2, 3, 4, 5</li>
<li>y: 2, 4, 5, 4, 5</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Krok</th>
<th>Opis</th>
<th>Obliczenie</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Oblicz średnie</td>
<td><span class="math inline">\(\bar{x} = 3, \bar{y} = 4\)</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>Oblicz <span class="math inline">\((x_i - \bar{x})(y_i - \bar{y})\)</span> dla każdej pary</td>
<td><span class="math inline">\((-2)(-2) = 4\)</span></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td><span class="math inline">\((-1)(0) = 0\)</span></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td><span class="math inline">\((0)(1) = 0\)</span></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td><span class="math inline">\((1)(0) = 0\)</span></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td><span class="math inline">\((2)(1) = 2\)</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Zsumuj wyniki</td>
<td><span class="math inline">\(4 + 0 + 0 + 0 + 2 = 6\)</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>Podziel przez (n-1)</td>
<td><span class="math inline">\(6 / 4 = 1,5\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Obliczenie w R:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.5</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong> - Dodatnia kowariancja (1,5) wskazuje, że x i y mają tendencję do wzrostu razem.</p>
<p><strong>Zalety:</strong></p>
<ul>
<li>Dostarcza informacji o kierunku związku (dodatni lub ujemny)</li>
<li>Przydatna w obliczaniu innych miar, takich jak korelacja</li>
</ul>
<p><strong>Wady:</strong></p>
<ul>
<li>Zależna od skali, co utrudnia porównywanie między różnymi parami zmiennych</li>
<li>Nie dostarcza informacji o sile związku</li>
</ul>
</section>
<section id="korelacja-pearsona" class="level3" data-number="16.1.2">
<h3 data-number="16.1.2" class="anchored" data-anchor-id="korelacja-pearsona"><span class="header-section-number">16.1.2</span> Korelacja Pearsona</h3>
<p>Korelacja Pearsona mierzy siłę i kierunek liniowego związku między dwiema zmiennymi ciągłymi.</p>
<p><strong>Wzór:</strong> <span class="math inline">\(r = \frac{cov(X,Y)}{s_X s_Y} = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum (x_i - \bar{x})^2 \sum (y_i - \bar{y})^2}}\)</span></p>
<p><strong>Przykład Ręcznego Obliczenia:</strong></p>
<p>Używając tych samych danych co wyżej:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Krok</th>
<th>Opis</th>
<th>Obliczenie</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Oblicz kowariancję</td>
<td>(Z poprzedniego obliczenia) 1,5</td>
</tr>
<tr class="even">
<td>2</td>
<td>Oblicz odchylenia standardowe</td>
<td><span class="math inline">\(s_X = \sqrt{\frac{10}{4}} = 1,58, s_Y = \sqrt{\frac{6}{4}} = 1,22\)</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Podziel kowariancję przez iloczyn odchyleń standardowych</td>
<td><span class="math inline">\(1,5 / (1,58 * 1,22) = 0,7746\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Obliczenie w R:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7745967</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong> - Współczynnik korelacji 0,7746 wskazuje na silny dodatni związek liniowy między x i y.</p>
<p><strong>Zalety:</strong></p>
<ul>
<li>Niezależna od skali, zawsze między -1 a 1</li>
<li>Szeroko rozumiana i stosowana</li>
<li>Testuje związki liniowe</li>
</ul>
<p><strong>Wady:</strong></p>
<ul>
<li>Wrażliwa na wartości odstające</li>
<li>Mierzy tylko związki liniowe</li>
<li>Zakłada normalnie rozłożone zmienne</li>
</ul>
</section>
<section id="korelacja-spearmana" class="level3" data-number="16.1.3">
<h3 data-number="16.1.3" class="anchored" data-anchor-id="korelacja-spearmana"><span class="header-section-number">16.1.3</span> Korelacja Spearmana</h3>
<p>Korelacja Spearmana mierzy siłę i kierunek monotonicznego związku między dwiema zmiennymi, które mogą być ciągłe lub porządkowe.</p>
<p><strong>Wzór:</strong> <span class="math inline">\(\rho = 1 - \frac{6 \sum d_i^2}{n(n^2 - 1)}\)</span>, gdzie <span class="math inline">\(d_i\)</span> to różnica między rangami.</p>
<p><strong>Przykład Ręcznego Obliczenia:</strong></p>
<p>Użyjmy nieco innych danych:</p>
<ul>
<li>x: 1, 2, 3, 4, 5</li>
<li>y: 1, 3, 2, 5, 4</li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Krok</th>
<th>Opis</th>
<th>Obliczenie</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Przypisz rangi obu zmiennym</td>
<td>x_ranga: 1, 2, 3, 4, 5</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>y_ranga: 1, 3, 2, 5, 4</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Oblicz różnice w rangach (d)</td>
<td>0, -1, 1, -1, 1</td>
</tr>
<tr class="even">
<td>3</td>
<td>Podnieś różnice do kwadratu</td>
<td>0, 1, 1, 1, 1</td>
</tr>
<tr class="odd">
<td>4</td>
<td>Zsumuj kwadraty różnic</td>
<td><span class="math inline">\(\sum d_i^2 = 4\)</span></td>
</tr>
<tr class="even">
<td>5</td>
<td>Zastosuj wzór</td>
<td><span class="math inline">\(\rho = 1 - \frac{6(4)}{5(5^2 - 1)} = 0,8\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Obliczenie w R:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong> - Korelacja Spearmana 0,8 wskazuje na silny dodatni związek monotoniczny między x i y.</p>
<p><strong>Zalety:</strong></p>
<ul>
<li>Odporna na wartości odstające</li>
<li>Może wykrywać nieliniowe związki monotoniczne</li>
<li>Odpowiednia dla danych porządkowych</li>
</ul>
<p><strong>Wady:</strong></p>
<ul>
<li>Mniej odporna niż korelacja Pearsona do wykrywania związków liniowych w normalnie rozłożonych danych</li>
<li>Nie dostarcza informacji o kształcie związku poza monotonicznością</li>
</ul>
</section>
<section id="tabela-krzyżowa" class="level3" data-number="16.1.4">
<h3 data-number="16.1.4" class="anchored" data-anchor-id="tabela-krzyżowa"><span class="header-section-number">16.1.4</span> Tabela Krzyżowa</h3>
<p>Tabela krzyżowa (tabela kontyngencji) pokazuje związek między dwiema zmiennymi kategorycznymi.</p>
<p><strong>Przykład:</strong></p>
<p>Stwórzmy tabelę krzyżową dla dwóch zmiennych: - Poziom wykształcenia: Średnie, Wyższe, Podyplomowe - Status zatrudnienia: Zatrudniony, Bezrobotny</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>wyksztalcenie <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Średnie"</span>, <span class="st">"Wyższe"</span>, <span class="st">"Podyplomowe"</span>, <span class="st">"Średnie"</span>, <span class="st">"Wyższe"</span>, <span class="st">"Podyplomowe"</span>, <span class="st">"Średnie"</span>, <span class="st">"Wyższe"</span>, <span class="st">"Podyplomowe"</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>zatrudnienie <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Zatrudniony"</span>, <span class="st">"Zatrudniony"</span>, <span class="st">"Zatrudniony"</span>, <span class="st">"Bezrobotny"</span>, <span class="st">"Zatrudniony"</span>, <span class="st">"Zatrudniony"</span>, <span class="st">"Bezrobotny"</span>, <span class="st">"Bezrobotny"</span>, <span class="st">"Zatrudniony"</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wyksztalcenie, zatrudnienie)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             zatrudnienie
wyksztalcenie Bezrobotny Zatrudniony
  Podyplomowe          0           3
  Średnie              2           1
  Wyższe               1           2</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li>Ta tabela pokazuje liczbę osób w każdej kombinacji poziomu wykształcenia i statusu zatrudnienia.</li>
<li>Na przykład, możemy zobaczyć, ilu absolwentów szkół średnich jest zatrudnionych, a ilu bezrobotnych.</li>
</ul>
<p><strong>Zalety:</strong></p>
<ul>
<li>Zapewnia jasną wizualną reprezentację związku między zmiennymi kategorycznymi</li>
<li>Łatwa do zrozumienia i interpretacji</li>
<li>Podstawa dla wielu testów statystycznych (np. test chi-kwadrat niezależności)</li>
</ul>
<p><strong>Wady:</strong></p>
<ul>
<li>Ograniczona do danych kategorycznych</li>
<li>Może stać się nieporęczna przy wielu kategoriach</li>
<li>Nie dostarcza pojedynczej statystyki podsumowującej siłę związku</li>
</ul>
</section>
<section id="wybór-odpowiedniej-miary" class="level3" data-number="16.1.5">
<h3 data-number="16.1.5" class="anchored" data-anchor-id="wybór-odpowiedniej-miary"><span class="header-section-number">16.1.5</span> Wybór Odpowiedniej Miary</h3>
<p>Przy wyborze statystyki dwuwymiarowej należy wziąć pod uwagę:</p>
<ol type="1">
<li><p>Typ danych:</p>
<ul>
<li>Dane ciągłe: Kowariancja, korelacja Pearsona</li>
<li>Dane porządkowe: Korelacja Spearmana</li>
<li>Dane kategoryczne: Tabela krzyżowa</li>
</ul></li>
<li><p>Typ związku:</p>
<ul>
<li>Liniowy: Korelacja Pearsona</li>
<li>Monotoniczny, ale potencjalnie nieliniowy: Korelacja Spearmana</li>
</ul></li>
<li><p>Obecność wartości odstających:</p>
<ul>
<li>Jeśli wartości odstające są problemem, korelacja Spearmana jest bardziej odporna</li>
</ul></li>
<li><p>Rozkład:</p>
<ul>
<li>Dla normalnie rozłożonych danych korelacja Pearsona jest najbardziej odporna (robust)</li>
<li>Dla rozkładów “nienormalnych” rozważ korelację Spearmana</li>
</ul></li>
<li><p>Wielkość próby:</p>
<ul>
<li>Dla bardzo małych prób metody nieparametryczne, takie jak korelacja Spearmana, mogą być preferowane</li>
</ul></li>
</ol>
<p>Pamiętaj, że często wartościowe jest użycie wielu miar i wizualizacji (takich jak wykresy rozrzutu), aby uzyskać kompleksowe zrozumienie związku między zmiennymi.</p>
</section>
</section>
<section id="zrozumienie-korelacji-pearsona-spearmana-i-kendalla" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="zrozumienie-korelacji-pearsona-spearmana-i-kendalla"><span class="header-section-number">16.2</span> Zrozumienie Korelacji Pearsona, Spearmana i Kendalla</h2>
<p>Miary korelacji określają siłę i kierunek zależności między zmiennymi. Omówimy trzy kluczowe współczynniki korelacji:</p>
<ul>
<li>Współczynnik korelacji liniowej Pearsona (r)</li>
<li>Współczynnik korelacji rangowej Spearmana (ρ)</li>
<li>Współczynnik korelacji τ Kendalla (τ)</li>
</ul>
<section id="podstawy-matematyczne" class="level3" data-number="16.2.1">
<h3 data-number="16.2.1" class="anchored" data-anchor-id="podstawy-matematyczne"><span class="header-section-number">16.2.1</span> Podstawy Matematyczne</h3>
<section id="współczynnik-korelacji-pearsona" class="level4" data-number="16.2.1.1">
<h4 data-number="16.2.1.1" class="anchored" data-anchor-id="współczynnik-korelacji-pearsona"><span class="header-section-number">16.2.1.1</span> Współczynnik Korelacji Pearsona</h4>
<p>Współczynnik korelacji Pearsona mierzy zależność liniową między dwiema zmiennymi ciągłymi.</p>
<p><span class="math display">\[ r = \frac{\sum_{i=1}^{n} (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum_{i=1}^{n} (x_i - \bar{x})^2 \sum_{i=1}^{n} (y_i - \bar{y})^2}} \]</span></p>
<p>gdzie:</p>
<ul>
<li><span class="math inline">\(x_i, y_i\)</span> to poszczególne obserwacje</li>
<li><span class="math inline">\(\bar{x}, \bar{y}\)</span> to średnie arytmetyczne</li>
<li><span class="math inline">\(n\)</span> to liczebność próby</li>
</ul>
</section>
<section id="korelacja-rangowa-spearmana" class="level4" data-number="16.2.1.2">
<h4 data-number="16.2.1.2" class="anchored" data-anchor-id="korelacja-rangowa-spearmana"><span class="header-section-number">16.2.1.2</span> Korelacja Rangowa Spearmana</h4>
<p>Współczynnik ρ Spearmana ocenia zależności monotoniczne wykorzystując rangi.</p>
<p><span class="math display">\[ \rho = 1 - \frac{6\sum d_i^2}{n(n^2-1)} \]</span></p>
<p>gdzie:</p>
<ul>
<li><span class="math inline">\(d_i\)</span> to różnica między rangami dla i-tej obserwacji</li>
<li><span class="math inline">\(n\)</span> to liczebność próby</li>
</ul>
</section>
<section id="współczynnik-τ-kendalla" class="level4" data-number="16.2.1.3">
<h4 data-number="16.2.1.3" class="anchored" data-anchor-id="współczynnik-τ-kendalla"><span class="header-section-number">16.2.1.3</span> Współczynnik τ Kendalla</h4>
<p>Tau Kendalla mierzy związek porządkowy na podstawie par zgodnych i niezgodnych.</p>
<p><span class="math display">\[ \tau = \frac{2(P - Q)}{n(n-1)} \]</span></p>
<p>gdzie:</p>
<ul>
<li>P to liczba par zgodnych</li>
<li>Q to liczba par niezgodnych</li>
<li>n to liczebność próby</li>
</ul>
</section>
</section>
<section id="implementacja-w-r" class="level3" data-number="16.2.2">
<h3 data-number="16.2.2" class="anchored" data-anchor-id="implementacja-w-r"><span class="header-section-number">16.2.2</span> Implementacja w R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Przykładowe dane</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">8</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">7</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczanie korelacji</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>korelacja_pearson <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>korelacja_spearman <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>korelacja_kendall <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"kendall"</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Wyświetlenie wyników</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Korelacja Pearsona:"</span>, <span class="fu">round</span>(korelacja_pearson, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Korelacja Pearsona: 0.917 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Korelacja Spearmana:"</span>, <span class="fu">round</span>(korelacja_spearman, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Korelacja Spearmana: 0.821 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Korelacja Kendalla:"</span>, <span class="fu">round</span>(korelacja_kendall, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Korelacja Kendalla: 0.738 </code></pre>
</div>
</div>
</section>
<section id="wizualizacja" class="level3" data-number="16.2.3">
<h3 data-number="16.2.3" class="anchored" data-anchor-id="wizualizacja"><span class="header-section-number">16.2.3</span> Wizualizacja</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Przykład Korelacji"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Korelacja Pearsona r ="</span>, <span class="fu">round</span>(korelacja_pearson, <span class="dv">3</span>)),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Zmienna X"</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Zmienna Y"</span>) <span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="główne-właściwości" class="level3" data-number="16.2.4">
<h3 data-number="16.2.4" class="anchored" data-anchor-id="główne-właściwości"><span class="header-section-number">16.2.4</span> Główne Właściwości</h3>
<section id="korelacja-pearsona-r" class="level4" data-number="16.2.4.1">
<h4 data-number="16.2.4.1" class="anchored" data-anchor-id="korelacja-pearsona-r"><span class="header-section-number">16.2.4.1</span> Korelacja Pearsona (r)</h4>
<ol type="1">
<li><p>Zakres: [-1, 1]</p></li>
<li><p>Właściwości:</p>
<ul>
<li>r = 1: Idealna dodatnia zależność liniowa</li>
<li>r = -1: Idealna ujemna zależność liniowa</li>
<li>r = 0: Brak zależności liniowej</li>
</ul></li>
</ol>
</section>
<section id="korelacja-spearmana-ρ" class="level4" data-number="16.2.4.2">
<h4 data-number="16.2.4.2" class="anchored" data-anchor-id="korelacja-spearmana-ρ"><span class="header-section-number">16.2.4.2</span> Korelacja Spearmana (ρ)</h4>
<ol type="1">
<li><p>Zakres: [-1, 1]</p></li>
<li><p>Właściwości:</p>
<ul>
<li>Oparta na rangach, nie na wartościach surowych</li>
<li>Odporna na wartości odstające</li>
<li>Wykrywa zależności monotoniczne</li>
</ul></li>
</ol>
</section>
<section id="korelacja-kendalla-τ" class="level4" data-number="16.2.4.3">
<h4 data-number="16.2.4.3" class="anchored" data-anchor-id="korelacja-kendalla-τ"><span class="header-section-number">16.2.4.3</span> Korelacja Kendalla (τ)</h4>
<ol type="1">
<li><p>Zakres: [-1, 1]</p></li>
<li><p>Właściwości:</p>
<ul>
<li>Oparta na parach zgodnych/niezgodnych</li>
<li>Bardziej odporna niż Spearman</li>
<li>Preferowana dla małych prób</li>
</ul></li>
</ol>
</section>
</section>
<section id="kiedy-stosować-poszczególne-miary" class="level3" data-number="16.2.5">
<h3 data-number="16.2.5" class="anchored" data-anchor-id="kiedy-stosować-poszczególne-miary"><span class="header-section-number">16.2.5</span> Kiedy Stosować Poszczególne Miary</h3>
<ol type="1">
<li><p><strong>Stosuj Pearsona gdy:</strong></p>
<ul>
<li>Zależność wydaje się liniowa</li>
<li>Dane są ciągłe</li>
<li>Zakładamy rozkład normalny</li>
<li>Brak znaczących wartości odstających</li>
</ul></li>
<li><p><strong>Stosuj Spearmana gdy:</strong></p>
<ul>
<li>Zależność jest monotonniczna, ale nieliniowa</li>
<li>Dane są porządkowe</li>
<li>Występują wartości odstające</li>
<li>Rozkład nie jest normalny</li>
</ul></li>
<li><p><strong>Stosuj Kendalla gdy:</strong></p>
<ul>
<li>Mała liczebność próby</li>
<li>Wiele rang wiązanych</li>
<li>Potrzebna najbardziej odporna miara</li>
<li>Dane porządkowe z małą liczbą kategorii</li>
</ul></li>
</ol>
</section>
<section id="przykład-analizy" class="level3" data-number="16.2.6">
<h3 data-number="16.2.6" class="anchored" data-anchor-id="przykład-analizy"><span class="header-section-number">16.2.6</span> Przykład Analizy</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generowanie nieliniowej zależności</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">20</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> x2<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>dane2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x2, <span class="at">y =</span> y2)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczanie korelacji</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>wyniki_korelacji <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metoda =</span> <span class="fu">c</span>(<span class="st">"Pearson"</span>, <span class="st">"Spearman"</span>, <span class="st">"Kendall"</span>),</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Korelacja =</span> <span class="fu">c</span>(</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor</span>(x2, y2, <span class="at">method =</span> <span class="st">"pearson"</span>),</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor</span>(x2, y2, <span class="at">method =</span> <span class="st">"spearman"</span>),</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor</span>(x2, y2, <span class="at">method =</span> <span class="st">"kendall"</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(wyniki_korelacji)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Metoda Korelacja
1  Pearson 0.9699718
2 Spearman 0.9849624
3  Kendall 0.9368421</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wizualizacja</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane2, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Przykład Zależności Nieliniowej"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Porównanie różnych miar korelacji"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Zmienna X"</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Zmienna Y"</span>) <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="praktyczne-uwagi" class="level3" data-number="16.2.7">
<h3 data-number="16.2.7" class="anchored" data-anchor-id="praktyczne-uwagi"><span class="header-section-number">16.2.7</span> Praktyczne Uwagi</h3>
<ol type="1">
<li><strong>Liczebność Próby</strong>
<ul>
<li>Małe próby (n &lt; 10): Zalecany τ Kendalla</li>
<li>Większe próby: Wszystkie metody odpowiednie</li>
</ul></li>
<li><strong>Wartości Odstające</strong>
<ul>
<li>Obecne: Preferuj Spearmana lub Kendalla</li>
<li>Brak: Pearson może być bardziej efektywny</li>
</ul></li>
<li><strong>Typ Zależności</strong>
<ul>
<li>Liniowa: Optymalny Pearson</li>
<li>Monotonniczna: Spearman lub Kendall</li>
<li>Złożona: Rozważ inne metody</li>
</ul></li>
</ol>
</section>
<section id="częste-błędy" class="level3" data-number="16.2.8">
<h3 data-number="16.2.8" class="anchored" data-anchor-id="częste-błędy"><span class="header-section-number">16.2.8</span> Częste Błędy</h3>
<ol type="1">
<li><strong>Błędna Interpretacja</strong>
<ul>
<li>Korelacja ≠ przyczynowość</li>
<li>Wysoka korelacja nie oznacza dobrego dopasowania</li>
<li>Niska korelacja nie oznacza braku zależności</li>
</ul></li>
<li><strong>Problemy Techniczne</strong>
<ul>
<li>Obsługa brakujących wartości</li>
<li>Rangi wiązane w Spearman/Kendall</li>
<li>Wrażliwość na skalę pomiaru</li>
</ul></li>
</ol>
</section>
</section>
<section id="wprowadzenie-do-podstawowej-statystyki-wielowymiarowej" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="wprowadzenie-do-podstawowej-statystyki-wielowymiarowej"><span class="header-section-number">16.3</span> Wprowadzenie do Podstawowej Statystyki Wielowymiarowej</h2>
<p>Statystyki wielowymiarowe obejmują analizę związków między trzema lub więcej zmiennymi jednocześnie. Ta sekcja wprowadzi niektóre podstawowe koncepcje i techniki analizy wielowymiarowej, koncentrując się na metodach opartych na korelacji.</p>
<section id="macierz-korelacji" class="level3" data-number="16.3.1">
<h3 data-number="16.3.1" class="anchored" data-anchor-id="macierz-korelacji"><span class="header-section-number">16.3.1</span> Macierz Korelacji</h3>
<p>Macierz korelacji to tabela pokazująca korelacje parami dla kilku zmiennych. Jest to podstawowe narzędzie w analizie wielowymiarowej.</p>
<p><strong>Przykład:</strong> Stwórzmy macierz korelacji dla czterech zmiennych: wzrost, waga, wiek i dochód.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># Dla powtarzalności</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>wzrost <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">170</span>, <span class="dv">10</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>waga <span class="ot">&lt;-</span> wzrost <span class="sc">*</span> <span class="fl">0.5</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>wiek <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">40</span>, <span class="dv">10</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>dochod <span class="ot">&lt;-</span> wiek <span class="sc">*</span> <span class="dv">1000</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">10000</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(wzrost, waga, wiek, dochod)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>macierz_kor <span class="ot">&lt;-</span> <span class="fu">cor</span>(dane)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(macierz_kor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           wzrost        waga        wiek      dochod
wzrost  1.0000000  0.66712996 -0.12917601 -0.12246786
waga    0.6671300  1.00000000 -0.06814187 -0.04579492
wiek   -0.1291760 -0.06814187  1.00000000  0.65654902
dochod -0.1224679 -0.04579492  0.65654902  1.00000000</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong> - Każda komórka pokazuje korelację między dwiema zmiennymi. - Przekątna zawsze wynosi 1 (korelacja zmiennej z samą sobą). - Szukaj silnych korelacji (bliskich 1 lub -1), aby zidentyfikować potencjalne związki.</p>
</section>
<section id="wizualizacja-związków-wielowymiarowych" class="level3" data-number="16.3.2">
<h3 data-number="16.3.2" class="anchored" data-anchor-id="wizualizacja-związków-wielowymiarowych"><span class="header-section-number">16.3.2</span> Wizualizacja Związków Wielowymiarowych</h3>
<section id="macierz-wykresów-rozrzutu" class="level4" data-number="16.3.2.1">
<h4 data-number="16.3.2.1" class="anchored" data-anchor-id="macierz-wykresów-rozrzutu"><span class="header-section-number">16.3.2.1</span> Macierz Wykresów Rozrzutu</h4>
<p>Macierz wykresów rozrzutu pokazuje parami związki między wieloma zmiennymi.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(dane)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li>Każdy wykres pokazuje związek między dwiema zmiennymi.</li>
<li>Elementy na przekątnej pokazują rozkład każdej zmiennej.</li>
<li>Szukaj wzorców, skupisk lub trendów na wykresach.</li>
</ul>
</section>
<section id="wykres-korelacji" class="level4" data-number="16.3.2.2">
<h4 data-number="16.3.2.2" class="anchored" data-anchor-id="wykres-korelacji"><span class="header-section-number">16.3.2.2</span> Wykres Korelacji</h4>
<p>Wykres korelacji zapewnia wizualną reprezentację macierzy korelacji.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.94 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(macierz_kor, <span class="at">method =</span> <span class="st">"color"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li>Intensywność koloru i rozmiar kół wskazują na siłę korelacji.</li>
<li>Niebieskie kolory zazwyczaj wskazują na dodatnie korelacje, czerwone na ujemne.</li>
</ul>
</section>
</section>
<section id="korelacja-cząstkowa" class="level3" data-number="16.3.3">
<h3 data-number="16.3.3" class="anchored" data-anchor-id="korelacja-cząstkowa"><span class="header-section-number">16.3.3</span> Korelacja Cząstkowa</h3>
<p>Korelacja cząstkowa mierzy związek między dwiema zmiennymi przy kontrolowaniu jednej lub więcej innych zmiennych.</p>
<p><strong>Przykład:</strong> Obliczmy korelację cząstkową między wzrostem a wagą, kontrolując wiek.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ppcor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MASS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pcor.test</span>(dane<span class="sc">$</span>wzrost, dane<span class="sc">$</span>waga, dane<span class="sc">$</span>wiek)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   estimate      p.value statistic   n gp  Method
1 0.6654367 5.758157e-14  8.779896 100  1 pearson</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li>Porównaj to z prostą korelacją między wzrostem a wagą.</li>
<li>Znacząca zmiana może wskazywać, że wiek odgrywa rolę w związku między wzrostem a wagą.</li>
</ul>
</section>
<section id="korelacja-wielokrotna" class="level3" data-number="16.3.4">
<h3 data-number="16.3.4" class="anchored" data-anchor-id="korelacja-wielokrotna"><span class="header-section-number">16.3.4</span> Korelacja Wielokrotna</h3>
<p>Korelacja wielokrotna mierzy siłę związku między zmienną zależną a wieloma zmiennymi niezależnymi.</p>
<p><strong>Przykład:</strong> Przewidźmy wagę na podstawie wzrostu i wieku.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(waga <span class="sc">~</span> wzrost <span class="sc">+</span> wiek, <span class="at">data =</span> dane)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Współczynnik korelacji wielokrotnej:"</span>, R))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Współczynnik korelacji wielokrotnej: 0.667377840470434"</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li>R waha się od 0 do 1, przy czym wyższe wartości wskazują na silniejsze związki.</li>
<li>R² (R-kwadrat) reprezentuje proporcję wariancji w zmiennej zależnej wyjaśnioną przez zmienne niezależne.</li>
</ul>
</section>
<section id="analiza-czynnikowa" class="level3" data-number="16.3.5">
<h3 data-number="16.3.5" class="anchored" data-anchor-id="analiza-czynnikowa"><span class="header-section-number">16.3.5</span> Analiza Czynnikowa</h3>
<p>Analiza czynnikowa to technika używana do zredukowania wielu zmiennych do mniejszej liczby czynników leżących u podstaw.</p>
<p><strong>Przykład:</strong> Wykonajmy prostą analizę czynnikową na naszym zbiorze danych.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'psych'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ggplot2':

    %+%, alpha</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>wynik_fa <span class="ot">&lt;-</span> <span class="fu">fa</span>(dane, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(wynik_fa<span class="sc">$</span>loadings, <span class="at">cutoff =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
       MR2    MR1   
wzrost  0.798       
waga    0.836       
wiek           0.729
dochod         0.895

                 MR2   MR1
SS loadings    1.344 1.341
Proportion Var 0.336 0.335
Cumulative Var 0.336 0.671</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li>Spójrz, które zmienne ładują się wysoko na każdy czynnik.</li>
<li>Spróbuj zinterpretować, co każdy czynnik może reprezentować na podstawie zmiennych, które się na niego ładują.</li>
</ul>
</section>
<section id="uwagi-dotyczące-analizy-wielowymiarowej" class="level3" data-number="16.3.6">
<h3 data-number="16.3.6" class="anchored" data-anchor-id="uwagi-dotyczące-analizy-wielowymiarowej"><span class="header-section-number">16.3.6</span> Uwagi dotyczące Analizy Wielowymiarowej</h3>
<ol type="1">
<li><p><strong>Wielkość próby</strong>: Techniki wielowymiarowe często wymagają większych prób dla stabilnych wyników.</p></li>
<li><p><strong>Współliniowość</strong>: Wysokie korelacje między zmiennymi niezależnymi mogą powodować problemy w niektórych analizach.</p></li>
<li><p><strong>Wartości odstające</strong>: Wielowymiarowe wartości odstające mogą mieć silny wpływ na wyniki.</p></li>
<li><p><strong>Założenia</strong>: Wiele technik zakłada wielowymiarową normalność i liniowe związki.</p></li>
<li><p><strong>Złożoność interpretacji</strong>: Wraz ze wzrostem liczby zmiennych interpretacja może stać się bardziej wyzwająca.</p></li>
</ol>
</section>
<section id="podsumowanie" class="level3" data-number="16.3.7">
<h3 data-number="16.3.7" class="anchored" data-anchor-id="podsumowanie"><span class="header-section-number">16.3.7</span> Podsumowanie</h3>
<p>To wprowadzenie do statystyki wielowymiarowej opiera się na koncepcji korelacji, aby badać związki między wieloma zmiennymi. Techniki te zapewniają potężne narzędzia do zrozumienia złożonych zbiorów danych, ale wymagają również starannego rozważenia założeń i ograniczeń. W miarę postępu w Twojej podróży statystycznej napotkasz bardziej zaawansowane techniki wielowymiarowe, takie jak MANOVA, analiza dyskryminacyjna i modelowanie równań strukturalnych.</p>
</section>
</section>
<section id="dodatek-a.1-obliczanie-kowariancji-oraz-korelacji-pearsona-i-spearmana---przykład-z-obliczeniami" class="level2" data-number="16.4">
<h2 data-number="16.4" class="anchored" data-anchor-id="dodatek-a.1-obliczanie-kowariancji-oraz-korelacji-pearsona-i-spearmana---przykład-z-obliczeniami"><span class="header-section-number">16.4</span> Dodatek A.1: Obliczanie Kowariancji oraz Korelacji Pearsona i Spearmana - przykład z obliczeniami</h2>
<p>Dane dotyczące wielkości okręgu wyborczego (DM) i indeksu Gallaghera:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>DM (<span class="math inline">\(X\)</span>)</th>
<th>Gallagher (<span class="math inline">\(Y\)</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>18,2</td>
</tr>
<tr class="even">
<td>3</td>
<td>16,7</td>
</tr>
<tr class="odd">
<td>4</td>
<td>15,8</td>
</tr>
<tr class="even">
<td>5</td>
<td>15,3</td>
</tr>
<tr class="odd">
<td>6</td>
<td>15,0</td>
</tr>
<tr class="even">
<td>7</td>
<td>14,8</td>
</tr>
<tr class="odd">
<td>8</td>
<td>14,7</td>
</tr>
<tr class="even">
<td>9</td>
<td>14,6</td>
</tr>
<tr class="odd">
<td>10</td>
<td>14,55</td>
</tr>
<tr class="even">
<td>11</td>
<td>14,52</td>
</tr>
</tbody>
</table>
<section id="krok-1-obliczanie-podstawowych-statystyk" class="level3" data-number="16.4.1">
<h3 data-number="16.4.1" class="anchored" data-anchor-id="krok-1-obliczanie-podstawowych-statystyk"><span class="header-section-number">16.4.1</span> Krok 1: Obliczanie Podstawowych Statystyk</h3>
<p>Obliczanie średnich:</p>
<p>Dla DM (<span class="math inline">\(X\)</span>): <span class="math inline">\(\bar{X} = \frac{\sum_{i=1}^n X_i}{n}\)</span></p>
<p>Szczegółowe obliczenia:</p>
<pre><code>2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 + 10 + 11 = 65
x̄ = 65 ÷ 10 = 6,5</code></pre>
<p>Dla indeksu Gallaghera (<span class="math inline">\(Y\)</span>): <span class="math inline">\(\bar{Y} = \frac{\sum_{i=1}^n Y_i}{n}\)</span></p>
<p>Szczegółowe obliczenia:</p>
<pre><code>18,2 + 16,7 + 15,8 + 15,3 + 15,0 + 14,8 + 14,7 + 14,6 + 14,55 + 14,52 = 154,17
ȳ = 154,17 ÷ 10 = 15,417</code></pre>
</section>
<section id="krok-2-szczegółowe-obliczenia-kowariancji" class="level3" data-number="16.4.2">
<h3 data-number="16.4.2" class="anchored" data-anchor-id="krok-2-szczegółowe-obliczenia-kowariancji"><span class="header-section-number">16.4.2</span> Krok 2: Szczegółowe Obliczenia Kowariancji</h3>
<p>Pełna tabela robocza ze wszystkimi obliczeniami:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 26%">
<col style="width: 15%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">\(i\)</span></th>
<th><span class="math inline">\(X_i\)</span></th>
<th><span class="math inline">\(Y_i\)</span></th>
<th><span class="math inline">\((X_i - \bar{X})\)</span></th>
<th><span class="math inline">\((Y_i - \bar{Y})\)</span></th>
<th><span class="math inline">\((X_i - \bar{X})(Y_i - \bar{Y})\)</span></th>
<th><span class="math inline">\((X_i - \bar{X})^2\)</span></th>
<th><span class="math inline">\((Y_i - \bar{Y})^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td>-4,5</td>
<td>2,783</td>
<td>-12,5235</td>
<td>20,25</td>
<td>7,7451</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td>-3,5</td>
<td>1,283</td>
<td>-4,4905</td>
<td>12,25</td>
<td>1,6461</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td>-2,5</td>
<td>0,383</td>
<td>-0,9575</td>
<td>6,25</td>
<td>0,1467</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td>-1,5</td>
<td>-0,117</td>
<td>0,1755</td>
<td>2,25</td>
<td>0,0137</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td>-0,5</td>
<td>-0,417</td>
<td>0,2085</td>
<td>0,25</td>
<td>0,1739</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>0,5</td>
<td>-0,617</td>
<td>-0,3085</td>
<td>0,25</td>
<td>0,3807</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>1,5</td>
<td>-0,717</td>
<td>-1,0755</td>
<td>2,25</td>
<td>0,5141</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>2,5</td>
<td>-0,817</td>
<td>-2,0425</td>
<td>6,25</td>
<td>0,6675</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>3,5</td>
<td>-0,867</td>
<td>-3,0345</td>
<td>12,25</td>
<td>0,7517</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>4,5</td>
<td>-0,897</td>
<td>-4,0365</td>
<td>20,25</td>
<td>0,8047</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td>65</td>
<td>154,17</td>
<td>0</td>
<td>0</td>
<td>-28,085</td>
<td>82,5</td>
<td>12,8442</td>
</tr>
</tbody>
</table>
<p>Obliczanie kowariancji: <span class="math inline">\(Cov(X,Y) = \frac{\sum_{i=1}^n (X_i - \bar{X})(Y_i - \bar{Y})}{n-1}\)</span></p>
<pre><code>Cov(X,Y) = -28,085 ÷ 9 = -3,120556</code></pre>
</section>
<section id="krok-3-obliczanie-odchylenia-standardowego" class="level3" data-number="16.4.3">
<h3 data-number="16.4.3" class="anchored" data-anchor-id="krok-3-obliczanie-odchylenia-standardowego"><span class="header-section-number">16.4.3</span> Krok 3: Obliczanie Odchylenia Standardowego</h3>
<p>Dla DM (<span class="math inline">\(X\)</span>): <span class="math inline">\(\sigma_X = \sqrt{\frac{\sum_{i=1}^n (X_i - \bar{X})^2}{n-1}}\)</span></p>
<pre><code>σx = √(82,5 ÷ 9)
   = √9,1667
   = 3,026582</code></pre>
<p>Dla Gallaghera (<span class="math inline">\(Y\)</span>): <span class="math inline">\(\sigma_Y = \sqrt{\frac{\sum_{i=1}^n (Y_i - \bar{Y})^2}{n-1}}\)</span></p>
<pre><code>σy = √(12,8442 ÷ 9)
   = √1,4271
   = 1,194612</code></pre>
</section>
<section id="krok-4-obliczanie-korelacji-pearsona" class="level3" data-number="16.4.4">
<h3 data-number="16.4.4" class="anchored" data-anchor-id="krok-4-obliczanie-korelacji-pearsona"><span class="header-section-number">16.4.4</span> Krok 4: Obliczanie Korelacji Pearsona</h3>
<p><span class="math inline">\(r = \frac{Cov(X,Y)}{\sigma_X \sigma_Y}\)</span></p>
<pre><code>r = -3,120556 ÷ (3,026582 × 1,194612)
  = -3,120556 ÷ 3,615752
  = -0,863044</code></pre>
</section>
<section id="krok-5-obliczanie-korelacji-rangowej-spearmana" class="level3" data-number="16.4.5">
<h3 data-number="16.4.5" class="anchored" data-anchor-id="krok-5-obliczanie-korelacji-rangowej-spearmana"><span class="header-section-number">16.4.5</span> Krok 5: Obliczanie Korelacji Rangowej Spearmana</h3>
<p>Pełna tabela rangowa ze wszystkimi obliczeniami:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(i\)</span></th>
<th><span class="math inline">\(X_i\)</span></th>
<th><span class="math inline">\(Y_i\)</span></th>
<th>Ranga <span class="math inline">\(X_i\)</span></th>
<th>Ranga <span class="math inline">\(Y_i\)</span></th>
<th><span class="math inline">\(d_i\)</span></th>
<th><span class="math inline">\(d_i^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td>1</td>
<td>10</td>
<td>-9</td>
<td>81</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td>2</td>
<td>9</td>
<td>-7</td>
<td>49</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td>3</td>
<td>8</td>
<td>-5</td>
<td>25</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td>4</td>
<td>7</td>
<td>-3</td>
<td>9</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td>5</td>
<td>6</td>
<td>-1</td>
<td>1</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>6</td>
<td>5</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>7</td>
<td>4</td>
<td>3</td>
<td>9</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>8</td>
<td>3</td>
<td>5</td>
<td>25</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>9</td>
<td>2</td>
<td>7</td>
<td>49</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>10</td>
<td>1</td>
<td>9</td>
<td>81</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>330</td>
</tr>
</tbody>
</table>
<p>Obliczanie korelacji Spearmana: <span class="math inline">\(\rho = 1 - \frac{6\sum d_i^2}{n(n^2-1)}\)</span></p>
<pre><code>rho = 1 - (6 × 330) ÷ (10(100 - 1))
   = 1 - 1980 ÷ 990
   = 1 - 2
   = -1</code></pre>
</section>
<section id="krok-6-weryfikacja-w-r" class="level3" data-number="16.4.6">
<h3 data-number="16.4.6" class="anchored" data-anchor-id="krok-6-weryfikacja-w-r"><span class="header-section-number">16.4.6</span> Krok 6: Weryfikacja w R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wektorów</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>DM <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>GH <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">18.2</span>, <span class="fl">16.7</span>, <span class="fl">15.8</span>, <span class="fl">15.3</span>, <span class="fl">15.0</span>, <span class="fl">14.8</span>, <span class="fl">14.7</span>, <span class="fl">14.6</span>, <span class="fl">14.55</span>, <span class="fl">14.52</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczanie kowariancji</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(DM, GH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3.120556</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczanie korelacji</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DM, GH, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8627742</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DM, GH, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1</code></pre>
</div>
</div>
</section>
<section id="krok-7-podstawowa-wizualizacja" class="level3" data-number="16.4.7">
<h3 data-number="16.4.7" class="anchored" data-anchor-id="krok-7-podstawowa-wizualizacja"><span class="header-section-number">16.4.7</span> Krok 7: Podstawowa Wizualizacja</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie ramki danych</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">DM =</span> DM, <span class="at">GH =</span> GH)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu rozrzutu</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Wielkość Okręgu vs Indeks Gallaghera"</span>,</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Wielkość Okręgu (DM)"</span>,</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Indeks Gallaghera (GH)"</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="dodatek-a.2-estymacja-ols-i-miary-dopasowania-modelu" class="level2" data-number="16.5">
<h2 data-number="16.5" class="anchored" data-anchor-id="dodatek-a.2-estymacja-ols-i-miary-dopasowania-modelu"><span class="header-section-number">16.5</span> Dodatek A.2: Estymacja OLS i Miary Dopasowania Modelu</h2>
<section id="krok-1-obliczanie-estymatorów-ols" class="level3" data-number="16.5.1">
<h3 data-number="16.5.1" class="anchored" data-anchor-id="krok-1-obliczanie-estymatorów-ols"><span class="header-section-number">16.5.1</span> Krok 1: Obliczanie Estymatorów OLS</h3>
<p>Korzystając z wcześniej obliczonych wartości: - <span class="math inline">\(\sum(X_i - \bar{X})(Y_i - \bar{Y}) = -28,085\)</span> - <span class="math inline">\(\sum(X_i - \bar{X})^2 = 82,5\)</span> - <span class="math inline">\(\bar{X} = 6,5\)</span> - <span class="math inline">\(\bar{Y} = 15,417\)</span></p>
<p>Obliczanie nachylenia (<span class="math inline">\(\beta_1\)</span>): <span class="math inline">\(\beta_1 = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2}\)</span></p>
<pre><code>β₁ = -28,085 ÷ 82,5 = -0,3404</code></pre>
<p>Obliczanie wyrazu wolnego (<span class="math inline">\(\beta_0\)</span>): <span class="math inline">\(\beta_0 = \bar{Y} - \beta_1\bar{X}\)</span></p>
<pre><code>β₀ = 15,417 - (-0,3404 × 6,5)
   = 15,417 + 2,2126
   = 17,6296</code></pre>
<p>Zatem równanie regresji OLS ma postać: <span class="math inline">\(\hat{Y} = 17,6296 - 0,3404X\)</span></p>
</section>
<section id="krok-2-obliczanie-wartości-dopasowanych-i-reszt" class="level3" data-number="16.5.2">
<h3 data-number="16.5.2" class="anchored" data-anchor-id="krok-2-obliczanie-wartości-dopasowanych-i-reszt"><span class="header-section-number">16.5.2</span> Krok 2: Obliczanie Wartości Dopasowanych i Reszt</h3>
<p>Pełna tabela ze wszystkimi obliczeniami:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 21%">
<col style="width: 8%">
<col style="width: 18%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">\(i\)</span></th>
<th><span class="math inline">\(X_i\)</span></th>
<th><span class="math inline">\(Y_i\)</span></th>
<th><span class="math inline">\(\hat{Y}_i\)</span></th>
<th><span class="math inline">\(e_i = Y_i - \hat{Y}_i\)</span></th>
<th><span class="math inline">\(e_i^2\)</span></th>
<th><span class="math inline">\((Y_i - \bar{Y})^2\)</span></th>
<th><span class="math inline">\((\hat{Y}_i - \bar{Y})^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td>16,9488</td>
<td>1,2512</td>
<td>1,5655</td>
<td>7,7451</td>
<td>2,3404</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td>16,6084</td>
<td>0,0916</td>
<td>0,0084</td>
<td>1,6461</td>
<td>1,4241</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td>16,2680</td>
<td>-0,4680</td>
<td>0,2190</td>
<td>0,1467</td>
<td>0,7225</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td>15,9276</td>
<td>-0,6276</td>
<td>0,3939</td>
<td>0,0137</td>
<td>0,2601</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td>15,5872</td>
<td>-0,5872</td>
<td>0,3448</td>
<td>0,1739</td>
<td>0,0289</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>15,2468</td>
<td>-0,4468</td>
<td>0,1996</td>
<td>0,3807</td>
<td>0,0290</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>14,9064</td>
<td>-0,2064</td>
<td>0,0426</td>
<td>0,5141</td>
<td>0,2610</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>14,5660</td>
<td>0,0340</td>
<td>0,0012</td>
<td>0,6675</td>
<td>0,7241</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>14,2256</td>
<td>0,3244</td>
<td>0,1052</td>
<td>0,7517</td>
<td>1,4184</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>13,8852</td>
<td>0,6348</td>
<td>0,4030</td>
<td>0,8047</td>
<td>2,3439</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td>65</td>
<td>154,17</td>
<td>154,17</td>
<td>0</td>
<td>3,2832</td>
<td>12,8442</td>
<td>9,5524</td>
</tr>
</tbody>
</table>
<p>Obliczenia dla wartości dopasowanych:</p>
<pre><code>Dla X = 2:
Ŷ = 17,6296 + (-0,3404 × 2) = 16,9488

Dla X = 3:
Ŷ = 17,6296 + (-0,3404 × 3) = 16,6084

[... kontynuacja dla wszystkich wartości]</code></pre>
</section>
<section id="krok-3-obliczanie-miar-dopasowania" class="level3" data-number="16.5.3">
<h3 data-number="16.5.3" class="anchored" data-anchor-id="krok-3-obliczanie-miar-dopasowania"><span class="header-section-number">16.5.3</span> Krok 3: Obliczanie Miar Dopasowania</h3>
<p>Suma kwadratów reszt (SSE): <span class="math inline">\(SSE = \sum e_i^2\)</span></p>
<pre><code>SSE = 3,2832</code></pre>
<p>Całkowita suma kwadratów (SST): <span class="math inline">\(SST = \sum(Y_i - \bar{Y})^2\)</span></p>
<pre><code>SST = 12,8442</code></pre>
<p>Suma kwadratów regresji (SSR): <span class="math inline">\(SSR = \sum(\hat{Y}_i - \bar{Y})^2\)</span></p>
<pre><code>SSR = 9,5524</code></pre>
<p>Weryfikacja dekompozycji: <span class="math inline">\(SST = SSR + SSE\)</span></p>
<pre><code>12,8442 = 9,5524 + 3,2832 (w granicach błędu zaokrąglenia)</code></pre>
<p>Obliczanie współczynnika determinacji R-kwadrat: <span class="math inline">\(R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}\)</span></p>
<pre><code>R² = 9,5524 ÷ 12,8442
   = 0,7438</code></pre>
</section>
<section id="krok-4-weryfikacja-w-r" class="level3" data-number="16.5.4">
<h3 data-number="16.5.4" class="anchored" data-anchor-id="krok-4-weryfikacja-w-r"><span class="header-section-number">16.5.4</span> Krok 4: Weryfikacja w R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modelu liniowego</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Podsumowanie statystyk</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = GH ~ DM, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.62764 -0.46274 -0.08615  0.26624  1.25109 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 17.62976    0.50121  35.174 4.67e-10 ***
DM          -0.34042    0.07053  -4.827  0.00131 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6406 on 8 degrees of freedom
Multiple R-squared:  0.7444,    Adjusted R-squared:  0.7124 
F-statistic:  23.3 on 1 and 8 DF,  p-value: 0.00131</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ręczne obliczenie R-kwadrat</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((GH <span class="sc">-</span> <span class="fu">mean</span>(GH))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(model)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> SST <span class="sc">-</span> SSE</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>R2_manual <span class="ot">&lt;-</span> SSR<span class="sc">/</span>SST</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>R2_manual</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7443793</code></pre>
</div>
</div>
</section>
<section id="krok-5-analiza-reszt" class="level3" data-number="16.5.5">
<h3 data-number="16.5.5" class="anchored" data-anchor-id="krok-5-analiza-reszt"><span class="header-section-number">16.5.5</span> Krok 5: Analiza Reszt</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresów reszt</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych" class="level3" data-number="16.5.6">
<h3 data-number="16.5.6" class="anchored" data-anchor-id="krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych"><span class="header-section-number">16.5.6</span> Krok 6: Wykres Wartości Przewidywanych vs Rzeczywistych</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu wartości przewidywanych vs rzeczywistych</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Rzeczywiste =</span> GH,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Przewidywane =</span> <span class="fu">fitted</span>(model)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>), <span class="fu">aes</span>(<span class="at">x =</span> Przewidywane, <span class="at">y =</span> Rzeczywiste)) <span class="sc">+</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Wartości Przewidywane vs Rzeczywiste"</span>,</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Przewidywany Indeks Gallaghera"</span>,</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Rzeczywisty Indeks Gallaghera"</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="dodatek-a.3-modele-z-transformacją-logarytmiczną" class="level2" data-number="16.6">
<h2 data-number="16.6" class="anchored" data-anchor-id="dodatek-a.3-modele-z-transformacją-logarytmiczną"><span class="header-section-number">16.6</span> Dodatek A.3: Modele z Transformacją Logarytmiczną</h2>
<section id="krok-1-transformacja-danych" class="level3" data-number="16.6.1">
<h3 data-number="16.6.1" class="anchored" data-anchor-id="krok-1-transformacja-danych"><span class="header-section-number">16.6.1</span> Krok 1: Transformacja Danych</h3>
<p>Najpierw obliczamy logarytmy naturalne zmiennych:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(i\)</span></th>
<th><span class="math inline">\(X_i\)</span></th>
<th><span class="math inline">\(Y_i\)</span></th>
<th><span class="math inline">\(\ln(X_i)\)</span></th>
<th><span class="math inline">\(\ln(Y_i)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td>0,6931</td>
<td>2,9014</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td>1,0986</td>
<td>2,8154</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td>1,3863</td>
<td>2,7600</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td>1,6094</td>
<td>2,7278</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td>1,7918</td>
<td>2,7081</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>1,9459</td>
<td>2,6946</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>2,0794</td>
<td>2,6878</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>2,1972</td>
<td>2,6810</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>2,3026</td>
<td>2,6777</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>2,3979</td>
<td>2,6757</td>
</tr>
</tbody>
</table>
</section>
<section id="krok-2-porównanie-różnych-specyfikacji-modelu" class="level3" data-number="16.6.2">
<h3 data-number="16.6.2" class="anchored" data-anchor-id="krok-2-porównanie-różnych-specyfikacji-modelu"><span class="header-section-number">16.6.2</span> Krok 2: Porównanie Różnych Specyfikacji Modelu</h3>
<p>Szacujemy trzy alternatywne specyfikacje:</p>
<ol type="1">
<li>Model log-liniowy: <span class="math inline">\(\ln(Y_i) = \beta_0 + \beta_1X_i + \epsilon_i\)</span></li>
<li>Model liniowo-logarytmiczny: <span class="math inline">\(Y_i = \beta_0 + \beta_1\ln(X_i) + \epsilon_i\)</span></li>
<li>Model log-log: <span class="math inline">\(\ln(Y_i) = \beta_0 + \beta_1\ln(X_i) + \epsilon_i\)</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie zmiennych transformowanych</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log_DM <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>DM)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log_GH <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>GH)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modeli</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>model_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>model_loglinear <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>model_linearlog <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> log_DM, <span class="at">data =</span> data)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>model_loglog <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_GH <span class="sc">~</span> log_DM, <span class="at">data =</span> data)</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Porównanie wartości R-kwadrat</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>models_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Liniowy"</span>, <span class="st">"Log-liniowy"</span>, <span class="st">"Liniowo-logarytmiczny"</span>, <span class="st">"Log-log"</span>),</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_kwadrat =</span> <span class="fu">c</span>(</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_linear)<span class="sc">$</span>r.squared,</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_loglinear)<span class="sc">$</span>r.squared,</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_linearlog)<span class="sc">$</span>r.squared,</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_loglog)<span class="sc">$</span>r.squared</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Wyświetlenie porównania</span></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>models_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Model R_kwadrat
1               Liniowy 0.7443793
2           Log-liniowy 0.7670346
3 Liniowo-logarytmiczny 0.9141560
4               Log-log 0.9288088</code></pre>
</div>
</div>
</section>
<section id="krok-3-porównanie-wizualne" class="level3" data-number="16.6.3">
<h3 data-number="16.6.3" class="anchored" data-anchor-id="krok-3-porównanie-wizualne"><span class="header-section-number">16.6.3</span> Krok 3: Porównanie Wizualne</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresów dla każdego modelu</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Liniowy"</span>) <span class="sc">+</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> log_GH)) <span class="sc">+</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Log-liniowy"</span>) <span class="sc">+</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Liniowo-logarytmiczny"</span>) <span class="sc">+</span></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> log_GH)) <span class="sc">+</span></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Log-log"</span>) <span class="sc">+</span></span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Układanie wykresów w siatkę</span></span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-4-analiza-reszt-dla-najlepszego-modelu" class="level3" data-number="16.6.4">
<h3 data-number="16.6.4" class="anchored" data-anchor-id="krok-4-analiza-reszt-dla-najlepszego-modelu"><span class="header-section-number">16.6.4</span> Krok 4: Analiza Reszt dla Najlepszego Modelu</h3>
<p>Na podstawie wartości R-kwadrat, analiza reszt dla najlepiej dopasowanego modelu:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykresy reszt dla najlepszego modelu</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_linearlog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-5-interpretacja-najlepszego-modelu" class="level3" data-number="16.6.5">
<h3 data-number="16.6.5" class="anchored" data-anchor-id="krok-5-interpretacja-najlepszego-modelu"><span class="header-section-number">16.6.5</span> Krok 5: Interpretacja Najlepszego Modelu</h3>
<p>Współczynniki modelu liniowo-logarytmicznego:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_linearlog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = GH ~ log_DM, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40702 -0.30207 -0.04907  0.22905  0.60549 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  19.0223     0.4079   46.64 4.94e-11 ***
log_DM       -2.0599     0.2232   -9.23 1.54e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3712 on 8 degrees of freedom
Multiple R-squared:  0.9142,    Adjusted R-squared:  0.9034 
F-statistic: 85.19 on 1 and 8 DF,  p-value: 1.539e-05</code></pre>
</div>
</div>
<p>Interpretacja: - <span class="math inline">\(\beta_0\)</span> reprezentuje oczekiwany Indeks Gallaghera, gdy ln(DM) = 0 (czyli gdy DM = 1) - <span class="math inline">\(\beta_1\)</span> reprezentuje zmianę Indeksu Gallaghera związaną z jednostkowym wzrostem ln(DM)</p>
</section>
<section id="krok-6-predykcje-modelu" class="level3" data-number="16.6.6">
<h3 data-number="16.6.6" class="anchored" data-anchor-id="krok-6-predykcje-modelu"><span class="header-section-number">16.6.6</span> Krok 6: Predykcje Modelu</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu predykcji dla najlepszego modelu</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model Liniowo-logarytmiczny: Indeks Gallaghera vs ln(Wielkość Okręgu)"</span>,</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"ln(Wielkość Okręgu)"</span>,</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Indeks Gallaghera"</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-7-analiza-elastyczności" class="level3" data-number="16.6.7">
<h3 data-number="16.6.7" class="anchored" data-anchor-id="krok-7-analiza-elastyczności"><span class="header-section-number">16.6.7</span> Krok 7: Analiza Elastyczności</h3>
<p>Dla modelu log-log współczynniki bezpośrednio reprezentują elastyczności. Obliczenie średniej elastyczności dla modelu liniowo-logarytmicznego:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie elastyczności przy wartościach średnich</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>mean_DM <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>DM)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>mean_GH <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>GH)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_linearlog)[<span class="dv">2</span>]</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>elastycznosc <span class="ot">&lt;-</span> beta1 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>mean_GH)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>elastycznosc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    log_DM 
-0.1336136 </code></pre>
</div>
</div>
<p>Wartość ta reprezentuje procentową zmianę Indeksu Gallaghera przy jednoprocentowej zmianie Wielkości Okręgu.</p>
</section>
</section>
<section id="dodatek-a.4-porównanie-popularnych-miar-korelacji-pearson-spearman-i-kendall" class="level2" data-number="16.7">
<h2 data-number="16.7" class="anchored" data-anchor-id="dodatek-a.4-porównanie-popularnych-miar-korelacji-pearson-spearman-i-kendall"><span class="header-section-number">16.7</span> Dodatek A.4: Porównanie Popularnych Miar Korelacji: Pearson, Spearman i Kendall</h2>
<section id="zbiór-danych" class="level3" data-number="16.7.1">
<h3 data-number="16.7.1" class="anchored" data-anchor-id="zbiór-danych"><span class="header-section-number">16.7.1</span> Zbiór Danych</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">8</span>),</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">7</span>)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="korelacja-pearsona-1" class="level3" data-number="16.7.2">
<h3 data-number="16.7.2" class="anchored" data-anchor-id="korelacja-pearsona-1"><span class="header-section-number">16.7.2</span> Korelacja Pearsona</h3>
<p><span class="math display">\[ r = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum (x_i - \bar{x})^2 \sum (y_i - \bar{y})^2}} \]</span></p>
<section id="obliczenia-krok-po-kroku" class="level4" data-number="16.7.2.1">
<h4 data-number="16.7.2.1" class="anchored" data-anchor-id="obliczenia-krok-po-kroku"><span class="header-section-number">16.7.2.1</span> Obliczenia krok po kroku:</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 26%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">\(x_i\)</span></th>
<th><span class="math inline">\(y_i\)</span></th>
<th><span class="math inline">\(x_i - \bar{x}\)</span></th>
<th><span class="math inline">\(y_i - \bar{y}\)</span></th>
<th><span class="math inline">\((x_i - \bar{x})(y_i - \bar{y})\)</span></th>
<th><span class="math inline">\((x_i - \bar{x})^2\)</span></th>
<th><span class="math inline">\((y_i - \bar{y})^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>3</td>
<td>-2,4</td>
<td>-1,6</td>
<td>3,84</td>
<td>5,76</td>
<td>2,56</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>5</td>
<td>-0,4</td>
<td>0,4</td>
<td>-0,16</td>
<td>0,16</td>
<td>0,16</td>
</tr>
<tr class="odd">
<td>3</td>
<td>5</td>
<td>4</td>
<td>0,6</td>
<td>-0,6</td>
<td>-0,36</td>
<td>0,36</td>
<td>0,36</td>
</tr>
<tr class="even">
<td>4</td>
<td>3</td>
<td>4</td>
<td>-1,4</td>
<td>-0,6</td>
<td>0,84</td>
<td>1,96</td>
<td>0,36</td>
</tr>
<tr class="odd">
<td>5</td>
<td>8</td>
<td>7</td>
<td>3,6</td>
<td>2,4</td>
<td>8,64</td>
<td>12,96</td>
<td>5,76</td>
</tr>
<tr class="even">
<td>Suma</td>
<td>22</td>
<td>23</td>
<td>0</td>
<td>0</td>
<td>12,8</td>
<td>21,2</td>
<td>9,2</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(\bar{x} = 4,4\)</span> <span class="math inline">\(\bar{y} = 4,6\)</span></p>
<p><span class="math display">\[ r = \frac{12,8}{\sqrt{21,2 \times 9,2}} = \frac{12,8}{\sqrt{195,04}} = \frac{12,8}{13,97} = 0,92 \]</span></p>
</section>
</section>
<section id="korelacja-spearmana-1" class="level3" data-number="16.7.3">
<h3 data-number="16.7.3" class="anchored" data-anchor-id="korelacja-spearmana-1"><span class="header-section-number">16.7.3</span> Korelacja Spearmana</h3>
<p><span class="math display">\[ \rho = 1 - \frac{6\sum d_i^2}{n(n^2-1)} \]</span></p>
<section id="obliczenia-krok-po-kroku-1" class="level4" data-number="16.7.3.1">
<h4 data-number="16.7.3.1" class="anchored" data-anchor-id="obliczenia-krok-po-kroku-1"><span class="header-section-number">16.7.3.1</span> Obliczenia krok po kroku:</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">\(x_i\)</span></th>
<th><span class="math inline">\(y_i\)</span></th>
<th>Ranga <span class="math inline">\(x_i\)</span></th>
<th>Ranga <span class="math inline">\(y_i\)</span></th>
<th><span class="math inline">\(d_i\)</span></th>
<th><span class="math inline">\(d_i^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>5</td>
<td>3</td>
<td>5</td>
<td>-2</td>
<td>4</td>
</tr>
<tr class="odd">
<td>3</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>2,5</td>
<td>1,5</td>
<td>2,25</td>
</tr>
<tr class="even">
<td>4</td>
<td>3</td>
<td>4</td>
<td>2</td>
<td>2,5</td>
<td>-0,5</td>
<td>0,25</td>
</tr>
<tr class="odd">
<td>5</td>
<td>8</td>
<td>7</td>
<td>5</td>
<td>4</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>Suma</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>7,5</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[ \rho = 1 - \frac{6(7,5)}{5(25-1)} = 1 - \frac{45}{120} = 0,82 \]</span></p>
</section>
</section>
<section id="tau-kendalla" class="level3" data-number="16.7.4">
<h3 data-number="16.7.4" class="anchored" data-anchor-id="tau-kendalla"><span class="header-section-number">16.7.4</span> Tau Kendalla</h3>
<p><span class="math display">\[ \tau = \frac{\text{liczba par zgodnych} - \text{liczba par niezgodnych}}{\frac{1}{2}n(n-1)} \]</span></p>
<section id="obliczenia-krok-po-kroku-2" class="level4" data-number="16.7.4.1">
<h4 data-number="16.7.4.1" class="anchored" data-anchor-id="obliczenia-krok-po-kroku-2"><span class="header-section-number">16.7.4.1</span> Obliczenia krok po kroku:</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 16%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th>Para (i,j)</th>
<th><span class="math inline">\(x_i,x_j\)</span></th>
<th><span class="math inline">\(y_i,y_j\)</span></th>
<th><span class="math inline">\(x_j-x_i\)</span></th>
<th><span class="math inline">\(y_j-y_i\)</span></th>
<th>Wynik</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(1,2)</td>
<td>2,4</td>
<td>3,5</td>
<td>+2</td>
<td>+2</td>
<td>Z</td>
</tr>
<tr class="even">
<td>(1,3)</td>
<td>2,5</td>
<td>3,4</td>
<td>+3</td>
<td>+1</td>
<td>Z</td>
</tr>
<tr class="odd">
<td>(1,4)</td>
<td>2,3</td>
<td>3,4</td>
<td>+1</td>
<td>+1</td>
<td>Z</td>
</tr>
<tr class="even">
<td>(1,5)</td>
<td>2,8</td>
<td>3,7</td>
<td>+6</td>
<td>+4</td>
<td>Z</td>
</tr>
<tr class="odd">
<td>(2,3)</td>
<td>4,5</td>
<td>5,4</td>
<td>+1</td>
<td>-1</td>
<td>N</td>
</tr>
<tr class="even">
<td>(2,4)</td>
<td>4,3</td>
<td>5,4</td>
<td>-1</td>
<td>-1</td>
<td>Z</td>
</tr>
<tr class="odd">
<td>(2,5)</td>
<td>4,8</td>
<td>5,7</td>
<td>+4</td>
<td>+2</td>
<td>Z</td>
</tr>
<tr class="even">
<td>(3,4)</td>
<td>5,3</td>
<td>4,4</td>
<td>-2</td>
<td>0</td>
<td>N</td>
</tr>
<tr class="odd">
<td>(3,5)</td>
<td>5,8</td>
<td>4,7</td>
<td>+3</td>
<td>+3</td>
<td>Z</td>
</tr>
<tr class="even">
<td>(4,5)</td>
<td>3,8</td>
<td>4,7</td>
<td>+5</td>
<td>+3</td>
<td>Z</td>
</tr>
</tbody>
</table>
<p>Liczba par zgodnych = 8 Liczba par niezgodnych = 2 <span class="math display">\[ \tau = \frac{8-2}{10} = 0,74 \]</span></p>
</section>
</section>
<section id="weryfikacja-w-r" class="level3" data-number="16.7.5">
<h3 data-number="16.7.5" class="anchored" data-anchor-id="weryfikacja-w-r"><span class="header-section-number">16.7.5</span> Weryfikacja w R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pearson:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(dane<span class="sc">$</span>x, dane<span class="sc">$</span>y, <span class="at">method=</span><span class="st">"pearson"</span>), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pearson: 0.92 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Spearman:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(dane<span class="sc">$</span>x, dane<span class="sc">$</span>y, <span class="at">method=</span><span class="st">"spearman"</span>), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spearman: 0.82 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Kendall:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(dane<span class="sc">$</span>x, dane<span class="sc">$</span>y, <span class="at">method=</span><span class="st">"kendall"</span>), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kendall: 0.74 </code></pre>
</div>
</div>
</section>
<section id="interpretacja-wyników" class="level3" data-number="16.7.6">
<h3 data-number="16.7.6" class="anchored" data-anchor-id="interpretacja-wyników"><span class="header-section-number">16.7.6</span> Interpretacja Wyników</h3>
<ol type="1">
<li><strong>Korelacja Pearsona (r = 0,92)</strong>
<ul>
<li>Silna dodatnia korelacja liniowa</li>
<li>Wskazuje na bardzo silny liniowy związek między zmiennymi</li>
</ul></li>
<li><strong>Korelacja Spearmana (ρ = 0,82)</strong>
<ul>
<li>Również silna dodatnia korelacja</li>
<li>Nieco niższa niż Pearsona, co sugeruje pewne odchylenia od monotoniczności</li>
</ul></li>
<li><strong>Tau Kendalla (τ = 0,74)</strong>
<ul>
<li>Najniższa z trzech wartości, ale wciąż wskazuje na silną zależność</li>
<li>Bardziej odporna na wartości odstające</li>
</ul></li>
</ol>
</section>
<section id="porównanie-miar" class="level3" data-number="16.7.7">
<h3 data-number="16.7.7" class="anchored" data-anchor-id="porównanie-miar"><span class="header-section-number">16.7.7</span> Porównanie Miar</h3>
<ol type="1">
<li><strong>Różnice w wartościach:</strong>
<ul>
<li>Pearson (0,92) - najwyższa wartość, silna liniowość</li>
<li>Spearman (0,82) - uwzględnia tylko uporządkowanie</li>
<li>Kendall (0,74) - najbardziej konserwatywna miara</li>
</ul></li>
<li><strong>Praktyczne zastosowanie:</strong>
<ul>
<li>Wszystkie miary potwierdzają silną dodatnią zależność</li>
<li>Różnice między miarami wskazują na nieznaczne odchylenia od idealnej liniowości</li>
<li>Kendall daje najbardziej ostrożną ocenę siły związku</li>
</ul></li>
</ol>
</section>
</section>
<section id="appendix-b." class="level2" data-number="16.8">
<h2 data-number="16.8" class="anchored" data-anchor-id="appendix-b."><span class="header-section-number">16.8</span> Appendix B.</h2>
<p>(…)</p>
</section>
<section id="appendix-c.-przykłady-różne" class="level2" data-number="16.9">
<h2 data-number="16.9" class="anchored" data-anchor-id="appendix-c.-przykłady-różne"><span class="header-section-number">16.9</span> Appendix C. Przykłady różne</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Descriptive Statistics and OLS Example - Income and Voter Turnout
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Background</strong></p>
<p>In preparation for the 2024 municipal elections, the Amsterdam Electoral Commission conducted research on voter participation patterns across different city neighborhoods. A key question emerged: Does economic prosperity of a neighborhood correlate with civic engagement, specifically voter turnout?</p>
<p><strong>Data Collection</strong></p>
<p>Sample: 5 representative neighborhoods in Amsterdam</p>
<p>Time Period: Data from the 2022 municipal elections</p>
<p>Variables:</p>
<ul>
<li>Income: Average annual household income per capita (thousands €)</li>
<li>Turnout: Percentage of registered voters who voted in the election</li>
</ul>
<section id="initial-r-output-for-reference" class="level3" data-number="16.9.1">
<h3 data-number="16.9.1" class="anchored" data-anchor-id="initial-r-output-for-reference"><span class="header-section-number">16.9.1</span> Initial R Output for Reference</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">45</span>, <span class="dv">56</span>, <span class="dv">40</span>, <span class="dv">60</span>)  <span class="co"># thousands €</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>turnout <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">56</span>, <span class="dv">70</span>, <span class="dv">50</span>, <span class="dv">75</span>) <span class="co"># %</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Full model check</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(turnout <span class="sc">~</span> income)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = turnout ~ income)

Residuals:
      1       2       3       4       5 
-1.9486  0.3359  0.5100  0.6204  0.4824 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.89647    3.96731  -0.226 0.835748    
income       1.25690    0.07822  16.068 0.000524 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.263 on 3 degrees of freedom
Multiple R-squared:  0.9885,    Adjusted R-squared:  0.9847 
F-statistic: 258.2 on 1 and 3 DF,  p-value: 0.0005243</code></pre>
</div>
</div>
</section>
<section id="dispersion-measures" class="level3" data-number="16.9.2">
<h3 data-number="16.9.2" class="anchored" data-anchor-id="dispersion-measures"><span class="header-section-number">16.9.2</span> Dispersion Measures</h3>
<p><strong>Means:</strong> <span class="math display">\[\bar{X} = \frac{50 + 45 + 56 + 40 + 60}{5} = \frac{251}{5} = 50.2\]</span> <span class="math display">\[\bar{Y} = \frac{60 + 56 + 70 + 50 + 75}{5} = \frac{311}{5} = 62.2\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(income)  <span class="co"># 50.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(turnout) <span class="co"># 62.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 62.2</code></pre>
</div>
</div>
<p><strong>Variances:</strong> <span class="math display">\[s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}\]</span></p>
<p>Deviations for X: (-0.2, -5.2, 5.8, -10.2, 9.8) <span class="math display">\[s^2_X = \frac{0.04 + 27.04 + 33.64 + 104.04 + 96.04}{4} = \frac{260.8}{4} = 65.2\]</span></p>
<p>Deviations for Y: (-2.2, -6.2, 7.8, -12.2, 12.8) <span class="math display">\[s^2_Y = \frac{4.84 + 38.44 + 60.84 + 148.84 + 163.84}{4} = \frac{416.8}{4} = 104.2\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(income)  <span class="co"># 65.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 65.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(turnout) <span class="co"># 104.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 104.2</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation" class="level3" data-number="16.9.3">
<h3 data-number="16.9.3" class="anchored" data-anchor-id="covariance-and-correlation"><span class="header-section-number">16.9.3</span> Covariance and Correlation</h3>
<p><strong>Covariance:</strong> <span class="math display">\[s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}\]</span></p>
<p>Products of deviations:</p>
<p>(-0.2 × -2.2) = 0.44 (-5.2 × -6.2) = 32.24 (5.8 × 7.8) = 45.24 (-10.2 × -12.2) = 124.44 (9.8 × 12.8) = 125.44</p>
<p><span class="math display">\[s_{XY} = \frac{327.8}{4} = 81.95\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(income, turnout) <span class="co"># 81.95</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 81.95</code></pre>
</div>
</div>
<p><strong>Correlation:</strong> <span class="math display">\[r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{81.95}{\sqrt{65.2}\sqrt{104.2}} = 0.994\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(income, turnout) <span class="co"># 0.994</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9942402</code></pre>
</div>
</div>
</section>
<section id="ols-regression-y-beta_0-beta_1x" class="level3" data-number="16.9.4">
<h3 data-number="16.9.4" class="anchored" data-anchor-id="ols-regression-y-beta_0-beta_1x"><span class="header-section-number">16.9.4</span> OLS Regression <span class="math inline">\((Y = \beta_0 + \beta_1X)\)</span></h3>
<p><strong>Slope coefficient:</strong> <span class="math display">\[\beta_1 = \frac{s_{XY}}{s^2_X} = \frac{81.95}{65.2} = 1.2571429\]</span></p>
<p><strong>Intercept:</strong> <span class="math display">\[\beta_0 = \bar{Y} - \beta_1\bar{X}\]</span> Step by step: 1. <span class="math inline">\(1.2571429 × 50.2 = 63.1085714\)</span> 2. <span class="math inline">\(\beta_0 = 62.2 - 63.1085714 = -0.9085714\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)  <span class="co"># Exact coefficients from R</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      income 
 -0.8964724   1.2569018 </code></pre>
</div>
</div>
</section>
<section id="detailed-decomposition-of-variance-and-r-squared" class="level3" data-number="16.9.5">
<h3 data-number="16.9.5" class="anchored" data-anchor-id="detailed-decomposition-of-variance-and-r-squared"><span class="header-section-number">16.9.5</span> Detailed Decomposition of Variance and R-squared</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">\((\hat{Y})\)</span>: <span class="math display">\[\hat{Y} = -0.9085714 + 1.2571429X\]</span></p>
<p>For each X:</p>
<p>X = 50: <span class="math inline">\(\hat{Y} = -0.9085714 + 1.2571429(50) = 61.9485736\)</span> X = 45: <span class="math inline">\(\hat{Y} = -0.9085714 + 1.2571429(45) = 55.6535591\)</span> X = 56: <span class="math inline">\(\hat{Y} = -0.9085714 + 1.2571429(56) = 69.5114310\)</span> X = 40: <span class="math inline">\(\hat{Y} = -0.9085714 + 1.2571429(40) = 49.3571446\)</span> X = 60: <span class="math inline">\(\hat{Y} = -0.9085714 + 1.2571429(60) = 74.5200026\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification of predicted values</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.9085714</span> <span class="sc">+</span> <span class="fl">1.2571429</span> <span class="sc">*</span> income</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> income,</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> turnout,</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y_hat =</span> y_hat,</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X  Y    Y_hat
1 50 60 61.94857
2 45 56 55.66286
3 56 70 69.49143
4 40 50 49.37714
5 60 75 74.52000</code></pre>
</div>
</div>
<p><strong>Step 2: Calculate SST (Total Sum of Squares)</strong></p>
<p><span class="math inline">\(SST = \sum(Y_i - \bar{Y})^2\)</span> where <span class="math inline">\(\bar{Y} = 62.2\)</span></p>
<p><span class="math inline">\((60 - 62.2)^2 = (-2.2)^2 = 4.84\)</span> <span class="math inline">\((56 - 62.2)^2 = (-6.2)^2 = 38.44\)</span> <span class="math inline">\((70 - 62.2)^2 = (7.8)^2 = 60.84\)</span> <span class="math inline">\((50 - 62.2)^2 = (-12.2)^2 = 148.84\)</span> <span class="math inline">\((75 - 62.2)^2 = (12.8)^2 = 163.84\)</span></p>
<p><span class="math inline">\(SST = 4.84 + 38.44 + 60.84 + 148.84 + 163.84 = 416.8\)</span></p>
<p><strong>Step 3: Calculate SSR (Regression Sum of Squares)</strong></p>
<p><span class="math inline">\(SSR = \sum(\hat{Y}_i - \bar{Y})^2\)</span></p>
<p><span class="math inline">\((61.9485736 - 62.2)^2 = (-0.2514264)^2 = 0.0632151\)</span> <span class="math inline">\((55.6535591 - 62.2)^2 = (-6.5464409)^2 = 42.8558689\)</span> <span class="math inline">\((69.5114310 - 62.2)^2 = (7.3114310)^2 = 53.4570178\)</span> <span class="math inline">\((49.3571446 - 62.2)^2 = (-12.8428554)^2 = 164.9389370\)</span> <span class="math inline">\((74.5200026 - 62.2)^2 = (12.3200026)^2 = 151.7824640\)</span></p>
<p><span class="math inline">\(SSR = 413.0975028\)</span></p>
<p><strong>Step 4: Calculate SSE (Error Sum of Squares)</strong></p>
<p><span class="math inline">\(SSE = \sum(Y_i - \hat{Y}_i)^2\)</span></p>
<p><span class="math inline">\((60 - 61.9485736)^2 = (-1.9485736)^2 = 3.7969384\)</span> <span class="math inline">\((56 - 55.6535591)^2 = (0.3464409)^2 = 0.1200212\)</span> <span class="math inline">\((70 - 69.5114310)^2 = (0.4885690)^2 = 0.2387198\)</span> <span class="math inline">\((50 - 49.3571446)^2 = (0.6428554)^2 = 0.4132631\)</span> <span class="math inline">\((75 - 74.5200026)^2 = (0.4799974)^2 = 0.2303975\)</span></p>
<p><span class="math inline">\(SSE = 4.7024972\)</span></p>
<p><strong>Step 5: Verify decomposition</strong> <span class="math display">\[SST = SSR + SSE\]</span> <span class="math display">\[416.8 = 413.0975028 + 4.7024972\]</span></p>
<p><strong>Step 6: Calculate R-squared</strong> <span class="math display">\[R^2 = \frac{SSR}{SST} = \frac{413.0975028}{416.8} = 0.9916\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared  <span class="co"># Should match our calculation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9885135</code></pre>
</div>
</div>
</section>
<section id="visualization" class="level3" data-number="16.9.6">
<h3 data-number="16.9.6" class="anchored" data-anchor-id="visualization"><span class="header-section-number">16.9.6</span> Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">income =</span> income, <span class="at">turnout =</span> turnout)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> turnout)) <span class="sc">+</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Voter Turnout vs Income per Capita"</span>,</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Income per Capita (thousands €)"</span>,</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Voter Turnout (%)"</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation" class="level3" data-number="16.9.7">
<h3 data-number="16.9.7" class="anchored" data-anchor-id="interpretation"><span class="header-section-number">16.9.7</span> Interpretation</h3>
<p>The analysis shows:</p>
<ol type="1">
<li>A very strong positive correlation (r = 0.994) between income and voter turnout</li>
<li>The regression equation <span class="math inline">\(Y = -0.9085714 + 1.2571429X\)</span> indicates that:
<ul>
<li>For each €1,000 increase in income, turnout increases by about 1.26 percentage points</li>
<li>The intercept (-0.9086) has little practical meaning as income is never zero</li>
</ul></li>
<li>The R-squared of 0.9916 indicates that 99.16% of the variance in turnout is explained by income</li>
</ol>
</section>
</div>
</div>
<p>I’ll create a new example with a psychological focus and ensure all calculations are clearly broken down and verified.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Anxiety Levels and Cognitive Performance: A Laboratory Study
</div>
</div>
<div class="callout-body-container callout-body">
<section id="data-and-context" class="level3" data-number="16.9.8">
<h3 data-number="16.9.8" class="anchored" data-anchor-id="data-and-context"><span class="header-section-number">16.9.8</span> Data and Context</h3>
<p>In a psychology experiment, researchers measured the relationship between anxiety levels (measured by galvanic skin response, GSR) and cognitive performance (score on a working memory task).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>anxiety <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">3.4</span>, <span class="fl">4.2</span>, <span class="fl">5.1</span>, <span class="fl">5.8</span>, <span class="fl">6.4</span>, <span class="fl">7.2</span>, <span class="fl">8.0</span>)  <span class="co"># GSR readings</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>performance <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">92</span>, <span class="dv">88</span>, <span class="dv">84</span>, <span class="dv">78</span>, <span class="dv">74</span>, <span class="dv">70</span>, <span class="dv">65</span>, <span class="dv">62</span>)      <span class="co"># Working memory scores</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial model check</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(performance <span class="sc">~</span> anxiety)</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = performance ~ anxiety)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8993 -0.6660  0.2162  0.6106  1.5262 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 105.3248     1.3189   79.86 2.60e-10 ***
anxiety      -5.4407     0.2359  -23.06 4.35e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.236 on 6 degrees of freedom
Multiple R-squared:  0.9888,    Adjusted R-squared:  0.987 
F-statistic: 531.9 on 1 and 6 DF,  p-value: 4.355e-07</code></pre>
</div>
</div>
</section>
<section id="descriptive-statistics" class="level3" data-number="16.9.9">
<h3 data-number="16.9.9" class="anchored" data-anchor-id="descriptive-statistics"><span class="header-section-number">16.9.9</span> Descriptive Statistics</h3>
<p><strong>Means:</strong> <span class="math display">\[\bar{X} = \frac{2.1 + 3.4 + 4.2 + 5.1 + 5.8 + 6.4 + 7.2 + 8.0}{8} = \frac{42.2}{8} = 5.275\]</span></p>
<p><span class="math display">\[\bar{Y} = \frac{92 + 88 + 84 + 78 + 74 + 70 + 65 + 62}{8} = \frac{613}{8} = 76.625\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(anxiety)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.275</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76.625</code></pre>
</div>
</div>
<p><strong>Variances:</strong> <span class="math display">\[s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}\]</span></p>
<p>Deviations for X:</p>
<p>(2.1 - 5.275) = -3.175 (3.4 - 5.275) = -1.875 (4.2 - 5.275) = -1.075 (5.1 - 5.275) = -0.175 (5.8 - 5.275) = 0.525 (6.4 - 5.275) = 1.125 (7.2 - 5.275) = 1.925 (8.0 - 5.275) = 2.725</p>
<p>Squared deviations:</p>
<p>10.08063 + 3.51563 + 1.15563 + 0.03063 + 0.27563 + 1.26563 + 3.70563 + 7.42563 = 27.45500</p>
<p><span class="math display">\[s^2_X = \frac{27.45500}{7} = 3.922143\]</span></p>
<p>Similarly for Y:</p>
<p>Deviations: 15.375, 11.375, 7.375, 1.375, -2.625, -6.625, -11.625, -14.625</p>
<p><span class="math display">\[s^2_Y = \frac{236.875 + 129.391 + 54.391 + 1.891 + 6.891 + 43.891 + 135.141 + 213.891}{7} = \frac{822.362}{7} = 117.4803\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(anxiety)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.922143</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 117.4107</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation-1" class="level3" data-number="16.9.10">
<h3 data-number="16.9.10" class="anchored" data-anchor-id="covariance-and-correlation-1"><span class="header-section-number">16.9.10</span> Covariance and Correlation</h3>
<p><strong>Covariance:</strong> <span class="math display">\[s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}\]</span></p>
<p>Products of deviations:</p>
<p>(-3.175 × 15.375) = -48.815625</p>
<p>(-1.875 × 11.375) = -21.328125</p>
<p>(-1.075 × 7.375) = -7.928125</p>
<p>(-0.175 × 1.375) = -0.240625</p>
<p>(0.525 × -2.625) = -1.378125</p>
<p>(1.125 × -6.625) = -7.453125</p>
<p>(1.925 × -11.625) = -22.378125</p>
<p>(2.725 × -14.625) = -39.853125</p>
<p>Sum = -149.375</p>
<p><span class="math display">\[s_{XY} = \frac{-149.375}{7} = -21.33929\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(anxiety, performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -21.33929</code></pre>
</div>
</div>
<p><strong>Correlation:</strong> <span class="math display">\[r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{-21.33929}{\sqrt{3.922143}\sqrt{117.4803}} = -0.9932\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(anxiety, performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9944073</code></pre>
</div>
</div>
</section>
<section id="ols-regression-y-beta_0-beta_1x-1" class="level3" data-number="16.9.11">
<h3 data-number="16.9.11" class="anchored" data-anchor-id="ols-regression-y-beta_0-beta_1x-1"><span class="header-section-number">16.9.11</span> OLS Regression <span class="math inline">\((Y = \beta_0 + \beta_1X)\)</span></h3>
<p><strong>Slope coefficient:</strong> <span class="math display">\[\beta_1 = \frac{s_{XY}}{s^2_X} = \frac{-21.33929}{3.922143} = -5.4407\]</span></p>
<p><strong>Intercept:</strong> <span class="math display">\[\beta_0 = \bar{Y} - \beta_1\bar{X}\]</span> Steps: 1. <span class="math inline">\(-5.4407 × 5.275 = -28.6997\)</span> 2. <span class="math inline">\(\beta_0 = 76.625 - (-28.6997) = 105.3247\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     anxiety 
 105.324804   -5.440721 </code></pre>
</div>
</div>
</section>
<section id="r-squared-calculation" class="level3" data-number="16.9.12">
<h3 data-number="16.9.12" class="anchored" data-anchor-id="r-squared-calculation"><span class="header-section-number">16.9.12</span> R-squared Calculation</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">\((\hat{Y})\)</span>: <span class="math display">\[\hat{Y} = 105.3247 - 5.4407X\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted values</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="fl">105.3247</span> <span class="sc">-</span> <span class="fl">5.4407</span> <span class="sc">*</span> anxiety</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Anxiety =</span> anxiety,</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Performance =</span> performance,</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> y_hat,</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Anxiety Performance Predicted
1     2.1          92  93.89923
2     3.4          88  86.82632
3     4.2          84  82.47376
4     5.1          78  77.57713
5     5.8          74  73.76864
6     6.4          70  70.50422
7     7.2          65  66.15166
8     8.0          62  61.79910</code></pre>
</div>
</div>
<p><strong>Step 2: Sum of Squares</strong></p>
<p><span class="math inline">\(SST = \sum(Y_i - \bar{Y})^2 = 822.362\)</span></p>
<p><span class="math inline">\(SSR = \sum(\hat{Y}_i - \bar{Y})^2 = 816.3094\)</span></p>
<p><span class="math inline">\(SSE = \sum(Y_i - \hat{Y}_i)^2 = 6.0526\)</span></p>
<p><strong>R-squared:</strong> <span class="math display">\[R^2 = \frac{SSR}{SST} = \frac{816.3094}{822.362} = 0.9926\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9888459</code></pre>
</div>
</div>
</section>
<section id="visualization-1" class="level3" data-number="16.9.13">
<h3 data-number="16.9.13" class="anchored" data-anchor-id="visualization-1"><span class="header-section-number">16.9.13</span> Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(anxiety, performance), <span class="fu">aes</span>(<span class="at">x =</span> anxiety, <span class="at">y =</span> performance)) <span class="sc">+</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cognitive Performance vs. Anxiety Levels"</span>,</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Anxiety (GSR)"</span>,</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Performance Score"</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation-1" class="level3" data-number="16.9.14">
<h3 data-number="16.9.14" class="anchored" data-anchor-id="interpretation-1"><span class="header-section-number">16.9.14</span> Interpretation</h3>
<ol type="1">
<li>Strong negative correlation (r = -0.993) between anxiety and cognitive performance</li>
<li>For each unit increase in GSR (anxiety), performance decreases by approximately 5.44 points</li>
<li>The model explains 99.26% of the variance in performance scores</li>
<li>The relationship appears to be strongly linear, suggesting a reliable anxiety-performance relationship</li>
<li>The high intercept (105.32) represents the theoretical maximum performance at zero anxiety</li>
</ol>
</section>
<section id="study-limitations" class="level3" data-number="16.9.15">
<h3 data-number="16.9.15" class="anchored" data-anchor-id="study-limitations"><span class="header-section-number">16.9.15</span> Study Limitations</h3>
<ol type="1">
<li>Small sample size (n=8)</li>
<li>Possible other confounding variables</li>
<li>Limited range of anxiety levels</li>
<li>Cross-sectional rather than longitudinal data</li>
</ol>
</section>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
District Magnitude and Electoral Disproportionality: A Comparative Analysis
</div>
</div>
<div class="callout-body-container callout-body">
<section id="data-generating-process" class="level3" data-number="16.9.16">
<h3 data-number="16.9.16" class="anchored" data-anchor-id="data-generating-process"><span class="header-section-number">16.9.16</span> Data Generating Process</h3>
<p>Let’s set up a DGP where:</p>
<ul>
<li>Y (Gallagher Index) = 12 - 0.8X (District Magnitude) + ε</li>
<li>ε ~ N(0, 1)</li>
<li>X values chosen: 3, 5, 7, 10, 12, 15</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DGP</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>magnitude <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">15</span>)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>gallagher <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">-</span> <span class="fl">0.8</span> <span class="sc">*</span> magnitude <span class="sc">+</span> epsilon</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Round (sampled from the DGP) Gallagher indices to one decimal place</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>gallagher <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fl">9.0</span>, <span class="fl">7.8</span>, <span class="fl">9.2</span>, <span class="fl">4.1</span>, <span class="fl">2.5</span>, <span class="fl">1.7</span>), <span class="dv">1</span>)</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Show data</span></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">District_Magnitude =</span> magnitude,</span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gallagher_Index =</span> gallagher</span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  District_Magnitude Gallagher_Index
1                  3             9.0
2                  5             7.8
3                  7             9.2
4                 10             4.1
5                 12             2.5
6                 15             1.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial model check</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(gallagher <span class="sc">~</span> magnitude)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = gallagher ~ magnitude)

Residuals:
      1       2       3       4       5       6 
-0.6516 -0.4628  2.3260 -0.6908 -0.9020  0.3813 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  11.7349     1.3034   9.003 0.000843 ***
magnitude    -0.6944     0.1359  -5.110 0.006934 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.368 on 4 degrees of freedom
Multiple R-squared:  0.8672,    Adjusted R-squared:  0.834 
F-statistic: 26.11 on 1 and 4 DF,  p-value: 0.006934</code></pre>
</div>
</div>
</section>
<section id="descriptive-statistics-1" class="level3" data-number="16.9.17">
<h3 data-number="16.9.17" class="anchored" data-anchor-id="descriptive-statistics-1"><span class="header-section-number">16.9.17</span> Descriptive Statistics</h3>
<p><strong>Means:</strong> <span class="math display">\[\bar{X} = \frac{3 + 5 + 7 + 10 + 12 + 15}{6} = \frac{52}{6} = 8.6667\]</span></p>
<p><span class="math display">\[\bar{Y} = \frac{9.0 + 7.8 + 9.2 + 4.1 + 2.5 + 1.7}{6} = \frac{34.3}{6} = 5.7167\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(magnitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.666667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.716667</code></pre>
</div>
</div>
<p><strong>Variances:</strong> <span class="math display">\[s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}\]</span></p>
<p>Deviations for X:</p>
<ul>
<li>(3 - 8.6667) = -5.6667</li>
<li>(5 - 8.6667) = -3.6667</li>
<li>(7 - 8.6667) = -1.6667</li>
<li>(10 - 8.6667) = 1.3333</li>
<li>(12 - 8.6667) = 3.3333</li>
<li>(15 - 8.6667) = 6.3333</li>
</ul>
<p>Squared deviations: 32.1115 + 13.4445 + 2.7779 + 1.7777 + 11.1109 + 40.1107 = 101.3332</p>
<p><span class="math display">\[s^2_X = \frac{101.3332}{5} = 20.2666\]</span></p>
<p>For Y: Deviations: 3.2833, 2.0833, 3.4833, -1.6167, -3.2167, -4.0167</p>
<p><span class="math display">\[s^2_Y = \frac{56.3483}{5} = 11.2697\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(magnitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.26667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.26967</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation-2" class="level3" data-number="16.9.18">
<h3 data-number="16.9.18" class="anchored" data-anchor-id="covariance-and-correlation-2"><span class="header-section-number">16.9.18</span> Covariance and Correlation</h3>
<p><strong>Covariance:</strong> <span class="math display">\[s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}\]</span></p>
<p>Products of deviations:</p>
<ul>
<li>(-5.6667 × 3.2833) = -18.6057</li>
<li>(-3.6667 × 2.0833) = -7.6387</li>
<li>(-1.6667 × 3.4833) = -5.8056</li>
<li>(1.3333 × -1.6167) = -2.1556</li>
<li>(3.3333 × -3.2167) = -10.7223</li>
<li>(6.3333 × -4.0167) = -25.4391</li>
</ul>
<p>Sum = -70.3670</p>
<p><span class="math display">\[s_{XY} = \frac{-70.3670}{5} = -14.0734\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(magnitude, gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -14.07333</code></pre>
</div>
</div>
<p><strong>Correlation:</strong> <span class="math display">\[r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{-14.0734}{\sqrt{20.2666}\sqrt{11.2697}} = -0.9279\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(magnitude, gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9312157</code></pre>
</div>
</div>
</section>
<section id="ols-regression-y-beta_0-beta_1x-2" class="level3" data-number="16.9.19">
<h3 data-number="16.9.19" class="anchored" data-anchor-id="ols-regression-y-beta_0-beta_1x-2"><span class="header-section-number">16.9.19</span> OLS Regression <span class="math inline">\((Y = \beta_0 + \beta_1X)\)</span></h3>
<p><strong>Slope coefficient:</strong> <span class="math display">\[\beta_1 = \frac{s_{XY}}{s^2_X} = \frac{-14.0734}{20.2666} = -0.6944\]</span></p>
<p><strong>Intercept:</strong> <span class="math display">\[\beta_0 = \bar{Y} - \beta_1\bar{X}\]</span> Steps: 1. <span class="math inline">\(-0.6944 × 8.6667 = -6.0181\)</span> 2. <span class="math inline">\(\beta_0 = 5.7167 - (-6.0181) = 11.7348\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)   magnitude 
 11.7348684  -0.6944079 </code></pre>
</div>
</div>
</section>
<section id="r-squared-calculation-1" class="level3" data-number="16.9.20">
<h3 data-number="16.9.20" class="anchored" data-anchor-id="r-squared-calculation-1"><span class="header-section-number">16.9.20</span> R-squared Calculation</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">\((\hat{Y})\)</span>: <span class="math display">\[\hat{Y} = 11.7348 - 0.6944X\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted values</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="fl">11.7348</span> <span class="sc">-</span> <span class="fl">0.6944</span> <span class="sc">*</span> magnitude</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Magnitude =</span> magnitude,</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gallagher =</span> gallagher,</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> y_hat,</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Magnitude Gallagher Predicted
1         3       9.0    9.6516
2         5       7.8    8.2628
3         7       9.2    6.8740
4        10       4.1    4.7908
5        12       2.5    3.4020
6        15       1.7    1.3188</code></pre>
</div>
</div>
<p><strong>Step 2: Sum of Squares</strong> <span class="math inline">\(SST = \sum(Y_i - \bar{Y})^2 = 56.3483\)</span> <span class="math inline">\(SSR = \sum(\hat{Y}_i - \bar{Y})^2 = 48.5271\)</span> <span class="math inline">\(SSE = \sum(Y_i - \hat{Y}_i)^2 = 7.8212\)</span></p>
<p><strong>R-squared:</strong> <span class="math display">\[R^2 = \frac{SSR}{SST} = \frac{48.5271}{56.3483} = 0.8612\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8671626</code></pre>
</div>
</div>
</section>
<section id="visualization---true-vs.-estimated-parameters" class="level3" data-number="16.9.21">
<h3 data-number="16.9.21" class="anchored" data-anchor-id="visualization---true-vs.-estimated-parameters"><span class="header-section-number">16.9.21</span> Visualization - True vs.&nbsp;Estimated Parameters</h3>
<ul>
<li>True DGP: Y = 12 - 0.8X + ε</li>
<li>Estimated Model: Y = 11.7348 - 0.6944X</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame with original data</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">magnitude =</span> magnitude,</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">gallagher =</span> gallagher</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sequence for smooth lines</span></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>x_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(magnitude), <span class="fu">max</span>(magnitude), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate predicted values for both lines</span></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>true_dgp <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">-</span> <span class="fl">0.8</span> <span class="sc">*</span> x_seq</span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>estimated <span class="ot">&lt;-</span> <span class="fl">11.7348</span> <span class="sc">-</span> <span class="fl">0.6944</span> <span class="sc">*</span> x_seq</span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine into a data frame for plotting</span></span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a>lines_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">magnitude =</span> <span class="fu">rep</span>(x_seq, <span class="dv">2</span>),</span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(true_dgp, estimated),</span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"True DGP"</span>, <span class="st">"Estimated"</span>), <span class="at">each =</span> <span class="fu">length</span>(x_seq))</span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb149-25"><a href="#cb149-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> lines_df, </span>
<span id="cb149-26"><a href="#cb149-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> magnitude, <span class="at">y =</span> value, <span class="at">color =</span> Model, <span class="at">linetype =</span> Model),</span>
<span id="cb149-27"><a href="#cb149-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb149-28"><a href="#cb149-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df, </span>
<span id="cb149-29"><a href="#cb149-29" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> magnitude, <span class="at">y =</span> gallagher),</span>
<span id="cb149-30"><a href="#cb149-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb149-31"><a href="#cb149-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb149-32"><a href="#cb149-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb149-33"><a href="#cb149-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"dashed"</span>, <span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb149-34"><a href="#cb149-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb149-35"><a href="#cb149-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"True DGP vs. Estimated Regression Line"</span>,</span>
<span id="cb149-36"><a href="#cb149-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Black points show observed data with random noise"</span>,</span>
<span id="cb149-37"><a href="#cb149-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"District Magnitude"</span>,</span>
<span id="cb149-38"><a href="#cb149-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gallagher Index"</span>,</span>
<span id="cb149-39"><a href="#cb149-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"True DGP: Y = 12 - 0.8X + ε</span><span class="sc">\n</span><span class="st">Estimated: Y = 11.73 - 0.69X"</span></span>
<span id="cb149-40"><a href="#cb149-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb149-41"><a href="#cb149-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb149-42"><a href="#cb149-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb149-43"><a href="#cb149-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb149-44"><a href="#cb149-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb149-45"><a href="#cb149-45" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="observations-about-model-fit" class="level3" data-number="16.9.22">
<h3 data-number="16.9.22" class="anchored" data-anchor-id="observations-about-model-fit"><span class="header-section-number">16.9.22</span> Observations about Model Fit</h3>
<ol type="1">
<li><strong>Slope Comparison</strong>
<ul>
<li>True slope: -0.8</li>
<li>Estimated slope: -0.69</li>
<li>The estimated slope is reasonably close to the true parameter</li>
</ul></li>
<li><strong>Intercept Comparison</strong>
<ul>
<li>True intercept: 12</li>
<li>Estimated intercept: 11.73</li>
<li>The estimated intercept very closely approximates the true value</li>
</ul></li>
<li><strong>Visual Patterns</strong>
<ul>
<li>The lines are nearly parallel, showing good slope recovery</li>
<li>Points scatter around both lines due to the random error term (ε)</li>
<li>The small sample size (n=6) leads to some imprecision in estimation</li>
<li>The estimated line (blue) provides a good approximation of the true DGP (red dashed)</li>
</ul></li>
<li><strong>Impact of Random Error</strong>
<ul>
<li>The scatter of points around the true DGP line reflects the N(0,1) error term</li>
<li>This noise leads to the slight differences in estimated parameters</li>
<li>With a larger sample, we would expect even closer convergence to true parameters</li>
</ul></li>
</ol>
</section>
<section id="interpretation-2" class="level3" data-number="16.9.23">
<h3 data-number="16.9.23" class="anchored" data-anchor-id="interpretation-2"><span class="header-section-number">16.9.23</span> Interpretation</h3>
<ol type="1">
<li>Strong negative correlation (r = -0.93) between district magnitude and electoral disproportionality</li>
<li>For each unit increase in district magnitude, the Gallagher index decreases by approximately 0.69 points</li>
<li>The model explains 86.12% of the variance in disproportionality</li>
<li>The relationship appears strongly linear with moderate scatter</li>
<li>The intercept (11.73) represents the expected disproportionality in a hypothetical single-member district system</li>
</ol>
</section>
<section id="study-context" class="level3" data-number="16.9.24">
<h3 data-number="16.9.24" class="anchored" data-anchor-id="study-context"><span class="header-section-number">16.9.24</span> Study Context</h3>
<ul>
<li>Data represents simulated observations from a DGP with moderate noise</li>
<li>Sample shows how increasing district magnitude tends to reduce disproportionality</li>
<li>Random component reflects other institutional and political factors affecting disproportionality</li>
</ul>
</section>
<section id="limitations" class="level3" data-number="16.9.25">
<h3 data-number="16.9.25" class="anchored" data-anchor-id="limitations"><span class="header-section-number">16.9.25</span> Limitations</h3>
<ol type="1">
<li>Small sample size (n=6)</li>
<li>Simulated rather than real-world data</li>
<li>Assumes linear relationship</li>
<li>Does not account for other institutional features</li>
</ol>
</section>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./correg_en.html" class="pagination-link" aria-label="Introduction to Correlation and Regression Analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./probability_en.html" class="pagination-link" aria-label="Introduction to Probability">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction to Probability</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>