<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>16&nbsp; Wprowadzenie do Analizy Korelacji i Regresji – Social Data Analysis: An Introduction (Wprowadzenie do analizy danych społecznych)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./probability_en.html" rel="next">
<link href="./correg_en.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./correg_pl.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Social Data Analysis: An Introduction (Wprowadzenie do analizy danych społecznych)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Science and Statistics for Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wprowadzenie do Nauki o Danych i Statystyki dla Nauk Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Zrozumienie Typów Danych w Naukach Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">From Sample to Population - Understanding Randomness, Sampling, and Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Od Próby do Populacji - Zrozumienie Losowości, Próbkowania i Wnioskowania</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reliability and Validity in Data Science Research</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Rzetelność i Trafność w Badaniach Nauk o Danych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Research Designs: Experimental and Non-Experimental Approaches</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Projekty Badawcze: Podejścia Eksperymentalne i Nieeksperymentalne</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fundamentals of Univariate Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Podstawy Jednowymiarowej Statystyki Opisowej</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data Visualization: with examples in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Wizualizacja Danych: z przykładami w R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_pl.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction to Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Wprowadzenie do Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Introduction to Statistical Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Wprowadzenie do Wnioskowania Statystycznego</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#statystyki-dwuwymiarowe" id="toc-statystyki-dwuwymiarowe" class="nav-link active" data-scroll-target="#statystyki-dwuwymiarowe"><span class="header-section-number">16.1</span> Statystyki Dwuwymiarowe</a>
  <ul class="collapse">
  <li><a href="#kowariancja" id="toc-kowariancja" class="nav-link" data-scroll-target="#kowariancja"><span class="header-section-number">16.1.6</span> Kowariancja</a></li>
  <li><a href="#korelacja-pearsona" id="toc-korelacja-pearsona" class="nav-link" data-scroll-target="#korelacja-pearsona"><span class="header-section-number">16.1.13</span> Korelacja Pearsona</a></li>
  <li><a href="#korelacja-spearmana" id="toc-korelacja-spearmana" class="nav-link" data-scroll-target="#korelacja-spearmana"><span class="header-section-number">16.1.14</span> Korelacja Spearmana</a></li>
  <li><a href="#tabela-krzyżowa" id="toc-tabela-krzyżowa" class="nav-link" data-scroll-target="#tabela-krzyżowa"><span class="header-section-number">16.1.15</span> Tabela Krzyżowa</a></li>
  <li><a href="#wybór-odpowiedniej-miary" id="toc-wybór-odpowiedniej-miary" class="nav-link" data-scroll-target="#wybór-odpowiedniej-miary"><span class="header-section-number">16.1.16</span> Wybór Odpowiedniej Miary</a></li>
  </ul></li>
  <li><a href="#wprowadzenie-do-podstawowej-statystyki-wielowymiarowej" id="toc-wprowadzenie-do-podstawowej-statystyki-wielowymiarowej" class="nav-link" data-scroll-target="#wprowadzenie-do-podstawowej-statystyki-wielowymiarowej"><span class="header-section-number">16.2</span> Wprowadzenie do Podstawowej Statystyki Wielowymiarowej (*)</a>
  <ul class="collapse">
  <li><a href="#macierz-korelacji" id="toc-macierz-korelacji" class="nav-link" data-scroll-target="#macierz-korelacji"><span class="header-section-number">16.2.1</span> Macierz Korelacji</a></li>
  <li><a href="#wizualizacja-związków-wielowymiarowych" id="toc-wizualizacja-związków-wielowymiarowych" class="nav-link" data-scroll-target="#wizualizacja-związków-wielowymiarowych"><span class="header-section-number">16.2.2</span> Wizualizacja Związków Wielowymiarowych</a></li>
  <li><a href="#korelacja-cząstkowa" id="toc-korelacja-cząstkowa" class="nav-link" data-scroll-target="#korelacja-cząstkowa"><span class="header-section-number">16.2.3</span> Korelacja Cząstkowa</a></li>
  <li><a href="#korelacja-wielokrotna" id="toc-korelacja-wielokrotna" class="nav-link" data-scroll-target="#korelacja-wielokrotna"><span class="header-section-number">16.2.4</span> Korelacja Wielokrotna</a></li>
  <li><a href="#analiza-czynnikowa" id="toc-analiza-czynnikowa" class="nav-link" data-scroll-target="#analiza-czynnikowa"><span class="header-section-number">16.2.5</span> Analiza Czynnikowa</a></li>
  <li><a href="#uwagi-dotyczące-analizy-wielowymiarowej" id="toc-uwagi-dotyczące-analizy-wielowymiarowej" class="nav-link" data-scroll-target="#uwagi-dotyczące-analizy-wielowymiarowej"><span class="header-section-number">16.2.6</span> Uwagi dotyczące Analizy Wielowymiarowej</a></li>
  <li><a href="#podsumowanie" id="toc-podsumowanie" class="nav-link" data-scroll-target="#podsumowanie"><span class="header-section-number">16.2.7</span> Podsumowanie</a></li>
  </ul></li>
  <li><a href="#wprowadzenie-do-analizy-regresji" id="toc-wprowadzenie-do-analizy-regresji" class="nav-link" data-scroll-target="#wprowadzenie-do-analizy-regresji"><span class="header-section-number">16.3</span> Wprowadzenie do Analizy Regresji</a>
  <ul class="collapse">
  <li><a href="#podstawowe-pojęcia-i-terminologia" id="toc-podstawowe-pojęcia-i-terminologia" class="nav-link" data-scroll-target="#podstawowe-pojęcia-i-terminologia"><span class="header-section-number">16.3.6</span> Podstawowe Pojęcia i Terminologia</a></li>
  <li><a href="#główna-idea" id="toc-główna-idea" class="nav-link" data-scroll-target="#główna-idea"><span class="header-section-number">16.3.7</span> Główna Idea</a></li>
  </ul></li>
  <li><a href="#model-regresji-liniowej" id="toc-model-regresji-liniowej" class="nav-link" data-scroll-target="#model-regresji-liniowej"><span class="header-section-number">16.4</span> Model Regresji Liniowej</a>
  <ul class="collapse">
  <li><a href="#model-populacyjny-vs.-oszacowania-z-próby" id="toc-model-populacyjny-vs.-oszacowania-z-próby" class="nav-link" data-scroll-target="#model-populacyjny-vs.-oszacowania-z-próby"><span class="header-section-number">16.4.1</span> Model Populacyjny vs.&nbsp;Oszacowania z Próby</a></li>
  </ul></li>
  <li><a href="#kluczowe-założenia-regresji-liniowej" id="toc-kluczowe-założenia-regresji-liniowej" class="nav-link" data-scroll-target="#kluczowe-założenia-regresji-liniowej"><span class="header-section-number">16.5</span> Kluczowe Założenia Regresji Liniowej</a>
  <ul class="collapse">
  <li><a href="#ścisła-egzogeniczność-podstawowe-założenie" id="toc-ścisła-egzogeniczność-podstawowe-założenie" class="nav-link" data-scroll-target="#ścisła-egzogeniczność-podstawowe-założenie"><span class="header-section-number">16.5.1</span> Ścisła Egzogeniczność: Podstawowe Założenie</a></li>
  <li><a href="#liniowość-założenie-o-formie" id="toc-liniowość-założenie-o-formie" class="nav-link" data-scroll-target="#liniowość-założenie-o-formie"><span class="header-section-number">16.5.2</span> Liniowość: Założenie o Formie</a></li>
  <li><a href="#zrozumienie-naruszeń-i-rozwiązania" id="toc-zrozumienie-naruszeń-i-rozwiązania" class="nav-link" data-scroll-target="#zrozumienie-naruszeń-i-rozwiązania"><span class="header-section-number">16.5.3</span> Zrozumienie Naruszeń i Rozwiązania</a></li>
  </ul></li>
  <li><a href="#ocena-dopasowania-modelu" id="toc-ocena-dopasowania-modelu" class="nav-link" data-scroll-target="#ocena-dopasowania-modelu"><span class="header-section-number">16.6</span> Ocena Dopasowania Modelu</a>
  <ul class="collapse">
  <li><a href="#dekompozycja-wariancji" id="toc-dekompozycja-wariancji" class="nav-link" data-scroll-target="#dekompozycja-wariancji"><span class="header-section-number">16.6.1</span> Dekompozycja Wariancji</a></li>
  <li><a href="#trzy-komponenty-wariancji" id="toc-trzy-komponenty-wariancji" class="nav-link" data-scroll-target="#trzy-komponenty-wariancji"><span class="header-section-number">16.6.2</span> Trzy Komponenty Wariancji</a></li>
  <li><a href="#współczynnik-r²---wyjaśnienie" id="toc-współczynnik-r²---wyjaśnienie" class="nav-link" data-scroll-target="#współczynnik-r²---wyjaśnienie"><span class="header-section-number">16.6.3</span> Współczynnik R² - Wyjaśnienie</a></li>
  <li><a href="#kiedy-zachować-ostrożność" id="toc-kiedy-zachować-ostrożność" class="nav-link" data-scroll-target="#kiedy-zachować-ostrożność"><span class="header-section-number">16.6.4</span> Kiedy Zachować Ostrożność</a></li>
  <li><a href="#praktyczne-wskazówki-do-analizy" id="toc-praktyczne-wskazówki-do-analizy" class="nav-link" data-scroll-target="#praktyczne-wskazówki-do-analizy"><span class="header-section-number">16.6.5</span> Praktyczne Wskazówki do Analizy</a></li>
  <li><a href="#kluczowe-wnioski-1" id="toc-kluczowe-wnioski-1" class="nav-link" data-scroll-target="#kluczowe-wnioski-1"><span class="header-section-number">16.6.6</span> Kluczowe Wnioski</a></li>
  <li><a href="#miary-dopasowania" id="toc-miary-dopasowania" class="nav-link" data-scroll-target="#miary-dopasowania"><span class="header-section-number">16.6.7</span> Miary Dopasowania</a></li>
  </ul></li>
  <li><a href="#regresja-wieloraka" id="toc-regresja-wieloraka" class="nav-link" data-scroll-target="#regresja-wieloraka"><span class="header-section-number">16.7</span> Regresja Wieloraka (*)</a>
  <ul class="collapse">
  <li><a href="#rozszerzenie-do-wielu-predyktorów" id="toc-rozszerzenie-do-wielu-predyktorów" class="nav-link" data-scroll-target="#rozszerzenie-do-wielu-predyktorów"><span class="header-section-number">16.7.1</span> Rozszerzenie do Wielu Predyktorów</a></li>
  <li><a href="#interpretacja-współczynników" id="toc-interpretacja-współczynników" class="nav-link" data-scroll-target="#interpretacja-współczynników"><span class="header-section-number">16.7.2</span> Interpretacja Współczynników</a></li>
  <li><a href="#współliniowość" id="toc-współliniowość" class="nav-link" data-scroll-target="#współliniowość"><span class="header-section-number">16.7.3</span> Współliniowość</a></li>
  </ul></li>
  <li><a href="#tematy-zaawansowane" id="toc-tematy-zaawansowane" class="nav-link" data-scroll-target="#tematy-zaawansowane"><span class="header-section-number">16.8</span> Tematy Zaawansowane</a>
  <ul class="collapse">
  <li><a href="#efekty-interakcji" id="toc-efekty-interakcji" class="nav-link" data-scroll-target="#efekty-interakcji"><span class="header-section-number">16.8.1</span> Efekty Interakcji</a></li>
  <li><a href="#wyrazy-wielomianowe" id="toc-wyrazy-wielomianowe" class="nav-link" data-scroll-target="#wyrazy-wielomianowe"><span class="header-section-number">16.8.2</span> Wyrazy Wielomianowe</a></li>
  </ul></li>
  <li><a href="#praktyczne-wskazówki-do-analizy-regresji" id="toc-praktyczne-wskazówki-do-analizy-regresji" class="nav-link" data-scroll-target="#praktyczne-wskazówki-do-analizy-regresji"><span class="header-section-number">16.9</span> Praktyczne Wskazówki do Analizy Regresji</a>
  <ul class="collapse">
  <li><a href="#proces-budowy-modelu" id="toc-proces-budowy-modelu" class="nav-link" data-scroll-target="#proces-budowy-modelu"><span class="header-section-number">16.9.1</span> Proces Budowy Modelu</a></li>
  <li><a href="#typowe-pułapki-i-rozwiązania" id="toc-typowe-pułapki-i-rozwiązania" class="nav-link" data-scroll-target="#typowe-pułapki-i-rozwiązania"><span class="header-section-number">16.9.2</span> Typowe Pułapki i Rozwiązania</a></li>
  </ul></li>
  <li><a href="#najlepsze-praktyki" id="toc-najlepsze-praktyki" class="nav-link" data-scroll-target="#najlepsze-praktyki"><span class="header-section-number">16.10</span> Najlepsze Praktyki</a>
  <ul class="collapse">
  <li><a href="#walidacja-modelu" id="toc-walidacja-modelu" class="nav-link" data-scroll-target="#walidacja-modelu"><span class="header-section-number">16.10.1</span> Walidacja Modelu</a></li>
  <li><a href="#prezentacja-wyników" id="toc-prezentacja-wyników" class="nav-link" data-scroll-target="#prezentacja-wyników"><span class="header-section-number">16.10.2</span> Prezentacja Wyników</a></li>
  </ul></li>
  <li><a href="#podsumowanie-1" id="toc-podsumowanie-1" class="nav-link" data-scroll-target="#podsumowanie-1"><span class="header-section-number">16.11</span> Podsumowanie</a>
  <ul class="collapse">
  <li><a href="#kluczowe-wnioski-4" id="toc-kluczowe-wnioski-4" class="nav-link" data-scroll-target="#kluczowe-wnioski-4"><span class="header-section-number">16.11.1</span> Kluczowe Wnioski</a></li>
  <li><a href="#literatura-uzupełniająca" id="toc-literatura-uzupełniająca" class="nav-link" data-scroll-target="#literatura-uzupełniająca">Literatura Uzupełniająca</a></li>
  </ul></li>
  <li><a href="#dodatek-a.1-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-z-obliczeniami" id="toc-dodatek-a.1-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-z-obliczeniami" class="nav-link" data-scroll-target="#dodatek-a.1-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-z-obliczeniami"><span class="header-section-number">16.12</span> Dodatek A.1: Obliczanie Kowariancji, Korelacji Pearsona i Spearmana, oraz modelowanie OLS - przykład z obliczeniami</a>
  <ul class="collapse">
  <li><a href="#krok-1-obliczanie-podstawowych-statystyk" id="toc-krok-1-obliczanie-podstawowych-statystyk" class="nav-link" data-scroll-target="#krok-1-obliczanie-podstawowych-statystyk"><span class="header-section-number">16.12.1</span> Krok 1: Obliczanie Podstawowych Statystyk</a></li>
  <li><a href="#krok-2-szczegółowe-obliczenia-kowariancji" id="toc-krok-2-szczegółowe-obliczenia-kowariancji" class="nav-link" data-scroll-target="#krok-2-szczegółowe-obliczenia-kowariancji"><span class="header-section-number">16.12.2</span> Krok 2: Szczegółowe Obliczenia Kowariancji</a></li>
  <li><a href="#krok-3-obliczanie-odchylenia-standardowego" id="toc-krok-3-obliczanie-odchylenia-standardowego" class="nav-link" data-scroll-target="#krok-3-obliczanie-odchylenia-standardowego"><span class="header-section-number">16.12.3</span> Krok 3: Obliczanie Odchylenia Standardowego</a></li>
  <li><a href="#krok-4-obliczanie-korelacji-pearsona" id="toc-krok-4-obliczanie-korelacji-pearsona" class="nav-link" data-scroll-target="#krok-4-obliczanie-korelacji-pearsona"><span class="header-section-number">16.12.4</span> Krok 4: Obliczanie Korelacji Pearsona</a></li>
  <li><a href="#krok-5-obliczanie-korelacji-rangowej-spearmana" id="toc-krok-5-obliczanie-korelacji-rangowej-spearmana" class="nav-link" data-scroll-target="#krok-5-obliczanie-korelacji-rangowej-spearmana"><span class="header-section-number">16.12.5</span> Krok 5: Obliczanie Korelacji Rangowej Spearmana</a></li>
  <li><a href="#krok-6-weryfikacja-w-r" id="toc-krok-6-weryfikacja-w-r" class="nav-link" data-scroll-target="#krok-6-weryfikacja-w-r"><span class="header-section-number">16.12.6</span> Krok 6: Weryfikacja w R</a></li>
  <li><a href="#krok-7-podstawowa-wizualizacja" id="toc-krok-7-podstawowa-wizualizacja" class="nav-link" data-scroll-target="#krok-7-podstawowa-wizualizacja"><span class="header-section-number">16.12.7</span> Krok 7: Podstawowa Wizualizacja</a></li>
  <li><a href="#estymacja-ols-i-miary-dopasowania-modelu" id="toc-estymacja-ols-i-miary-dopasowania-modelu" class="nav-link" data-scroll-target="#estymacja-ols-i-miary-dopasowania-modelu"><span class="header-section-number">16.12.8</span> Estymacja OLS i Miary Dopasowania Modelu</a></li>
  <li><a href="#krok-1-obliczanie-estymatorów-ols" id="toc-krok-1-obliczanie-estymatorów-ols" class="nav-link" data-scroll-target="#krok-1-obliczanie-estymatorów-ols"><span class="header-section-number">16.12.9</span> Krok 1: Obliczanie Estymatorów OLS</a></li>
  <li><a href="#krok-2-obliczanie-wartości-dopasowanych-i-reszt" id="toc-krok-2-obliczanie-wartości-dopasowanych-i-reszt" class="nav-link" data-scroll-target="#krok-2-obliczanie-wartości-dopasowanych-i-reszt"><span class="header-section-number">16.12.10</span> Krok 2: Obliczanie Wartości Dopasowanych i Reszt</a></li>
  <li><a href="#krok-3-obliczanie-miar-dopasowania" id="toc-krok-3-obliczanie-miar-dopasowania" class="nav-link" data-scroll-target="#krok-3-obliczanie-miar-dopasowania"><span class="header-section-number">16.12.11</span> Krok 3: Obliczanie Miar Dopasowania</a></li>
  <li><a href="#krok-4-weryfikacja-w-r" id="toc-krok-4-weryfikacja-w-r" class="nav-link" data-scroll-target="#krok-4-weryfikacja-w-r"><span class="header-section-number">16.12.12</span> Krok 4: Weryfikacja w R</a></li>
  <li><a href="#krok-5-analiza-reszt" id="toc-krok-5-analiza-reszt" class="nav-link" data-scroll-target="#krok-5-analiza-reszt"><span class="header-section-number">16.12.13</span> Krok 5: Analiza Reszt</a></li>
  <li><a href="#krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych" id="toc-krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych" class="nav-link" data-scroll-target="#krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych"><span class="header-section-number">16.12.14</span> Krok 6: Wykres Wartości Przewidywanych vs Rzeczywistych</a></li>
  <li><a href="#modele-z-transformacją-logarytmiczną" id="toc-modele-z-transformacją-logarytmiczną" class="nav-link" data-scroll-target="#modele-z-transformacją-logarytmiczną"><span class="header-section-number">16.12.15</span> Modele z Transformacją Logarytmiczną</a></li>
  <li><a href="#krok-1-transformacja-danych" id="toc-krok-1-transformacja-danych" class="nav-link" data-scroll-target="#krok-1-transformacja-danych"><span class="header-section-number">16.12.16</span> Krok 1: Transformacja Danych</a></li>
  <li><a href="#krok-2-porównanie-różnych-specyfikacji-modelu" id="toc-krok-2-porównanie-różnych-specyfikacji-modelu" class="nav-link" data-scroll-target="#krok-2-porównanie-różnych-specyfikacji-modelu"><span class="header-section-number">16.12.17</span> Krok 2: Porównanie Różnych Specyfikacji Modelu</a></li>
  <li><a href="#krok-3-porównanie-wizualne" id="toc-krok-3-porównanie-wizualne" class="nav-link" data-scroll-target="#krok-3-porównanie-wizualne"><span class="header-section-number">16.12.18</span> Krok 3: Porównanie Wizualne</a></li>
  <li><a href="#krok-4-analiza-reszt-dla-najlepszego-modelu" id="toc-krok-4-analiza-reszt-dla-najlepszego-modelu" class="nav-link" data-scroll-target="#krok-4-analiza-reszt-dla-najlepszego-modelu"><span class="header-section-number">16.12.19</span> Krok 4: Analiza Reszt dla Najlepszego Modelu</a></li>
  <li><a href="#krok-5-interpretacja-najlepszego-modelu" id="toc-krok-5-interpretacja-najlepszego-modelu" class="nav-link" data-scroll-target="#krok-5-interpretacja-najlepszego-modelu"><span class="header-section-number">16.12.20</span> Krok 5: Interpretacja Najlepszego Modelu</a></li>
  <li><a href="#krok-6-predykcje-modelu" id="toc-krok-6-predykcje-modelu" class="nav-link" data-scroll-target="#krok-6-predykcje-modelu"><span class="header-section-number">16.12.21</span> Krok 6: Predykcje Modelu</a></li>
  <li><a href="#krok-7-analiza-elastyczności" id="toc-krok-7-analiza-elastyczności" class="nav-link" data-scroll-target="#krok-7-analiza-elastyczności"><span class="header-section-number">16.12.22</span> Krok 7: Analiza Elastyczności</a></li>
  </ul></li>
  <li><a href="#dodatek-a.2-porównanie-popularnych-miar-korelacji-pearson-spearman-i-kendall" id="toc-dodatek-a.2-porównanie-popularnych-miar-korelacji-pearson-spearman-i-kendall" class="nav-link" data-scroll-target="#dodatek-a.2-porównanie-popularnych-miar-korelacji-pearson-spearman-i-kendall"><span class="header-section-number">16.13</span> Dodatek A.2: Porównanie Popularnych Miar Korelacji: Pearson, Spearman i Kendall</a>
  <ul class="collapse">
  <li><a href="#zbiór-danych" id="toc-zbiór-danych" class="nav-link" data-scroll-target="#zbiór-danych"><span class="header-section-number">16.13.1</span> Zbiór Danych</a></li>
  <li><a href="#korelacja-pearsona-1" id="toc-korelacja-pearsona-1" class="nav-link" data-scroll-target="#korelacja-pearsona-1"><span class="header-section-number">16.13.2</span> Korelacja Pearsona</a></li>
  <li><a href="#korelacja-spearmana-1" id="toc-korelacja-spearmana-1" class="nav-link" data-scroll-target="#korelacja-spearmana-1"><span class="header-section-number">16.13.3</span> Korelacja Spearmana</a></li>
  <li><a href="#tau-kendalla" id="toc-tau-kendalla" class="nav-link" data-scroll-target="#tau-kendalla"><span class="header-section-number">16.13.4</span> Tau Kendalla</a></li>
  <li><a href="#weryfikacja-w-r" id="toc-weryfikacja-w-r" class="nav-link" data-scroll-target="#weryfikacja-w-r"><span class="header-section-number">16.13.5</span> Weryfikacja w R</a></li>
  <li><a href="#interpretacja-wyników" id="toc-interpretacja-wyników" class="nav-link" data-scroll-target="#interpretacja-wyników"><span class="header-section-number">16.13.6</span> Interpretacja Wyników</a></li>
  <li><a href="#porównanie-miar" id="toc-porównanie-miar" class="nav-link" data-scroll-target="#porównanie-miar"><span class="header-section-number">16.13.7</span> Porównanie Miar</a></li>
  </ul></li>
  <li><a href="#appendix-b." id="toc-appendix-b." class="nav-link" data-scroll-target="#appendix-b."><span class="header-section-number">16.14</span> Appendix B.</a></li>
  <li><a href="#appendix-c.-przykłady" id="toc-appendix-c.-przykłady" class="nav-link" data-scroll-target="#appendix-c.-przykłady"><span class="header-section-number">16.15</span> Appendix C. Przykłady</a></li>
  <li><a href="#descriptive-statistics-and-ols-example---income-and-voter-turnout" id="toc-descriptive-statistics-and-ols-example---income-and-voter-turnout" class="nav-link" data-scroll-target="#descriptive-statistics-and-ols-example---income-and-voter-turnout"><span class="header-section-number">16.16</span> Descriptive Statistics and OLS Example - Income and Voter Turnout</a>
  <ul class="collapse">
  <li><a href="#initial-r-output-for-reference" id="toc-initial-r-output-for-reference" class="nav-link" data-scroll-target="#initial-r-output-for-reference"><span class="header-section-number">16.16.1</span> Initial R Output for Reference</a></li>
  <li><a href="#dispersion-measures" id="toc-dispersion-measures" class="nav-link" data-scroll-target="#dispersion-measures"><span class="header-section-number">16.16.2</span> Dispersion Measures</a></li>
  <li><a href="#covariance-and-correlation" id="toc-covariance-and-correlation" class="nav-link" data-scroll-target="#covariance-and-correlation"><span class="header-section-number">16.16.3</span> Covariance and Correlation</a></li>
  <li><a href="#ols-regression-haty-hatbeta_0-hatbeta_1x" id="toc-ols-regression-haty-hatbeta_0-hatbeta_1x" class="nav-link" data-scroll-target="#ols-regression-haty-hatbeta_0-hatbeta_1x"><span class="header-section-number">16.16.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></a></li>
  <li><a href="#detailed-decomposition-of-variance-and-r-squared" id="toc-detailed-decomposition-of-variance-and-r-squared" class="nav-link" data-scroll-target="#detailed-decomposition-of-variance-and-r-squared"><span class="header-section-number">16.16.5</span> Detailed Decomposition of Variance and R-squared</a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization"><span class="header-section-number">16.16.6</span> Visualization</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation"><span class="header-section-number">16.16.7</span> Interpretation</a></li>
  </ul></li>
  <li><a href="#anxiety-levels-and-cognitive-performance-a-laboratory-study" id="toc-anxiety-levels-and-cognitive-performance-a-laboratory-study" class="nav-link" data-scroll-target="#anxiety-levels-and-cognitive-performance-a-laboratory-study"><span class="header-section-number">16.17</span> Anxiety Levels and Cognitive Performance: A Laboratory Study</a>
  <ul class="collapse">
  <li><a href="#data-and-context" id="toc-data-and-context" class="nav-link" data-scroll-target="#data-and-context"><span class="header-section-number">16.17.1</span> Data and Context</a></li>
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics"><span class="header-section-number">16.17.2</span> Descriptive Statistics</a></li>
  <li><a href="#covariance-and-correlation-1" id="toc-covariance-and-correlation-1" class="nav-link" data-scroll-target="#covariance-and-correlation-1"><span class="header-section-number">16.17.3</span> Covariance and Correlation</a></li>
  <li><a href="#ols-regression-haty-hatbeta_0-hatbeta_1x-1" id="toc-ols-regression-haty-hatbeta_0-hatbeta_1x-1" class="nav-link" data-scroll-target="#ols-regression-haty-hatbeta_0-hatbeta_1x-1"><span class="header-section-number">16.17.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></a></li>
  <li><a href="#r-squared-calculation" id="toc-r-squared-calculation" class="nav-link" data-scroll-target="#r-squared-calculation"><span class="header-section-number">16.17.5</span> 4. R-squared Calculation</a></li>
  <li><a href="#visualization-1" id="toc-visualization-1" class="nav-link" data-scroll-target="#visualization-1"><span class="header-section-number">16.17.6</span> Visualization</a></li>
  <li><a href="#interpretation-1" id="toc-interpretation-1" class="nav-link" data-scroll-target="#interpretation-1"><span class="header-section-number">16.17.7</span> Interpretation</a></li>
  <li><a href="#study-limitations" id="toc-study-limitations" class="nav-link" data-scroll-target="#study-limitations"><span class="header-section-number">16.17.8</span> Study Limitations</a></li>
  </ul></li>
  <li><a href="#district-magnitude-and-electoral-disproportionality-a-comparative-analysis" id="toc-district-magnitude-and-electoral-disproportionality-a-comparative-analysis" class="nav-link" data-scroll-target="#district-magnitude-and-electoral-disproportionality-a-comparative-analysis"><span class="header-section-number">16.18</span> District Magnitude and Electoral Disproportionality: A Comparative Analysis</a>
  <ul class="collapse">
  <li><a href="#data-generating-process" id="toc-data-generating-process" class="nav-link" data-scroll-target="#data-generating-process"><span class="header-section-number">16.18.1</span> Data Generating Process</a></li>
  <li><a href="#descriptive-statistics-1" id="toc-descriptive-statistics-1" class="nav-link" data-scroll-target="#descriptive-statistics-1"><span class="header-section-number">16.18.2</span> Descriptive Statistics</a></li>
  <li><a href="#covariance-and-correlation-2" id="toc-covariance-and-correlation-2" class="nav-link" data-scroll-target="#covariance-and-correlation-2"><span class="header-section-number">16.18.3</span> Covariance and Correlation</a></li>
  <li><a href="#ols-regression-haty-hatbeta_0-hatbeta_1x-2" id="toc-ols-regression-haty-hatbeta_0-hatbeta_1x-2" class="nav-link" data-scroll-target="#ols-regression-haty-hatbeta_0-hatbeta_1x-2"><span class="header-section-number">16.18.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></a></li>
  <li><a href="#r-squared-calculation-1" id="toc-r-squared-calculation-1" class="nav-link" data-scroll-target="#r-squared-calculation-1"><span class="header-section-number">16.18.5</span> R-squared Calculation</a></li>
  <li><a href="#visualization---true-vs.-estimated-parameters" id="toc-visualization---true-vs.-estimated-parameters" class="nav-link" data-scroll-target="#visualization---true-vs.-estimated-parameters"><span class="header-section-number">16.18.6</span> Visualization - True vs.&nbsp;Estimated Parameters</a></li>
  <li><a href="#observations-about-model-fit" id="toc-observations-about-model-fit" class="nav-link" data-scroll-target="#observations-about-model-fit"><span class="header-section-number">16.18.7</span> Observations about Model Fit</a></li>
  <li><a href="#interpretation-2" id="toc-interpretation-2" class="nav-link" data-scroll-target="#interpretation-2"><span class="header-section-number">16.18.8</span> Interpretation</a></li>
  <li><a href="#study-context" id="toc-study-context" class="nav-link" data-scroll-target="#study-context"><span class="header-section-number">16.18.9</span> Study Context</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations"><span class="header-section-number">16.18.10</span> Limitations</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="statystyki-dwuwymiarowe" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="statystyki-dwuwymiarowe"><span class="header-section-number">16.1</span> Statystyki Dwuwymiarowe</h2>
<p>Statystyki dwuwymiarowe opisują związek między dwiema zmiennymi. Omówimy kilka miar, zaczynając od kowariancji.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Analiza Zależności Zmiennych w Badaniach Społecznych
</div>
</div>
<div class="callout-body-container callout-body">
<p>W tej sekcji przeanalizujemy, w jaki sposób różne zmienne społeczne wchodzą ze sobą w interakcje i korelują. Zbadamy cztery charakterystyczne typy zależności często obserwowane w naukach społecznych, wykorzystując empiryczne przykłady do zilustrowania kluczowych wzorców i ich znaczenia dla analizy danych.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Analiza Zależności między Zmiennymi:</p>
<ol type="1">
<li><strong>Dodatnia Korelacja Liniowa</strong> (Dostęp do Opieki Zdrowotnej a Długość Życia)</li>
</ol>
<p>Dane wykazują dodatnią zależność liniową między dostępem do opieki zdrowotnej a oczekiwaną długością życia. Analiza statystyczna wskazuje, że wzrost dostępności opieki zdrowotnej o 10 punktów procentowych koreluje z wydłużeniem oczekiwanej długości życia o około 2,5 roku. Zależność ta utrzymuje istotność statystyczną w całym obserwowanym zakresie.</p>
<ol start="2" type="1">
<li><strong>Ujemna Korelacja Liniowa</strong> (Użytkowanie Urządzeń Cyfrowych a Jakość Snu)</li>
</ol>
<p>Analiza ujawnia odwrotną zależność między czasem spędzonym przed ekranami urządzeń cyfrowych a wskaźnikami jakości snu. Dane wskazują, że każda dodatkowa godzina użytkowania urządzeń koreluje z mierzalnym spadkiem wskaźników jakości snu, wykazując spójną negatywną zależność liniową.</p>
<ol start="3" type="1">
<li><strong>Brak Korelacji</strong> (Infrastruktura a Wskaźniki Ekonomiczne (np. GDP per capita in PLN))</li>
</ol>
<p>Zależność między gęstością infrastruktury a wskaźnikami ekonomicznymi (np. GDP per capita in PLN) nie wykazuje statystycznie istotnej korelacji. Ten brak korelacji sugeruje, że zmienne te funkcjonują niezależnie w ramach obserwowanych parametrów, wskazując na obecność innych czynników determinujących, nieuwzględnionych w tej analizie.</p>
<ol start="4" type="1">
<li><strong>Zależność Nieliniowa</strong> (Wielkość Zespołu a Produktywność)</li>
</ol>
<p>Zależność między wielkością zespołu a produktywnością wykazuje charakterystykę krzywoliniową. Dane wskazują na istnienie optymalnego przedziału liczebności zespołu, przy czym produktywność maleje zarówno poniżej, jak i powyżej tego przedziału. Pokazuje to, jak ważne jest uwzględnianie wzorców nieliniowych w badaniach organizacyjnych.</p>
<p>Aspekty Metodologiczne:</p>
<ol type="1">
<li><p><strong>Istotność Statystyczna</strong>: Obserwowane zależności wymagają weryfikacji pod kątem istotności statystycznej przed wyciągnięciem wniosków.</p></li>
<li><p><strong>Niezależność Zmiennych</strong>: Założenie o niezależności zmiennych wymaga weryfikacji poprzez odpowiednie testy statystyczne.</p></li>
<li><p><strong>Zmienne Zakłócające</strong>: Analizy muszą uwzględniać potencjalne zmienne zakłócające, które mogą wpływać na obserwowane zależności.</p></li>
<li><p><strong>Przyczynowość</strong>: Wzorce korelacji nie implikują koniecznie związków przyczynowych; ustalenie przyczynowości wymaga zastosowania dodatkowych metod badawczych.</p></li>
</ol>
<p>Zastosowania Badawcze:</p>
<p>Zrozumienie tych wzorców zależności ma istotne znaczenie dla:</p>
<ul>
<li>Projektowania i metodologii badań</li>
<li>Procedur analizy statystycznej</li>
<li>Rozwoju i testowania teorii</li>
</ul>
<p>Krytyczna ocena tych zależności umożliwia bardziej rzetelne projektowanie badań i formułowanie wiarygodnych wniosków w naukach społecznych.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Rozróżnienie między Korelacją a Przyczynowością [Zob. np. https://www.tylervigen.com/spurious-correlations]
</div>
</div>
<div class="callout-body-container callout-body">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/EmIodcqXEAMRW83.jpeg" class="img-fluid figure-img"></p>
<figcaption>https://x.com/EUFIC/status/1324667630238814209?prefetchTimestamp=1732463940216</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/IMG_4580.png" class="img-fluid figure-img"></p>
<figcaption>https://sitn.hms.harvard.edu/flash/2021/when-correlation-does-not-imply-causation-why-your-gut-microbes-may-not-yet-be-a-silver-bullet-to-all-your-problems/</figcaption>
</figure>
</div>
<p>Zależności statystyczne między zmiennymi stanowią jeden z najczęściej błędnie interpretowanych aspektów analizy danych. Mimo że korelacje mogą ujawniać wzorce w danych, wymagają starannej interpretacji, aby uniknąć wyciągania nieprawidłowych wniosków przyczynowych. Przeanalizujmy to zagadnienie na przykładach.</p>
<section id="wzorce-sezonowe-i-pozorne-korelacje-studium-przypadku" class="level3" data-number="16.1.1">
<h3 data-number="16.1.1" class="anchored" data-anchor-id="wzorce-sezonowe-i-pozorne-korelacje-studium-przypadku"><span class="header-section-number">16.1.1</span> Wzorce Sezonowe i Pozorne Korelacje: Studium Przypadku</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ta wizualizacja przedstawia klasyczny przykład zmiennej zakłócającej w analizie statystycznej. Pozorna korelacja między sprzedażą lodów a wskaźnikiem przestępczości (r = 0,85, p &lt; 0,001) pokazuje, jak wahania sezonowe mogą tworzyć mylące zależności statystyczne. Korelacja wynika ze wspólnego czynnika przyczynowego: sezonowych zmian temperatury, które niezależnie wpływają na obie zmienne poprzez odrębne mechanizmy.</p>
</section>
<section id="trendy-czasowe-i-pozorne-związki" class="level3" data-number="16.1.2">
<h3 data-number="16.1.2" class="anchored" data-anchor-id="trendy-czasowe-i-pozorne-związki"><span class="header-section-number">16.1.2</span> Trendy Czasowe i Pozorne Związki</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ta druga analiza ilustruje błąd korelacji czasowej, gdzie dwa niezależnie malejące trendy tworzą sztuczny związek statystyczny. Pomimo silnego współczynnika korelacji (r = 0,91, p &lt; 0,001), nie istnieje żaden wiarygodny mechanizm przyczynowy łączący te zmienne.</p>
</section>
<section id="mechanizmy-powstawania-pozornych-korelacji" class="level3" data-number="16.1.3">
<h3 data-number="16.1.3" class="anchored" data-anchor-id="mechanizmy-powstawania-pozornych-korelacji"><span class="header-section-number">16.1.3</span> Mechanizmy Powstawania Pozornych Korelacji</h3>
<p>Analiza statystyczna może być zakłócona przez kilka systematycznych błędów, które tworzą pozorne, ale pozbawione znaczenia korelacje. Oto główne mechanizmy:</p>
<p><strong>1. Zmienne Zakłócające</strong></p>
<p>Zmienna zakłócająca tworzy pozorny związek między niezależnymi zmiennymi poprzez niezależny wpływ na każdą z nich. To zjawisko statystyczne wymaga starannego planowania eksperymentów i analizy wielowymiarowej w celu wykrycia i kontroli potencjalnych czynników zakłócających.</p>
<p><strong>2. Autokorelacja Czasowa</strong></p>
<p>Gdy zmienne wykazują silne trendy czasowe, mogą wykazywać korelację po prostu dlatego, że zmieniają się w czasie, a nie z powodu jakiejkolwiek znaczącej relacji. Efekt ten można kontrolować poprzez metody takie jak usuwanie trendu lub różnicowanie szeregów czasowych.</p>
<p><strong>3. Błąd Jednoczesnej Przyczynowości</strong></p>
<p>Występuje, gdy kierunek przyczynowości jest niejednoznaczny lub dwukierunkowy. Na przykład, wzrost gospodarczy i stopy inwestycji mogą wykazywać jednoczesną przyczynowość, ponieważ każda zmienna potencjalnie wpływa na drugą poprzez złożone mechanizmy sprzężenia zwrotnego.</p>
</section>
<section id="metody-statystyczne-wnioskowania-przyczynowego" class="level3" data-number="16.1.4">
<h3 data-number="16.1.4" class="anchored" data-anchor-id="metody-statystyczne-wnioskowania-przyczynowego"><span class="header-section-number">16.1.4</span> Metody Statystyczne Wnioskowania Przyczynowego</h3>
<p>Współczesne podejścia statystyczne oferują kilka technik pozwalających wyjść poza prostą korelację w kierunku wnioskowania przyczynowego, np.:</p>
<p><strong>1. Planowanie Eksperymentów</strong></p>
<p>Randomizowane badania kontrolowane stanowią złoty standard wnioskowania przyczynowego, pozwalając badaczom na izolację wpływu pojedynczych zmiennych przy jednoczesnej kontroli czynników zakłócających.</p>
<p><strong>2. Zmienne Instrumentalne</strong></p>
<p>Ta technika statystyczna wykorzystuje zmienną, która wpływa na wynik wyłącznie poprzez jej wpływ na zmienną będącą przedmiotem zainteresowania, pomagając ustalić związki przyczynowe w danych obserwacyjnych.</p>
<p><strong>3. Regresja Nieciągła</strong></p>
<p>Ten quasi-eksperymentalny projekt wykorzystuje naturalnie występujące progi do przybliżenia eksperymentów randomizowanych, dostarczając dowodów na istnienie związków przyczynowych.</p>
</section>
<section id="ramy-krytycznej-analizy-korelacji" class="level3" data-number="16.1.5">
<h3 data-number="16.1.5" class="anchored" data-anchor-id="ramy-krytycznej-analizy-korelacji"><span class="header-section-number">16.1.5</span> Ramy Krytycznej Analizy Korelacji</h3>
<p>Przy ocenie wyników korelacyjnych należy wziąć pod uwagę następujące ramy analityczne:</p>
<ol type="1">
<li><p>Wiarygodność Teoretyczna: Zbadanie, czy istnieje logiczny mechanizm, poprzez który jedna zmienna mogłaby wpływać na drugą.</p></li>
<li><p>Pierwszeństwo Czasowe: Weryfikacja, czy proponowana przyczyna poprzedza skutek w czasie.</p></li>
<li><p>Zależność Dawka-Odpowiedź: Ocena, czy zmiany w wielkości proponowanej przyczyny odpowiadają proporcjonalnym zmianom w skutku.</p></li>
<li><p>Spójność: Ocena, czy zależność utrzymuje się w różnych kontekstach i populacjach.</p></li>
<li><p>Alternatywne Wyjaśnienia: Systematyczne rozważanie i testowanie alternatywnych wyjaśnień zaobserwowanej korelacji.</p></li>
</ol>
<p>Pamiętaj: Korelacja statystyczna stanowi warunek konieczny, ale niewystarczający do ustalenia przyczynowości.</p>
</section>
</div>
</div>
<section id="kowariancja" class="level3" data-number="16.1.6">
<h3 data-number="16.1.6" class="anchored" data-anchor-id="kowariancja"><span class="header-section-number">16.1.6</span> Kowariancja</h3>
<p>Kowariancja mierzy, jak dwie zmienne są powiązane (zmieniają się razem).</p>
<p><strong>Wzór:</strong> <span class="math inline">cov(X,Y) = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{n - 1}</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Od Kowariancji do Różnych Miar Korelacji
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generowanie różnych typów zależności</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Zależność liniowa</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fl">0.8</span><span class="sc">*</span>x1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd=</span><span class="fl">0.5</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x1, <span class="at">y=</span>y1, <span class="at">type=</span><span class="st">"Zależność Liniowa"</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Zależność monotoniczna nieliniowa</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">sign</span>(x2)<span class="sc">*</span>(x2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd=</span><span class="fl">0.5</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x2, <span class="at">y=</span>y2, <span class="at">type=</span><span class="st">"Monotoniczna Nieliniowa"</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Zależność niemonotoniczna</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length.out=</span>n)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> x3<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd=</span><span class="fl">0.5</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>data3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x3, <span class="at">y=</span>y3, <span class="at">type=</span><span class="st">"Niemonotoniczna"</span>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Łączenie danych</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data1, data2, data3)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Różne Typy Zależności Między Zmiennymi"</span>,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Zmienna X"</span>,</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Zmienna Y"</span>) <span class="sc">+</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="pojęcie-korelacji" class="level3" data-number="16.1.7">
<h3 data-number="16.1.7" class="anchored" data-anchor-id="pojęcie-korelacji"><span class="header-section-number">16.1.7</span> Pojęcie Korelacji</h3>
<p>Korelacja to szerokie pojęcie opisujące, jak zmienne są ze sobą powiązane. Jak widać na wykresach, zależności te mogą przybierać różne formy.</p>
</section>
<section id="rozpoczynając-od-kowariancji" class="level3" data-number="16.1.8">
<h3 data-number="16.1.8" class="anchored" data-anchor-id="rozpoczynając-od-kowariancji"><span class="header-section-number">16.1.8</span> Rozpoczynając od Kowariancji</h3>
<p>Kowariancja jest podstawową miarą wspólnej zmienności zmiennych:</p>
<p><span class="math display">Cov(X,Y) = \frac{\sum(x_i - \bar{x})(y_i - \bar{y})}{n-1}</span></p>
<p>Informuje nas o tym:</p>
<ul>
<li>Czy zmienne zmieniają się w tym samym kierunku (kowariancja dodatnia)</li>
<li>Czy zmieniają się w przeciwnych kierunkach (kowariancja ujemna)</li>
<li>Czy brak wyraźnego wzorca liniowego (kowariancja bliska zeru)</li>
</ul>
<p>Jednak kowariancja ma ograniczenie: jej wartość zależy od jednostek pomiaru. Na przykład:</p>
<ul>
<li>Wzrost w metrach vs waga w kg daje jedną wartość kowariancji</li>
<li>Wzrost w centymetrach vs waga w kg daje inną wartość</li>
<li>Ta sama zależność, różne skale!</li>
</ul>
</section>
<section id="standaryzacja-i-miary-korelacji" class="level3" data-number="16.1.9">
<h3 data-number="16.1.9" class="anchored" data-anchor-id="standaryzacja-i-miary-korelacji"><span class="header-section-number">16.1.9</span> Standaryzacja i Miary Korelacji</h3>
<ol type="1">
<li>Współczynnik korelacji Pearsona standaryzuje kowariancję: <span class="math display">r = \frac{Cov(X,Y)}{\sqrt{Var(X)Var(Y)}}</span></li>
</ol>
<ul>
<li>Eliminuje zależność od jednostek</li>
<li>Zawsze między -1 a 1</li>
<li>Mierzy zależności liniowe</li>
</ul>
<ol start="2" type="1">
<li>Współczynnik korelacji rangowej Spearmana:</li>
</ol>
<ul>
<li>Bazuje na rangach zamiast surowych wartości</li>
<li>Wychwytuje zależności monotoniczne (także nieliniowe)</li>
<li>Również przyjmuje wartości od -1 do 1</li>
</ul>
</section>
<section id="kluczowe-wnioski" class="level3" data-number="16.1.10">
<h3 data-number="16.1.10" class="anchored" data-anchor-id="kluczowe-wnioski"><span class="header-section-number">16.1.10</span> Kluczowe Wnioski</h3>
<ol type="1">
<li>Kowariancja pokazuje wspólną zmienność</li>
<li>Miary korelacji dają standaryzowane wartości</li>
<li>Wybór miary korelacji zależy od:
<ul>
<li>Spodziewanego typu zależności</li>
<li>Charakteru danych</li>
<li>Pytania badawczego</li>
</ul></li>
<li>Zawsze wizualizuj dane</li>
</ol>
</section>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Rangi: Pozycje w Uporządkowanym Ciągu
</div>
</div>
<div class="callout-body-container callout-body">
<p>Rangi to po prostu numery pozycji w uporządkowanym zbiorze danych:</p>
<section id="jak-wyznaczyć-rangi" class="level3" data-number="16.1.11">
<h3 data-number="16.1.11" class="anchored" data-anchor-id="jak-wyznaczyć-rangi"><span class="header-section-number">16.1.11</span> Jak Wyznaczyć Rangi?</h3>
<ol type="1">
<li><p>Porządkujemy dane od najmniejszej do największej wartości</p></li>
<li><p>Przypisujemy kolejne liczby naturalne:</p>
<ul>
<li>Najmniejsza wartość → ranga 1</li>
<li>Kolejne wartości → kolejne rangi</li>
<li>Największa wartość → ranga n (liczba obserwacji)</li>
<li>Dla remisów → średnia rang</li>
</ul></li>
</ol>
</section>
<section id="przykład" class="level3" data-number="16.1.12">
<h3 data-number="16.1.12" class="anchored" data-anchor-id="przykład"><span class="header-section-number">16.1.12</span> Przykład</h3>
<p>Mamy 5 studentów o wzroście:</p>
<pre><code>Wzrost:   165, 182, 170, 168, 175
Rangi:     1,   5,   3,   2,   4</code></pre>
<p>Dla danych z remisami (np. oceny):</p>
<pre><code>Oceny:     2,   3,   3,   4,   5
Rangi:     1,  2.5, 2.5,  4,   5</code></pre>
</section>
</div>
</div>
<p><strong>Przykład Ręcznego Obliczenia:</strong></p>
<p>Obliczmy kowariancję dla dwóch zmiennych:</p>
<ul>
<li>x: 1, 2, 3, 4, 5</li>
<li>y: 2, 4, 5, 4, 5</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th>Krok</th>
<th>Opis</th>
<th>Obliczenie</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Oblicz średnie</td>
<td><span class="math inline">\bar{x} = 3, \bar{y} = 4</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>Oblicz <span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span> dla każdej pary</td>
<td><span class="math inline">(-2)(-2) = 4</span></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td><span class="math inline">(-1)(0) = 0</span></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td><span class="math inline">(0)(1) = 0</span></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td><span class="math inline">(1)(0) = 0</span></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td><span class="math inline">(2)(1) = 2</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Zsumuj wyniki</td>
<td><span class="math inline">4 + 0 + 0 + 0 + 2 = 6</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>Podziel przez (n-1)</td>
<td><span class="math inline">6 / 4 = 1,5</span></td>
</tr>
</tbody>
</table>
<p><strong>Obliczenie w R:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.5</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong> - Dodatnia kowariancja (1,5) wskazuje, że x i y mają tendencję do wzrostu razem.</p>
<p><strong>Zalety:</strong></p>
<ul>
<li>Dostarcza informacji o kierunku związku (dodatni lub ujemny)</li>
<li>Przydatna w obliczaniu innych miar, takich jak korelacja</li>
</ul>
<p><strong>Wady:</strong></p>
<ul>
<li>Zależna od skali, co utrudnia porównywanie między różnymi parami zmiennych</li>
<li>Nie dostarcza informacji o sile związku</li>
</ul>
</section>
<section id="korelacja-pearsona" class="level3" data-number="16.1.13">
<h3 data-number="16.1.13" class="anchored" data-anchor-id="korelacja-pearsona"><span class="header-section-number">16.1.13</span> Korelacja Pearsona</h3>
<p>Korelacja Pearsona mierzy siłę i kierunek liniowego związku między dwiema zmiennymi ciągłymi.</p>
<p><strong>Wzór:</strong> <span class="math inline">r = \frac{cov(X,Y)}{s_X s_Y} = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum (x_i - \bar{x})^2 \sum (y_i - \bar{y})^2}}</span></p>
<p><strong>Przykład Ręcznego Obliczenia:</strong></p>
<p>Używając tych samych danych co wyżej:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th>Krok</th>
<th>Opis</th>
<th>Obliczenie</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Oblicz kowariancję</td>
<td>(Z poprzedniego obliczenia) 1,5</td>
</tr>
<tr class="even">
<td>2</td>
<td>Oblicz odchylenia standardowe</td>
<td><span class="math inline">s_X = \sqrt{\frac{10}{4}} = 1,58, s_Y = \sqrt{\frac{6}{4}} = 1,22</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Podziel kowariancję przez iloczyn odchyleń standardowych</td>
<td><span class="math inline">1,5 / (1,58 * 1,22) = 0,7746</span></td>
</tr>
</tbody>
</table>
<p><strong>Obliczenie w R:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7745967</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong> - Współczynnik korelacji 0,7746 wskazuje na silny dodatni związek liniowy między x i y.</p>
<p><strong>Zalety:</strong></p>
<ul>
<li>Niezależna od skali, zawsze między -1 a 1</li>
<li>Szeroko rozumiana i stosowana</li>
<li>Testuje związki liniowe</li>
</ul>
<p><strong>Wady:</strong></p>
<ul>
<li>Wrażliwa na wartości odstające</li>
<li>Mierzy tylko związki liniowe</li>
<li>Zakłada normalnie rozłożone zmienne</li>
</ul>
</section>
<section id="korelacja-spearmana" class="level3" data-number="16.1.14">
<h3 data-number="16.1.14" class="anchored" data-anchor-id="korelacja-spearmana"><span class="header-section-number">16.1.14</span> Korelacja Spearmana</h3>
<p>Korelacja Spearmana mierzy siłę i kierunek monotonicznego związku między dwiema zmiennymi, które mogą być ciągłe lub porządkowe.</p>
<p><strong>Wzór:</strong> <span class="math inline">\rho = 1 - \frac{6 \sum d_i^2}{n(n^2 - 1)}</span>, gdzie <span class="math inline">d_i</span> to różnica między rangami.</p>
<p><strong>Przykład Ręcznego Obliczenia:</strong></p>
<p>Użyjmy nieco innych danych:</p>
<ul>
<li>x: 1, 2, 3, 4, 5</li>
<li>y: 1, 3, 2, 5, 4</li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Krok</th>
<th>Opis</th>
<th>Obliczenie</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Przypisz rangi obu zmiennym</td>
<td>x_ranga: 1, 2, 3, 4, 5</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>y_ranga: 1, 3, 2, 5, 4</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Oblicz różnice w rangach (d)</td>
<td>0, -1, 1, -1, 1</td>
</tr>
<tr class="even">
<td>3</td>
<td>Podnieś różnice do kwadratu</td>
<td>0, 1, 1, 1, 1</td>
</tr>
<tr class="odd">
<td>4</td>
<td>Zsumuj kwadraty różnic</td>
<td><span class="math inline">\sum d_i^2 = 4</span></td>
</tr>
<tr class="even">
<td>5</td>
<td>Zastosuj wzór</td>
<td><span class="math inline">\rho = 1 - \frac{6(4)}{5(5^2 - 1)} = 0,8</span></td>
</tr>
</tbody>
</table>
<p><strong>Obliczenie w R:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong> - Korelacja Spearmana 0,8 wskazuje na silny dodatni związek monotoniczny między x i y.</p>
<p><strong>Zalety:</strong></p>
<ul>
<li>Odporna na wartości odstające</li>
<li>Może wykrywać nieliniowe związki monotoniczne</li>
<li>Odpowiednia dla danych porządkowych</li>
</ul>
<p><strong>Wady:</strong></p>
<ul>
<li>Mniej odporna niż korelacja Pearsona do wykrywania związków liniowych w normalnie rozłożonych danych</li>
<li>Nie dostarcza informacji o kształcie związku poza monotonicznością</li>
</ul>
</section>
<section id="tabela-krzyżowa" class="level3" data-number="16.1.15">
<h3 data-number="16.1.15" class="anchored" data-anchor-id="tabela-krzyżowa"><span class="header-section-number">16.1.15</span> Tabela Krzyżowa</h3>
<p>Tabela krzyżowa (tabela kontyngencji) pokazuje związek między dwiema zmiennymi kategorycznymi.</p>
<p><strong>Przykład:</strong></p>
<p>Stwórzmy tabelę krzyżową dla dwóch zmiennych: - Poziom wykształcenia: Średnie, Wyższe, Podyplomowe - Status zatrudnienia: Zatrudniony, Bezrobotny</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>wyksztalcenie <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Średnie"</span>, <span class="st">"Wyższe"</span>, <span class="st">"Podyplomowe"</span>, <span class="st">"Średnie"</span>, <span class="st">"Wyższe"</span>, <span class="st">"Podyplomowe"</span>, <span class="st">"Średnie"</span>, <span class="st">"Wyższe"</span>, <span class="st">"Podyplomowe"</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>zatrudnienie <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Zatrudniony"</span>, <span class="st">"Zatrudniony"</span>, <span class="st">"Zatrudniony"</span>, <span class="st">"Bezrobotny"</span>, <span class="st">"Zatrudniony"</span>, <span class="st">"Zatrudniony"</span>, <span class="st">"Bezrobotny"</span>, <span class="st">"Bezrobotny"</span>, <span class="st">"Zatrudniony"</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wyksztalcenie, zatrudnienie)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             zatrudnienie
wyksztalcenie Bezrobotny Zatrudniony
  Podyplomowe          0           3
  Średnie              2           1
  Wyższe               1           2</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li>Ta tabela pokazuje liczbę osób w każdej kombinacji poziomu wykształcenia i statusu zatrudnienia.</li>
<li>Na przykład, możemy zobaczyć, ilu absolwentów szkół średnich jest zatrudnionych, a ilu bezrobotnych.</li>
</ul>
<p><strong>Zalety:</strong></p>
<ul>
<li>Zapewnia jasną wizualną reprezentację związku między zmiennymi kategorycznymi</li>
<li>Łatwa do zrozumienia i interpretacji</li>
<li>Podstawa dla wielu testów statystycznych (np. test chi-kwadrat niezależności)</li>
</ul>
<p><strong>Wady:</strong></p>
<ul>
<li>Ograniczona do danych kategorycznych</li>
<li>Może stać się nieporęczna przy wielu kategoriach</li>
<li>Nie dostarcza pojedynczej statystyki podsumowującej siłę związku</li>
</ul>
</section>
<section id="wybór-odpowiedniej-miary" class="level3" data-number="16.1.16">
<h3 data-number="16.1.16" class="anchored" data-anchor-id="wybór-odpowiedniej-miary"><span class="header-section-number">16.1.16</span> Wybór Odpowiedniej Miary</h3>
<p>Przy wyborze statystyki dwuwymiarowej należy wziąć pod uwagę:</p>
<ol type="1">
<li><p>Typ danych:</p>
<ul>
<li>Dane ciągłe: Kowariancja, korelacja Pearsona</li>
<li>Dane porządkowe: Korelacja Spearmana</li>
<li>Dane kategoryczne: Tabela krzyżowa</li>
</ul></li>
<li><p>Typ związku:</p>
<ul>
<li>Liniowy: Korelacja Pearsona</li>
<li>Monotoniczny, ale potencjalnie nieliniowy: Korelacja Spearmana</li>
</ul></li>
<li><p>Obecność wartości odstających:</p>
<ul>
<li>Jeśli wartości odstające są problemem, korelacja Spearmana jest bardziej odporna</li>
</ul></li>
<li><p>Rozkład:</p>
<ul>
<li>Dla normalnie rozłożonych danych korelacja Pearsona jest najbardziej odporna (robust)</li>
<li>Dla rozkładów “nienormalnych” rozważ korelację Spearmana</li>
</ul></li>
<li><p>Wielkość próby:</p>
<ul>
<li>Dla bardzo małych prób metody nieparametryczne, takie jak korelacja Spearmana, mogą być preferowane</li>
</ul></li>
</ol>
<p>Pamiętaj, że często wartościowe jest użycie wielu miar i wizualizacji (takich jak wykresy rozrzutu), aby uzyskać kompleksowe zrozumienie związku między zmiennymi.</p>
</section>
</section>
<section id="wprowadzenie-do-podstawowej-statystyki-wielowymiarowej" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="wprowadzenie-do-podstawowej-statystyki-wielowymiarowej"><span class="header-section-number">16.2</span> Wprowadzenie do Podstawowej Statystyki Wielowymiarowej (*)</h2>
<p>Statystyki wielowymiarowe obejmują analizę związków między trzema lub więcej zmiennymi jednocześnie. Ta sekcja wprowadzi niektóre podstawowe koncepcje i techniki analizy wielowymiarowej, koncentrując się na metodach opartych na korelacji.</p>
<section id="macierz-korelacji" class="level3" data-number="16.2.1">
<h3 data-number="16.2.1" class="anchored" data-anchor-id="macierz-korelacji"><span class="header-section-number">16.2.1</span> Macierz Korelacji</h3>
<p>Macierz korelacji to tabela pokazująca korelacje parami dla kilku zmiennych. Jest to podstawowe narzędzie w analizie wielowymiarowej.</p>
<p><strong>Przykład:</strong> Stwórzmy macierz korelacji dla czterech zmiennych: wzrost, waga, wiek i dochód.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># Dla powtarzalności</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>wzrost <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">170</span>, <span class="dv">10</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>waga <span class="ot">&lt;-</span> wzrost <span class="sc">*</span> <span class="fl">0.5</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>wiek <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">40</span>, <span class="dv">10</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>dochod <span class="ot">&lt;-</span> wiek <span class="sc">*</span> <span class="dv">1000</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">10000</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(wzrost, waga, wiek, dochod)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>macierz_kor <span class="ot">&lt;-</span> <span class="fu">cor</span>(dane)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(macierz_kor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           wzrost        waga        wiek      dochod
wzrost  1.0000000  0.66712996 -0.12917601 -0.12246786
waga    0.6671300  1.00000000 -0.06814187 -0.04579492
wiek   -0.1291760 -0.06814187  1.00000000  0.65654902
dochod -0.1224679 -0.04579492  0.65654902  1.00000000</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong> - Każda komórka pokazuje korelację między dwiema zmiennymi. - Przekątna zawsze wynosi 1 (korelacja zmiennej z samą sobą). - Szukaj silnych korelacji (bliskich 1 lub -1), aby zidentyfikować potencjalne związki.</p>
</section>
<section id="wizualizacja-związków-wielowymiarowych" class="level3" data-number="16.2.2">
<h3 data-number="16.2.2" class="anchored" data-anchor-id="wizualizacja-związków-wielowymiarowych"><span class="header-section-number">16.2.2</span> Wizualizacja Związków Wielowymiarowych</h3>
<section id="macierz-wykresów-rozrzutu" class="level4" data-number="16.2.2.1">
<h4 data-number="16.2.2.1" class="anchored" data-anchor-id="macierz-wykresów-rozrzutu"><span class="header-section-number">16.2.2.1</span> Macierz Wykresów Rozrzutu</h4>
<p>Macierz wykresów rozrzutu pokazuje parami związki między wieloma zmiennymi.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(dane)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li>Każdy wykres pokazuje związek między dwiema zmiennymi.</li>
<li>Elementy na przekątnej pokazują rozkład każdej zmiennej.</li>
<li>Szukaj wzorców, skupisk lub trendów na wykresach.</li>
</ul>
</section>
<section id="wykres-korelacji" class="level4" data-number="16.2.2.2">
<h4 data-number="16.2.2.2" class="anchored" data-anchor-id="wykres-korelacji"><span class="header-section-number">16.2.2.2</span> Wykres Korelacji</h4>
<p>Wykres korelacji zapewnia wizualną reprezentację macierzy korelacji.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.94 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(macierz_kor, <span class="at">method =</span> <span class="st">"color"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li>Intensywność koloru i rozmiar kół wskazują na siłę korelacji.</li>
<li>Niebieskie kolory zazwyczaj wskazują na dodatnie korelacje, czerwone na ujemne.</li>
</ul>
</section>
</section>
<section id="korelacja-cząstkowa" class="level3" data-number="16.2.3">
<h3 data-number="16.2.3" class="anchored" data-anchor-id="korelacja-cząstkowa"><span class="header-section-number">16.2.3</span> Korelacja Cząstkowa</h3>
<p>Korelacja cząstkowa mierzy związek między dwiema zmiennymi przy kontrolowaniu jednej lub więcej innych zmiennych.</p>
<p><strong>Przykład:</strong> Obliczmy korelację cząstkową między wzrostem a wagą, kontrolując wiek.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ppcor)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pcor.test</span>(dane<span class="sc">$</span>wzrost, dane<span class="sc">$</span>waga, dane<span class="sc">$</span>wiek)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   estimate      p.value statistic   n gp  Method
1 0.6654367 5.758157e-14  8.779896 100  1 pearson</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li>Porównaj to z prostą korelacją między wzrostem a wagą.</li>
<li>Znacząca zmiana może wskazywać, że wiek odgrywa rolę w związku między wzrostem a wagą.</li>
</ul>
</section>
<section id="korelacja-wielokrotna" class="level3" data-number="16.2.4">
<h3 data-number="16.2.4" class="anchored" data-anchor-id="korelacja-wielokrotna"><span class="header-section-number">16.2.4</span> Korelacja Wielokrotna</h3>
<p>Korelacja wielokrotna mierzy siłę związku między zmienną zależną a wieloma zmiennymi niezależnymi.</p>
<p><strong>Przykład:</strong> Przewidźmy wagę na podstawie wzrostu i wieku.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(waga <span class="sc">~</span> wzrost <span class="sc">+</span> wiek, <span class="at">data =</span> dane)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Współczynnik korelacji wielokrotnej:"</span>, R))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Współczynnik korelacji wielokrotnej: 0.667377840470434"</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li>R waha się od 0 do 1, przy czym wyższe wartości wskazują na silniejsze związki.</li>
<li>R² (R-kwadrat) reprezentuje proporcję wariancji w zmiennej zależnej wyjaśnioną przez zmienne niezależne.</li>
</ul>
</section>
<section id="analiza-czynnikowa" class="level3" data-number="16.2.5">
<h3 data-number="16.2.5" class="anchored" data-anchor-id="analiza-czynnikowa"><span class="header-section-number">16.2.5</span> Analiza Czynnikowa</h3>
<p>Analiza czynnikowa to technika używana do zredukowania wielu zmiennych do mniejszej liczby czynników leżących u podstaw.</p>
<p><strong>Przykład:</strong> Wykonajmy prostą analizę czynnikową na naszym zbiorze danych.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'psych'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ggplot2':

    %+%, alpha</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>wynik_fa <span class="ot">&lt;-</span> <span class="fu">fa</span>(dane, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(wynik_fa<span class="sc">$</span>loadings, <span class="at">cutoff =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
       MR2    MR1   
wzrost  0.798       
waga    0.836       
wiek           0.729
dochod         0.895

                 MR2   MR1
SS loadings    1.344 1.341
Proportion Var 0.336 0.335
Cumulative Var 0.336 0.671</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li>Spójrz, które zmienne ładują się wysoko na każdy czynnik.</li>
<li>Spróbuj zinterpretować, co każdy czynnik może reprezentować na podstawie zmiennych, które się na niego ładują.</li>
</ul>
</section>
<section id="uwagi-dotyczące-analizy-wielowymiarowej" class="level3" data-number="16.2.6">
<h3 data-number="16.2.6" class="anchored" data-anchor-id="uwagi-dotyczące-analizy-wielowymiarowej"><span class="header-section-number">16.2.6</span> Uwagi dotyczące Analizy Wielowymiarowej</h3>
<ol type="1">
<li><p><strong>Wielkość próby</strong>: Techniki wielowymiarowe często wymagają większych prób dla stabilnych wyników.</p></li>
<li><p><strong>Współliniowość</strong>: Wysokie korelacje między zmiennymi niezależnymi mogą powodować problemy w niektórych analizach.</p></li>
<li><p><strong>Wartości odstające</strong>: Wielowymiarowe wartości odstające mogą mieć silny wpływ na wyniki.</p></li>
<li><p><strong>Założenia</strong>: Wiele technik zakłada wielowymiarową normalność i liniowe związki.</p></li>
<li><p><strong>Złożoność interpretacji</strong>: Wraz ze wzrostem liczby zmiennych interpretacja może stać się bardziej wyzwająca.</p></li>
</ol>
</section>
<section id="podsumowanie" class="level3" data-number="16.2.7">
<h3 data-number="16.2.7" class="anchored" data-anchor-id="podsumowanie"><span class="header-section-number">16.2.7</span> Podsumowanie</h3>
<p>To wprowadzenie do statystyki wielowymiarowej opiera się na koncepcji korelacji, aby badać związki między wieloma zmiennymi. Techniki te zapewniają potężne narzędzia do zrozumienia złożonych zbiorów danych, ale wymagają również starannego rozważenia założeń i ograniczeń. W miarę postępu w Twojej podróży statystycznej napotkasz bardziej zaawansowane techniki wielowymiarowe, takie jak MANOVA, analiza dyskryminacyjna i modelowanie równań strukturalnych.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.0     ✔ readr     2.1.5
✔ lubridate 1.9.3     ✔ stringr   1.5.1
✔ purrr     1.0.2     ✔ tibble    3.2.1
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ psych::%+%()         masks ggplot2::%+%()
✖ psych::alpha()       masks ggplot2::alpha()
✖ gridExtra::combine() masks dplyr::combine()
✖ dplyr::filter()      masks stats::filter()
✖ dplyr::lag()         masks stats::lag()
✖ MASS::select()       masks dplyr::select()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="wprowadzenie-do-analizy-regresji" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="wprowadzenie-do-analizy-regresji"><span class="header-section-number">16.3</span> Wprowadzenie do Analizy Regresji</h2>
<p>Analiza regresji jest fundamentalnym narzędziem statystycznym, które pomaga nam zrozumieć relacje między zmiennymi. Zanim zagłębimy się w formuły i szczegóły techniczne, zrozummy, na jakie pytania może odpowiedzieć regresja:</p>
<ul>
<li>Jak każdy dodatkowy rok edukacji wpływa na czyjeś wynagrodzenie?</li>
<li>Jaka jest zależność między wydatkami na reklamę a sprzedażą?</li>
<li>Jak temperatura wpływa na zużycie energii?</li>
<li>Czy liczba godzin nauki przewiduje wyniki egzaminów?</li>
</ul>
<p>Te pytania mają wspólną strukturę: wszystkie badają, jak zmiany jednej zmiennej wiążą się ze zmianami innej.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Model Regresji Liniowej (MNK): Szybki Start
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">length.out =</span> n)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">1.5</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate OLS parameters</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">cov</span>(x, y) <span class="sc">/</span> <span class="fu">var</span>(x)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y) <span class="sc">-</span> beta1 <span class="sc">*</span> <span class="fu">mean</span>(x)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create alternative lines</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>lines_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept =</span> <span class="fu">c</span>(beta0, beta0 <span class="sc">+</span> <span class="dv">1</span>, beta0 <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">slope =</span> <span class="fu">c</span>(beta1, beta1 <span class="sc">+</span> <span class="fl">0.3</span>, beta1 <span class="sc">-</span> <span class="fl">0.3</span>),</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">line_type =</span> <span class="fu">c</span>(<span class="st">"Best fit (OLS)"</span>, <span class="st">"Suboptimal 1"</span>, <span class="st">"Suboptimal 2"</span>)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> lines_data,</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> intercept, </span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">slope =</span> slope,</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> line_type,</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">linetype =</span> line_type),</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Best fit (OLS)"</span> <span class="ot">=</span> <span class="st">"#FF4500"</span>,</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Suboptimal 1"</span> <span class="ot">=</span> <span class="st">"#4169E1"</span>,</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Suboptimal 2"</span> <span class="ot">=</span> <span class="st">"#228B22"</span>)) <span class="sc">+</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Finding the Best-Fitting Line"</span>,</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Orange line minimizes the sum of squared errors"</span>,</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"X Variable"</span>,</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Y Variable"</span>,</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Line Type"</span>,</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">"Line Type"</span>) <span class="sc">+</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="koncepcja-modelu" class="level3" data-number="16.3.1">
<h3 data-number="16.3.1" class="anchored" data-anchor-id="koncepcja-modelu"><span class="header-section-number">16.3.1</span> Koncepcja Modelu</h3>
<p>Regresja MNK (Metoda Najmniejszych Kwadratów) to model statystyczny opisujący związek między zmiennymi. Dwa kluczowe założenia definiują ten model:</p>
<ol type="1">
<li>Związek można opisać linią prostą (liniowość)</li>
<li>Błędy w naszych przewidywaniach nie są systematycznie powiązane ze zmienną x (ścisła egzogeniczność)</li>
</ol>
</section>
<section id="przykład-edukacja-i-wynagrodzenia" class="level3" data-number="16.3.2">
<h3 data-number="16.3.2" class="anchored" data-anchor-id="przykład-edukacja-i-wynagrodzenia"><span class="header-section-number">16.3.2</span> Przykład: Edukacja i Wynagrodzenia</h3>
<p>Rozważmy badanie wpływu edukacji (x) na wynagrodzenia (y). Powiedzmy, że szacujemy:</p>
<p><span class="math display">wynagrodzenia = \beta_0 + \beta_1 \cdot edukacja + \epsilon</span></p>
<p>Składnik błędu <span class="math inline">\epsilon</span> zawiera wszystkie inne czynniki wpływające na wynagrodzenia. Ścisła egzogeniczność jest naruszona, jeśli pominiemy ważną zmienną, jak “zdolności”, która wpływa zarówno na edukację, jak i wynagrodzenia. Dlaczego? Ponieważ bardziej zdolni ludzie mają tendencję do zdobywania lepszego wykształcenia I wyższych wynagrodzeń, co powoduje zawyżenie szacowanego efektu edukacji.</p>
</section>
<section id="problem-optymalizacji-metoda-najmniejszych-kwadratów-ols" class="level3" data-number="16.3.3">
<h3 data-number="16.3.3" class="anchored" data-anchor-id="problem-optymalizacji-metoda-najmniejszych-kwadratów-ols"><span class="header-section-number">16.3.3</span> Problem Optymalizacji: Metoda Najmniejszych Kwadratów (OLS)</h3>
<p>Kiedy analizujemy zależności między zmiennymi, takimi jak poziom wykształcenia a wynagrodzenie, potrzebujemy systematycznej metody znalezienia linii, która najlepiej odzwierciedla tę relację w naszych danych. Metoda Najmniejszych Kwadratów (OLS - Ordinary Least Squares) dostarcza nam takiego rozwiązania poprzez precyzyjne podejście matematyczne.</p>
<p>Spójrzmy na nasz wykres poziomów wykształcenia i wynagrodzeń. Każdy punkt reprezentuje rzeczywiste dane - poziom wykształcenia danej osoby i odpowiadające mu wynagrodzenie. Naszym celem jest znalezienie pojedynczej linii, która najdokładniej uchwyci podstawową zależność między tymi zmiennymi.</p>
<p>Dla każdej obserwacji <span class="math inline">i</span> możemy wyrazić tę relację jako:</p>
<p><span class="math display">y_i = \beta_0 + \beta_1x_i + \epsilon_i</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">y_i</span> to rzeczywiste zaobserwowane wynagrodzenie</li>
<li><span class="math inline">\hat{y_i} = \beta_0 + \beta_1x_i</span> to przewidywane wynagrodzenie</li>
<li><span class="math inline">\epsilon_i = y_i - \hat{y_i}</span> to składnik błędu (reszta)</li>
</ul>
<p>Metoda OLS znajduje optymalne wartości dla <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span> poprzez minimalizację sumy kwadratów błędów:</p>
<p><span class="math display">\min_{\beta_0, \beta_1} \sum \epsilon_i^2 = \min_{\beta_0, \beta_1} \sum(y_i - \hat{y_i})^2 = \min_{\beta_0, \beta_1} \sum(y_i - (\beta_0 + \beta_1x_i))^2</span></p>
<p>Analizując naszą wizualizację:</p>
<ul>
<li>Rozproszone punkty pokazują rzeczywiste obserwacje <span class="math inline">(x_i, y_i)</span></li>
<li>Czerwona linia reprezentuje dopasowane wartości <span class="math inline">\hat{y_i}</span>, które minimalizują <span class="math inline">\sum \epsilon_i^2</span></li>
<li>Niebieska i zielona linia przedstawiają alternatywne dopasowania o większych sumach kwadratów błędów</li>
<li>Pionowe odległości od każdego punktu do tych linii reprezentują błędy <span class="math inline">\epsilon_i</span></li>
</ul>
<p>Rozwiązanie OLS dostarcza nam estymatorów <span class="math inline">\hat{\beta_0}</span> i <span class="math inline">\hat{\beta_1}</span> nieznanych parametrów <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span>, które minimalizują całkowity błąd kwadratowy, dając nam najdokładniejszą liniową reprezentację zależności między poziomem wykształcenia a wynagrodzeniem na podstawie dostępnych danych.</p>
</section>
<section id="znalezienie-najlepszej-linii" class="level3" data-number="16.3.4">
<h3 data-number="16.3.4" class="anchored" data-anchor-id="znalezienie-najlepszej-linii"><span class="header-section-number">16.3.4</span> Znalezienie Najlepszej Linii</h3>
<p>Rozwiązanie tego problemu minimalizacji daje nam:</p>
<p><span class="math display">\hat{\beta}_1 = \frac{\sum(x_i - \bar{x})(y_i - \bar{y})}{\sum(x_i - \bar{x})^2} = \frac{cov(X, Y)}{var(X)}</span></p>
<p><span class="math display">\hat{\beta}_0 = \bar{y} - \hat{\beta}_1\bar{x}</span></p>
</section>
<section id="kluczowe-punkty" class="level3" data-number="16.3.5">
<h3 data-number="16.3.5" class="anchored" data-anchor-id="kluczowe-punkty"><span class="header-section-number">16.3.5</span> Kluczowe Punkty</h3>
<ol type="1">
<li>MNK znajduje linię, która minimalizuje kwadraty błędów predykcji</li>
<li>Ta linia jest “najlepsza” pod względem dopasowania, ale może nie ujmować prawdziwych relacji, jeśli pominięto ważne zmienne</li>
<li>W przykładzie edukacja-wynagrodzenia, pominięcie zdolności oznacza, że przypisujemy cały wzrost wynagrodzeń samej edukacji</li>
</ol>
</section>
</div>
</div>
<section id="podstawowe-pojęcia-i-terminologia" class="level3" data-number="16.3.6">
<h3 data-number="16.3.6" class="anchored" data-anchor-id="podstawowe-pojęcia-i-terminologia"><span class="header-section-number">16.3.6</span> Podstawowe Pojęcia i Terminologia</h3>
<p>Ustalmy kluczowe terminy:</p>
<ul>
<li><strong>Zmienna Zależna (Y)</strong>:
<ul>
<li>Wynik, który chcemy zrozumieć lub przewidzieć</li>
<li>Nazywana również: zmienna odpowiedzi, zmienna docelowa</li>
<li>Przykłady: wynagrodzenie, sprzedaż, wyniki egzaminów</li>
</ul></li>
<li><strong>Zmienna Niezależna (X)</strong>:
<ul>
<li>Zmienna, która naszym zdaniem wpływa na Y</li>
<li>Nazywana również: predyktor, zmienna objaśniająca, regresor</li>
<li>Przykłady: lata edukacji, budżet reklamowy, godziny nauki</li>
</ul></li>
<li><strong>Parametry Populacji (<span class="math inline">\beta</span>)</strong>:
<ul>
<li>Prawdziwe podstawowe zależności, które chcemy zrozumieć</li>
<li>Zazwyczaj nieznane w praktyce</li>
<li>Przykłady: <span class="math inline">\beta_0</span> (prawdziwy wyraz wolny), <span class="math inline">\beta_1</span> (prawdziwe nachylenie)</li>
</ul></li>
<li><strong>Oszacowania Parametrów (<span class="math inline">\hat{\beta}</span>)</strong>:
<ul>
<li>Nasze najlepsze przypuszczenia dotyczące prawdziwych parametrów na podstawie danych</li>
<li>Obliczane na podstawie danych próby</li>
<li>Przykłady: <span class="math inline">\hat{\beta}_0</span> (oszacowany wyraz wolny), <span class="math inline">\hat{\beta}_1</span> (oszacowane nachylenie)</li>
</ul></li>
</ul>
</section>
<section id="główna-idea" class="level3" data-number="16.3.7">
<h3 data-number="16.3.7" class="anchored" data-anchor-id="główna-idea"><span class="header-section-number">16.3.7</span> Główna Idea</h3>
<p>Zobaczmy na przykładzie, co robi regresja:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate some example data</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.5</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Przykład Prostej Regresji Liniowej"</span>,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Punkty reprezentują dane, czerwona linia pokazuje dopasowanie regresji"</span>,</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Zmienna Niezależna (X)"</span>,</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Zmienna Zależna (Y)"</span>) <span class="sc">+</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-basic-idea" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-basic-idea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-basic-idea-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-basic-idea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.1: Podstawowa Idea Regresji: Dopasowanie Linii do Danych
</figcaption>
</figure>
</div>
</div>
</div>
<p>Ten wykres pokazuje istotę regresji:</p>
<ul>
<li>Każdy punkt reprezentuje obserwację (X, Y)</li>
<li>Linia reprezentuje nasze najlepsze przypuszczenie dotyczące zależności</li>
<li>Rozproszenie punktów wokół linii pokazuje niepewność</li>
</ul>
</section>
</section>
<section id="model-regresji-liniowej" class="level2" data-number="16.4">
<h2 data-number="16.4" class="anchored" data-anchor-id="model-regresji-liniowej"><span class="header-section-number">16.4</span> Model Regresji Liniowej</h2>
<section id="model-populacyjny-vs.-oszacowania-z-próby" class="level3" data-number="16.4.1">
<h3 data-number="16.4.1" class="anchored" data-anchor-id="model-populacyjny-vs.-oszacowania-z-próby"><span class="header-section-number">16.4.1</span> Model Populacyjny vs.&nbsp;Oszacowania z Próby</h3>
<p>W teorii istnieje prawdziwa zależność populacyjna:</p>
<p><span class="math display">Y = \beta_0 + \beta_1X + \varepsilon</span></p>
<p>gdzie:</p>
<ul>
<li><span class="math inline">\beta_0</span> to prawdziwy wyraz wolny populacji</li>
<li><span class="math inline">\beta_1</span> to prawdziwe nachylenie populacji</li>
<li><span class="math inline">\varepsilon</span> to składnik losowy błędu</li>
</ul>
<p>W praktyce pracujemy z danymi próby, aby oszacować tę zależność:</p>
<p><span class="math display">\hat{Y} = \hat{\beta}_0 + \hat{\beta}_1X</span></p>
<p>Zobaczmy wizualizację różnicy między zależnościami populacyjnymi a próbkowymi:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate population data</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>x_pop <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>true_relationship <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x_pop  <span class="co"># True β₀=2, β₁=3</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>y_pop <span class="ot">&lt;-</span> true_relationship <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x_pop), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create several samples</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rep</span>(<span class="fu">sample</span>(x_pop, sample_size), <span class="dv">3</span>),</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each =</span> sample_size)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>samples<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>samples<span class="sc">$</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(samples), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models to each sample</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> samples <span class="sc">%&gt;%</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> <span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x))[<span class="dv">1</span>],</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">slope =</span> <span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x))[<span class="dv">2</span>]</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> samples, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> <span class="fu">factor</span>(sample)), </span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> models, </span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> intercept, <span class="at">slope =</span> slope, </span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> <span class="fu">factor</span>(sample)),</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_pop, <span class="at">y =</span> true_relationship), </span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Linie Regresji: Populacyjna vs. Próbkowe"</span>,</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Czarna linia: prawdziwa zależność populacyjna</span><span class="sc">\n</span><span class="st">Linie przerywane: oszacowania próbkowe"</span>,</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"X"</span>, <span class="at">y =</span> <span class="st">"Y"</span>,</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Próba"</span>) <span class="sc">+</span></span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-pop-vs-sample" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pop-vs-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-pop-vs-sample-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pop-vs-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.2: Linie Regresji: Populacyjna vs.&nbsp;Próbkowe
</figcaption>
</figure>
</div>
</div>
</div>
<p>Ta wizualizacja pokazuje:</p>
<ul>
<li>Prawdziwą linię populacyjną (czarną), którą próbujemy odkryć</li>
<li>Różne oszacowania próbkowe (linie przerywane) oparte na różnych próbach</li>
<li>Jak oszacowania próbkowe różnią się wokół prawdziwej zależności</li>
</ul>
</section>
</section>
<section id="kluczowe-założenia-regresji-liniowej" class="level2" data-number="16.5">
<h2 data-number="16.5" class="anchored" data-anchor-id="kluczowe-założenia-regresji-liniowej"><span class="header-section-number">16.5</span> Kluczowe Założenia Regresji Liniowej</h2>
<section id="ścisła-egzogeniczność-podstawowe-założenie" class="level3" data-number="16.5.1">
<h3 data-number="16.5.1" class="anchored" data-anchor-id="ścisła-egzogeniczność-podstawowe-założenie"><span class="header-section-number">16.5.1</span> Ścisła Egzogeniczność: Podstawowe Założenie</h3>
<p>Najważniejszym założeniem w regresji jest ścisła egzogeniczność:</p>
<p><span class="math display">E[\varepsilon|X] = 0</span></p>
<p>Oznacza to:</p>
<ol type="1">
<li>Wartość oczekiwana składnika błędu warunkowego względem X wynosi zero</li>
<li>X nie zawiera informacji o przeciętnym błędzie</li>
<li>Nie ma systematycznych wzorców w tym, jak nasze przewidywania są błędne</li>
</ol>
<p>Zobaczmy wizualizację sytuacji, gdy to założenie jest spełnione i gdy nie jest:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.2</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 1: Exogenous errors</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>y_exog <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 2: Non-exogenous errors (error variance increases with x)</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>y_nonexog <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>x<span class="sc">*</span><span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create datasets</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>data_exog <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x,</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y_exog,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"Błędy Egzogeniczne</span><span class="sc">\n</span><span class="st">(Założenie Spełnione)"</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>data_nonexog <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x,</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y_nonexog,</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"Błędy Nieegzogeniczne</span><span class="sc">\n</span><span class="st">(Założenie Niespełnione)"</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_exog, data_nonexog)</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots with residuals</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>plot_residuals <span class="ot">&lt;-</span> <span class="cf">function</span>(data, title) {</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model)</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> title)</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Reszty"</span>)</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(p1, p2)</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate plots</span></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>plots_exog <span class="ot">&lt;-</span> <span class="fu">plot_residuals</span>(data_exog, <span class="st">"Błędy Egzogeniczne"</span>)</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>plots_nonexog <span class="ot">&lt;-</span> <span class="fu">plot_residuals</span>(data_nonexog, <span class="st">"Błędy Nieegzogeniczne"</span>)</span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange plots</span></span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(</span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>  plots_exog[[<span class="dv">1</span>]], plots_exog[[<span class="dv">2</span>]],</span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>  plots_nonexog[[<span class="dv">1</span>]], plots_nonexog[[<span class="dv">2</span>]],</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span></span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-exogeneity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-exogeneity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-exogeneity-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-exogeneity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.3: Przykłady Egzogeniczności vs.&nbsp;Nieegzogeniczności
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="liniowość-założenie-o-formie" class="level3" data-number="16.5.2">
<h3 data-number="16.5.2" class="anchored" data-anchor-id="liniowość-założenie-o-formie"><span class="header-section-number">16.5.2</span> Liniowość: Założenie o Formie</h3>
<p>Zależność między X a Y powinna być liniowa w parametrach:</p>
<p><span class="math display">E[Y|X] = \beta_0 + \beta_1X</span></p>
<p>Zauważ, że nie oznacza to, że X i Y muszą mieć zależność w postaci linii prostej - możemy transformować zmienne. Zobaczmy różne rodzaje zależności:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Different relationships</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>data_relationships <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rep</span>(x, <span class="dv">3</span>),</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Linear</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Quadratic</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Exponential</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">exp</span>(<span class="fl">0.3</span><span class="sc">*</span>x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Liniowa"</span>, <span class="st">"Kwadratowa"</span>, <span class="st">"Wykładnicza"</span>), <span class="at">each =</span> <span class="fu">length</span>(x))</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_relationships, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"Czerwona: dopasowanie liniowe, Niebieska: prawdziwa zależność"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-linearity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linearity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-linearity-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linearity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.4: Zależności Liniowe i Nieliniowe
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="zrozumienie-naruszeń-i-rozwiązania" class="level3" data-number="16.5.3">
<h3 data-number="16.5.3" class="anchored" data-anchor-id="zrozumienie-naruszeń-i-rozwiązania"><span class="header-section-number">16.5.3</span> Zrozumienie Naruszeń i Rozwiązania</h3>
<p>Gdy założenie liniowości jest naruszone:</p>
<ol type="1">
<li>Transformacja zmiennych:
<ul>
<li>Transformacja logarytmiczna: dla zależności wykładniczych</li>
<li>Pierwiastek kwadratowy: dla umiarkowanej nieliniowości</li>
<li>Transformacje potęgowe: dla bardziej złożonych zależności</li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate exponential data</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">102</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.2</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fl">0.3</span><span class="sc">*</span>x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create datasets</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>data_trans <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x,</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">log_y =</span> <span class="fu">log</span>(y)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in log(y): NaNs produced</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Original scale plot</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_trans, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Skala Oryginalna"</span>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Log scale plot</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_trans, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> log_y)) <span class="sc">+</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Y po Transformacji Logarytmicznej"</span>)</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-transformations" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-transformations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-transformations-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-transformations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.5: Efekt Transformacji Zmiennych
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Intuicyjne zrozumienie Metody Najmniejszych Kwadratów (MNK)
</div>
</div>
<div class="callout-body-container callout-body">
<section id="podstawowy-problem" class="level3" data-number="16.5.4">
<h3 data-number="16.5.4" class="anchored" data-anchor-id="podstawowy-problem"><span class="header-section-number">16.5.4</span> Podstawowy Problem</h3>
<p>Zacznijmy od rzeczywistego scenariusza: chcemy zrozumieć, jak czas nauki wpływa na wyniki egzaminu. Zbieramy dane z Twojej klasy, gdzie:</p>
<ul>
<li>Każdy student zapisuje swoje godziny nauki (<span class="math inline">x</span>), oraz swój końcowy wynik egzaminu (<span class="math inline">y</span>)</li>
<li>Więc student 1 mógł się uczyć <span class="math inline">x_1 = 3</span> godziny i uzyskać <span class="math inline">y_1 = 75</span> punktów</li>
<li>Student 2 mógł się uczyć <span class="math inline">x_2 = 5</span> godzin i uzyskać <span class="math inline">y_2 = 82</span> punkty</li>
<li>I tak dalej dla wszystkich <span class="math inline">n</span> studentów w klasie</li>
</ul>
<p>Naszym celem jest znalezienie prostej, która najlepiej opisuje tę zależność. Próbujemy oszacować prawdziwą zależność (której nigdy nie znamy dokładnie) używając naszej próby danych. Przeanalizujmy to krok po kroku.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie przykładowych danych</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>godziny_nauki <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>, <span class="dv">1</span>, <span class="dv">8</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>wyniki_egzaminu <span class="ot">&lt;-</span> <span class="dv">60</span> <span class="sc">+</span> <span class="dv">5</span> <span class="sc">*</span> godziny_nauki <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(godziny_nauki, wyniki_egzaminu)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Podstawowy wykres punktowy</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> godziny_nauki, <span class="at">y =</span> wyniki_egzaminu)) <span class="sc">+</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Godziny nauki"</span>, <span class="at">y =</span> <span class="st">"Wyniki egzaminu"</span>,</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Dane z Twojej klasy: Godziny nauki vs. Wyniki egzaminu"</span>) <span class="sc">+</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="co-sprawia-że-prosta-jest-dobra" class="level3" data-number="16.5.5">
<h3 data-number="16.5.5" class="anchored" data-anchor-id="co-sprawia-że-prosta-jest-dobra"><span class="header-section-number">16.5.5</span> Co sprawia, że prosta jest “dobra”?</h3>
<p>Każdą prostą można zapisać w postaci:</p>
<p><span class="math inline">y = \hat{\beta}_0 + \hat{\beta}_1x</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">\hat{\beta}_0</span> to nasza estymata wyrazu wolnego (przewidywany wynik dla zero godzin nauki)</li>
<li><span class="math inline">\hat{\beta}_1</span> to nasza estymata nachylenia (ile punktów zyskujemy za każdą dodatkową godzinę nauki)</li>
<li>Daszki (^) wskazują, że są to nasze estymaty prawdziwych (nieznanych) parametrów <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span></li>
</ul>
<p>Spójrzmy na trzy możliwe proste przechodzące przez nasze dane:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> godziny_nauki, <span class="at">y =</span> wyniki_egzaminu)) <span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">50</span>, <span class="at">slope =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">70</span>, <span class="at">slope =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Godziny nauki"</span>, <span class="at">y =</span> <span class="st">"Wyniki egzaminu"</span>,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Trzy różne proste: Która jest najlepsza?"</span>) <span class="sc">+</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">7.5</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">label =</span> <span class="st">"Prosta A: Za stroma"</span>) <span class="sc">+</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">7.5</span>, <span class="at">y =</span> <span class="dv">85</span>, <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">label =</span> <span class="st">"Prosta B: Za płaska"</span>) <span class="sc">+</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">7.5</span>, <span class="at">y =</span> <span class="dv">100</span>, <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">label =</span> <span class="st">"Prosta C: W sam raz"</span>) <span class="sc">+</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="zrozumienie-błędów-przewidywania-reszt" class="level3" data-number="16.5.6">
<h3 data-number="16.5.6" class="anchored" data-anchor-id="zrozumienie-błędów-przewidywania-reszt"><span class="header-section-number">16.5.6</span> Zrozumienie błędów przewidywania (reszt)</h3>
<p>Dla każdego studenta w naszych danych:</p>
<ol type="1">
<li>Patrzymy na jego rzeczywisty wynik egzaminu (<span class="math inline">y_i</span>)</li>
<li>Obliczamy przewidywany wynik używając naszej prostej (<span class="math inline">\hat{y}_i = \hat{\beta}_0 + \hat{\beta}_1x_i</span>)</li>
<li>Różnica między nimi nazywana jest resztą:</li>
</ol>
<p><span class="math inline">\text{reszta}_i = y_i - \hat{y}_i = y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i)</span></p>
<p>Zobaczmy wizualizację tych reszt dla jednej prostej:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modelu i pokazanie reszt</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(wyniki_egzaminu <span class="sc">~</span> godziny_nauki, <span class="at">data =</span> dane)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> godziny_nauki, <span class="at">y =</span> wyniki_egzaminu)) <span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> godziny_nauki, </span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">yend =</span> <span class="fu">predict</span>(model, dane)),</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Godziny nauki"</span>, <span class="at">y =</span> <span class="st">"Wyniki egzaminu"</span>,</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Zrozumienie reszt: Różnice między przewidywaniami a rzeczywistością"</span>) <span class="sc">+</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Pomarańczowe pionowe linie pokazują, jak bardzo nasze przewidywania odbiegają od rzeczywistości dla każdego studenta. Niektóre przewidywania są za wysokie (dodatnie reszty), inne za niskie (ujemne reszty).</p>
</section>
<section id="dlaczego-podnosimy-reszty-do-kwadratu" class="level3" data-number="16.5.7">
<h3 data-number="16.5.7" class="anchored" data-anchor-id="dlaczego-podnosimy-reszty-do-kwadratu"><span class="header-section-number">16.5.7</span> Dlaczego podnosimy reszty do kwadratu?</h3>
<p>To kluczowa koncepcja! Przeanalizujmy to na prostym przykładzie:</p>
<p>Wyobraź sobie, że mamy tylko dwoje studentów:</p>
<ol type="1">
<li>Ala: Przewidywane 80, rzeczywisty wynik 85 (reszta = +5)</li>
<li>Bob: Przewidywane 90, rzeczywisty wynik 85 (reszta = -5)</li>
</ol>
<p>Jeśli po prostu dodamy te reszty: <span class="math inline">(+5) + (-5) = 0</span></p>
<p>To sugerowałoby, że nasza prosta jest idealna (całkowity błąd = 0), ale wiemy, że tak nie jest! Oba przewidywania były nietrafne o 5 punktów.</p>
<p>Rozwiązanie: Podnosimy reszty do kwadratu przed dodaniem:</p>
<ul>
<li>Kwadrat reszty Ali: <span class="math inline">(+5)^2 = 25</span></li>
<li>Kwadrat reszty Boba: <span class="math inline">(-5)^2 = 25</span></li>
<li>Całkowity błąd kwadratowy: <span class="math inline">25 + 25 = 50</span></li>
</ul>
<p>To daje nam znacznie lepszą miarę tego, jak bardzo nasze przewidywania są błędne!</p>
</section>
<section id="suma-kwadratów-reszt-sse" class="level3" data-number="16.5.8">
<h3 data-number="16.5.8" class="anchored" data-anchor-id="suma-kwadratów-reszt-sse"><span class="header-section-number">16.5.8</span> Suma kwadratów reszt (SSE)</h3>
<p>Suma kwadratów reszt (SSE - Sum of Squared Errors) jest fundamentalną miarą dopasowania modelu regresji liniowej. Możemy ją wyrazić matematycznie jako:</p>
<p><span class="math display">SSE = \sum_{i=1}^n (y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i))^2</span></p>
<p>gdzie:</p>
<ul>
<li><span class="math inline">y_i</span> to rzeczywista wartość zmiennej zależnej dla i-tej obserwacji</li>
<li><span class="math inline">\hat{\beta}_0</span> to oszacowany wyraz wolny (punkt przecięcia z osią Y)</li>
<li><span class="math inline">\hat{\beta}_1</span> to oszacowany współczynnik nachylenia prostej</li>
<li><span class="math inline">x_i</span> to wartość zmiennej niezależnej dla i-tej obserwacji</li>
</ul>
<p>Proces obliczania SSE można przedstawić w następujących krokach:</p>
<ol type="1">
<li><p>Dla każdej obserwacji obliczamy różnicę między wartością rzeczywistą (<span class="math inline">y_i</span>) a wartością przewidywaną przez model (<span class="math inline">\hat{\beta}_0 + \hat{\beta}_1x_i</span>). Ta różnica nazywana jest resztą.</p></li>
<li><p>Każdą resztę podnosimy do kwadratu, co powoduje, że:</p>
<ul>
<li>wszystkie wartości stają się dodatnie</li>
<li>większe błędy są silniej “karane” niż małe</li>
<li>jednostki miary są podnoszone do kwadratu</li>
</ul></li>
<li><p>Sumujemy wszystkie kwadraty reszt, otrzymując jedną liczbę reprezentującą całkowity błąd modelu.</p></li>
</ol>
<p><strong>Im mniejsza wartość SSE, tym lepsze dopasowanie modelu do danych empirycznych</strong>.</p>
<p>Wartość SSE = 0 oznaczałaby idealne dopasowanie, gdzie wszystkie punkty leżą dokładnie na prostej regresji. W praktyce tak doskonałe dopasowanie występuje niezwykle rzadko i może sugerować problem przeuczenia modelu.</p>
<p>SSE stanowi podstawę do obliczania innych ważnych miar jakości dopasowania modelu, takich jak współczynnik determinacji R² czy błąd standardowy estymacji.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Porównanie dobrego i złego dopasowania</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>zle_przewidywania <span class="ot">&lt;-</span> <span class="dv">70</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> dane<span class="sc">$</span>godziny_nauki</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>dobre_przewidywania <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, dane)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>zle_sse <span class="ot">&lt;-</span> <span class="fu">sum</span>((dane<span class="sc">$</span>wyniki_egzaminu <span class="sc">-</span> zle_przewidywania)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>dobre_sse <span class="ot">&lt;-</span> <span class="fu">sum</span>((dane<span class="sc">$</span>wyniki_egzaminu <span class="sc">-</span> dobre_przewidywania)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> godziny_nauki, <span class="at">y =</span> wyniki_egzaminu)) <span class="sc">+</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">70</span>, <span class="at">slope =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">95</span>, </span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Czerwona prosta: Błąd ="</span>, <span class="fu">round</span>(zle_sse)), </span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">90</span>, </span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Fioletowa prosta: Błąd ="</span>, <span class="fu">round</span>(dobre_sse)), </span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Godziny nauki"</span>, <span class="at">y =</span> <span class="st">"Wyniki egzaminu"</span>,</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Porównanie całkowitych błędów przewidywania"</span>) <span class="sc">+</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="dlaczego-nazywamy-to-metodą-najmniejszych-kwadratów" class="level3" data-number="16.5.9">
<h3 data-number="16.5.9" class="anchored" data-anchor-id="dlaczego-nazywamy-to-metodą-najmniejszych-kwadratów"><span class="header-section-number">16.5.9</span> Dlaczego nazywamy to “Metodą Najmniejszych Kwadratów”?</h3>
<p>Przeanalizujmy nazwę:</p>
<ul>
<li>“Kwadratów”: Podnosimy reszty do kwadratu</li>
<li>“Najmniejszych”: Chcemy najmniejszej możliwej sumy</li>
<li>“Zwykłych” (w angielskim “Ordinary”): To podstawowa wersja (istnieją bardziej zaawansowane warianty!)</li>
</ul>
<p>Prosta MNK ma kilka ciekawych właściwości:</p>
<ol type="1">
<li>Średnia wszystkich reszt równa się zero</li>
<li>Prosta zawsze przechodzi przez punkt (<span class="math inline">\bar{x}</span>, <span class="math inline">\bar{y}</span>) - średnie godziny nauki i średni wynik</li>
<li>Małe zmiany w danych prowadzą do małych zmian w prostej (jest “stabilna”)</li>
<li>Nasze estymaty <span class="math inline">\hat{\beta}_0</span> i <span class="math inline">\hat{\beta}_1</span> są najlepszymi możliwymi estymatorami prawdziwych parametrów <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span></li>
</ol>
</section>
<section id="ważne-uwagi" class="level3" data-number="16.5.10">
<h3 data-number="16.5.10" class="anchored" data-anchor-id="ważne-uwagi"><span class="header-section-number">16.5.10</span> Ważne uwagi</h3>
<ol type="1">
<li><p>Oznaczenie z daszkiem (<span class="math inline">\hat{\beta}_0</span>, <span class="math inline">\hat{\beta}_1</span>) przypomina nam, że estymujemy prawdziwą zależność z naszej próby. Nigdy nie znamy prawdziwych <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span> - możemy je tylko oszacować z naszych danych.</p></li>
<li><p>MNK daje nam najlepsze możliwe estymaty, gdy spełnione są pewne warunki (jak losowo pobrana próba i rzeczywiście liniowa zależność).</p></li>
</ol>
</section>
</div>
</div>
</section>
</section>
<section id="ocena-dopasowania-modelu" class="level2" data-number="16.6">
<h2 data-number="16.6" class="anchored" data-anchor-id="ocena-dopasowania-modelu"><span class="header-section-number">16.6</span> Ocena Dopasowania Modelu</h2>
<section id="dekompozycja-wariancji" class="level3" data-number="16.6.1">
<h3 data-number="16.6.1" class="anchored" data-anchor-id="dekompozycja-wariancji"><span class="header-section-number">16.6.1</span> Dekompozycja Wariancji</h3>
<p>Całkowita zmienność Y może być rozłożona na komponenty wyjaśnione i niewyjaśnione:</p>
<p><span class="math display">\underbrace{\sum_{i=1}^n (Y_i - \bar{Y})^2}_{SST} = \underbrace{\sum_{i=1}^n (\hat{Y}_i - \bar{Y})^2}_{SSR} + \underbrace{\sum_{i=1}^n (Y_i - \hat{Y}_i)^2}_{SSE}</span></p>
<p>gdzie:</p>
<ul>
<li>SST (Całkowita Suma Kwadratów): Całkowita zmienność Y</li>
<li>SSR (Regresyjna Suma Kwadratów): Zmienność wyjaśniona przez regresję</li>
<li>SSE (Suma Kwadratów Błędów): Zmienność niewyjaśniona</li>
</ul>
</section>
<section id="trzy-komponenty-wariancji" class="level3" data-number="16.6.2">
<h3 data-number="16.6.2" class="anchored" data-anchor-id="trzy-komponenty-wariancji"><span class="header-section-number">16.6.2</span> Trzy Komponenty Wariancji</h3>
<ol type="1">
<li><strong>Wariancja Całkowita (SST - Suma Kwadratów Całkowita)</strong>
<ul>
<li>Pytanie: “Jak bardzo obserwacje różnią się od średniej?”</li>
<li>Wzór: <span class="math inline">SST = \sum(y_i - \bar{y})^2</span></li>
<li>Intuicja: “Rozrzut” naszych danych wokół ich średniej</li>
</ul></li>
<li><strong>Wariancja Wyjaśniona (SSR - Suma Kwadratów Regresji)</strong>
<ul>
<li>Pytanie: “Ile wariancji wyjaśnił nasz model?”</li>
<li>Wzór: <span class="math inline">SSR = \sum(\hat{y}_i - \bar{y})^2</span></li>
<li>Intuicja: Poprawa, którą uzyskaliśmy dzięki użyciu X</li>
</ul></li>
<li><strong>Wariancja Niewyjaśniona (SSE - Suma Kwadratów Błędów)</strong>
<ul>
<li>Pytanie: “Jaka wariancja pozostaje niewyjaśniona?”</li>
<li>Wzór: <span class="math inline">SSE = \sum(y_i - \hat{y}_i)^2</span></li>
<li>Intuicja: Błędy, które pozostają po użyciu X</li>
</ul></li>
</ol>
</section>
<section id="współczynnik-r²---wyjaśnienie" class="level3" data-number="16.6.3">
<h3 data-number="16.6.3" class="anchored" data-anchor-id="współczynnik-r²---wyjaśnienie"><span class="header-section-number">16.6.3</span> Współczynnik R² - Wyjaśnienie</h3>
<p><span class="math display">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span> Współczynnik R² odpowiada na pytanie: “Jaki procent pierwotnej zmienności Y możemy wyjaśnić za pomocą X?”</p>
<section id="intuicyjne-przykłady" class="level4" data-number="16.6.3.1">
<h4 data-number="16.6.3.1" class="anchored" data-anchor-id="intuicyjne-przykłady"><span class="header-section-number">16.6.3.1</span> Intuicyjne Przykłady:</h4>
<ul>
<li>R² = 0,80: Wykorzystanie X wyeliminowało 80% błędów predykcji</li>
<li>R² = 0,25: Wykorzystanie X wyeliminowało 25% błędów predykcji</li>
<li>R² = 0,00: Wykorzystanie X nie przyniosło żadnej poprawy</li>
</ul>
</section>
</section>
<section id="kiedy-zachować-ostrożność" class="level3" data-number="16.6.4">
<h3 data-number="16.6.4" class="anchored" data-anchor-id="kiedy-zachować-ostrożność"><span class="header-section-number">16.6.4</span> Kiedy Zachować Ostrożność</h3>
<ol type="1">
<li><strong>Wysoki R² Nie Jest Wszystkim</strong>
<ul>
<li>Wysoki R² może wskazywać na przeuczenie modelu</li>
<li>Zawsze sprawdzaj, czy model ma sens praktyczny</li>
<li>Weź pod uwagę kontekst swojej dziedziny</li>
</ul></li>
<li><strong>Niski R² Nie Zawsze Jest Zły</strong>
<ul>
<li>W niektórych dziedzinach R² = 0,30 może być imponujący</li>
<li>Nauki społeczne często mają niższe wartości R²</li>
<li>Skup się na znaczeniu praktycznym</li>
</ul></li>
</ol>
</section>
<section id="praktyczne-wskazówki-do-analizy" class="level3" data-number="16.6.5">
<h3 data-number="16.6.5" class="anchored" data-anchor-id="praktyczne-wskazówki-do-analizy"><span class="header-section-number">16.6.5</span> Praktyczne Wskazówki do Analizy</h3>
<ol type="1">
<li><strong>Inspekcja Wizualna</strong>
<ul>
<li>Zawsze wizualizuj swoje dane</li>
<li>Szukaj wzorców w resztach</li>
<li>Sprawdzaj punkty wpływowe</li>
</ul></li>
<li><strong>Uwzględnienie Kontekstu</strong>
<ul>
<li>Co jest “dobrym” R² w twojej dziedzinie?</li>
<li>Jaki jest praktyczny wpływ twoich błędów?</li>
<li>Czy twoje predyktory są znaczące?</li>
</ul></li>
<li><strong>Diagnostyka Modelu</strong>
<ul>
<li>Sprawdź normalność reszt</li>
<li>Szukaj heteroskedastyczności</li>
<li>Badaj punkty wpływowe</li>
</ul></li>
</ol>
</section>
<section id="kluczowe-wnioski-1" class="level3" data-number="16.6.6">
<h3 data-number="16.6.6" class="anchored" data-anchor-id="kluczowe-wnioski-1"><span class="header-section-number">16.6.6</span> Kluczowe Wnioski</h3>
<ol type="1">
<li>Dekompozycja wariancji pomaga zrozumieć poprawę predykcji</li>
<li>R² określa proporcję wyjaśnionej wariancji</li>
<li>Zrozumienie wizualne jest kluczowe dla interpretacji</li>
<li>Kontekst jest ważniejszy niż bezwzględne wartości R²</li>
<li>Zawsze łącz R² z innymi narzędziami diagnostycznymi</li>
</ol>
</section>
<section id="miary-dopasowania" class="level3" data-number="16.6.7">
<h3 data-number="16.6.7" class="anchored" data-anchor-id="miary-dopasowania"><span class="header-section-number">16.6.7</span> Miary Dopasowania</h3>
<ol type="1">
<li><p><strong>R-kwadrat (<span class="math inline">R^2</span>)</strong>: <span class="math display">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span></p></li>
<li><p><strong>Pierwiastek Błędu Średniokwadratowego (RMSE)</strong>: <span class="math display">RMSE = \sqrt{\frac{SSE}{n}}</span></p></li>
<li><p><strong>Średni Błąd Bezwzględny (MAE)</strong>: <span class="math display">MAE = \frac{1}{n}\sum_{i=1}^n |Y_i - \hat{Y}_i|</span></p></li>
</ol>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dekompozycja Wariancji w Regresji Liniowej: Intuicyjny Przewodnik
</div>
</div>
<div class="callout-body-container callout-body">
<section id="dlaczego-to-jest-ważne-zrozumienie-poprawy-prognoz-poprzez-dodatkowe-informacje" class="level3" data-number="16.6.8">
<h3 data-number="16.6.8" class="anchored" data-anchor-id="dlaczego-to-jest-ważne-zrozumienie-poprawy-prognoz-poprzez-dodatkowe-informacje"><span class="header-section-number">16.6.8</span> Dlaczego To Jest Ważne: Zrozumienie Poprawy Prognoz Poprzez Dodatkowe Informacje</h3>
<p>Rozważmy wyzwanie związane z przewidywaniem cen nieruchomości na rynku mieszkaniowym. Na najbardziej podstawowym poziomie można oszacować cenę dowolnego domu, używając średniej ceny rynkowej. Jednakże takie podejście pomija potencjalnie wartościowe informacje. Gdy uwzględnimy dodatkowe zmienne, takie jak powierzchnia użytkowa, lokalizacja czy liczba sypialni, nasze prognozy zazwyczaj stają się bardziej precyzyjne. <strong>Dekompozycja wariancji</strong> dostarcza matematycznych ram do dokładnego określenia, o ile poprawia się trafność prognoz, gdy włączamy takie dodatkowe informacje.</p>
</section>
<section id="udoskonalenie-estymacji" class="level3" data-number="16.6.9">
<h3 data-number="16.6.9" class="anchored" data-anchor-id="udoskonalenie-estymacji"><span class="header-section-number">16.6.9</span> Udoskonalenie Estymacji</h3>
<section id="podejście-początkowe-uniwersalna-średnia" class="level4" data-number="16.6.9.1">
<h4 data-number="16.6.9.1" class="anchored" data-anchor-id="podejście-początkowe-uniwersalna-średnia"><span class="header-section-number">16.6.9.1</span> Podejście Początkowe: Uniwersalna Średnia</h4>
<p>Nasza podróż rozpoczyna się od najprostszej możliwej prognozy: średniej wszystkich cen domów (<span class="math inline">\bar{y}</span>). Stanowi to nasz punkt wyjścia – prognozę dokonaną bez żadnych szczególnych informacji o poszczególnych nieruchomościach. Choć podejście to zapewnia rozsądny punkt odniesienia, traktuje każdy dom identycznie, prowadząc do tzw. <strong>błędów bazowych</strong>. Błędy te powstają właśnie dlatego, że ignorujemy unikalne cechy każdej nieruchomości.</p>
</section>
<section id="podejście-zaawansowane-włączenie-informacji-szczegółowych" class="level4" data-number="16.6.9.2">
<h4 data-number="16.6.9.2" class="anchored" data-anchor-id="podejście-zaawansowane-włączenie-informacji-szczegółowych"><span class="header-section-number">16.6.9.2</span> Podejście Zaawansowane: Włączenie Informacji Szczegółowych</h4>
<p>Gdy wprowadzamy charakterystyki specyficzne dla nieruchomości (oznaczone jako <span class="math inline">X</span>), takie jak powierzchnia użytkowa, możemy udoskonalić nasze prognozy. To udoskonalenie pozwala nam różnicować między nieruchomościami, tworząc spersonalizowane prognozy odzwierciedlające indywidualne cechy domów. Wynikające z tego błędy prognoz zazwyczaj maleją, demonstrując wartość włączenia dodatkowych informacji.</p>
</section>
</section>
<section id="zrozumienie-komponentów-wariancji" class="level3" data-number="16.6.10">
<h3 data-number="16.6.10" class="anchored" data-anchor-id="zrozumienie-komponentów-wariancji"><span class="header-section-number">16.6.10</span> Zrozumienie Komponentów Wariancji</h3>
<ol type="1">
<li><strong>Wariancja Całkowita (SST)</strong> Wariancja całkowita określa ogólną zmienność cen domów wokół średniej rynkowej.
<ul>
<li><strong>Wyrażenie Matematyczne:</strong> <span class="math inline">SST = \sum(y_i - \bar{y})^2</span></li>
<li><strong>Reprezentacja Wizualna:</strong> Zobrazowana przez fioletowe pionowe linie na wykresie, pokazujące odległość każdej rzeczywistej ceny domu od średniej ogólnej</li>
<li><strong>Ramy Koncepcyjne:</strong> Można to rozumieć jako pomiar tego, jak bardzo ceny domów różnią się od siebie na rynku</li>
<li><strong>Interpretacja Praktyczna:</strong> Większe SST wskazuje na bardziej zróżnicowany rynek mieszkaniowy z większą zmiennością cen</li>
</ul></li>
<li><strong>Wariancja Wyjaśniona (SSR)</strong> Ten komponent reprezentuje część zmienności cen, którą nasz model skutecznie wychwytuje poprzez uwzględnione zmienne.
<ul>
<li><strong>Wyrażenie Matematyczne:</strong> <span class="math inline">SSR = \sum(\hat{y}_i - \bar{y})^2</span></li>
<li><strong>Reprezentacja Wizualna:</strong> Pokazana przez zielone przerywane linie, reprezentujące jak bardzo prognozy naszego modelu odbiegają od średniej</li>
<li><strong>Ramy Koncepcyjne:</strong> Mierzy to, o ile lepsze stają się nasze prognozy, gdy uwzględniamy szczególne cechy domów</li>
<li><strong>Interpretacja Praktyczna:</strong> Większe SSR w stosunku do SST wskazuje, że wybrane przez nas zmienne (jak powierzchnia użytkowa) silnie wpływają na ceny domów</li>
</ul></li>
<li><strong>Wariancja Niewyjaśniona (SSE)</strong> Reprezentuje pozostałą zmienność cen, której nasz model nie może wyjaśnić przy użyciu uwzględnionych zmiennych.
<ul>
<li><strong>Wyrażenie Matematyczne:</strong> <span class="math inline">SSE = \sum(y_i - \hat{y}_i)^2</span></li>
<li><strong>Reprezentacja Wizualna:</strong> Zobrazowana przez pomarańczowe przerywane linie, pokazujące pozostałe błędy między naszymi prognozami a rzeczywistymi cenami</li>
<li><strong>Ramy Koncepcyjne:</strong> Są to błędy prognoz, które utrzymują się nawet po uwzględnieniu wszystkich wybranych zmiennych</li>
<li><strong>Interpretacja Praktyczna:</strong> Mniejsze SSE sugeruje, że nasz model wychwytuje większość głównych czynników wpływających na cenę</li>
</ul></li>
</ol>
<p>Piękno tej dekompozycji tkwi w jej matematycznej kompletności: SST = SSR + SSE. Ta zależność mówi nam, że cała zmienność cen musi być albo wyjaśniona przez nasz model (SSR), albo pozostać niewyjaśniona (SSE), dostarczając kompleksowych ram do zrozumienia poprawy prognoz. Kolorowe linie na wykresie stanowią wizualne potwierdzenie tej zależności, pomagając zrozumieć, jak te komponenty współdziałają w praktyce.</p>
<section id="wizualizacja-dekompozycji-wariancji" class="level4" data-number="16.6.10.1">
<h4 data-number="16.6.10.1" class="anchored" data-anchor-id="wizualizacja-dekompozycji-wariancji"><span class="header-section-number">16.6.10.1</span> Wizualizacja Dekompozycji Wariancji</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'patchwork'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    area</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data with clearer pattern</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">sd =</span> <span class="fl">0.8</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model and calculations</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, data)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>mean_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Select specific points for demonstration that are well-spaced</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>demonstration_points <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">25</span>, <span class="dv">42</span>)  <span class="co"># Changed points for better spacing</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create main plot with improved aesthetics</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add background grid for better readability</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="at">by =</span> <span class="fl">0.5</span>), <span class="at">color =</span> <span class="st">"gray90"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.5</span>), <span class="at">color =</span> <span class="st">"gray90"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add regression line and mean line</span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#E41A1C"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_y, <span class="at">linetype =</span> <span class="st">"longdash"</span>, <span class="at">color =</span> <span class="st">"#377EB8"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add data points</span></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"#4A4A4A"</span>) <span class="sc">+</span></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add decomposition segments with improved colors and positioning</span></span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total deviation (purple)</span></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> data[demonstration_points,],</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> x, <span class="at">y =</span> y, <span class="at">yend =</span> mean_y),</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#984EA3"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">1.8</span>) <span class="sc">+</span></span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Explained component (green)</span></span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> data[demonstration_points,],</span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> x, <span class="at">y =</span> mean_y, <span class="at">yend =</span> predicted),</span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#4DAF4A"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Unexplained component (orange)</span></span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> data[demonstration_points,],</span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> x, <span class="at">y =</span> predicted, <span class="at">yend =</span> y),</span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#FF7F00"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add annotations for better understanding</span></span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> data<span class="sc">$</span>x[demonstration_points[<span class="dv">2</span>]], <span class="at">y =</span> mean_y <span class="sc">-</span> <span class="fl">0.2</span>,</span>
<span id="cb58-44"><a href="#cb58-44" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Mean"</span>, <span class="at">color =</span> <span class="st">"#377EB8"</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb58-45"><a href="#cb58-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> data<span class="sc">$</span>x[demonstration_points[<span class="dv">2</span>]], </span>
<span id="cb58-46"><a href="#cb58-46" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> data<span class="sc">$</span>predicted[demonstration_points[<span class="dv">2</span>]] <span class="sc">+</span> <span class="fl">0.2</span>,</span>
<span id="cb58-47"><a href="#cb58-47" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Regression Line"</span>, <span class="at">color =</span> <span class="st">"#E41A1C"</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb58-48"><a href="#cb58-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-49"><a href="#cb58-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Improve theme and labels</span></span>
<span id="cb58-50"><a href="#cb58-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb58-51"><a href="#cb58-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb58-52"><a href="#cb58-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb58-53"><a href="#cb58-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb58-54"><a href="#cb58-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-55"><a href="#cb58-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb58-56"><a href="#cb58-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb58-57"><a href="#cb58-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb58-58"><a href="#cb58-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Variance Decomposition in Linear Regression"</span>,</span>
<span id="cb58-59"><a href="#cb58-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Decomposing total variance into explained and unexplained components"</span>,</span>
<span id="cb58-60"><a href="#cb58-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Predictor (X)"</span>,</span>
<span id="cb58-61"><a href="#cb58-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Response (Y)"</span></span>
<span id="cb58-62"><a href="#cb58-62" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-63"><a href="#cb58-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-64"><a href="#cb58-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Create error distribution plot with improved aesthetics</span></span>
<span id="cb58-65"><a href="#cb58-65" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>mean_error <span class="ot">&lt;-</span> y <span class="sc">-</span> mean_y</span>
<span id="cb58-66"><a href="#cb58-66" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>regression_error <span class="ot">&lt;-</span> y <span class="sc">-</span> data<span class="sc">$</span>predicted</span>
<span id="cb58-67"><a href="#cb58-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-68"><a href="#cb58-68" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data) <span class="sc">+</span></span>
<span id="cb58-69"><a href="#cb58-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_error, <span class="at">fill =</span> <span class="st">"Deviation from Mean"</span>), </span>
<span id="cb58-70"><a href="#cb58-70" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb58-71"><a href="#cb58-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> regression_error, <span class="at">fill =</span> <span class="st">"Regression Residuals"</span>), </span>
<span id="cb58-72"><a href="#cb58-72" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb58-73"><a href="#cb58-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb58-74"><a href="#cb58-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb58-75"><a href="#cb58-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb58-76"><a href="#cb58-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()</span>
<span id="cb58-77"><a href="#cb58-77" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb58-78"><a href="#cb58-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb58-79"><a href="#cb58-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Error Distribution Comparison"</span>,</span>
<span id="cb58-80"><a href="#cb58-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Error Magnitude"</span>,</span>
<span id="cb58-81"><a href="#cb58-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb58-82"><a href="#cb58-82" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb58-83"><a href="#cb58-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb58-84"><a href="#cb58-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#377EB8"</span>, <span class="st">"#E41A1C"</span>)</span>
<span id="cb58-85"><a href="#cb58-85" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-86"><a href="#cb58-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-87"><a href="#cb58-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend explaining the decomposition components</span></span>
<span id="cb58-88"><a href="#cb58-88" aria-hidden="true" tabindex="-1"></a>legend_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb58-89"><a href="#cb58-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb58-90"><a href="#cb58-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb58-91"><a href="#cb58-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb58-92"><a href="#cb58-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">"horizontal"</span></span>
<span id="cb58-93"><a href="#cb58-93" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb58-94"><a href="#cb58-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">label =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb58-95"><a href="#cb58-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb58-96"><a href="#cb58-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Variance Components"</span>,</span>
<span id="cb58-97"><a href="#cb58-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#984EA3"</span>, <span class="st">"#4DAF4A"</span>, <span class="st">"#FF7F00"</span>),</span>
<span id="cb58-98"><a href="#cb58-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Total Deviation"</span>, <span class="st">"Explained Variance"</span>, <span class="st">"Unexplained Variance"</span>)</span>
<span id="cb58-99"><a href="#cb58-99" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-100"><a href="#cb58-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-101"><a href="#cb58-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots with adjusted heights</span></span>
<span id="cb58-102"><a href="#cb58-102" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> (p1 <span class="sc">/</span> p2) <span class="sc">+</span></span>
<span id="cb58-103"><a href="#cb58-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb58-104"><a href="#cb58-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-105"><a href="#cb58-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb58-106"><a href="#cb58-106" aria-hidden="true" tabindex="-1"></a>combined_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="r²-wyjaśnione" class="level3" data-number="16.6.11">
<h3 data-number="16.6.11" class="anchored" data-anchor-id="r²-wyjaśnione"><span class="header-section-number">16.6.11</span> R² Wyjaśnione</h3>
<p><span class="math display">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span></p>
<p>Myśl o R² jako o odpowiedzi na pytanie: “Jaki procent pierwotnej wariancji Y możemy wyjaśnić używając X?”</p>
<section id="intuicyjne-przykłady-1" class="level4" data-number="16.6.11.1">
<h4 data-number="16.6.11.1" class="anchored" data-anchor-id="intuicyjne-przykłady-1"><span class="header-section-number">16.6.11.1</span> Intuicyjne Przykłady:</h4>
<ul>
<li>R² = 0,80: Użycie X wyeliminowało 80% naszych błędów predykcji</li>
<li>R² = 0,25: Użycie X wyeliminowało 25% naszych błędów predykcji</li>
<li>R² = 0,00: Użycie X wcale nie pomogło</li>
</ul>
</section>
</section>
<section id="kiedy-zachować-ostrożność-1" class="level3" data-number="16.6.12">
<h3 data-number="16.6.12" class="anchored" data-anchor-id="kiedy-zachować-ostrożność-1"><span class="header-section-number">16.6.12</span> Kiedy Zachować Ostrożność</h3>
<ol type="1">
<li><strong>Wysoki R² To Nie Wszystko</strong>
<ul>
<li>Wysoki R² może wskazywać na przeuczenie</li>
<li>Zawsze sprawdzaj, czy twój model ma praktyczny sens</li>
<li>Weź pod uwagę kontekst swojej dziedziny</li>
</ul></li>
<li><strong>Niski R² Nie Zawsze Jest Zły</strong>
<ul>
<li>W niektórych dziedzinach R² = 0,30 może być imponujący</li>
<li>Nauki społeczne często mają niższe wartości R²</li>
<li>Skup się na znaczeniu praktycznym</li>
</ul></li>
<li><strong>Wielkość Próby Ma Znaczenie</strong>
<ul>
<li>Używaj skorygowanego R² dla regresji wielorakiej: <span class="math inline">R^2_{adj} = 1 - \frac{SSE/(n-p)}{SST/(n-1)}</span></li>
<li>Penalizuje dodawanie niepotrzebnych predyktorów</li>
</ul></li>
</ol>
</section>
<section id="praktyczne-wskazówki-do-analizy-1" class="level3" data-number="16.6.13">
<h3 data-number="16.6.13" class="anchored" data-anchor-id="praktyczne-wskazówki-do-analizy-1"><span class="header-section-number">16.6.13</span> Praktyczne Wskazówki do Analizy</h3>
<ol type="1">
<li><strong>Inspekcja Wizualna</strong>
<ul>
<li>Zawsze wizualizuj swoje dane</li>
<li>Szukaj wzorców w resztach</li>
<li>Sprawdzaj punkty wpływowe</li>
</ul></li>
<li><strong>Uwzględnienie Kontekstu</strong>
<ul>
<li>Co jest “dobrym” R² w twojej dziedzinie?</li>
<li>Jaki jest praktyczny wpływ twoich błędów?</li>
<li>Czy twoje predyktory są znaczące?</li>
</ul></li>
<li><strong>Diagnostyka Modelu</strong>
<ul>
<li>Sprawdź normalność reszt</li>
<li>Szukaj heteroskedastyczności</li>
<li>Badaj punkty wpływowe</li>
</ul></li>
</ol>
</section>
<section id="kluczowe-wnioski-2" class="level3" data-number="16.6.14">
<h3 data-number="16.6.14" class="anchored" data-anchor-id="kluczowe-wnioski-2"><span class="header-section-number">16.6.14</span> Kluczowe Wnioski</h3>
<ol type="1">
<li>Dekompozycja wariancji pomaga zrozumieć poprawę predykcji</li>
<li>R² określa ilościowo proporcję wyjaśnionej wariancji</li>
<li>Zrozumienie wizualne jest kluczowe dla interpretacji</li>
<li>Kontekst jest ważniejszy niż bezwzględne wartości R²</li>
<li>Zawsze łącz R² z innymi narzędziami diagnostycznymi</li>
</ol>
</section>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Formalne wyprowadzenie estymatorów MNK
</div>
</div>
<div class="callout-body-container callout-body">
<section id="założenia-wstępne" class="level3" data-number="16.6.15">
<h3 data-number="16.6.15" class="anchored" data-anchor-id="założenia-wstępne"><span class="header-section-number">16.6.15</span> Założenia wstępne</h3>
<p>Chcemy znaleźć prostą <span class="math inline">y = \hat{\beta}_0 + \hat{\beta}_1x</span>, która minimalizuje sumę kwadratów reszt. Wyprowadźmy to krok po kroku:</p>
<ol type="1">
<li><p>Najpierw zapisujemy funkcję, którą chcemy zminimalizować:</p>
<p><span class="math inline">SSE = \sum_{i=1}^n (y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i))^2</span></p></li>
<li><p>Aby znaleźć minimum, musimy obliczyć pochodne cząstkowe względem <span class="math inline">\hat{\beta}_0</span> i <span class="math inline">\hat{\beta}_1</span> oraz przyrównać je do zera:</p>
<p><span class="math inline">\frac{\partial SSE}{\partial \hat{\beta}_0} = 0</span> oraz <span class="math inline">\frac{\partial SSE}{\partial \hat{\beta}_1} = 0</span></p></li>
</ol>
</section>
<section id="krok-1-znalezienie-hatbeta_0" class="level3" data-number="16.6.16">
<h3 data-number="16.6.16" class="anchored" data-anchor-id="krok-1-znalezienie-hatbeta_0"><span class="header-section-number">16.6.16</span> Krok 1: Znalezienie <span class="math inline">\hat{\beta}_0</span></h3>
<p>Obliczmy pochodną cząstkową względem <span class="math inline">\hat{\beta}_0</span>:</p>
<p><span class="math inline">\frac{\partial SSE}{\partial \hat{\beta}_0} = \frac{\partial}{\partial \hat{\beta}_0} \sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1x_i)^2</span></p>
<p>Korzystając z reguły łańcuchowej:</p>
<p><span class="math inline">\frac{\partial SSE}{\partial \hat{\beta}_0} = \sum_{i=1}^n 2(y_i - \hat{\beta}_0 - \hat{\beta}_1x_i)(-1) = 0</span></p>
<p>Upraszczając:</p>
<p><span class="math inline">-2\sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1x_i) = 0</span></p>
<p><span class="math inline">\sum_{i=1}^n y_i - n\hat{\beta}_0 - \hat{\beta}_1\sum_{i=1}^n x_i = 0</span></p>
<p>Rozwiązując względem <span class="math inline">\hat{\beta}_0</span>:</p>
<p><span class="math inline">\hat{\beta}_0 = \frac{\sum_{i=1}^n y_i}{n} - \hat{\beta}_1\frac{\sum_{i=1}^n x_i}{n} = \bar{y} - \hat{\beta}_1\bar{x}</span></p>
<p>Gdzie <span class="math inline">\bar{y}</span> i <span class="math inline">\bar{x}</span> to średnie z próby.</p>
</section>
<section id="krok-2-znalezienie-hatbeta_1" class="level3" data-number="16.6.17">
<h3 data-number="16.6.17" class="anchored" data-anchor-id="krok-2-znalezienie-hatbeta_1"><span class="header-section-number">16.6.17</span> Krok 2: Znalezienie <span class="math inline">\hat{\beta}_1</span></h3>
<p>Teraz obliczamy pochodną cząstkową względem <span class="math inline">\hat{\beta}_1</span>:</p>
<p><span class="math inline">\frac{\partial SSE}{\partial \hat{\beta}_1} = \frac{\partial}{\partial \hat{\beta}_1} \sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1x_i)^2</span></p>
<p>Korzystając z reguły łańcuchowej:</p>
<p><span class="math inline">\frac{\partial SSE}{\partial \hat{\beta}_1} = \sum_{i=1}^n 2(y_i - \hat{\beta}_0 - \hat{\beta}_1x_i)(-x_i) = 0</span></p>
<p>Upraszczając:</p>
<p><span class="math inline">-2\sum_{i=1}^n x_i(y_i - \hat{\beta}_0 - \hat{\beta}_1x_i) = 0</span></p>
<p>Podstawiając nasze wyrażenie na <span class="math inline">\hat{\beta}_0</span>:</p>
<p><span class="math inline">-2\sum_{i=1}^n x_i(y_i - (\bar{y} - \hat{\beta}_1\bar{x}) - \hat{\beta}_1x_i) = 0</span></p>
<p><span class="math inline">\sum_{i=1}^n x_i(y_i - \bar{y} + \hat{\beta}_1\bar{x} - \hat{\beta}_1x_i) = 0</span></p>
<p>Po przekształceniach algebraicznych (rozwinięciu i zgrupowaniu wyrazów):</p>
<p><span class="math inline">\hat{\beta}_1 = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^n (x_i - \bar{x})^2}</span></p>
</section>
<section id="wyniki-końcowe" class="level3" data-number="16.6.18">
<h3 data-number="16.6.18" class="anchored" data-anchor-id="wyniki-końcowe"><span class="header-section-number">16.6.18</span> Wyniki końcowe</h3>
<p>Wyprowadziliśmy estymatory MNK:</p>
<p><span class="math inline">\hat{\beta}_1 = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^n (x_i - \bar{x})^2}</span></p>
<p><span class="math inline">\hat{\beta}_0 = \bar{y} - \hat{\beta}_1\bar{x}</span></p>
<p>Zrozummy, co oznaczają te wzory:</p>
<ol type="1">
<li><p>Estymator nachylenia <span class="math inline">\hat{\beta}_1</span>:</p>
<ul>
<li>Licznik: Mierzy, jak <span class="math inline">x</span> i <span class="math inline">y</span> zmieniają się razem (kowariancja)</li>
<li>Mianownik: Mierzy, jak bardzo zmienia się <span class="math inline">x</span> (wariancja)</li>
<li>Więc <span class="math inline">\hat{\beta}_1</span> jest zasadniczo stosunkiem kowariancji do wariancji</li>
</ul></li>
<li><p>Estymator wyrazu wolnego <span class="math inline">\hat{\beta}_0</span>:</p>
<ul>
<li>Zapewnia, że prosta przechodzi przez punkt <span class="math inline">(\bar{x}, \bar{y})</span></li>
<li>Dostosowuje wysokość prostej na podstawie nachylenia</li>
</ul></li>
</ol>
</section>
<section id="weryfikacja-drugie-pochodne" class="level3" data-number="16.6.19">
<h3 data-number="16.6.19" class="anchored" data-anchor-id="weryfikacja-drugie-pochodne"><span class="header-section-number">16.6.19</span> Weryfikacja: Drugie pochodne</h3>
<p>Aby potwierdzić, że znaleźliśmy minimum (a nie maksimum), sprawdzamy drugie pochodne:</p>
<p><span class="math inline">\frac{\partial^2 SSE}{\partial \hat{\beta}_0^2} = 2n &gt; 0</span></p>
<p><span class="math inline">\frac{\partial^2 SSE}{\partial \hat{\beta}_1^2} = 2\sum_{i=1}^n x_i^2 &gt; 0</span></p>
<p>Ponieważ obie drugie pochodne są dodatnie, rzeczywiście znaleźliśmy minimum.</p>
</section>
<section id="postać-macierzowa-temat-zaawansowany-opcjonalny" class="level3" data-number="16.6.20">
<h3 data-number="16.6.20" class="anchored" data-anchor-id="postać-macierzowa-temat-zaawansowany-opcjonalny"><span class="header-section-number">16.6.20</span> Postać macierzowa (Temat zaawansowany, opcjonalny)</h3>
<p>Dla osób znających algebrę liniową, możemy zapisać to zwięźlej:</p>
<p><span class="math inline">\mathbf{X} = \begin{bmatrix} 1 &amp; x_1 \\ 1 &amp; x_2 \\ \vdots &amp; \vdots \\ 1 &amp; x_n \end{bmatrix}</span></p>
<p><span class="math inline">\mathbf{y} = \begin{bmatrix} y_1 \\ y_2 \\ \vdots \\ y_n \end{bmatrix}</span></p>
<p>Wtedy estymator MNK w postaci macierzowej to:</p>
<p><span class="math inline">\hat{\boldsymbol{\beta}} = (\mathbf{X}'\mathbf{X})^{-1}\mathbf{X}'\mathbf{y}</span></p>
<p>To daje nam zarówno <span class="math inline">\hat{\beta}_0</span> jak i <span class="math inline">\hat{\beta}_1</span> w jednym eleganckim wyrażeniu.</p>
</section>
<section id="wizualizacja-wyprowadzenia" class="level3" data-number="16.6.21">
<h3 data-number="16.6.21" class="anchored" data-anchor-id="wizualizacja-wyprowadzenia"><span class="header-section-number">16.6.21</span> Wizualizacja wyprowadzenia</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie przykładowych danych</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>, <span class="dv">1</span>, <span class="dv">8</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczanie średnich</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>x_srednia <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>y_srednia <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wizualizacji odchyleń</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> y_srednia, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> x_srednia, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> x, <span class="at">yend =</span> y_srednia), <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">yend =</span> y, <span class="at">xend =</span> x_srednia), <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wizualizacja odchyleń od średnich"</span>,</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Zielone: Odchylenia w y, Fioletowe: Odchylenia w x"</span>,</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Powyższy wykres pokazuje, jak działają estymatory MNK z odchyleniami od średnich. Iloczyn tych odchyleń (zielone × fioletowe) dla każdego punktu, zsumowany i znormalizowany, daje nam nasz estymator nachylenia <span class="math inline">\hat{\beta}_1</span>.</p>
</section>
<section id="ważne-uwagi-1" class="level3" data-number="16.6.22">
<h3 data-number="16.6.22" class="anchored" data-anchor-id="ważne-uwagi-1"><span class="header-section-number">16.6.22</span> Ważne uwagi</h3>
<ol type="1">
<li><p>Wyprowadzone estymatory są BLUE (Best Linear Unbiased Estimators - Najlepsze Liniowe Nieobciążone Estymatory) przy spełnieniu założeń Gaussa-Markowa.</p></li>
<li><p>Założenia te obejmują:</p>
<ul>
<li>Liniowość zależności</li>
<li>Losowość próby</li>
<li>Brak współliniowości idealnej</li>
<li>Homoskedastyczność (stała wariancja reszt)</li>
<li>Niezależność obserwacji</li>
</ul></li>
<li><p>Metoda ta minimalizuje sumę kwadratów reszt w kierunku pionowym (odchylenia w <span class="math inline">y</span>), a nie prostopadłym do prostej.</p></li>
</ol>
</section>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Endogeniczność
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pomyśl o endogeniczności jako o “problemie ukrytych zależności” w twojej analizie. To jak próba rozwiązania układanki, gdzie niektóre elementy wpływają na siebie nawzajem w sposób, którego nie możesz bezpośrednio zobaczyć. W języku technicznym endogeniczność występuje, gdy zmienna objaśniająca w modelu regresji jest skorelowana ze składnikiem losowym.</p>
<ol type="1">
<li>Błąd Pominiętej Zmiennej (OVB)</li>
</ol>
<p>Wyobraź sobie, że próbujesz zrozumieć, dlaczego niektóre rośliny rosną wyżej niż inne, i mierzysz tylko ilość wody, którą otrzymują. Ale zapomniałeś o świetle słonecznym, które wpływa zarówno na to, ile wody roślina potrzebuje, JAK I na to, jak wysoko urośnie!</p>
<p><strong>Przykład z Życia: Edukacja i Dochód</strong></p>
<ul>
<li>Co widzimy: Więcej edukacji → Wyższy dochód</li>
<li>Co możemy przeoczyć: Naturalny talent/zdolności
<ul>
<li>Wpływa na to, jak długo ludzie się uczą</li>
<li>Wpływa na to, ile mogą zarabiać</li>
</ul></li>
<li>Rezultat: Możemy przeszacować wpływ edukacji</li>
</ul>
<p><strong>Matematyka za tym stojąca</strong>:</p>
<ul>
<li>Prawdziwy obraz: <span class="math inline">y_i = \beta_0 + \beta_1x_i + \beta_2z_i + \epsilon_i</span></li>
<li>Co faktycznie szacujemy: <span class="math inline">y_i = \beta_0 + \beta_1x_i + u_i</span></li>
<li>Pomyśl o tym jak o przepisie: Jeśli zapomnisz ważnego składnika (z), twoje końcowe danie (y) nie wyjdzie zgodnie z oczekiwaniami!</li>
</ul>
<ol start="2" type="1">
<li>Symultaniczność (Odwrotna Przyczynowość)</li>
</ol>
<p>Pamiętasz problem jajka i kury? Czasami dwie rzeczy wpływają na siebie jednocześnie. Oto kilka przykładów, które możesz napotkać:</p>
<p><strong>a) Zagadka Godzin Nauki</strong></p>
<ul>
<li>Czy lepsze oceny prowadzą do dłuższej nauki?</li>
<li>Czy dłuższa nauka prowadzi do lepszych ocen?</li>
<li>W rzeczywistości… obie odpowiedzi! Wzajemnie na siebie wpływają</li>
</ul>
<p><strong>b) Efekt Mediów Społecznościowych</strong></p>
<ul>
<li>Więcej obserwujących → Więcej postów</li>
<li>Więcej postów → Więcej obserwujących</li>
<li>To ciągły cykl!</li>
</ul>
<p><strong>c) Cykl Ćwiczenia-Energia</strong></p>
<ul>
<li>Więcej ćwiczeń → Więcej energii</li>
<li>Więcej energii → Większa chęć do ćwiczeń</li>
<li>Pomyśl o tym jak o dwóch przyjaciołach pchających się nawzajem na huśtawkach!</li>
</ul>
<ol start="3" type="1">
<li>Błąd Pomiaru</li>
</ol>
<p>Wyobraź sobie próbę zmierzenia swojego wzrostu stojąc na nierównej podłodze - twoje pomiary nie będą całkiem dokładne! Oto jak to się przejawia w rzeczywistości:</p>
<p><strong>Przykłady, Które Rozpoznasz:</strong></p>
<ul>
<li>Samodzielnie Raportowany Czas Nauki
<ul>
<li>“Uczę się 5 godzin dziennie” może w rzeczywistości oznaczać 3-4 godziny</li>
<li>Utrudnia poznanie prawdziwego wpływu na oceny</li>
</ul></li>
<li>Śledzenie w Aplikacji Fitness
<ul>
<li>Aplikacja pokazuje, że spaliłeś 500 kalorii</li>
<li>W rzeczywistości może to być 400 lub 600</li>
<li>Wpływa na analizę wpływu ćwiczeń</li>
</ul></li>
</ul>
<section id="jak-wykryć-te-problemy-we-własnych-badaniach" class="level4" data-number="16.6.22.1">
<h4 data-number="16.6.22.1" class="anchored" data-anchor-id="jak-wykryć-te-problemy-we-własnych-badaniach"><span class="header-section-number">16.6.22.1</span> Jak Wykryć Te Problemy we Własnych Badaniach?</h4>
<p><strong>1. W przypadku Pominiętych Zmiennych, Zapytaj:</strong></p>
<ul>
<li>Co jeszcze mogłoby wpływać na obie zmienne?</li>
<li>Czy nie pomijam oczywistych czynników?</li>
<li>Co powiedzieliby rodzice/przyjaciele, że ma na to wpływ?</li>
</ul>
<p><strong>2. W przypadku Symultaniczności, Rozważ:</strong></p>
<ul>
<li>Czy A może powodować B, czy B może powodować A?</li>
<li>Czy mogą na siebie wpływać?</li>
<li>Co wydarzyło się najpierw? (jeśli można to określić)</li>
</ul>
<p><strong>3. W przypadku Błędu Pomiaru, Pomyśl:</strong></p>
<ul>
<li>Jak dokładne są moje pomiary?</li>
<li>Czy ludzie prawdopodobnie podają prawdziwe informacje?</li>
<li>Co może powodować problemy z pomiarem?</li>
</ul>
<p><strong>Proste Rozwiązania</strong></p>
<p><strong>1. Dla Pominiętych Zmiennych:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Zamiast:</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># simple_model &lt;- lm(grades ~ study_hours)</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Spróbuj:</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co"># better_model &lt;- lm(grades ~ study_hours + sleep_hours + stress_level + prior_knowledge)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>2. Dla Symultaniczności:</strong></p>
<ul>
<li>Szukaj “zewnętrznych” czynników, które wpływają tylko na jedną zmienną</li>
<li>Rozważ opóźnienia czasowe</li>
<li>Wykorzystuj eksperymenty naturalne, gdy to możliwe</li>
</ul>
<p><strong>3. Dla Błędu Pomiaru:</strong></p>
<ul>
<li>Wykorzystuj wielokrotne pomiary</li>
<li>Znajdź bardziej wiarygodne źródła danych</li>
<li>Uznaj niepewność w swoich wnioskach</li>
</ul>
</section>
<section id="kluczowe-wnioski-3" class="level4" data-number="16.6.22.2">
<h4 data-number="16.6.22.2" class="anchored" data-anchor-id="kluczowe-wnioski-3"><span class="header-section-number">16.6.22.2</span> Kluczowe Wnioski</h4>
<ol type="1">
<li><p><strong>Rzeczywistość Jest Złożona</strong></p>
<ul>
<li>Większość relacji nie jest prostym A → B</li>
<li>Szukaj ukrytych czynników</li>
<li>Rozważ dwukierunkowe zależności</li>
</ul></li>
<li><p><strong>Zawsze Pytaj</strong></p>
<ul>
<li>“Co pomijam?”</li>
<li>“Czy te pominięte zmienne mogą na siebie wpływać?”</li>
<li>“Jak dobrze mierzę te zmienne?”</li>
</ul></li>
<li><p><strong>Podczas Pisania Prac</strong></p>
<ul>
<li>Omów potencjalną endogeniczność</li>
<li>Wyjaśnij, jak się do niej odniosłeś</li>
<li>Bądź szczery odnośnie ograniczeń</li>
</ul></li>
</ol>
<p><strong>Zalecana Literatura</strong></p>
<ol type="1">
<li>“Mastering Metrics” autorstwa Angrist &amp; Pischke</li>
<li>“Naked Statistics” autorstwa Charles Wheelan</li>
</ol>
<p>Pamiętaj: W rzeczywistym świecie relacje są zwykle bardziej złożone, niż się początkowo wydaje. Gdy znajdziesz połączenie między A i B, zawsze zadaj sobie pytanie, co jeszcze może może wpływać na zmienne A i B!</p>
</section>
</div>
</div>
</section>
</section>
<section id="regresja-wieloraka" class="level2" data-number="16.7">
<h2 data-number="16.7" class="anchored" data-anchor-id="regresja-wieloraka"><span class="header-section-number">16.7</span> Regresja Wieloraka (*)</h2>
<section id="rozszerzenie-do-wielu-predyktorów" class="level3" data-number="16.7.1">
<h3 data-number="16.7.1" class="anchored" data-anchor-id="rozszerzenie-do-wielu-predyktorów"><span class="header-section-number">16.7.1</span> Rozszerzenie do Wielu Predyktorów</h3>
<p>Model regresji wielorakiej rozszerza nasz prosty model o kilka predyktorów:</p>
<p>Model Populacyjny: <span class="math display">Y = \beta_0 + \beta_1X_1 + \beta_2X_2 + ... + \beta_kX_k + \varepsilon</span></p>
<p>Oszacowanie Próbkowe: <span class="math display">\hat{Y} = \hat{\beta}_0 + \hat{\beta}_1X_1 + \hat{\beta}_2X_2 + ... + \hat{\beta}_kX_k</span></p>
<p>Stwórzmy przykład z wieloma predyktorami:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data with two predictors</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">105</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>X1 <span class="sc">+</span> <span class="fl">0.8</span><span class="sc">*</span>X2 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>data_multiple <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y =</span> Y, <span class="at">X1 =</span> X1, <span class="at">X2 =</span> X2)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit multiple regression model</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>model_multiple <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2, <span class="at">data =</span> data_multiple)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 3D visualization using scatter plots</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_multiple, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Y vs X1"</span>)</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_multiple, <span class="fu">aes</span>(<span class="at">x =</span> X2, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Y vs X2"</span>)</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/multiple-regression-example-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Przykład Regresji Wielorakiej</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_multiple)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Y ~ X1 + X2, data = data_multiple)

Residuals:
     Min       1Q   Median       3Q      Max 
-10.8598  -3.6005   0.1166   3.0892  14.6102 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 11.77567    4.01351   2.934  0.00418 ** 
X1           0.45849    0.05992   7.651 1.47e-11 ***
X2           0.81639    0.11370   7.180 1.42e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.122 on 97 degrees of freedom
Multiple R-squared:  0.5062,    Adjusted R-squared:  0.4961 
F-statistic: 49.72 on 2 and 97 DF,  p-value: 1.367e-15</code></pre>
</div>
</div>
</section>
<section id="interpretacja-współczynników" class="level3" data-number="16.7.2">
<h3 data-number="16.7.2" class="anchored" data-anchor-id="interpretacja-współczynników"><span class="header-section-number">16.7.2</span> Interpretacja Współczynników</h3>
<p>W regresji wielorakiej, każdy <span class="math inline">\hat{\beta}_k</span> reprezentuje oczekiwaną zmianę w Y przy jednostkowym wzroście <span class="math inline">X_k</span>, przy utrzymaniu wszystkich innych zmiennych na stałym poziomie.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction grid for X1 (holding X2 at its mean)</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>X1_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X1), <span class="fu">max</span>(X1), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>pred_data_X1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">X1 =</span> X1_grid,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">X2 =</span> <span class="fu">mean</span>(X2)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>pred_data_X1<span class="sc">$</span>Y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_multiple, <span class="at">newdata =</span> pred_data_X1)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction grid for X2 (holding X1 at its mean)</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>X2_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X2), <span class="fu">max</span>(X2), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>pred_data_X2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">X1 =</span> <span class="fu">mean</span>(X1),</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">X2 =</span> X2_grid</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>pred_data_X2<span class="sc">$</span>Y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_multiple, <span class="at">newdata =</span> pred_data_X2)</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot partial effects</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_multiple, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pred_data_X1, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> Y_pred), </span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Efekt Cząstkowy X1"</span>,</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"(X2 utrzymane na średniej ="</span>, <span class="fu">round</span>(<span class="fu">mean</span>(X2), <span class="dv">2</span>), <span class="st">")"</span>))</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_multiple, <span class="fu">aes</span>(<span class="at">x =</span> X2, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pred_data_X2, <span class="fu">aes</span>(<span class="at">x =</span> X2, <span class="at">y =</span> Y_pred), </span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Efekt Cząstkowy X2"</span>,</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"(X1 utrzymane na średniej ="</span>, <span class="fu">round</span>(<span class="fu">mean</span>(X1), <span class="dv">2</span>), <span class="st">")"</span>))</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/coefficient-interpretation-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Efekty Cząstkowe w Regresji Wielorakiej</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="współliniowość" class="level3" data-number="16.7.3">
<h3 data-number="16.7.3" class="anchored" data-anchor-id="współliniowość"><span class="header-section-number">16.7.3</span> Współliniowość</h3>
<p>Współliniowość występuje, gdy predyktory są silnie skorelowane. Zobaczmy jej efekty:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data with multicollinearity</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">106</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>X1_new <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>X2_new <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>X1_new <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)  <span class="co"># X2 silnie skorelowane z X1</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>Y_new <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>X1_new <span class="sc">+</span> <span class="fl">0.8</span><span class="sc">*</span>X2_new <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>data_collinear <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y =</span> Y_new, <span class="at">X1 =</span> X1_new, <span class="at">X2 =</span> X2_new)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model with multicollinearity</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>model_collinear <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2, <span class="at">data =</span> data_collinear)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate VIF</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    some</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:psych':

    logit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>vif_results <span class="ot">&lt;-</span> <span class="fu">vif</span>(model_collinear)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot correlation</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_collinear, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2)) <span class="sc">+</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Korelacja między Predyktorami"</span>,</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Korelacja ="</span>, </span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">round</span>(<span class="fu">cor</span>(X1_new, X2_new), <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/multicollinearity-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Efekty Współliniowości</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="tematy-zaawansowane" class="level2" data-number="16.8">
<h2 data-number="16.8" class="anchored" data-anchor-id="tematy-zaawansowane"><span class="header-section-number">16.8</span> Tematy Zaawansowane</h2>
<section id="efekty-interakcji" class="level3" data-number="16.8.1">
<h3 data-number="16.8.1" class="anchored" data-anchor-id="efekty-interakcji"><span class="header-section-number">16.8.1</span> Efekty Interakcji</h3>
<p>Efekty interakcji pozwalają na to, by wpływ jednego predyktora zależał od innego:</p>
<p><span class="math display">Y = \beta_0 + \beta_1X_1 + \beta_2X_2 + \beta_3(X_1 \times X_2) + \varepsilon</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data with interaction</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">107</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>X1_int <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>X2_int <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>Y_int <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>X1_int <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>X2_int <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>X1_int<span class="sc">*</span>X2_int <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>data_int <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X1 =</span> X1_int, <span class="at">X2 =</span> X2_int, <span class="at">Y =</span> Y_int)</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>model_int <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">*</span> X2, <span class="at">data =</span> data_int)</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create interaction plot</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>X1_levels <span class="ot">&lt;-</span> <span class="fu">quantile</span>(X1_int, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>X2_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X2_int), <span class="fu">max</span>(X2_int), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">X1 =</span> X1_levels,</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">X2 =</span> X2_seq</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>pred_data<span class="sc">$</span>Y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_int, <span class="at">newdata =</span> pred_data)</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>pred_data<span class="sc">$</span>X1_level <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_data<span class="sc">$</span>X1, </span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Niskie X1"</span>, <span class="st">"Wysokie X1"</span>))</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_data, <span class="fu">aes</span>(<span class="at">x =</span> X2, <span class="at">y =</span> Y_pred, <span class="at">color =</span> X1_level)) <span class="sc">+</span></span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Efekt Interakcji"</span>,</span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Wpływ X2 zależy od poziomu X1"</span>,</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Poziom X1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/interactions-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Wizualizacja Efektów Interakcji</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="wyrazy-wielomianowe" class="level3" data-number="16.8.2">
<h3 data-number="16.8.2" class="anchored" data-anchor-id="wyrazy-wielomianowe"><span class="header-section-number">16.8.2</span> Wyrazy Wielomianowe</h3>
<p>Gdy zależności są nieliniowe, możemy dodać wyrazy wielomianowe:</p>
<p><span class="math display">Y = \beta_0 + \beta_1X + \beta_2X^2 + \varepsilon</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data with quadratic relationship</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">108</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>X_poly <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>Y_poly <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>X_poly <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>X_poly<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(X_poly), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>data_poly <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> X_poly, <span class="at">Y =</span> Y_poly)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear and quadratic models</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>model_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> data_poly)</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>model_quad <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X <span class="sc">+</span> <span class="fu">I</span>(X<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> data_poly)</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Add predictions</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>data_poly<span class="sc">$</span>pred_linear <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_linear)</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>data_poly<span class="sc">$</span>pred_quad <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_quad)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_poly, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_linear, <span class="at">color =</span> <span class="st">"Liniowy"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_quad, <span class="at">color =</span> <span class="st">"Kwadratowy"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Dopasowanie Liniowe vs Kwadratowe"</span>,</span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Typ Modelu"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/polynomial-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Przykład Regresji Wielomianowej</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="praktyczne-wskazówki-do-analizy-regresji" class="level2" data-number="16.9">
<h2 data-number="16.9" class="anchored" data-anchor-id="praktyczne-wskazówki-do-analizy-regresji"><span class="header-section-number">16.9</span> Praktyczne Wskazówki do Analizy Regresji</h2>
<section id="proces-budowy-modelu" class="level3" data-number="16.9.1">
<h3 data-number="16.9.1" class="anchored" data-anchor-id="proces-budowy-modelu"><span class="header-section-number">16.9.1</span> Proces Budowy Modelu</h3>
<ol type="1">
<li><strong>Eksploracja Danych</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate example dataset</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">109</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>data_example <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x1 =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">x2 =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">x3 =</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>data_example<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>data_example<span class="sc">$</span>x1 <span class="sc">+</span> <span class="fl">0.8</span><span class="sc">*</span>data_example<span class="sc">$</span>x2 <span class="sc">-</span> </span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>                 <span class="fl">0.3</span><span class="sc">*</span>data_example<span class="sc">$</span>x3 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation matrix plot</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(data_example) <span class="sc">+</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Analiza Eksploracyjna Danych"</span>,</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Macierz korelacji i rozkłady"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/data-exploration-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Przykład Eksploracji Danych</figcaption>
</figure>
</div>
</div>
</div>
<ol start="2" type="1">
<li><strong>Wybór Zmiennych</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models with different variables</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1, <span class="at">data =</span> data_example)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> data_example)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">data =</span> data_example)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare models</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>models_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"y ~ x1"</span>, <span class="st">"y ~ x1 + x2"</span>, <span class="st">"y ~ x1 + x2 + x3"</span>),</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_kwadrat =</span> <span class="fu">c</span>(<span class="fu">summary</span>(model1)<span class="sc">$</span>r.squared,</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">summary</span>(model2)<span class="sc">$</span>r.squared,</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">summary</span>(model3)<span class="sc">$</span>r.squared),</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Skorygowany_R_kwadrat =</span> <span class="fu">c</span>(<span class="fu">summary</span>(model1)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">summary</span>(model2)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">summary</span>(model3)<span class="sc">$</span>adj.r.squared)</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(models_comparison, <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Podsumowanie Porównania Modeli"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Podsumowanie Porównania Modeli</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">R_kwadrat</th>
<th style="text-align: right;">Skorygowany_R_kwadrat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">y ~ x1</td>
<td style="text-align: right;">0.323</td>
<td style="text-align: right;">0.316</td>
</tr>
<tr class="even">
<td style="text-align: left;">y ~ x1 + x2</td>
<td style="text-align: right;">0.433</td>
<td style="text-align: right;">0.421</td>
</tr>
<tr class="odd">
<td style="text-align: left;">y ~ x1 + x2 + x3</td>
<td style="text-align: right;">0.893</td>
<td style="text-align: right;">0.890</td>
</tr>
</tbody>
</table>
<p>Proces Wyboru Zmiennych</p>
</div>
</div>
</section>
<section id="typowe-pułapki-i-rozwiązania" class="level3" data-number="16.9.2">
<h3 data-number="16.9.2" class="anchored" data-anchor-id="typowe-pułapki-i-rozwiązania"><span class="header-section-number">16.9.2</span> Typowe Pułapki i Rozwiązania</h3>
<ol type="1">
<li><strong>Wartości Odstające i Punkty Wpływowe</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data with outlier</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">110</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>x_clean <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>y_clean <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x_clean <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>data_clean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_clean, <span class="at">y =</span> y_clean)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add outlier</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>data_outlier <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_clean,</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">10</span>))</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>model_clean <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data_clean)</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>model_outlier <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data_outlier)</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_clean, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_outlier[<span class="dv">51</span>,], <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), </span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> data_clean, </span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">predict</span>(model_clean), </span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"Bez Wartości Odstającej"</span>)) <span class="sc">+</span></span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> data_outlier, </span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">predict</span>(model_outlier), </span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"Z Wartością Odstającą"</span>)) <span class="sc">+</span></span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wpływ Wartości Odstających na Regresję"</span>,</span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Model"</span>) <span class="sc">+</span></span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/outliers-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Identyfikacja i Obsługa Wartości Odstających</figcaption>
</figure>
</div>
</div>
</div>
<ol start="2" type="1">
<li><strong>Wzorce Brakujących Danych</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data with missing values</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>data_missing <span class="ot">&lt;-</span> data_example</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>data_missing<span class="sc">$</span>x1[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">10</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>data_missing<span class="sc">$</span>x2[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">15</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>data_missing<span class="sc">$</span>x3[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">20</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize missing patterns</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(data_missing) <span class="sc">+</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wzorce Brakujących Danych"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/missing-data-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Wzorce Brakujących Danych</figcaption>
</figure>
</div>
</div>
</div>
<ol start="3" type="1">
<li><strong>Heteroskedastyczność</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate heteroscedastic data</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">112</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>x_hetero <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>y_hetero <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span>x_hetero <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="fu">abs</span>(x_hetero)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>data_hetero <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_hetero, <span class="at">y =</span> y_hetero)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>model_hetero <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data_hetero)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_hetero, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Dane Heteroskedastyczne"</span>)</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_hetero, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fitted</span>(model_hetero), </span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> <span class="fu">residuals</span>(model_hetero))) <span class="sc">+</span></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wykres Reszt"</span>,</span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Wartości dopasowane"</span>,</span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reszty"</span>)</span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/heteroscedasticity-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Wykrywanie i Wizualizacja Heteroskedastyczności</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="najlepsze-praktyki" class="level2" data-number="16.10">
<h2 data-number="16.10" class="anchored" data-anchor-id="najlepsze-praktyki"><span class="header-section-number">16.10</span> Najlepsze Praktyki</h2>
<section id="walidacja-modelu" class="level3" data-number="16.10.1">
<h3 data-number="16.10.1" class="anchored" data-anchor-id="walidacja-modelu"><span class="header-section-number">16.10.1</span> Walidacja Modelu</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple cross-validation example</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">113</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create training and test sets</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data_example), <span class="fl">0.7</span><span class="sc">*</span><span class="fu">nrow</span>(data_example))</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> data_example[train_index, ]</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> data_example[<span class="sc">-</span>train_index, ]</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model on training data</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>model_train <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">data =</span> train_data)</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on test data</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_train, <span class="at">newdata =</span> test_data)</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>actual <span class="ot">&lt;-</span> test_data<span class="sc">$</span>y</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate performance metrics</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((predictions <span class="sc">-</span> actual)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predictions <span class="sc">-</span> actual))</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">cor</span>(predictions, actual)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot predictions vs actual</span></span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a>data_validation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Przewidywane =</span> predictions,</span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Rzeczywiste =</span> actual</span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_validation, <span class="fu">aes</span>(<span class="at">x =</span> Rzeczywiste, <span class="at">y =</span> Przewidywane)) <span class="sc">+</span></span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb85-29"><a href="#cb85-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb85-30"><a href="#cb85-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb85-31"><a href="#cb85-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Walidacja Modelu: Przewidywane vs Rzeczywiste"</span>,</span>
<span id="cb85-32"><a href="#cb85-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"RMSE = %.2f, MAE = %.2f, R² = %.2f"</span>, </span>
<span id="cb85-33"><a href="#cb85-33" aria-hidden="true" tabindex="-1"></a>                         rmse, mae, r2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/model-validation-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Przykład Walidacji Krzyżowej</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="prezentacja-wyników" class="level3" data-number="16.10.2">
<h3 data-number="16.10.2" class="anchored" data-anchor-id="prezentacja-wyników"><span class="header-section-number">16.10.2</span> Prezentacja Wyników</h3>
<p>Przykład profesjonalnej tabeli wyników regresji:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create regression results table</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kableExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>model_final <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">data =</span> data_example)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">tidy</span>(model_final, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(results, <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Podsumowanie Wyników Regresji"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Podsumowanie Wyników Regresji</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">9.116</td>
<td style="text-align: right;">2.835</td>
<td style="text-align: right;">3.216</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">3.489</td>
<td style="text-align: right;">14.743</td>
</tr>
<tr class="even">
<td style="text-align: left;">x1</td>
<td style="text-align: right;">0.497</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">12.756</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.419</td>
<td style="text-align: right;">0.574</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x2</td>
<td style="text-align: right;">0.905</td>
<td style="text-align: right;">0.086</td>
<td style="text-align: right;">10.468</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.734</td>
<td style="text-align: right;">1.077</td>
</tr>
<tr class="even">
<td style="text-align: left;">x3</td>
<td style="text-align: right;">-0.324</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">-20.322</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">-0.356</td>
<td style="text-align: right;">-0.292</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="podsumowanie-1" class="level2" data-number="16.11">
<h2 data-number="16.11" class="anchored" data-anchor-id="podsumowanie-1"><span class="header-section-number">16.11</span> Podsumowanie</h2>
<section id="kluczowe-wnioski-4" class="level3" data-number="16.11.1">
<h3 data-number="16.11.1" class="anchored" data-anchor-id="kluczowe-wnioski-4"><span class="header-section-number">16.11.1</span> Kluczowe Wnioski</h3>
<ol type="1">
<li>Zawsze zaczynaj od eksploracyjnej analizy danych</li>
<li>Sprawdzaj założenia przed interpretacją wyników</li>
<li>Bądź świadomy typowych pułapek:
<ul>
<li>Wartości odstające</li>
<li>Brakujące dane</li>
<li>Współliniowość</li>
<li>Heteroskedastyczność</li>
</ul></li>
<li>Waliduj swój model używając:
<ul>
<li>Wykresów diagnostycznych</li>
<li>Walidacji krzyżowej</li>
<li>Analizy reszt</li>
</ul></li>
<li>Prezentuj wyniki jasno i kompletnie</li>
</ol>
</section>
<section id="literatura-uzupełniająca" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="literatura-uzupełniająca">Literatura Uzupełniająca</h3>
<p>Dla głębszego zrozumienia:</p>
<ul>
<li>Wooldridge, J.M. “Wprowadzenie do Ekonometrii: Współczesne Ujęcie”</li>
<li>Fox, J. “Analiza Regresji Stosowana i Uogólnione Modele Liniowe”</li>
<li>Angrist, J.D. i Pischke, J.S. “W Większości Nieszkodliwa Ekonometria”</li>
<li>Stock &amp; Watson “Wprowadzenie do Ekonometrii”</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zrozumienie Regresji Metodą Najmniejszych Kwadratów (OLS): Podsumowanie dla Studentów
</div>
</div>
<div class="callout-body-container callout-body">
<section id="czym-jest-prosta-regresja-liniowa" class="level3" data-number="16.11.2">
<h3 data-number="16.11.2" class="anchored" data-anchor-id="czym-jest-prosta-regresja-liniowa"><span class="header-section-number">16.11.2</span> 1. Czym jest Prosta Regresja Liniowa?</h3>
<p>Rozważmy związek między czasem poświęconym na naukę a wynikami egzaminów. Prosta regresja liniowa tworzy optymalną linię prostą przechodzącą przez punkty danych, modelującą tę relację. Linia ta służy dwóm celom: prognozowaniu oraz kwantyfikacji związku między zmiennymi.</p>
<p>Zależność matematyczna jest wyrażona jako:</p>
<p><span class="math display"> Y_i = \beta_0 + \beta_1X_i + \epsilon_i </span></p>
<p>Używając naszego przykładu z czasem nauki do zilustrowania każdego składnika:</p>
<ul>
<li><span class="math inline">Y_i</span> reprezentuje zmienną zależną (wyniki egzaminów)</li>
<li><span class="math inline">X_i</span> reprezentuje zmienną niezależną (godziny nauki)</li>
<li><span class="math inline">\beta_0</span> reprezentuje wyraz wolny - oczekiwany wynik egzaminu przy zerowym czasie nauki</li>
<li><span class="math inline">\beta_1</span> reprezentuje nachylenie - zmianę wyniku egzaminu na każdą dodatkową godzinę nauki</li>
<li><span class="math inline">\epsilon_i</span> reprezentuje składnik błędu, uwzględniający nieobserwowane czynniki</li>
</ul>
<p>Naszym celem jest znalezienie oszacowań <span class="math inline">\hat{\beta}_0</span> i <span class="math inline">\hat{\beta}_1</span>, które najlepiej przybliżają prawdziwe parametry <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span>. Dopasowana linia regresji jest wtedy wyrażona jako:</p>
<p><span class="math display"> \hat{Y}_i = \hat{\beta}_0 + \hat{\beta}_1X_i </span></p>
</section>
<section id="metoda-najmniejszych-kwadratów" class="level3" data-number="16.11.3">
<h3 data-number="16.11.3" class="anchored" data-anchor-id="metoda-najmniejszych-kwadratów"><span class="header-section-number">16.11.3</span> 2. Metoda Najmniejszych Kwadratów</h3>
<p>Metoda “Najmniejszych Kwadratów” określa optymalne wartości dla <span class="math inline">\hat{\beta}_0</span> i <span class="math inline">\hat{\beta}_1</span> poprzez metodyczny proces. Choć współczesne oprogramowanie statystyczne wykonuje te obliczenia automatycznie, zrozumienie podstawowego procesu jest kluczowe:</p>
<ol type="1">
<li>Rozpocznij od wstępnego oszacowania linii regresji
<ul>
<li>Zazwyczaj zaczynamy od linii poziomej na poziomie <span class="math inline">\bar{Y}</span> (średnia Y)</li>
<li>Służy to jako punkt odniesienia, reprezentujący brak związku między X a Y</li>
</ul></li>
<li>Oblicz odległości pionowe (reszty) od każdego obserwowanego punktu do tej linii
<ul>
<li>Te reszty <span class="math inline">\hat{\epsilon}_i = Y_i - \hat{Y}_i</span> reprezentują nasze błędy predykcji</li>
<li>Dodatnia reszta oznacza, że nasza linia niedoszacowuje prawdziwej wartości</li>
<li>Ujemna reszta oznacza, że nasza linia przeszacowuje prawdziwą wartość</li>
</ul></li>
<li>Podnieś te odległości do kwadratu, aby:
<ul>
<li>Zapewnić, że dodatnie i ujemne odchylenia się nie znoszą</li>
<li>Przypisać większą wagę większym odchyleniom</li>
</ul></li>
<li>Zsumuj wszystkie kwadraty odległości, aby otrzymać Sumę Kwadratów Błędów (SSE)
<ul>
<li><span class="math inline">SSE = \sum(Y_i - \hat{Y}_i)^2</span></li>
<li>Reprezentuje to całkowite kwadratowe odchylenie obserwowanych wartości od naszych przewidywanych wartości</li>
</ul></li>
<li>Systematycznie dostosowuj nachylenie i wyraz wolny linii, aby zminimalizować SSE:</li>
</ol>
<ul>
<li>Proces polega na stopniowym modyfikowaniu nachylenia i położenia linii, obserwując jak zmienia się suma kwadratów odchyłek (SSE) [formalnie wymaga to zastosowania pojęć z rachunku różniczkowego]</li>
<li>Gdy SSE przestaje się zmniejszać przy kolejnych niewielkich zmianach parametrów linii, oznacza to znalezienie optymalnego dopasowania</li>
<li>To miejsce odpowiada najmniejszej możliwej wartości SSE, czyli najlepszemu dopasowaniu linii do danych</li>
</ul>
</section>
<section id="estymacja-parametrów" class="level3" data-number="16.11.4">
<h3 data-number="16.11.4" class="anchored" data-anchor-id="estymacja-parametrów"><span class="header-section-number">16.11.4</span> 3. Estymacja Parametrów</h3>
<p>Formuły do oszacowania parametrów wykorzystują podstawowe miary statystyczne:</p>
<p><span class="math display"> \hat{\beta}_1 = \frac{Cov(X,Y)}{Var(X)} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2} </span></p>
<p>Ta formuła zawiera dwa istotne pojęcia statystyczne:</p>
<ul>
<li>Kowariancja (<span class="math inline">Cov</span>) kwantyfikuje wspólny ruch X i Y</li>
<li>Wariancja (<span class="math inline">Var</span>) mierzy rozproszenie wartości X wokół ich średniej</li>
<li><span class="math inline">\bar{X}</span> i <span class="math inline">\bar{Y}</span> reprezentują odpowiednio średnie X i Y</li>
</ul>
<p>Po obliczeniu <span class="math inline">\hat{\beta}_1</span> określamy <span class="math inline">\hat{\beta}_0</span>:</p>
<p><span class="math display"> \hat{\beta}_0 = \bar{Y} - \hat{\beta}_1\bar{X} </span></p>
<p>Zapewnia to, że linia regresji przechodzi przez punkt średnich (<span class="math inline">\bar{X}</span>, <span class="math inline">\bar{Y}</span>).</p>
</section>
<section id="dekompozycja-wariancji-1" class="level3" data-number="16.11.5">
<h3 data-number="16.11.5" class="anchored" data-anchor-id="dekompozycja-wariancji-1"><span class="header-section-number">16.11.5</span> 4. Dekompozycja Wariancji</h3>
<p>Całkowita wariancja w naszych danych ma trzy ważne składniki:</p>
<ol type="1">
<li><p>Całkowita Suma Kwadratów (SST): Całkowita zmienność w Y <span class="math display"> SST = \sum(Y_i - \bar{Y})^2 </span> Reprezentuje to całkowitą zmienność, którą staramy się wyjaśnić</p></li>
<li><p>Wyjaśniona Wariancja (SSR): Zmienność uchwycona przez nasz model <span class="math display"> SSR = \sum(\hat{Y}_i - \bar{Y})^2 </span> Mierzy to odchylenie przewidywanych wartości od średniej</p></li>
<li><p>Niewyjaśniona Wariancja (SSE): Zmienność resztowa <span class="math display"> SSE = \sum(Y_i - \hat{Y}_i)^2 </span> Kwantyfikuje to odchylenie obserwowanych wartości od przewidywanych wartości</p></li>
</ol>
<p>Fundamentalna relacja w analizie regresji mówi, że całkowita zmienność równa się sumie zmienności wyjaśnionej i niewyjaśnionej:</p>
<p><span class="math display"> SST = SSR + SSE </span></p>
</section>
<section id="współczynnik-determinacji-r2" class="level3" data-number="16.11.6">
<h3 data-number="16.11.6" class="anchored" data-anchor-id="współczynnik-determinacji-r2"><span class="header-section-number">16.11.6</span> 5. Współczynnik Determinacji (<span class="math inline">R^2</span>)</h3>
<p><span class="math inline">R^2</span> służy jako miara dopasowania modelu, reprezentująca proporcję wariancji wyjaśnionej przez naszą regresję:</p>
<p><span class="math display"> R^2 = \frac{SSR}{SST} = \frac{SSR}{SSR + SSE} = 1 - \frac{SSE}{SST} </span></p>
<p>Aby zinterpretować <span class="math inline">R^2</span>:</p>
<ul>
<li><span class="math inline">R^2</span> równe 0,75 wskazuje, że model wyjaśnia 75% wariancji wyników egzaminów</li>
<li><span class="math inline">R^2</span> równe 0,20 sugeruje, że godziny nauki odpowiadają za 20% zmienności wyników</li>
<li><span class="math inline">R^2</span> równe 1,00 reprezentuje doskonałą predykcję (rzadko obserwowane w praktyce)</li>
<li><span class="math inline">R^2</span> równe 0,00 wskazuje na brak mocy wyjaśniającej</li>
</ul>
<p>Uwaga: Niższa wartość <span class="math inline">R^2</span> niekoniecznie oznacza gorszy model - może po prostu odzwierciedlać złożoność badanej relacji.</p>
</section>
<section id="kluczowy-wniosek" class="level3" data-number="16.11.7">
<h3 data-number="16.11.7" class="anchored" data-anchor-id="kluczowy-wniosek"><span class="header-section-number">16.11.7</span> Kluczowy Wniosek</h3>
<p>Regresja liniowa ustala relacje między zmiennymi poprzez identyfikację optymalnego dopasowania liniowego przez punkty danych. Ta optymalizacja zachodzi poprzez minimalizację kwadratów reszt. Współczynnik determinacji (<span class="math inline">R^2</span>) kwantyfikuje następnie moc wyjaśniającą modelu poprzez porównanie wyjaśnionej zmienności z całkowitą zmiennością w naszych danych.</p>
</section>
</div>
</div>
</section>
</section>
<section id="dodatek-a.1-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-z-obliczeniami" class="level2" data-number="16.12">
<h2 data-number="16.12" class="anchored" data-anchor-id="dodatek-a.1-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-z-obliczeniami"><span class="header-section-number">16.12</span> Dodatek A.1: Obliczanie Kowariancji, Korelacji Pearsona i Spearmana, oraz modelowanie OLS - przykład z obliczeniami</h2>
<p>Dane dotyczące wielkości okręgu wyborczego (<span class="math inline">\text{DM}</span>) i indeksu Gallaghera:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\text{DM}</span> (<span class="math inline">X</span>)</th>
<th>Gallagher (<span class="math inline">Y</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>18,2</td>
</tr>
<tr class="even">
<td>3</td>
<td>16,7</td>
</tr>
<tr class="odd">
<td>4</td>
<td>15,8</td>
</tr>
<tr class="even">
<td>5</td>
<td>15,3</td>
</tr>
<tr class="odd">
<td>6</td>
<td>15,0</td>
</tr>
<tr class="even">
<td>7</td>
<td>14,8</td>
</tr>
<tr class="odd">
<td>8</td>
<td>14,7</td>
</tr>
<tr class="even">
<td>9</td>
<td>14,6</td>
</tr>
<tr class="odd">
<td>10</td>
<td>14,55</td>
</tr>
<tr class="even">
<td>11</td>
<td>14,52</td>
</tr>
</tbody>
</table>
<section id="krok-1-obliczanie-podstawowych-statystyk" class="level3" data-number="16.12.1">
<h3 data-number="16.12.1" class="anchored" data-anchor-id="krok-1-obliczanie-podstawowych-statystyk"><span class="header-section-number">16.12.1</span> Krok 1: Obliczanie Podstawowych Statystyk</h3>
<p>Obliczanie średnich:</p>
<p>Dla <span class="math inline">\text{DM}</span> (<span class="math inline">X</span>): <span class="math display">\bar{X} = \frac{\sum_{i=1}^n X_i}{n}</span></p>
<p>Szczegółowe obliczenia:</p>
<p><span class="math display">2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 + 10 + 11 = 65</span> <span class="math display">\bar{x} = \frac{65}{10} = 6,5</span></p>
<p>Dla indeksu Gallaghera (<span class="math inline">Y</span>): <span class="math display">\bar{Y} = \frac{\sum_{i=1}^n Y_i}{n}</span></p>
<p>Szczegółowe obliczenia:</p>
<p><span class="math display">18,2 + 16,7 + 15,8 + 15,3 + 15,0 + 14,8 + 14,7 + 14,6 + 14,55 + 14,52 = 154,17</span> <span class="math display">\bar{y} = \frac{154,17}{10} = 15,417</span></p>
</section>
<section id="krok-2-szczegółowe-obliczenia-kowariancji" class="level3" data-number="16.12.2">
<h3 data-number="16.12.2" class="anchored" data-anchor-id="krok-2-szczegółowe-obliczenia-kowariancji"><span class="header-section-number">16.12.2</span> Krok 2: Szczegółowe Obliczenia Kowariancji</h3>
<p>Pełna tabela robocza ze wszystkimi obliczeniami:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 26%">
<col style="width: 15%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">(X_i - \bar{X})</span></th>
<th><span class="math inline">(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})^2</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td><span class="math inline">-4,5</span></td>
<td>2,783</td>
<td><span class="math inline">-12,5235</span></td>
<td>20,25</td>
<td>7,7451</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td><span class="math inline">-3,5</span></td>
<td>1,283</td>
<td><span class="math inline">-4,4905</span></td>
<td>12,25</td>
<td>1,6461</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td><span class="math inline">-2,5</span></td>
<td>0,383</td>
<td><span class="math inline">-0,9575</span></td>
<td>6,25</td>
<td>0,1467</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td><span class="math inline">-1,5</span></td>
<td><span class="math inline">-0,117</span></td>
<td>0,1755</td>
<td>2,25</td>
<td>0,0137</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td><span class="math inline">-0,5</span></td>
<td><span class="math inline">-0,417</span></td>
<td>0,2085</td>
<td>0,25</td>
<td>0,1739</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>0,5</td>
<td><span class="math inline">-0,617</span></td>
<td><span class="math inline">-0,3085</span></td>
<td>0,25</td>
<td>0,3807</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>1,5</td>
<td><span class="math inline">-0,717</span></td>
<td><span class="math inline">-1,0755</span></td>
<td>2,25</td>
<td>0,5141</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>2,5</td>
<td><span class="math inline">-0,817</span></td>
<td><span class="math inline">-2,0425</span></td>
<td>6,25</td>
<td>0,6675</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>3,5</td>
<td><span class="math inline">-0,867</span></td>
<td><span class="math inline">-3,0345</span></td>
<td>12,25</td>
<td>0,7517</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>4,5</td>
<td><span class="math inline">-0,897</span></td>
<td><span class="math inline">-4,0365</span></td>
<td>20,25</td>
<td>0,8047</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td>65</td>
<td>154,17</td>
<td>0</td>
<td>0</td>
<td><span class="math inline">-28,085</span></td>
<td>82,5</td>
<td>12,8442</td>
</tr>
</tbody>
</table>
<p>Obliczanie kowariancji: <span class="math display">\text{Cov}(X,Y) = \frac{\sum_{i=1}^n (X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p><span class="math display">\text{Cov}(X,Y) = \frac{-28,085}{9} = -3,120556</span></p>
</section>
<section id="krok-3-obliczanie-odchylenia-standardowego" class="level3" data-number="16.12.3">
<h3 data-number="16.12.3" class="anchored" data-anchor-id="krok-3-obliczanie-odchylenia-standardowego"><span class="header-section-number">16.12.3</span> Krok 3: Obliczanie Odchylenia Standardowego</h3>
<p>Dla <span class="math inline">\text{DM}</span> (<span class="math inline">X</span>): <span class="math display">\sigma_X = \sqrt{\frac{\sum_{i=1}^n (X_i - \bar{X})^2}{n-1}}</span></p>
<p><span class="math display">\sigma_x = \sqrt{\frac{82,5}{9}} = \sqrt{9,1667} = 3,026582</span></p>
<p>Dla Gallaghera (<span class="math inline">Y</span>): <span class="math display">\sigma_Y = \sqrt{\frac{\sum_{i=1}^n (Y_i - \bar{Y})^2}{n-1}}</span></p>
<p><span class="math display">\sigma_y = \sqrt{\frac{12,8442}{9}} = \sqrt{1,4271} = 1,194612</span></p>
</section>
<section id="krok-4-obliczanie-korelacji-pearsona" class="level3" data-number="16.12.4">
<h3 data-number="16.12.4" class="anchored" data-anchor-id="krok-4-obliczanie-korelacji-pearsona"><span class="header-section-number">16.12.4</span> Krok 4: Obliczanie Korelacji Pearsona</h3>
<p><span class="math display">r = \frac{\text{Cov}(X,Y)}{\sigma_X \sigma_Y}</span></p>
<p><span class="math display">r = \frac{-3,120556}{3,026582 \times 1,194612} = \frac{-3,120556}{3,615752} = -0,863044</span></p>
</section>
<section id="krok-5-obliczanie-korelacji-rangowej-spearmana" class="level3" data-number="16.12.5">
<h3 data-number="16.12.5" class="anchored" data-anchor-id="krok-5-obliczanie-korelacji-rangowej-spearmana"><span class="header-section-number">16.12.5</span> Krok 5: Obliczanie Korelacji Rangowej Spearmana</h3>
<p>Pełna tabela rangowa ze wszystkimi obliczeniami:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th>Ranga <span class="math inline">X_i</span></th>
<th>Ranga <span class="math inline">Y_i</span></th>
<th><span class="math inline">d_i</span></th>
<th><span class="math inline">d_i^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td>1</td>
<td>10</td>
<td><span class="math inline">-9</span></td>
<td>81</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td>2</td>
<td>9</td>
<td><span class="math inline">-7</span></td>
<td>49</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td>3</td>
<td>8</td>
<td><span class="math inline">-5</span></td>
<td>25</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td>4</td>
<td>7</td>
<td><span class="math inline">-3</span></td>
<td>9</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td>5</td>
<td>6</td>
<td><span class="math inline">-1</span></td>
<td>1</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>6</td>
<td>5</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>7</td>
<td>4</td>
<td>3</td>
<td>9</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>8</td>
<td>3</td>
<td>5</td>
<td>25</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>9</td>
<td>2</td>
<td>7</td>
<td>49</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>10</td>
<td>1</td>
<td>9</td>
<td>81</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>330</td>
</tr>
</tbody>
</table>
<p>Obliczanie korelacji Spearmana: <span class="math display">\rho = 1 - \frac{6\sum d_i^2}{n(n^2-1)}</span></p>
<p><span class="math display">\rho = 1 - \frac{6 \times 330}{10(100 - 1)} = 1 - \frac{1980}{990} = 1 - 2 = -1</span></p>
</section>
<section id="krok-6-weryfikacja-w-r" class="level3" data-number="16.12.6">
<h3 data-number="16.12.6" class="anchored" data-anchor-id="krok-6-weryfikacja-w-r"><span class="header-section-number">16.12.6</span> Krok 6: Weryfikacja w R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wektorów</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>DM <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>GH <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">18.2</span>, <span class="fl">16.7</span>, <span class="fl">15.8</span>, <span class="fl">15.3</span>, <span class="fl">15.0</span>, <span class="fl">14.8</span>, <span class="fl">14.7</span>, <span class="fl">14.6</span>, <span class="fl">14.55</span>, <span class="fl">14.52</span>)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczanie kowariancji</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(DM, GH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3.120556</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczanie korelacji</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DM, GH, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8627742</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DM, GH, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1</code></pre>
</div>
</div>
</section>
<section id="krok-7-podstawowa-wizualizacja" class="level3" data-number="16.12.7">
<h3 data-number="16.12.7" class="anchored" data-anchor-id="krok-7-podstawowa-wizualizacja"><span class="header-section-number">16.12.7</span> Krok 7: Podstawowa Wizualizacja</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie ramki danych</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">DM =</span> DM, <span class="at">GH =</span> GH)</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu rozrzutu</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Wielkość Okręgu vs Indeks Gallaghera"</span>,</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Wielkość Okręgu (DM)"</span>,</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Indeks Gallaghera (GH)"</span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="estymacja-ols-i-miary-dopasowania-modelu" class="level3" data-number="16.12.8">
<h3 data-number="16.12.8" class="anchored" data-anchor-id="estymacja-ols-i-miary-dopasowania-modelu"><span class="header-section-number">16.12.8</span> Estymacja OLS i Miary Dopasowania Modelu</h3>
</section>
<section id="krok-1-obliczanie-estymatorów-ols" class="level3" data-number="16.12.9">
<h3 data-number="16.12.9" class="anchored" data-anchor-id="krok-1-obliczanie-estymatorów-ols"><span class="header-section-number">16.12.9</span> Krok 1: Obliczanie Estymatorów OLS</h3>
<p>Korzystając z wcześniej obliczonych wartości:</p>
<ul>
<li><span class="math inline">\sum(X_i - \bar{X})(Y_i - \bar{Y}) = -28,085</span></li>
<li><span class="math inline">\sum(X_i - \bar{X})^2 = 82,5</span></li>
<li><span class="math inline">\bar{X} = 6,5</span></li>
<li><span class="math inline">\bar{Y} = 15,417</span></li>
</ul>
<p>Obliczanie nachylenia (<span class="math inline">\hat{\beta_1}</span>):</p>
<p><span class="math inline">\hat{\beta_1} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2}</span></p>
<p><span class="math display">\hat{\beta_1} = -28,085 ÷ 82,5 = -0,3404</span></p>
<p>Obliczanie wyrazu wolnego (<span class="math inline">\hat{\beta_0}</span>): <span class="math inline">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span></p>
<p><span class="math display">\hat{\beta_0} = 15,417 - (-0,3404 × 6,5)
   = 15,417 + 2,2126
   = 17,6296</span></p>
<p>Zatem równanie regresji OLS ma postać: <span class="math inline">\hat{Y} = 17,6296 - 0,3404X</span></p>
</section>
<section id="krok-2-obliczanie-wartości-dopasowanych-i-reszt" class="level3" data-number="16.12.10">
<h3 data-number="16.12.10" class="anchored" data-anchor-id="krok-2-obliczanie-wartości-dopasowanych-i-reszt"><span class="header-section-number">16.12.10</span> Krok 2: Obliczanie Wartości Dopasowanych i Reszt</h3>
<p>Pełna tabela ze wszystkimi obliczeniami:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i</span></th>
<th><span class="math inline">e_i = Y_i - \hat{Y}_i</span></th>
<th><span class="math inline">e_i^2</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
<th><span class="math inline">(\hat{Y}_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td>16,9488</td>
<td>1,2512</td>
<td>1,5655</td>
<td>7,7451</td>
<td>2,3404</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td>16,6084</td>
<td>0,0916</td>
<td>0,0084</td>
<td>1,6461</td>
<td>1,4241</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td>16,2680</td>
<td>-0,4680</td>
<td>0,2190</td>
<td>0,1467</td>
<td>0,7225</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td>15,9276</td>
<td>-0,6276</td>
<td>0,3939</td>
<td>0,0137</td>
<td>0,2601</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td>15,5872</td>
<td>-0,5872</td>
<td>0,3448</td>
<td>0,1739</td>
<td>0,0289</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>15,2468</td>
<td>-0,4468</td>
<td>0,1996</td>
<td>0,3807</td>
<td>0,0290</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>14,9064</td>
<td>-0,2064</td>
<td>0,0426</td>
<td>0,5141</td>
<td>0,2610</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>14,5660</td>
<td>0,0340</td>
<td>0,0012</td>
<td>0,6675</td>
<td>0,7241</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>14,2256</td>
<td>0,3244</td>
<td>0,1052</td>
<td>0,7517</td>
<td>1,4184</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>13,8852</td>
<td>0,6348</td>
<td>0,4030</td>
<td>0,8047</td>
<td>2,3439</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td>65</td>
<td>154,17</td>
<td>154,17</td>
<td>0</td>
<td>3,2832</td>
<td>12,8442</td>
<td>9,5524</td>
</tr>
</tbody>
</table>
<p>Obliczenia dla wartości dopasowanych:</p>
<pre><code>Dla X = 2:
Ŷ = 17,6296 + (-0,3404 × 2) = 16,9488

Dla X = 3:
Ŷ = 17,6296 + (-0,3404 × 3) = 16,6084

[... kontynuacja dla wszystkich wartości]</code></pre>
</section>
<section id="krok-3-obliczanie-miar-dopasowania" class="level3" data-number="16.12.11">
<h3 data-number="16.12.11" class="anchored" data-anchor-id="krok-3-obliczanie-miar-dopasowania"><span class="header-section-number">16.12.11</span> Krok 3: Obliczanie Miar Dopasowania</h3>
<p>Suma kwadratów reszt (SSE): <span class="math inline">SSE = \sum e_i^2</span></p>
<pre><code>SSE = 3,2832</code></pre>
<p>Całkowita suma kwadratów (SST): <span class="math inline">SST = \sum(Y_i - \bar{Y})^2</span></p>
<pre><code>SST = 12,8442</code></pre>
<p>Suma kwadratów regresji (SSR): <span class="math inline">SSR = \sum(\hat{Y}_i - \bar{Y})^2</span></p>
<pre><code>SSR = 9,5524</code></pre>
<p>Weryfikacja dekompozycji: <span class="math inline">SST = SSR + SSE</span></p>
<pre><code>12,8442 = 9,5524 + 3,2832 (w granicach błędu zaokrąglenia)</code></pre>
<p>Obliczanie współczynnika determinacji R-kwadrat: <span class="math inline">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span></p>
<pre><code>R² = 9,5524 ÷ 12,8442
   = 0,7438</code></pre>
</section>
<section id="krok-4-weryfikacja-w-r" class="level3" data-number="16.12.12">
<h3 data-number="16.12.12" class="anchored" data-anchor-id="krok-4-weryfikacja-w-r"><span class="header-section-number">16.12.12</span> Krok 4: Weryfikacja w R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modelu liniowego</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Podsumowanie statystyk</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = GH ~ DM, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.62764 -0.46274 -0.08615  0.26624  1.25109 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 17.62976    0.50121  35.174 4.67e-10 ***
DM          -0.34042    0.07053  -4.827  0.00131 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6406 on 8 degrees of freedom
Multiple R-squared:  0.7444,    Adjusted R-squared:  0.7124 
F-statistic:  23.3 on 1 and 8 DF,  p-value: 0.00131</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ręczne obliczenie R-kwadrat</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((GH <span class="sc">-</span> <span class="fu">mean</span>(GH))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(model)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> SST <span class="sc">-</span> SSE</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>R2_manual <span class="ot">&lt;-</span> SSR<span class="sc">/</span>SST</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>R2_manual</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7443793</code></pre>
</div>
</div>
</section>
<section id="krok-5-analiza-reszt" class="level3" data-number="16.12.13">
<h3 data-number="16.12.13" class="anchored" data-anchor-id="krok-5-analiza-reszt"><span class="header-section-number">16.12.13</span> Krok 5: Analiza Reszt</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresów reszt</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych" class="level3" data-number="16.12.14">
<h3 data-number="16.12.14" class="anchored" data-anchor-id="krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych"><span class="header-section-number">16.12.14</span> Krok 6: Wykres Wartości Przewidywanych vs Rzeczywistych</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu wartości przewidywanych vs rzeczywistych</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Rzeczywiste =</span> GH,</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Przewidywane =</span> <span class="fu">fitted</span>(model)</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>), <span class="fu">aes</span>(<span class="at">x =</span> Przewidywane, <span class="at">y =</span> Rzeczywiste)) <span class="sc">+</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Wartości Przewidywane vs Rzeczywiste"</span>,</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Przewidywany Indeks Gallaghera"</span>,</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Rzeczywisty Indeks Gallaghera"</span></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="modele-z-transformacją-logarytmiczną" class="level3" data-number="16.12.15">
<h3 data-number="16.12.15" class="anchored" data-anchor-id="modele-z-transformacją-logarytmiczną"><span class="header-section-number">16.12.15</span> Modele z Transformacją Logarytmiczną</h3>
</section>
<section id="krok-1-transformacja-danych" class="level3" data-number="16.12.16">
<h3 data-number="16.12.16" class="anchored" data-anchor-id="krok-1-transformacja-danych"><span class="header-section-number">16.12.16</span> Krok 1: Transformacja Danych</h3>
<p>Najpierw obliczamy logarytmy naturalne zmiennych:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\ln(X_i)</span></th>
<th><span class="math inline">\ln(Y_i)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td>0,6931</td>
<td>2,9014</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td>1,0986</td>
<td>2,8154</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td>1,3863</td>
<td>2,7600</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td>1,6094</td>
<td>2,7278</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td>1,7918</td>
<td>2,7081</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>1,9459</td>
<td>2,6946</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>2,0794</td>
<td>2,6878</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>2,1972</td>
<td>2,6810</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>2,3026</td>
<td>2,6777</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>2,3979</td>
<td>2,6757</td>
</tr>
</tbody>
</table>
</section>
<section id="krok-2-porównanie-różnych-specyfikacji-modelu" class="level3" data-number="16.12.17">
<h3 data-number="16.12.17" class="anchored" data-anchor-id="krok-2-porównanie-różnych-specyfikacji-modelu"><span class="header-section-number">16.12.17</span> Krok 2: Porównanie Różnych Specyfikacji Modelu</h3>
<p>Szacujemy trzy alternatywne specyfikacje:</p>
<ol type="1">
<li>Model log-liniowy: <span class="math inline">\ln(Y_i) = \beta_0 + \beta_1 X_i + \epsilon_i</span></li>
<li>Model liniowo-logarytmiczny: <span class="math inline">Y_i = \beta_0 + \beta_1\ln(X_i) + \epsilon_i</span></li>
<li>Model log-log: <span class="math inline">\ln(Y_i) = \beta_0 + \beta_1\ln(X_i) + \epsilon_i</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie zmiennych transformowanych</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log_DM <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>DM)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log_GH <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>GH)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modeli</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>model_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>model_loglinear <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>model_linearlog <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> log_DM, <span class="at">data =</span> data)</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>model_loglog <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_GH <span class="sc">~</span> log_DM, <span class="at">data =</span> data)</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Porównanie wartości R-kwadrat</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>models_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Liniowy"</span>, <span class="st">"Log-liniowy"</span>, <span class="st">"Liniowo-logarytmiczny"</span>, <span class="st">"Log-log"</span>),</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_kwadrat =</span> <span class="fu">c</span>(</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_linear)<span class="sc">$</span>r.squared,</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_loglinear)<span class="sc">$</span>r.squared,</span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_linearlog)<span class="sc">$</span>r.squared,</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_loglog)<span class="sc">$</span>r.squared</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Wyświetlenie porównania</span></span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>models_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Model R_kwadrat
1               Liniowy 0.7443793
2           Log-liniowy 0.7670346
3 Liniowo-logarytmiczny 0.9141560
4               Log-log 0.9288088</code></pre>
</div>
</div>
</section>
<section id="krok-3-porównanie-wizualne" class="level3" data-number="16.12.18">
<h3 data-number="16.12.18" class="anchored" data-anchor-id="krok-3-porównanie-wizualne"><span class="header-section-number">16.12.18</span> Krok 3: Porównanie Wizualne</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresów dla każdego modelu</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Liniowy"</span>) <span class="sc">+</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> log_GH)) <span class="sc">+</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Log-liniowy"</span>) <span class="sc">+</span></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Liniowo-logarytmiczny"</span>) <span class="sc">+</span></span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> log_GH)) <span class="sc">+</span></span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Log-log"</span>) <span class="sc">+</span></span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Układanie wykresów w siatkę</span></span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb112-28"><a href="#cb112-28" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-4-analiza-reszt-dla-najlepszego-modelu" class="level3" data-number="16.12.19">
<h3 data-number="16.12.19" class="anchored" data-anchor-id="krok-4-analiza-reszt-dla-najlepszego-modelu"><span class="header-section-number">16.12.19</span> Krok 4: Analiza Reszt dla Najlepszego Modelu</h3>
<p>Na podstawie wartości R-kwadrat, analiza reszt dla najlepiej dopasowanego modelu:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykresy reszt dla najlepszego modelu</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_linearlog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-5-interpretacja-najlepszego-modelu" class="level3" data-number="16.12.20">
<h3 data-number="16.12.20" class="anchored" data-anchor-id="krok-5-interpretacja-najlepszego-modelu"><span class="header-section-number">16.12.20</span> Krok 5: Interpretacja Najlepszego Modelu</h3>
<p>Współczynniki modelu liniowo-logarytmicznego:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_linearlog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = GH ~ log_DM, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40702 -0.30207 -0.04907  0.22905  0.60549 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  19.0223     0.4079   46.64 4.94e-11 ***
log_DM       -2.0599     0.2232   -9.23 1.54e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3712 on 8 degrees of freedom
Multiple R-squared:  0.9142,    Adjusted R-squared:  0.9034 
F-statistic: 85.19 on 1 and 8 DF,  p-value: 1.539e-05</code></pre>
</div>
</div>
<p>Interpretacja: - <span class="math inline">\hat{\beta_0}</span> reprezentuje oczekiwany Indeks Gallaghera, gdy ln(DM) = 0 (czyli gdy DM = 1) - <span class="math inline">\hat{\beta_1}</span> reprezentuje zmianę Indeksu Gallaghera związaną z jednostkowym wzrostem ln(DM)</p>
</section>
<section id="krok-6-predykcje-modelu" class="level3" data-number="16.12.21">
<h3 data-number="16.12.21" class="anchored" data-anchor-id="krok-6-predykcje-modelu"><span class="header-section-number">16.12.21</span> Krok 6: Predykcje Modelu</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu predykcji dla najlepszego modelu</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model Liniowo-logarytmiczny: Indeks Gallaghera vs ln(Wielkość Okręgu)"</span>,</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"ln(Wielkość Okręgu)"</span>,</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Indeks Gallaghera"</span></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-7-analiza-elastyczności" class="level3" data-number="16.12.22">
<h3 data-number="16.12.22" class="anchored" data-anchor-id="krok-7-analiza-elastyczności"><span class="header-section-number">16.12.22</span> Krok 7: Analiza Elastyczności</h3>
<p>Dla modelu log-log współczynniki bezpośrednio reprezentują elastyczności. Obliczenie średniej elastyczności dla modelu liniowo-logarytmicznego:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie elastyczności przy wartościach średnich</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>mean_DM <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>DM)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>mean_GH <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>GH)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_linearlog)[<span class="dv">2</span>]</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>elastycznosc <span class="ot">&lt;-</span> beta1 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>mean_GH)</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>elastycznosc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    log_DM 
-0.1336136 </code></pre>
</div>
</div>
<p>Wartość ta reprezentuje procentową zmianę Indeksu Gallaghera przy jednoprocentowej zmianie Wielkości Okręgu.</p>
</section>
</section>
<section id="dodatek-a.2-porównanie-popularnych-miar-korelacji-pearson-spearman-i-kendall" class="level2" data-number="16.13">
<h2 data-number="16.13" class="anchored" data-anchor-id="dodatek-a.2-porównanie-popularnych-miar-korelacji-pearson-spearman-i-kendall"><span class="header-section-number">16.13</span> Dodatek A.2: Porównanie Popularnych Miar Korelacji: Pearson, Spearman i Kendall</h2>
<section id="zbiór-danych" class="level3" data-number="16.13.1">
<h3 data-number="16.13.1" class="anchored" data-anchor-id="zbiór-danych"><span class="header-section-number">16.13.1</span> Zbiór Danych</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">8</span>),</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">7</span>)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="korelacja-pearsona-1" class="level3" data-number="16.13.2">
<h3 data-number="16.13.2" class="anchored" data-anchor-id="korelacja-pearsona-1"><span class="header-section-number">16.13.2</span> Korelacja Pearsona</h3>
<p><span class="math display"> r = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum (x_i - \bar{x})^2 \sum (y_i - \bar{y})^2}} </span></p>
<section id="obliczenia-krok-po-kroku" class="level4" data-number="16.13.2.1">
<h4 data-number="16.13.2.1" class="anchored" data-anchor-id="obliczenia-krok-po-kroku"><span class="header-section-number">16.13.2.1</span> Obliczenia krok po kroku:</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">x_i</span></th>
<th><span class="math inline">y_i</span></th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>3</td>
<td>-2,4</td>
<td>-1,6</td>
<td>3,84</td>
<td>5,76</td>
<td>2,56</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>5</td>
<td>-0,4</td>
<td>0,4</td>
<td>-0,16</td>
<td>0,16</td>
<td>0,16</td>
</tr>
<tr class="odd">
<td>3</td>
<td>5</td>
<td>4</td>
<td>0,6</td>
<td>-0,6</td>
<td>-0,36</td>
<td>0,36</td>
<td>0,36</td>
</tr>
<tr class="even">
<td>4</td>
<td>3</td>
<td>4</td>
<td>-1,4</td>
<td>-0,6</td>
<td>0,84</td>
<td>1,96</td>
<td>0,36</td>
</tr>
<tr class="odd">
<td>5</td>
<td>8</td>
<td>7</td>
<td>3,6</td>
<td>2,4</td>
<td>8,64</td>
<td>12,96</td>
<td>5,76</td>
</tr>
<tr class="even">
<td>Suma</td>
<td>22</td>
<td>23</td>
<td>0</td>
<td>0</td>
<td>12,8</td>
<td>21,2</td>
<td>9,2</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\bar{x} = 4,4</span> <span class="math inline">\bar{y} = 4,6</span></p>
<p><span class="math display"> r = \frac{12,8}{\sqrt{21,2 \times 9,2}} = \frac{12,8}{\sqrt{195,04}} = \frac{12,8}{13,97} = 0,92 </span></p>
</section>
</section>
<section id="korelacja-spearmana-1" class="level3" data-number="16.13.3">
<h3 data-number="16.13.3" class="anchored" data-anchor-id="korelacja-spearmana-1"><span class="header-section-number">16.13.3</span> Korelacja Spearmana</h3>
<p><span class="math display"> \rho = 1 - \frac{6\sum d_i^2}{n(n^2-1)} </span></p>
<section id="obliczenia-krok-po-kroku-1" class="level4" data-number="16.13.3.1">
<h4 data-number="16.13.3.1" class="anchored" data-anchor-id="obliczenia-krok-po-kroku-1"><span class="header-section-number">16.13.3.1</span> Obliczenia krok po kroku:</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">x_i</span></th>
<th><span class="math inline">y_i</span></th>
<th>Ranga <span class="math inline">x_i</span></th>
<th>Ranga <span class="math inline">y_i</span></th>
<th><span class="math inline">d_i</span></th>
<th><span class="math inline">d_i^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>5</td>
<td>3</td>
<td>5</td>
<td>-2</td>
<td>4</td>
</tr>
<tr class="odd">
<td>3</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>2,5</td>
<td>1,5</td>
<td>2,25</td>
</tr>
<tr class="even">
<td>4</td>
<td>3</td>
<td>4</td>
<td>2</td>
<td>2,5</td>
<td>-0,5</td>
<td>0,25</td>
</tr>
<tr class="odd">
<td>5</td>
<td>8</td>
<td>7</td>
<td>5</td>
<td>4</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>Suma</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>7,5</td>
</tr>
</tbody>
</table>
<p><span class="math display"> \rho = 1 - \frac{6(7,5)}{5(25-1)} = 1 - \frac{45}{120} = 0,82 </span></p>
</section>
</section>
<section id="tau-kendalla" class="level3" data-number="16.13.4">
<h3 data-number="16.13.4" class="anchored" data-anchor-id="tau-kendalla"><span class="header-section-number">16.13.4</span> Tau Kendalla</h3>
<p><span class="math display"> \tau = \frac{\text{liczba par zgodnych} - \text{liczba par niezgodnych}}{\frac{1}{2}n(n-1)} </span></p>
<section id="obliczenia-krok-po-kroku-2" class="level4" data-number="16.13.4.1">
<h4 data-number="16.13.4.1" class="anchored" data-anchor-id="obliczenia-krok-po-kroku-2"><span class="header-section-number">16.13.4.1</span> Obliczenia krok po kroku:</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Para (i,j)</th>
<th><span class="math inline">x_i,x_j</span></th>
<th><span class="math inline">y_i,y_j</span></th>
<th><span class="math inline">x_j-x_i</span></th>
<th><span class="math inline">y_j-y_i</span></th>
<th>Wynik</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(1,2)</td>
<td>2,4</td>
<td>3,5</td>
<td>+2</td>
<td>+2</td>
<td>Z</td>
</tr>
<tr class="even">
<td>(1,3)</td>
<td>2,5</td>
<td>3,4</td>
<td>+3</td>
<td>+1</td>
<td>Z</td>
</tr>
<tr class="odd">
<td>(1,4)</td>
<td>2,3</td>
<td>3,4</td>
<td>+1</td>
<td>+1</td>
<td>Z</td>
</tr>
<tr class="even">
<td>(1,5)</td>
<td>2,8</td>
<td>3,7</td>
<td>+6</td>
<td>+4</td>
<td>Z</td>
</tr>
<tr class="odd">
<td>(2,3)</td>
<td>4,5</td>
<td>5,4</td>
<td>+1</td>
<td>-1</td>
<td>N</td>
</tr>
<tr class="even">
<td>(2,4)</td>
<td>4,3</td>
<td>5,4</td>
<td>-1</td>
<td>-1</td>
<td>Z</td>
</tr>
<tr class="odd">
<td>(2,5)</td>
<td>4,8</td>
<td>5,7</td>
<td>+4</td>
<td>+2</td>
<td>Z</td>
</tr>
<tr class="even">
<td>(3,4)</td>
<td>5,3</td>
<td>4,4</td>
<td>-2</td>
<td>0</td>
<td>N</td>
</tr>
<tr class="odd">
<td>(3,5)</td>
<td>5,8</td>
<td>4,7</td>
<td>+3</td>
<td>+3</td>
<td>Z</td>
</tr>
<tr class="even">
<td>(4,5)</td>
<td>3,8</td>
<td>4,7</td>
<td>+5</td>
<td>+3</td>
<td>Z</td>
</tr>
</tbody>
</table>
<p>Liczba par zgodnych = 8 Liczba par niezgodnych = 2 <span class="math display"> \tau = \frac{8-2}{10} = 0,74 </span></p>
</section>
</section>
<section id="weryfikacja-w-r" class="level3" data-number="16.13.5">
<h3 data-number="16.13.5" class="anchored" data-anchor-id="weryfikacja-w-r"><span class="header-section-number">16.13.5</span> Weryfikacja w R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pearson:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(dane<span class="sc">$</span>x, dane<span class="sc">$</span>y, <span class="at">method=</span><span class="st">"pearson"</span>), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pearson: 0.92 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Spearman:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(dane<span class="sc">$</span>x, dane<span class="sc">$</span>y, <span class="at">method=</span><span class="st">"spearman"</span>), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spearman: 0.82 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Kendall:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(dane<span class="sc">$</span>x, dane<span class="sc">$</span>y, <span class="at">method=</span><span class="st">"kendall"</span>), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kendall: 0.74 </code></pre>
</div>
</div>
</section>
<section id="interpretacja-wyników" class="level3" data-number="16.13.6">
<h3 data-number="16.13.6" class="anchored" data-anchor-id="interpretacja-wyników"><span class="header-section-number">16.13.6</span> Interpretacja Wyników</h3>
<ol type="1">
<li><strong>Korelacja Pearsona (r = 0,92)</strong>
<ul>
<li>Silna dodatnia korelacja liniowa</li>
<li>Wskazuje na bardzo silny liniowy związek między zmiennymi</li>
</ul></li>
<li><strong>Korelacja Spearmana (ρ = 0,82)</strong>
<ul>
<li>Również silna dodatnia korelacja</li>
<li>Nieco niższa niż Pearsona, co sugeruje pewne odchylenia od monotoniczności</li>
</ul></li>
<li><strong>Tau Kendalla (τ = 0,74)</strong>
<ul>
<li>Najniższa z trzech wartości, ale wciąż wskazuje na silną zależność</li>
<li>Bardziej odporna na wartości odstające</li>
</ul></li>
</ol>
</section>
<section id="porównanie-miar" class="level3" data-number="16.13.7">
<h3 data-number="16.13.7" class="anchored" data-anchor-id="porównanie-miar"><span class="header-section-number">16.13.7</span> Porównanie Miar</h3>
<ol type="1">
<li><strong>Różnice w wartościach:</strong>
<ul>
<li>Pearson (0,92) - najwyższa wartość, silna liniowość</li>
<li>Spearman (0,82) - uwzględnia tylko uporządkowanie</li>
<li>Kendall (0,74) - najbardziej konserwatywna miara</li>
</ul></li>
<li><strong>Praktyczne zastosowanie:</strong>
<ul>
<li>Wszystkie miary potwierdzają silną dodatnią zależność</li>
<li>Różnice między miarami wskazują na nieznaczne odchylenia od idealnej liniowości</li>
<li>Kendall daje najbardziej ostrożną ocenę siły związku</li>
</ul></li>
</ol>
</section>
</section>
<section id="appendix-b." class="level2" data-number="16.14">
<h2 data-number="16.14" class="anchored" data-anchor-id="appendix-b."><span class="header-section-number">16.14</span> Appendix B.</h2>
<p>(…)</p>
</section>
<section id="appendix-c.-przykłady" class="level2" data-number="16.15">
<h2 data-number="16.15" class="anchored" data-anchor-id="appendix-c.-przykłady"><span class="header-section-number">16.15</span> Appendix C. Przykłady</h2>
</section>
<section id="descriptive-statistics-and-ols-example---income-and-voter-turnout" class="level2" data-number="16.16">
<h2 data-number="16.16" class="anchored" data-anchor-id="descriptive-statistics-and-ols-example---income-and-voter-turnout"><span class="header-section-number">16.16</span> Descriptive Statistics and OLS Example - Income and Voter Turnout</h2>
<p><strong>Background</strong></p>
<p>In preparation for the 2024 municipal elections, the Amsterdam Electoral Commission conducted research on voter participation patterns across different city neighborhoods. A key question emerged:</p>
<p>Does economic prosperity of a neighborhood correlate with civic engagement, specifically voter turnout?</p>
<p><strong>Data Collection</strong></p>
<p>Sample: 5 representative neighborhoods in Amsterdam</p>
<p>Time Period: Data from the 2022 municipal elections</p>
<p>Variables:</p>
<ul>
<li>Income: Average annual household income per capita (thousands €)</li>
<li>Turnout: Percentage of registered voters who voted in the election</li>
</ul>
<section id="initial-r-output-for-reference" class="level3" data-number="16.16.1">
<h3 data-number="16.16.1" class="anchored" data-anchor-id="initial-r-output-for-reference"><span class="header-section-number">16.16.1</span> Initial R Output for Reference</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">45</span>, <span class="dv">56</span>, <span class="dv">40</span>, <span class="dv">60</span>)  <span class="co"># thousands €</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>turnout <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">56</span>, <span class="dv">70</span>, <span class="dv">50</span>, <span class="dv">75</span>) <span class="co"># %</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Full model check</span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(turnout <span class="sc">~</span> income)</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = turnout ~ income)

Residuals:
      1       2       3       4       5 
-1.9486  0.3359  0.5100  0.6204  0.4824 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.89647    3.96731  -0.226 0.835748    
income       1.25690    0.07822  16.068 0.000524 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.263 on 3 degrees of freedom
Multiple R-squared:  0.9885,    Adjusted R-squared:  0.9847 
F-statistic: 258.2 on 1 and 3 DF,  p-value: 0.0005243</code></pre>
</div>
</div>
</section>
<section id="dispersion-measures" class="level3" data-number="16.16.2">
<h3 data-number="16.16.2" class="anchored" data-anchor-id="dispersion-measures"><span class="header-section-number">16.16.2</span> Dispersion Measures</h3>
<p><strong>Means:</strong></p>
<p><span class="math display">\bar{X} = \frac{\sum_{i=1}^n X_i}{n} = \frac{50 + 45 + 56 + 40 + 60}{5} = \frac{251}{5} = 50.2</span></p>
<p><span class="math display">\bar{Y} = \frac{\sum_{i=1}^n Y_i}{n} = \frac{60 + 56 + 70 + 50 + 75}{5} = \frac{311}{5} = 62.2</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(income)  <span class="co"># 50.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(turnout) <span class="co"># 62.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 62.2</code></pre>
</div>
</div>
<p><strong>Variances:</strong></p>
<p><span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}</span></p>
<p>Deviations for X: <span class="math inline">(-0.2, -5.2, 5.8, -10.2, 9.8)</span></p>
<p><span class="math display">s^2_X = \frac{0.04 + 27.04 + 33.64 + 104.04 + 96.04}{4} = \frac{260.8}{4} = 65.2</span></p>
<p>Deviations for Y: <span class="math inline">(-2.2, -6.2, 7.8, -12.2, 12.8)</span></p>
<p><span class="math display">s^2_Y = \frac{4.84 + 38.44 + 60.84 + 148.84 + 163.84}{4} = \frac{416.8}{4} = 104.2</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(income)  <span class="co"># 65.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 65.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(turnout) <span class="co"># 104.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 104.2</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation" class="level3" data-number="16.16.3">
<h3 data-number="16.16.3" class="anchored" data-anchor-id="covariance-and-correlation"><span class="header-section-number">16.16.3</span> Covariance and Correlation</h3>
<p><strong>Covariance:</strong></p>
<p><span class="math display">s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Products of deviations:</p>
<p><span class="math display">(-0.2 \times -2.2) = 0.44</span> <span class="math display">(-5.2 \times -6.2) = 32.24</span> <span class="math display">(5.8 \times 7.8) = 45.24</span> <span class="math display">(-10.2 \times -12.2) = 124.44</span> <span class="math display">(9.8 \times 12.8) = 125.44</span></p>
<p><span class="math display">s_{XY} = \frac{327.8}{4} = 81.95</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(income, turnout) <span class="co"># 81.95</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 81.95</code></pre>
</div>
</div>
<p><strong>Correlation:</strong></p>
<p><span class="math display">r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{81.95}{\sqrt{65.2}\sqrt{104.2}} = 0.994</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(income, turnout) <span class="co"># 0.994</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9942402</code></pre>
</div>
</div>
</section>
<section id="ols-regression-haty-hatbeta_0-hatbeta_1x" class="level3" data-number="16.16.4">
<h3 data-number="16.16.4" class="anchored" data-anchor-id="ols-regression-haty-hatbeta_0-hatbeta_1x"><span class="header-section-number">16.16.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></h3>
<p><strong>Slope coefficient:</strong></p>
<p><span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{81.95}{65.2} = 1.2571429</span></p>
<p><strong>Intercept:</strong></p>
<p><span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span></p>
<p>Step by step:</p>
<ol type="1">
<li><span class="math display">1.2571429 \times 50.2 = 63.1085714</span></li>
<li><span class="math display">\hat{\beta_0} = 62.2 - 63.1085714 = -0.9085714</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)  <span class="co"># Exact coefficients from R</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      income 
 -0.8964724   1.2569018 </code></pre>
</div>
</div>
</section>
<section id="detailed-decomposition-of-variance-and-r-squared" class="level3" data-number="16.16.5">
<h3 data-number="16.16.5" class="anchored" data-anchor-id="detailed-decomposition-of-variance-and-r-squared"><span class="header-section-number">16.16.5</span> Detailed Decomposition of Variance and R-squared</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">(\hat{Y})</span>:</p>
<p><span class="math display">\hat{Y} = -0.9085714 + 1.2571429X</span></p>
<p>The predicted values <span class="math inline">\hat{Y}</span> for each <span class="math inline">X</span> value:</p>
<p>For <span class="math inline">X = 50</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (50)
</span> <span class="math display">\hat{Y} = -0.9085714 + 62.857145</span> <span class="math display">\hat{Y} = 61.9485736</span></p>
<p>For <span class="math inline">X = 45</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (45)
</span> <span class="math display">\hat{Y} = -0.9085714 + 56.5714305</span> <span class="math display">\hat{Y} = 55.6535591</span></p>
<p>For <span class="math inline">X = 56</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (56)
</span> <span class="math display">\hat{Y} = -0.9085714 + 70.4200024</span> <span class="math display">\hat{Y} = 69.5114310</span></p>
<p>For <span class="math inline">X = 40</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (40)
</span> <span class="math display">\hat{Y} = -0.9085714 + 50.2657160</span> <span class="math display">\hat{Y} = 49.3571446</span></p>
<p>For <span class="math inline">X = 60</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (60)
</span> <span class="math display">\hat{Y} = -0.9085714 + 75.4285740</span> <span class="math display">\hat{Y} = 74.5200026</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification of predicted values</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.9085714</span> <span class="sc">+</span> <span class="fl">1.2571429</span> <span class="sc">*</span> income</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> income,</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> turnout,</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y_hat =</span> y_hat,</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X  Y    Y_hat
1 50 60 61.94857
2 45 56 55.66286
3 56 70 69.49143
4 40 50 49.37714
5 60 75 74.52000</code></pre>
</div>
</div>
<p><strong>Step 2: Calculate SST (Total Sum of Squares)</strong></p>
<p><span class="math display">SST = \sum(Y_i - \bar{Y})^2 \text{ where } \bar{Y} = 62.2</span></p>
<p><span class="math display">(60 - 62.2)^2 = (-2.2)^2 = 4.84</span> <span class="math display">(56 - 62.2)^2 = (-6.2)^2 = 38.44</span> <span class="math display">(70 - 62.2)^2 = (7.8)^2 = 60.84</span> <span class="math display">(50 - 62.2)^2 = (-12.2)^2 = 148.84</span> <span class="math display">(75 - 62.2)^2 = (12.8)^2 = 163.84</span></p>
<p><span class="math display">SST = 4.84 + 38.44 + 60.84 + 148.84 + 163.84 = 416.8</span></p>
<p><strong>Step 3: Calculate SSR (Regression Sum of Squares)</strong></p>
<p><span class="math display">SSR = \sum(\hat{Y}_i - \bar{Y})^2</span></p>
<p><span class="math display">(61.9485736 - 62.2)^2 = (-0.2514264)^2 = 0.0632151</span> <span class="math display">(55.6535591 - 62.2)^2 = (-6.5464409)^2 = 42.8558689</span> <span class="math display">(69.5114310 - 62.2)^2 = (7.3114310)^2 = 53.4570178</span> <span class="math display">(49.3571446 - 62.2)^2 = (-12.8428554)^2 = 164.9389370</span> <span class="math display">(74.5200026 - 62.2)^2 = (12.3200026)^2 = 151.7824640</span></p>
<p><span class="math display">SSR = 413.0975028</span></p>
<p><strong>Step 4: Calculate SSE (Error Sum of Squares)</strong></p>
<p><span class="math display">SSE = \sum(Y_i - \hat{Y}_i)^2</span></p>
<p><span class="math display">(60 - 61.9485736)^2 = (-1.9485736)^2 = 3.7969384</span> <span class="math display">(56 - 55.6535591)^2 = (0.3464409)^2 = 0.1200212</span> <span class="math display">(70 - 69.5114310)^2 = (0.4885690)^2 = 0.2387198</span> <span class="math display">(50 - 49.3571446)^2 = (0.6428554)^2 = 0.4132631</span> <span class="math display">(75 - 74.5200026)^2 = (0.4799974)^2 = 0.2303975</span></p>
<p><span class="math display">SSE = 4.7024972</span></p>
<p><strong>Step 5: Verify decomposition</strong></p>
<p><span class="math display">SST = SSR + SSE</span> <span class="math display">416.8 = 413.0975028 + 4.7024972</span></p>
<p><strong>Step 6: Calculate R-squared</strong></p>
<p><span class="math display">R^2 = \frac{SSR}{SST} = \frac{413.0975028}{416.8} = 0.9916</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared  <span class="co"># Should match our calculation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9885135</code></pre>
</div>
</div>
</section>
<section id="visualization" class="level3" data-number="16.16.6">
<h3 data-number="16.16.6" class="anchored" data-anchor-id="visualization"><span class="header-section-number">16.16.6</span> Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">income =</span> income, <span class="at">turnout =</span> turnout)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> turnout)) <span class="sc">+</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Voter Turnout vs Income per Capita"</span>,</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Income per Capita (thousands €)"</span>,</span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Voter Turnout (%)"</span></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation" class="level3" data-number="16.16.7">
<h3 data-number="16.16.7" class="anchored" data-anchor-id="interpretation"><span class="header-section-number">16.16.7</span> Interpretation</h3>
<p>The analysis shows:</p>
<ol type="1">
<li><p>A very strong positive correlation (<span class="math inline">r = 0.994</span>) between income and voter turnout</p></li>
<li><p>The regression equation <span class="math display">\hat{Y} = -0.9085714 + 1.2571429X</span> indicates that:</p>
<ul>
<li>For each €1,000 increase in income, turnout increases by about 1.26 percentage points</li>
<li>The intercept (<span class="math inline">-0.9086</span>) has little practical meaning as income is never zero</li>
</ul></li>
<li><p>The R-squared of 0.9916 indicates that 99.16% of the variance in turnout is explained by income</p></li>
</ol>
</section>
</section>
<section id="anxiety-levels-and-cognitive-performance-a-laboratory-study" class="level2" data-number="16.17">
<h2 data-number="16.17" class="anchored" data-anchor-id="anxiety-levels-and-cognitive-performance-a-laboratory-study"><span class="header-section-number">16.17</span> Anxiety Levels and Cognitive Performance: A Laboratory Study</h2>
<section id="data-and-context" class="level3" data-number="16.17.1">
<h3 data-number="16.17.1" class="anchored" data-anchor-id="data-and-context"><span class="header-section-number">16.17.1</span> Data and Context</h3>
<p>In a psychology experiment, researchers measured the relationship between anxiety levels (measured by galvanic skin response, GSR) and cognitive performance (score on a working memory task).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>anxiety <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">3.4</span>, <span class="fl">4.2</span>, <span class="fl">5.1</span>, <span class="fl">5.8</span>, <span class="fl">6.4</span>, <span class="fl">7.2</span>, <span class="fl">8.0</span>)  <span class="co"># GSR readings</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>performance <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">92</span>, <span class="dv">88</span>, <span class="dv">84</span>, <span class="dv">78</span>, <span class="dv">74</span>, <span class="dv">70</span>, <span class="dv">65</span>, <span class="dv">62</span>)      <span class="co"># Working memory scores</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial model check</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(performance <span class="sc">~</span> anxiety)</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = performance ~ anxiety)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8993 -0.6660  0.2162  0.6106  1.5262 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 105.3248     1.3189   79.86 2.60e-10 ***
anxiety      -5.4407     0.2359  -23.06 4.35e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.236 on 6 degrees of freedom
Multiple R-squared:  0.9888,    Adjusted R-squared:  0.987 
F-statistic: 531.9 on 1 and 6 DF,  p-value: 4.355e-07</code></pre>
</div>
</div>
</section>
<section id="descriptive-statistics" class="level3" data-number="16.17.2">
<h3 data-number="16.17.2" class="anchored" data-anchor-id="descriptive-statistics"><span class="header-section-number">16.17.2</span> Descriptive Statistics</h3>
<p><strong>Means:</strong> <span class="math display">\bar{X} = \frac{2.1 + 3.4 + 4.2 + 5.1 + 5.8 + 6.4 + 7.2 + 8.0}{8} = \frac{42.2}{8} = 5.275</span></p>
<p><span class="math display">\bar{Y} = \frac{92 + 88 + 84 + 78 + 74 + 70 + 65 + 62}{8} = \frac{613}{8} = 76.625</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(anxiety)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.275</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76.625</code></pre>
</div>
</div>
<p><strong>Variances:</strong> <span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}</span></p>
<p>Deviations for X:</p>
<ul>
<li><span class="math inline">(2.1 - 5.275) = -3.175</span></li>
<li><span class="math inline">(3.4 - 5.275) = -1.875</span></li>
<li><span class="math inline">(4.2 - 5.275) = -1.075</span></li>
<li><span class="math inline">(5.1 - 5.275) = -0.175</span></li>
<li><span class="math inline">(5.8 - 5.275) = 0.525</span></li>
<li><span class="math inline">(6.4 - 5.275) = 1.125</span></li>
<li><span class="math inline">(7.2 - 5.275) = 1.925</span></li>
<li><span class="math inline">(8.0 - 5.275) = 2.725</span></li>
</ul>
<p>Squared deviations:</p>
<p><span class="math display">10.08063 + 3.51563 + 1.15563 + 0.03063 + 0.27563 + 1.26563 + 3.70563 +
7.42563 = 27.45500</span></p>
<p><span class="math display">s^2_X = \frac{27.45500}{7} = 3.922143</span></p>
<p>Similarly for Y: Deviations:</p>
<p><span class="math display">15.375, 11.375, 7.375, 1.375, -2.625, -6.625, -11.625, -14.625</span></p>
<p><span class="math display">s^2_Y = \frac{236.875 + 129.391 + 54.391 + 1.891 + 6.891 + 43.891 + 135.141 + 213.891}{7} = \frac{822.362}{7} = 117.4803</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(anxiety)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.922143</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 117.4107</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation-1" class="level3" data-number="16.17.3">
<h3 data-number="16.17.3" class="anchored" data-anchor-id="covariance-and-correlation-1"><span class="header-section-number">16.17.3</span> Covariance and Correlation</h3>
<p><strong>Covariance:</strong> <span class="math display">s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Products of deviations:</p>
<p><span class="math display">(-3.175 × 15.375) = -48.815625</span></p>
<p><span class="math display">(-1.875 × 11.375) = -21.328125</span></p>
<p><span class="math display">(-1.075 × 7.375) = -7.928125</span></p>
<p><span class="math display">(-0.175 × 1.375) = -0.240625</span></p>
<p><span class="math display">(0.525 × -2.625) = -1.378125</span></p>
<p><span class="math display">(1.125 × -6.625) = -7.453125</span></p>
<p><span class="math display">(1.925 × -11.625) = -22.378125</span></p>
<p><span class="math display">(2.725 × -14.625) = -39.853125</span></p>
<p>Sum <span class="math inline">= -149.375</span></p>
<p><span class="math display">s_{XY} = \frac{-149.375}{7} = -21.33929</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(anxiety, performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -21.33929</code></pre>
</div>
</div>
<p><strong>Correlation:</strong> <span class="math display">r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{-21.33929}{\sqrt{3.922143}\sqrt{117.4803}} = -0.9932</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(anxiety, performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9944073</code></pre>
</div>
</div>
</section>
<section id="ols-regression-haty-hatbeta_0-hatbeta_1x-1" class="level3" data-number="16.17.4">
<h3 data-number="16.17.4" class="anchored" data-anchor-id="ols-regression-haty-hatbeta_0-hatbeta_1x-1"><span class="header-section-number">16.17.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></h3>
<p><strong>Slope coefficient:</strong> <span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{-21.33929}{3.922143} = -5.4407</span></p>
<p><strong>Intercept:</strong> <span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span> Steps:</p>
<ol type="1">
<li><span class="math inline">-5.4407 × 5.275 = -28.6997</span></li>
<li><span class="math inline">\hat{\beta_0} = 76.625 - (-28.6997) = 105.3247</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     anxiety 
 105.324804   -5.440721 </code></pre>
</div>
</div>
</section>
<section id="r-squared-calculation" class="level3" data-number="16.17.5">
<h3 data-number="16.17.5" class="anchored" data-anchor-id="r-squared-calculation"><span class="header-section-number">16.17.5</span> 4. R-squared Calculation</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">(\hat{Y})</span>: <span class="math display">\hat{Y} = 105.3247 - 5.4407X</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted values</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="fl">105.3247</span> <span class="sc">-</span> <span class="fl">5.4407</span> <span class="sc">*</span> anxiety</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Anxiety =</span> anxiety,</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Performance =</span> performance,</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> y_hat,</span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Anxiety Performance Predicted
1     2.1          92  93.89923
2     3.4          88  86.82632
3     4.2          84  82.47376
4     5.1          78  77.57713
5     5.8          74  73.76864
6     6.4          70  70.50422
7     7.2          65  66.15166
8     8.0          62  61.79910</code></pre>
</div>
</div>
<p><strong>Step 2: Sum of Squares</strong></p>
<p><span class="math inline">SST = \sum(Y_i - \bar{Y})^2 = 822.362</span></p>
<p><span class="math inline">SSR = \sum(\hat{Y}_i - \bar{Y})^2 = 816.3094</span></p>
<p><span class="math inline">SSE = \sum(Y_i - \hat{Y}_i)^2 = 6.0526</span></p>
<p><strong>R-squared:</strong> <span class="math display">R^2 = \frac{SSR}{SST} = \frac{816.3094}{822.362} = 0.9926</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9888459</code></pre>
</div>
</div>
</section>
<section id="visualization-1" class="level3" data-number="16.17.6">
<h3 data-number="16.17.6" class="anchored" data-anchor-id="visualization-1"><span class="header-section-number">16.17.6</span> Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(anxiety, performance), <span class="fu">aes</span>(<span class="at">x =</span> anxiety, <span class="at">y =</span> performance)) <span class="sc">+</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cognitive Performance vs. Anxiety Levels"</span>,</span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Anxiety (GSR)"</span>,</span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Performance Score"</span></span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation-1" class="level3" data-number="16.17.7">
<h3 data-number="16.17.7" class="anchored" data-anchor-id="interpretation-1"><span class="header-section-number">16.17.7</span> Interpretation</h3>
<ol type="1">
<li>Strong negative correlation (r = -0.993) between anxiety and cognitive performance</li>
<li>For each unit increase in GSR (anxiety), performance decreases by approximately 5.44 points</li>
<li>The model explains 99.26% of the variance in performance scores</li>
<li>The relationship appears to be strongly linear, suggesting a reliable anxiety-performance relationship</li>
<li>The high intercept (105.32) represents the theoretical maximum performance at zero anxiety</li>
</ol>
</section>
<section id="study-limitations" class="level3" data-number="16.17.8">
<h3 data-number="16.17.8" class="anchored" data-anchor-id="study-limitations"><span class="header-section-number">16.17.8</span> Study Limitations</h3>
<ol type="1">
<li>Small sample size (n=8)</li>
<li>Possible other confounding variables</li>
<li>Limited range of anxiety levels</li>
<li>Cross-sectional rather than longitudinal data</li>
</ol>
</section>
</section>
<section id="district-magnitude-and-electoral-disproportionality-a-comparative-analysis" class="level2" data-number="16.18">
<h2 data-number="16.18" class="anchored" data-anchor-id="district-magnitude-and-electoral-disproportionality-a-comparative-analysis"><span class="header-section-number">16.18</span> District Magnitude and Electoral Disproportionality: A Comparative Analysis</h2>
<section id="data-generating-process" class="level3" data-number="16.18.1">
<h3 data-number="16.18.1" class="anchored" data-anchor-id="data-generating-process"><span class="header-section-number">16.18.1</span> Data Generating Process</h3>
<p>Let’s set up a DGP where:</p>
<p><span class="math display">\begin{aligned}
&amp; Y_{\text{Gallagher}} = 12 - 0.8X_{\text{DM}} + \varepsilon \\
&amp; \varepsilon \sim \mathcal{N}(0, 1) \\
&amp; X_{\text{DM}} \in \{3, 5, 7, 10, 12, 15\}
\end{aligned}</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DGP</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>magnitude <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">15</span>)</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>gallagher <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">-</span> <span class="fl">0.8</span> <span class="sc">*</span> magnitude <span class="sc">+</span> epsilon</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Round (sampled from the DGP) Gallagher indices to one decimal place</span></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>gallagher <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fl">9.0</span>, <span class="fl">7.8</span>, <span class="fl">9.2</span>, <span class="fl">4.1</span>, <span class="fl">2.5</span>, <span class="fl">1.7</span>), <span class="dv">1</span>)</span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Show data</span></span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">District_Magnitude =</span> magnitude,</span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gallagher_Index =</span> gallagher</span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  District_Magnitude Gallagher_Index
1                  3             9.0
2                  5             7.8
3                  7             9.2
4                 10             4.1
5                 12             2.5
6                 15             1.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial model check</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(gallagher <span class="sc">~</span> magnitude)</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = gallagher ~ magnitude)

Residuals:
      1       2       3       4       5       6 
-0.6516 -0.4628  2.3260 -0.6908 -0.9020  0.3813 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  11.7349     1.3034   9.003 0.000843 ***
magnitude    -0.6944     0.1359  -5.110 0.006934 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.368 on 4 degrees of freedom
Multiple R-squared:  0.8672,    Adjusted R-squared:  0.834 
F-statistic: 26.11 on 1 and 4 DF,  p-value: 0.006934</code></pre>
</div>
</div>
</section>
<section id="descriptive-statistics-1" class="level3" data-number="16.18.2">
<h3 data-number="16.18.2" class="anchored" data-anchor-id="descriptive-statistics-1"><span class="header-section-number">16.18.2</span> Descriptive Statistics</h3>
<p><strong>Means:</strong> <span class="math display">\bar{X} = \frac{3 + 5 + 7 + 10 + 12 + 15}{6} = \frac{52}{6} = 8.6667</span></p>
<p><span class="math display">\bar{Y} = \frac{9.0 + 7.8 + 9.2 + 4.1 + 2.5 + 1.7}{6} = \frac{34.3}{6} = 5.7167</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(magnitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.666667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.716667</code></pre>
</div>
</div>
<p><strong>Variances:</strong> <span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}</span></p>
<p>Deviations for X:</p>
<ul>
<li>(3 - 8.6667) = -5.6667</li>
<li>(5 - 8.6667) = -3.6667</li>
<li>(7 - 8.6667) = -1.6667</li>
<li>(10 - 8.6667) = 1.3333</li>
<li>(12 - 8.6667) = 3.3333</li>
<li>(15 - 8.6667) = 6.3333</li>
</ul>
<p>Squared deviations:</p>
<p><span class="math display">
32.1115 + 13.4445 + 2.7779 + 1.7777 + 11.1109 + 40.1107 = 101.3332
</span></p>
<p><span class="math display">s^2_X = \frac{101.3332}{5} = 20.2666</span></p>
<p>For Y: Deviations: 3.2833, 2.0833, 3.4833, -1.6167, -3.2167, -4.0167</p>
<p><span class="math display">s^2_Y = \frac{56.3483}{5} = 11.2697</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(magnitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.26667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.26967</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation-2" class="level3" data-number="16.18.3">
<h3 data-number="16.18.3" class="anchored" data-anchor-id="covariance-and-correlation-2"><span class="header-section-number">16.18.3</span> Covariance and Correlation</h3>
<p><strong>Covariance:</strong> <span class="math display">s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Products of deviations:</p>
<ul>
<li>(-5.6667 × 3.2833) = -18.6057</li>
<li>(-3.6667 × 2.0833) = -7.6387</li>
<li>(-1.6667 × 3.4833) = -5.8056</li>
<li>(1.3333 × -1.6167) = -2.1556</li>
<li>(3.3333 × -3.2167) = -10.7223</li>
<li>(6.3333 × -4.0167) = -25.4391</li>
</ul>
<p>Sum = -70.3670</p>
<p><span class="math display">s_{XY} = \frac{-70.3670}{5} = -14.0734</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(magnitude, gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -14.07333</code></pre>
</div>
</div>
<p><strong>Correlation:</strong> <span class="math display">r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{-14.0734}{\sqrt{20.2666}\sqrt{11.2697}} = -0.9279</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(magnitude, gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9312157</code></pre>
</div>
</div>
</section>
<section id="ols-regression-haty-hatbeta_0-hatbeta_1x-2" class="level3" data-number="16.18.4">
<h3 data-number="16.18.4" class="anchored" data-anchor-id="ols-regression-haty-hatbeta_0-hatbeta_1x-2"><span class="header-section-number">16.18.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></h3>
<p><strong>Slope coefficient:</strong> <span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{-14.0734}{20.2666} = -0.6944</span></p>
<p><strong>Intercept:</strong> <span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span> Steps:</p>
<ol type="1">
<li><span class="math inline">-0.6944 × 8.6667 = -6.0181</span></li>
<li><span class="math inline">\hat{\beta_0} = 5.7167 - (-6.0181) = 11.7348</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)   magnitude 
 11.7348684  -0.6944079 </code></pre>
</div>
</div>
</section>
<section id="r-squared-calculation-1" class="level3" data-number="16.18.5">
<h3 data-number="16.18.5" class="anchored" data-anchor-id="r-squared-calculation-1"><span class="header-section-number">16.18.5</span> R-squared Calculation</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">(\hat{Y})</span>:</p>
<p><span class="math display">\hat{Y} = 11.7348 - 0.6944X</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted values</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="fl">11.7348</span> <span class="sc">-</span> <span class="fl">0.6944</span> <span class="sc">*</span> magnitude</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Magnitude =</span> magnitude,</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gallagher =</span> gallagher,</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> y_hat,</span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Magnitude Gallagher Predicted
1         3       9.0    9.6516
2         5       7.8    8.2628
3         7       9.2    6.8740
4        10       4.1    4.7908
5        12       2.5    3.4020
6        15       1.7    1.3188</code></pre>
</div>
</div>
<p><strong>Step 2: Sum of Squares</strong> <span class="math inline">SST = \sum(Y_i - \bar{Y})^2 = 56.3483</span> <span class="math inline">SSR = \sum(\hat{Y}_i - \bar{Y})^2 = 48.5271</span> <span class="math inline">SSE = \sum(Y_i - \hat{Y}_i)^2 = 7.8212</span></p>
<p><strong>R-squared:</strong> <span class="math display">R^2 = \frac{SSR}{SST} = \frac{48.5271}{56.3483} = 0.8612</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8671626</code></pre>
</div>
</div>
</section>
<section id="visualization---true-vs.-estimated-parameters" class="level3" data-number="16.18.6">
<h3 data-number="16.18.6" class="anchored" data-anchor-id="visualization---true-vs.-estimated-parameters"><span class="header-section-number">16.18.6</span> Visualization - True vs.&nbsp;Estimated Parameters</h3>
<ul>
<li>True DGP: Y = 12 - 0.8X + ε</li>
<li>Estimated Model: Y = 11.7348 - 0.6944X</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame with original data</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">magnitude =</span> magnitude,</span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">gallagher =</span> gallagher</span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sequence for smooth lines</span></span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a>x_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(magnitude), <span class="fu">max</span>(magnitude), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate predicted values for both lines</span></span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a>true_dgp <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">-</span> <span class="fl">0.8</span> <span class="sc">*</span> x_seq</span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a>estimated <span class="ot">&lt;-</span> <span class="fl">11.7348</span> <span class="sc">-</span> <span class="fl">0.6944</span> <span class="sc">*</span> x_seq</span>
<span id="cb192-15"><a href="#cb192-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-16"><a href="#cb192-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine into a data frame for plotting</span></span>
<span id="cb192-17"><a href="#cb192-17" aria-hidden="true" tabindex="-1"></a>lines_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb192-18"><a href="#cb192-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">magnitude =</span> <span class="fu">rep</span>(x_seq, <span class="dv">2</span>),</span>
<span id="cb192-19"><a href="#cb192-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(true_dgp, estimated),</span>
<span id="cb192-20"><a href="#cb192-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"True DGP"</span>, <span class="st">"Estimated"</span>), <span class="at">each =</span> <span class="fu">length</span>(x_seq))</span>
<span id="cb192-21"><a href="#cb192-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb192-22"><a href="#cb192-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-23"><a href="#cb192-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb192-24"><a href="#cb192-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb192-25"><a href="#cb192-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> lines_df, </span>
<span id="cb192-26"><a href="#cb192-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> magnitude, <span class="at">y =</span> value, <span class="at">color =</span> Model, <span class="at">linetype =</span> Model),</span>
<span id="cb192-27"><a href="#cb192-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb192-28"><a href="#cb192-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df, </span>
<span id="cb192-29"><a href="#cb192-29" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> magnitude, <span class="at">y =</span> gallagher),</span>
<span id="cb192-30"><a href="#cb192-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb192-31"><a href="#cb192-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb192-32"><a href="#cb192-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb192-33"><a href="#cb192-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"dashed"</span>, <span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb192-34"><a href="#cb192-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb192-35"><a href="#cb192-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"True DGP vs. Estimated Regression Line"</span>,</span>
<span id="cb192-36"><a href="#cb192-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Black points show observed data with random noise"</span>,</span>
<span id="cb192-37"><a href="#cb192-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"District Magnitude"</span>,</span>
<span id="cb192-38"><a href="#cb192-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gallagher Index"</span>,</span>
<span id="cb192-39"><a href="#cb192-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"True DGP: Y = 12 - 0.8X + ε</span><span class="sc">\n</span><span class="st">Estimated: Y = 11.73 - 0.69X"</span></span>
<span id="cb192-40"><a href="#cb192-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb192-41"><a href="#cb192-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb192-42"><a href="#cb192-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb192-43"><a href="#cb192-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb192-44"><a href="#cb192-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb192-45"><a href="#cb192-45" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="observations-about-model-fit" class="level3" data-number="16.18.7">
<h3 data-number="16.18.7" class="anchored" data-anchor-id="observations-about-model-fit"><span class="header-section-number">16.18.7</span> Observations about Model Fit</h3>
<ol type="1">
<li><strong>Slope Comparison</strong>
<ul>
<li>True slope: -0.8</li>
<li>Estimated slope: -0.69</li>
<li>The estimated slope is reasonably close to the true parameter</li>
</ul></li>
<li><strong>Intercept Comparison</strong>
<ul>
<li>True intercept: 12</li>
<li>Estimated intercept: 11.73</li>
<li>The estimated intercept very closely approximates the true value</li>
</ul></li>
<li><strong>Visual Patterns</strong>
<ul>
<li>The lines are nearly parallel, showing good slope recovery</li>
<li>Points scatter around both lines due to the random error term (ε)</li>
<li>The small sample size (n=6) leads to some imprecision in estimation</li>
<li>The estimated line (blue) provides a good approximation of the true DGP (red dashed)</li>
</ul></li>
<li><strong>Impact of Random Error</strong>
<ul>
<li>The scatter of points around the true DGP line reflects the N(0,1) error term</li>
<li>This noise leads to the slight differences in estimated parameters</li>
<li>With a larger sample, we would expect even closer convergence to true parameters</li>
</ul></li>
</ol>
</section>
<section id="interpretation-2" class="level3" data-number="16.18.8">
<h3 data-number="16.18.8" class="anchored" data-anchor-id="interpretation-2"><span class="header-section-number">16.18.8</span> Interpretation</h3>
<ol type="1">
<li>Strong negative correlation (r = -0.93) between district magnitude and electoral disproportionality</li>
<li>For each unit increase in district magnitude, the Gallagher index decreases by approximately 0.69 points</li>
<li>The model explains 86.12% of the variance in disproportionality</li>
<li>The relationship appears strongly linear with moderate scatter</li>
<li>The intercept (11.73) represents the expected disproportionality in a hypothetical single-member district system</li>
</ol>
</section>
<section id="study-context" class="level3" data-number="16.18.9">
<h3 data-number="16.18.9" class="anchored" data-anchor-id="study-context"><span class="header-section-number">16.18.9</span> Study Context</h3>
<ul>
<li>Data represents simulated observations from a DGP with moderate noise</li>
<li>Sample shows how increasing district magnitude tends to reduce disproportionality</li>
<li>Random component reflects other institutional and political factors affecting disproportionality</li>
</ul>
</section>
<section id="limitations" class="level3" data-number="16.18.10">
<h3 data-number="16.18.10" class="anchored" data-anchor-id="limitations"><span class="header-section-number">16.18.10</span> Limitations</h3>
<ol type="1">
<li>Small sample size (n=6)</li>
<li>Simulated rather than real-world data</li>
<li>Assumes linear relationship</li>
<li>Does not account for other institutional features</li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./correg_en.html" class="pagination-link" aria-label="Introduction to Correlation and Regression Analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./probability_en.html" class="pagination-link" aria-label="Introduction to Probability">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction to Probability</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>