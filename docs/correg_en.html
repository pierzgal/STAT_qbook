<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>15&nbsp; Introduction to Correlation and Regression Analysis – Social Data Analysis: An Introduction (Wprowadzenie do analizy danych społecznych)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./correg_pl.html" rel="next">
<link href="./rozdzial6.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./correg_en.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Social Data Analysis: An Introduction (Wprowadzenie do analizy danych społecznych)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Science and Statistics for Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wprowadzenie do Nauki o Danych i Statystyki dla Nauk Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Zrozumienie Typów Danych w Naukach Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">From Sample to Population - Understanding Randomness, Sampling, and Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Od Próby do Populacji - Zrozumienie Losowości, Próbkowania i Wnioskowania</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reliability and Validity in Data Science Research</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Rzetelność i Trafność w Badaniach Nauk o Danych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Research Designs: Experimental and Non-Experimental Approaches</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Projekty Badawcze: Podejścia Eksperymentalne i Nieeksperymentalne</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fundamentals of Univariate Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Podstawy Jednowymiarowej Statystyki Opisowej</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data Visualization: with examples in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Wizualizacja Danych: z przykładami w R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_en.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction to Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Wprowadzenie do Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Introduction to Statistical Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Wprowadzenie do Wnioskowania Statystycznego</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#bivariate-statistics---introduction" id="toc-bivariate-statistics---introduction" class="nav-link active" data-scroll-target="#bivariate-statistics---introduction"><span class="header-section-number">15.1</span> Bivariate Statistics - introduction</a>
  <ul class="collapse">
  <li><a href="#covariance" id="toc-covariance" class="nav-link" data-scroll-target="#covariance"><span class="header-section-number">15.1.1</span> Covariance</a></li>
  <li><a href="#pearson-correlation" id="toc-pearson-correlation" class="nav-link" data-scroll-target="#pearson-correlation"><span class="header-section-number">15.1.2</span> Pearson Correlation</a></li>
  <li><a href="#spearman-correlation" id="toc-spearman-correlation" class="nav-link" data-scroll-target="#spearman-correlation"><span class="header-section-number">15.1.3</span> Spearman Correlation</a></li>
  <li><a href="#cross-tabulation" id="toc-cross-tabulation" class="nav-link" data-scroll-target="#cross-tabulation"><span class="header-section-number">15.1.4</span> Cross-tabulation</a></li>
  <li><a href="#choosing-the-appropriate-measure" id="toc-choosing-the-appropriate-measure" class="nav-link" data-scroll-target="#choosing-the-appropriate-measure"><span class="header-section-number">15.1.5</span> Choosing the Appropriate Measure</a></li>
  </ul></li>
  <li><a href="#introduction-to-elementary-multivariate-statistics" id="toc-introduction-to-elementary-multivariate-statistics" class="nav-link" data-scroll-target="#introduction-to-elementary-multivariate-statistics"><span class="header-section-number">15.2</span> Introduction to Elementary Multivariate Statistics</a>
  <ul class="collapse">
  <li><a href="#correlation-matrix" id="toc-correlation-matrix" class="nav-link" data-scroll-target="#correlation-matrix"><span class="header-section-number">15.2.1</span> Correlation Matrix</a></li>
  <li><a href="#visualizing-multivariate-relationships" id="toc-visualizing-multivariate-relationships" class="nav-link" data-scroll-target="#visualizing-multivariate-relationships"><span class="header-section-number">15.2.2</span> Visualizing Multivariate Relationships</a></li>
  <li><a href="#partial-correlation" id="toc-partial-correlation" class="nav-link" data-scroll-target="#partial-correlation"><span class="header-section-number">15.2.3</span> Partial Correlation</a></li>
  <li><a href="#multiple-correlation" id="toc-multiple-correlation" class="nav-link" data-scroll-target="#multiple-correlation"><span class="header-section-number">15.2.4</span> Multiple Correlation</a></li>
  <li><a href="#factor-analysis" id="toc-factor-analysis" class="nav-link" data-scroll-target="#factor-analysis"><span class="header-section-number">15.2.5</span> Factor Analysis</a></li>
  <li><a href="#considerations-in-multivariate-analysis" id="toc-considerations-in-multivariate-analysis" class="nav-link" data-scroll-target="#considerations-in-multivariate-analysis"><span class="header-section-number">15.2.6</span> Considerations in Multivariate Analysis</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">15.2.7</span> Conclusion</a></li>
  </ul></li>
  <li><a href="#appendix-a.1-calculating-covariance-pearson-and-spearman-correlation---worked-example" id="toc-appendix-a.1-calculating-covariance-pearson-and-spearman-correlation---worked-example" class="nav-link" data-scroll-target="#appendix-a.1-calculating-covariance-pearson-and-spearman-correlation---worked-example"><span class="header-section-number">15.3</span> Appendix A.1: Calculating Covariance, Pearson, and Spearman Correlation - worked example</a>
  <ul class="collapse">
  <li><a href="#step-1-calculate-basic-statistics" id="toc-step-1-calculate-basic-statistics" class="nav-link" data-scroll-target="#step-1-calculate-basic-statistics"><span class="header-section-number">15.3.1</span> Step 1: Calculate Basic Statistics</a></li>
  <li><a href="#step-2-detailed-covariance-calculations" id="toc-step-2-detailed-covariance-calculations" class="nav-link" data-scroll-target="#step-2-detailed-covariance-calculations"><span class="header-section-number">15.3.2</span> Step 2: Detailed Covariance Calculations</a></li>
  <li><a href="#step-3-standard-deviation-calculations" id="toc-step-3-standard-deviation-calculations" class="nav-link" data-scroll-target="#step-3-standard-deviation-calculations"><span class="header-section-number">15.3.3</span> Step 3: Standard Deviation Calculations</a></li>
  <li><a href="#step-4-pearson-correlation-calculation" id="toc-step-4-pearson-correlation-calculation" class="nav-link" data-scroll-target="#step-4-pearson-correlation-calculation"><span class="header-section-number">15.3.4</span> Step 4: Pearson Correlation Calculation</a></li>
  <li><a href="#step-5-spearman-rank-correlation-calculation" id="toc-step-5-spearman-rank-correlation-calculation" class="nav-link" data-scroll-target="#step-5-spearman-rank-correlation-calculation"><span class="header-section-number">15.3.5</span> Step 5: Spearman Rank Correlation Calculation</a></li>
  <li><a href="#step-6-r-verification" id="toc-step-6-r-verification" class="nav-link" data-scroll-target="#step-6-r-verification"><span class="header-section-number">15.3.6</span> Step 6: R Verification</a></li>
  <li><a href="#step-7-basic-visualization" id="toc-step-7-basic-visualization" class="nav-link" data-scroll-target="#step-7-basic-visualization"><span class="header-section-number">15.3.7</span> Step 7: Basic Visualization</a></li>
  </ul></li>
  <li><a href="#appendix-a.2-ols-estimation-and-goodness-of-fit-measures" id="toc-appendix-a.2-ols-estimation-and-goodness-of-fit-measures" class="nav-link" data-scroll-target="#appendix-a.2-ols-estimation-and-goodness-of-fit-measures"><span class="header-section-number">15.4</span> Appendix A.2: OLS Estimation and Goodness-of-Fit Measures</a>
  <ul class="collapse">
  <li><a href="#step-1-calculate-ols-estimates" id="toc-step-1-calculate-ols-estimates" class="nav-link" data-scroll-target="#step-1-calculate-ols-estimates"><span class="header-section-number">15.4.1</span> Step 1: Calculate OLS Estimates</a></li>
  <li><a href="#step-2-calculate-fitted-values-and-residuals" id="toc-step-2-calculate-fitted-values-and-residuals" class="nav-link" data-scroll-target="#step-2-calculate-fitted-values-and-residuals"><span class="header-section-number">15.4.2</span> Step 2: Calculate Fitted Values and Residuals</a></li>
  <li><a href="#step-3-calculate-goodness-of-fit-measures" id="toc-step-3-calculate-goodness-of-fit-measures" class="nav-link" data-scroll-target="#step-3-calculate-goodness-of-fit-measures"><span class="header-section-number">15.4.3</span> Step 3: Calculate Goodness-of-Fit Measures</a></li>
  <li><a href="#step-4-r-verification" id="toc-step-4-r-verification" class="nav-link" data-scroll-target="#step-4-r-verification"><span class="header-section-number">15.4.4</span> Step 4: R Verification</a></li>
  <li><a href="#step-5-residual-analysis" id="toc-step-5-residual-analysis" class="nav-link" data-scroll-target="#step-5-residual-analysis"><span class="header-section-number">15.4.5</span> Step 5: Residual Analysis</a></li>
  <li><a href="#step-6-predicted-vs-actual-values-plot" id="toc-step-6-predicted-vs-actual-values-plot" class="nav-link" data-scroll-target="#step-6-predicted-vs-actual-values-plot"><span class="header-section-number">15.4.6</span> Step 6: Predicted vs Actual Values Plot</a></li>
  </ul></li>
  <li><a href="#appendix-a.3-log-transformed-models" id="toc-appendix-a.3-log-transformed-models" class="nav-link" data-scroll-target="#appendix-a.3-log-transformed-models"><span class="header-section-number">15.5</span> Appendix A.3: Log-Transformed Models</a>
  <ul class="collapse">
  <li><a href="#step-1-data-transformation" id="toc-step-1-data-transformation" class="nav-link" data-scroll-target="#step-1-data-transformation"><span class="header-section-number">15.5.1</span> Step 1: Data Transformation</a></li>
  <li><a href="#step-2-compare-different-model-specifications" id="toc-step-2-compare-different-model-specifications" class="nav-link" data-scroll-target="#step-2-compare-different-model-specifications"><span class="header-section-number">15.5.2</span> Step 2: Compare Different Model Specifications</a></li>
  <li><a href="#step-3-visual-comparison" id="toc-step-3-visual-comparison" class="nav-link" data-scroll-target="#step-3-visual-comparison"><span class="header-section-number">15.5.3</span> Step 3: Visual Comparison</a></li>
  <li><a href="#step-4-residual-analysis-for-best-model" id="toc-step-4-residual-analysis-for-best-model" class="nav-link" data-scroll-target="#step-4-residual-analysis-for-best-model"><span class="header-section-number">15.5.4</span> Step 4: Residual Analysis for Best Model</a></li>
  <li><a href="#step-5-interpretation-of-best-model" id="toc-step-5-interpretation-of-best-model" class="nav-link" data-scroll-target="#step-5-interpretation-of-best-model"><span class="header-section-number">15.5.5</span> Step 5: Interpretation of Best Model</a></li>
  <li><a href="#step-6-model-predictions" id="toc-step-6-model-predictions" class="nav-link" data-scroll-target="#step-6-model-predictions"><span class="header-section-number">15.5.6</span> Step 6: Model Predictions</a></li>
  <li><a href="#step-7-elasticity-analysis" id="toc-step-7-elasticity-analysis" class="nav-link" data-scroll-target="#step-7-elasticity-analysis"><span class="header-section-number">15.5.7</span> Step 7: Elasticity Analysis</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="bivariate-statistics---introduction" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="bivariate-statistics---introduction"><span class="header-section-number">15.1</span> Bivariate Statistics - introduction</h2>
<p>Bivariate statistics describe the relationship between two variables. We’ll explore several measures, starting with covariance and progressing to more advanced correlation measures.</p>
<section id="covariance" class="level3" data-number="15.1.1">
<h3 data-number="15.1.1" class="anchored" data-anchor-id="covariance"><span class="header-section-number">15.1.1</span> Covariance</h3>
<p>Covariance measures how two variables vary together.</p>
<p><strong>Formula:</strong> <span class="math inline">\(cov(X,Y) = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{n - 1}\)</span></p>
<p><strong>Manual Calculation Example:</strong></p>
<p>Let’s calculate the covariance for two variables:</p>
<ul>
<li>x: 1, 2, 3, 4, 5</li>
<li>y: 2, 4, 5, 4, 5</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 40%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Description</th>
<th>Calculation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Calculate means</td>
<td><span class="math inline">\(\bar{x} = 3, \bar{y} = 4\)</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>Calculate <span class="math inline">\((x_i - \bar{x})(y_i - \bar{y})\)</span> for each pair</td>
<td><span class="math inline">\((-2)(-2) = 4\)</span></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td><span class="math inline">\((-1)(0) = 0\)</span></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td><span class="math inline">\((0)(1) = 0\)</span></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td><span class="math inline">\((1)(0) = 0\)</span></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td><span class="math inline">\((2)(1) = 2\)</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Sum the results</td>
<td><span class="math inline">\(4 + 0 + 0 + 0 + 2 = 6\)</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>Divide by (n-1)</td>
<td><span class="math inline">\(6 / 4 = 1.5\)</span></td>
</tr>
</tbody>
</table>
<p><strong>R calculation:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.5</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong> - The positive covariance (1.5) indicates that x and y tend to increase together.</p>
<p><strong>Pros:</strong></p>
<ul>
<li>Provides direction of relationship (positive or negative)</li>
<li>Useful in calculating other measures like correlation</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Scale-dependent, making it difficult to compare across different variable pairs</li>
<li>Doesn’t provide information about the strength of the relationship</li>
</ul>
</section>
<section id="pearson-correlation" class="level3" data-number="15.1.2">
<h3 data-number="15.1.2" class="anchored" data-anchor-id="pearson-correlation"><span class="header-section-number">15.1.2</span> Pearson Correlation</h3>
<p>Pearson correlation measures the strength and direction of the linear relationship between two continuous variables.</p>
<p><strong>Formula:</strong> <span class="math inline">\(r = \frac{cov(X,Y)}{s_X s_Y} = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum (x_i - \bar{x})^2 \sum (y_i - \bar{y})^2}}\)</span></p>
<p><strong>Manual Calculation Example:</strong></p>
<p>Using the same data as above:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 40%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Description</th>
<th>Calculation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Calculate covariance</td>
<td>(From previous calculation) 1.5</td>
</tr>
<tr class="even">
<td>2</td>
<td>Calculate standard deviations</td>
<td><span class="math inline">\(s_X = \sqrt{\frac{10}{4}} = 1.58, s_Y = \sqrt{\frac{6}{4}} = 1.22\)</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Divide covariance by product of standard deviations</td>
<td><span class="math inline">\(1.5 / (1.58 * 1.22) = 0.7746\)</span></td>
</tr>
</tbody>
</table>
<p><strong>R calculation:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7745967</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong> - The correlation coefficient of 0.7746 indicates a strong positive linear relationship between x and y.</p>
<p><strong>Pros:</strong></p>
<ul>
<li>Scale-independent, always between -1 and 1</li>
<li>Widely understood and used</li>
<li>Tests for linear relationships</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Sensitive to outliers</li>
<li>Only measures linear relationships</li>
<li>Assumes normally distributed variables</li>
</ul>
</section>
<section id="spearman-correlation" class="level3" data-number="15.1.3">
<h3 data-number="15.1.3" class="anchored" data-anchor-id="spearman-correlation"><span class="header-section-number">15.1.3</span> Spearman Correlation</h3>
<p>Spearman correlation measures the strength and direction of the monotonic relationship between two variables, which can be continuous or ordinal.</p>
<p><strong>Formula:</strong> <span class="math inline">\(r_s = 1 - \frac{6 \sum d_i^2}{n(n^2 - 1)}\)</span>, where <span class="math inline">\(d_i\)</span> is the difference between ranks.</p>
<p><strong>Manual Calculation Example:</strong></p>
<p>Let’s use slightly different data:</p>
<ul>
<li>x: 1, 2, 3, 4, 5</li>
<li>y: 1, 3, 2, 5, 4</li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Step</th>
<th>Description</th>
<th>Calculation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Rank both variables</td>
<td>x_rank: 1, 2, 3, 4, 5</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>y_rank: 1, 3, 2, 5, 4</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Calculate differences in ranks (d)</td>
<td>0, -1, 1, -1, 1</td>
</tr>
<tr class="even">
<td>3</td>
<td>Square the differences</td>
<td>0, 1, 1, 1, 1</td>
</tr>
<tr class="odd">
<td>4</td>
<td>Sum the squared differences</td>
<td><span class="math inline">\(\sum d_i^2 = 4\)</span></td>
</tr>
<tr class="even">
<td>5</td>
<td>Apply the formula</td>
<td><span class="math inline">\(r_s = 1 - \frac{6(4)}{5(5^2 - 1)} = 0.8\)</span></td>
</tr>
</tbody>
</table>
<p><strong>R calculation:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong> - The Spearman correlation of 0.8 indicates a strong positive monotonic relationship between x and y.</p>
<p><strong>Pros:</strong></p>
<ul>
<li>Robust to outliers</li>
<li>Can detect non-linear monotonic relationships</li>
<li>Suitable for ordinal data</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Less powerful than Pearson for detecting linear relationships in normally distributed data</li>
<li>Doesn’t provide information about the shape of the relationship beyond monotonicity</li>
</ul>
</section>
<section id="cross-tabulation" class="level3" data-number="15.1.4">
<h3 data-number="15.1.4" class="anchored" data-anchor-id="cross-tabulation"><span class="header-section-number">15.1.4</span> Cross-tabulation</h3>
<p>Cross-tabulation (contingency table) shows the relationship between two categorical variables.</p>
<p><strong>Example:</strong></p>
<p>Let’s create a cross-tabulation of two variables: - Education level: High School, College, Graduate - Employment status: Employed, Unemployed</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>education <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"High School"</span>, <span class="st">"College"</span>, <span class="st">"Graduate"</span>, <span class="st">"High School"</span>, <span class="st">"College"</span>, <span class="st">"Graduate"</span>, <span class="st">"High School"</span>, <span class="st">"College"</span>, <span class="st">"Graduate"</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>employment <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Employed"</span>, <span class="st">"Employed"</span>, <span class="st">"Employed"</span>, <span class="st">"Unemployed"</span>, <span class="st">"Employed"</span>, <span class="st">"Employed"</span>, <span class="st">"Unemployed"</span>, <span class="st">"Unemployed"</span>, <span class="st">"Employed"</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(education, employment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             employment
education     Employed Unemployed
  College            2          1
  Graduate           3          0
  High School        1          2</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li>This table shows the count of individuals in each combination of education level and employment status.</li>
<li>For example, we can see how many high school graduates are employed versus unemployed.</li>
</ul>
<p><strong>Pros:</strong></p>
<ul>
<li>Provides a clear visual representation of the relationship between categorical variables</li>
<li>Easy to understand and interpret</li>
<li>Basis for many statistical tests (e.g., chi-square test of independence)</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Limited to categorical data</li>
<li>Can become unwieldy with many categories</li>
<li>Doesn’t provide a single summary statistic of association strength</li>
</ul>
</section>
<section id="choosing-the-appropriate-measure" class="level3" data-number="15.1.5">
<h3 data-number="15.1.5" class="anchored" data-anchor-id="choosing-the-appropriate-measure"><span class="header-section-number">15.1.5</span> Choosing the Appropriate Measure</h3>
<p>When deciding which bivariate statistic to use, consider:</p>
<ol type="1">
<li><p>Data type:</p>
<ul>
<li>Continuous data: Covariance, Pearson correlation</li>
<li>Ordinal data: Spearman correlation</li>
<li>Categorical data: Cross-tabulation</li>
</ul></li>
<li><p>Relationship type:</p>
<ul>
<li>Linear: Pearson correlation</li>
<li>Monotonic but potentially non-linear: Spearman correlation</li>
</ul></li>
<li><p>Presence of outliers:</p>
<ul>
<li>If outliers are a concern, Spearman correlation is more robust</li>
</ul></li>
<li><p>Distribution:</p>
<ul>
<li>For normally distributed data, Pearson correlation is most powerful</li>
<li>For non-normal distributions, consider Spearman correlation</li>
</ul></li>
<li><p>Sample size:</p>
<ul>
<li>For very small samples, non-parametric methods like Spearman correlation might be preferred</li>
</ul></li>
</ol>
<p>Remember, it’s often valuable to use multiple measures and visualizations (like scatter plots) to get a comprehensive understanding of the relationship between variables.</p>
</section>
</section>
<section id="introduction-to-elementary-multivariate-statistics" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="introduction-to-elementary-multivariate-statistics"><span class="header-section-number">15.2</span> Introduction to Elementary Multivariate Statistics</h2>
<p>Multivariate statistics involve the analysis of relationships among three or more variables simultaneously. This section will introduce some basic concepts and techniques in multivariate analysis, with a focus on correlation-based methods.</p>
<section id="correlation-matrix" class="level3" data-number="15.2.1">
<h3 data-number="15.2.1" class="anchored" data-anchor-id="correlation-matrix"><span class="header-section-number">15.2.1</span> Correlation Matrix</h3>
<p>A correlation matrix is a table showing the pairwise correlations of several variables. It’s a fundamental tool in multivariate analysis.</p>
<p><strong>Example:</strong> Let’s create a correlation matrix for four variables: height, weight, age, and income.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>height <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">170</span>, <span class="dv">10</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>weight <span class="ot">&lt;-</span> height <span class="sc">*</span> <span class="fl">0.5</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">40</span>, <span class="dv">10</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> age <span class="sc">*</span> <span class="dv">1000</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">10000</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(height, weight, age, income)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(data)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           height      weight         age      income
height  1.0000000  0.66712996 -0.12917601 -0.12246786
weight  0.6671300  1.00000000 -0.06814187 -0.04579492
age    -0.1291760 -0.06814187  1.00000000  0.65654902
income -0.1224679 -0.04579492  0.65654902  1.00000000</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li>Each cell shows the correlation between two variables.</li>
<li>The diagonal is always 1 (correlation of a variable with itself).</li>
<li>Look for strong correlations (close to 1 or -1) to identify potential relationships.</li>
</ul>
</section>
<section id="visualizing-multivariate-relationships" class="level3" data-number="15.2.2">
<h3 data-number="15.2.2" class="anchored" data-anchor-id="visualizing-multivariate-relationships"><span class="header-section-number">15.2.2</span> Visualizing Multivariate Relationships</h3>
<section id="scatterplot-matrix" class="level4" data-number="15.2.2.1">
<h4 data-number="15.2.2.1" class="anchored" data-anchor-id="scatterplot-matrix"><span class="header-section-number">15.2.2.1</span> Scatterplot Matrix</h4>
<p>A scatterplot matrix shows pairwise relationships between multiple variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li>Each plot shows the relationship between two variables.</li>
<li>Diagonal elements show the distribution of each variable.</li>
<li>Look for patterns, clusters, or trends in the plots.</li>
</ul>
</section>
<section id="correlation-plot" class="level4" data-number="15.2.2.2">
<h4 data-number="15.2.2.2" class="anchored" data-anchor-id="correlation-plot"><span class="header-section-number">15.2.2.2</span> Correlation Plot</h4>
<p>A correlation plot provides a visual representation of the correlation matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.94 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix, <span class="at">method =</span> <span class="st">"color"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li>Color intensity and size of the circles indicate the strength of correlation.</li>
<li>Blue colors typically indicate positive correlations, red colors indicate negative correlations.</li>
</ul>
</section>
</section>
<section id="partial-correlation" class="level3" data-number="15.2.3">
<h3 data-number="15.2.3" class="anchored" data-anchor-id="partial-correlation"><span class="header-section-number">15.2.3</span> Partial Correlation</h3>
<p>Partial correlation measures the relationship between two variables while controlling for one or more other variables.</p>
<p><strong>Example:</strong> Let’s calculate the partial correlation between height and weight, controlling for age.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ppcor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MASS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pcor.test</span>(data<span class="sc">$</span>height, data<span class="sc">$</span>weight, data<span class="sc">$</span>age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   estimate      p.value statistic   n gp  Method
1 0.6654367 5.758157e-14  8.779896 100  1 pearson</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li>Compare this to the simple correlation between height and weight.</li>
<li>A significant change might indicate that age plays a role in the height-weight relationship.</li>
</ul>
</section>
<section id="multiple-correlation" class="level3" data-number="15.2.4">
<h3 data-number="15.2.4" class="anchored" data-anchor-id="multiple-correlation"><span class="header-section-number">15.2.4</span> Multiple Correlation</h3>
<p>Multiple correlation measures the strength of the relationship between a dependent variable and multiple independent variables.</p>
<p><strong>Example:</strong> Let’s predict weight using height and age.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height <span class="sc">+</span> age, <span class="at">data =</span> data)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Multiple correlation coefficient:"</span>, R))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Multiple correlation coefficient: 0.667377840470434"</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li>R ranges from 0 to 1, with higher values indicating stronger relationships.</li>
<li>R² (R-squared) represents the proportion of variance in the dependent variable explained by the independent variables.</li>
</ul>
</section>
<section id="factor-analysis" class="level3" data-number="15.2.5">
<h3 data-number="15.2.5" class="anchored" data-anchor-id="factor-analysis"><span class="header-section-number">15.2.5</span> Factor Analysis</h3>
<p>Factor analysis is a technique used to reduce many variables to a smaller number of underlying factors.</p>
<p><strong>Example:</strong> Let’s perform a simple factor analysis on our dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>fa_result <span class="ot">&lt;-</span> <span class="fu">fa</span>(data, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_result<span class="sc">$</span>loadings, <span class="at">cutoff =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
       MR2    MR1   
height  0.798       
weight  0.836       
age            0.729
income         0.895

                 MR2   MR1
SS loadings    1.344 1.341
Proportion Var 0.336 0.335
Cumulative Var 0.336 0.671</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li>Look at which variables load highly on each factor.</li>
<li>Try to interpret what each factor might represent based on the variables that load on it.</li>
</ul>
</section>
<section id="considerations-in-multivariate-analysis" class="level3" data-number="15.2.6">
<h3 data-number="15.2.6" class="anchored" data-anchor-id="considerations-in-multivariate-analysis"><span class="header-section-number">15.2.6</span> Considerations in Multivariate Analysis</h3>
<ol type="1">
<li><p><strong>Sample Size</strong>: Multivariate techniques often require larger sample sizes for stable results.</p></li>
<li><p><strong>Multicollinearity</strong>: High correlations among independent variables can cause issues in some analyses.</p></li>
<li><p><strong>Outliers</strong>: Multivariate outliers can have a strong influence on results.</p></li>
<li><p><strong>Assumptions</strong>: Many techniques assume multivariate normality and linear relationships.</p></li>
<li><p><strong>Interpretation Complexity</strong>: As the number of variables increases, interpretation can become more challenging.</p></li>
</ol>
</section>
<section id="conclusion" class="level3" data-number="15.2.7">
<h3 data-number="15.2.7" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">15.2.7</span> Conclusion</h3>
<p>This introduction to multivariate statistics builds upon the concept of correlation to explore relationships among multiple variables. These techniques provide powerful tools for understanding complex datasets, but they also require careful consideration of assumptions and limitations. As you progress in your statistical journey, you’ll encounter more advanced multivariate techniques such as MANOVA, discriminant analysis, and structural equation modeling.</p>
</section>
</section>
<section id="appendix-a.1-calculating-covariance-pearson-and-spearman-correlation---worked-example" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="appendix-a.1-calculating-covariance-pearson-and-spearman-correlation---worked-example"><span class="header-section-number">15.3</span> Appendix A.1: Calculating Covariance, Pearson, and Spearman Correlation - worked example</h2>
<p>Given data on Electoral District Magnitude (DM) and Gallagher index:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>DM (<span class="math inline">\(X\)</span>)</th>
<th>Gallagher (<span class="math inline">\(Y\)</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>18.2</td>
</tr>
<tr class="even">
<td>3</td>
<td>16.7</td>
</tr>
<tr class="odd">
<td>4</td>
<td>15.8</td>
</tr>
<tr class="even">
<td>5</td>
<td>15.3</td>
</tr>
<tr class="odd">
<td>6</td>
<td>15.0</td>
</tr>
<tr class="even">
<td>7</td>
<td>14.8</td>
</tr>
<tr class="odd">
<td>8</td>
<td>14.7</td>
</tr>
<tr class="even">
<td>9</td>
<td>14.6</td>
</tr>
<tr class="odd">
<td>10</td>
<td>14.55</td>
</tr>
<tr class="even">
<td>11</td>
<td>14.52</td>
</tr>
</tbody>
</table>
<section id="step-1-calculate-basic-statistics" class="level3" data-number="15.3.1">
<h3 data-number="15.3.1" class="anchored" data-anchor-id="step-1-calculate-basic-statistics"><span class="header-section-number">15.3.1</span> Step 1: Calculate Basic Statistics</h3>
<p>Calculation of means:</p>
<p>For DM (<span class="math inline">\(X\)</span>): <span class="math inline">\(\bar{X} = \frac{\sum_{i=1}^n X_i}{n}\)</span></p>
<p>Detailed calculation:</p>
<pre><code>2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 + 10 + 11 = 65
x̄ = 65 ÷ 10 = 6.5</code></pre>
<p>For Gallagher index (<span class="math inline">\(Y\)</span>): <span class="math inline">\(\bar{Y} = \frac{\sum_{i=1}^n Y_i}{n}\)</span></p>
<p>Detailed calculation:</p>
<pre><code>18.2 + 16.7 + 15.8 + 15.3 + 15.0 + 14.8 + 14.7 + 14.6 + 14.55 + 14.52 = 154.17
ȳ = 154.17 ÷ 10 = 15.417</code></pre>
</section>
<section id="step-2-detailed-covariance-calculations" class="level3" data-number="15.3.2">
<h3 data-number="15.3.2" class="anchored" data-anchor-id="step-2-detailed-covariance-calculations"><span class="header-section-number">15.3.2</span> Step 2: Detailed Covariance Calculations</h3>
<p>Complete working table showing all calculations:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 26%">
<col style="width: 15%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">\(i\)</span></th>
<th><span class="math inline">\(X_i\)</span></th>
<th><span class="math inline">\(Y_i\)</span></th>
<th><span class="math inline">\((X_i - \bar{X})\)</span></th>
<th><span class="math inline">\((Y_i - \bar{Y})\)</span></th>
<th><span class="math inline">\((X_i - \bar{X})(Y_i - \bar{Y})\)</span></th>
<th><span class="math inline">\((X_i - \bar{X})^2\)</span></th>
<th><span class="math inline">\((Y_i - \bar{Y})^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18.2</td>
<td>-4.5</td>
<td>2.783</td>
<td>-12.5235</td>
<td>20.25</td>
<td>7.7451</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16.7</td>
<td>-3.5</td>
<td>1.283</td>
<td>-4.4905</td>
<td>12.25</td>
<td>1.6461</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15.8</td>
<td>-2.5</td>
<td>0.383</td>
<td>-0.9575</td>
<td>6.25</td>
<td>0.1467</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15.3</td>
<td>-1.5</td>
<td>-0.117</td>
<td>0.1755</td>
<td>2.25</td>
<td>0.0137</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15.0</td>
<td>-0.5</td>
<td>-0.417</td>
<td>0.2085</td>
<td>0.25</td>
<td>0.1739</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14.8</td>
<td>0.5</td>
<td>-0.617</td>
<td>-0.3085</td>
<td>0.25</td>
<td>0.3807</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14.7</td>
<td>1.5</td>
<td>-0.717</td>
<td>-1.0755</td>
<td>2.25</td>
<td>0.5141</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14.6</td>
<td>2.5</td>
<td>-0.817</td>
<td>-2.0425</td>
<td>6.25</td>
<td>0.6675</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14.55</td>
<td>3.5</td>
<td>-0.867</td>
<td>-3.0345</td>
<td>12.25</td>
<td>0.7517</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14.52</td>
<td>4.5</td>
<td>-0.897</td>
<td>-4.0365</td>
<td>20.25</td>
<td>0.8047</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td>65</td>
<td>154.17</td>
<td>0</td>
<td>0</td>
<td>-28.085</td>
<td>82.5</td>
<td>12.8442</td>
</tr>
</tbody>
</table>
<p>Covariance calculation: <span class="math inline">\(Cov(X,Y) = \frac{\sum_{i=1}^n (X_i - \bar{X})(Y_i - \bar{Y})}{n-1}\)</span></p>
<pre><code>Cov(X,Y) = -28.085 ÷ 9 = -3.120556</code></pre>
</section>
<section id="step-3-standard-deviation-calculations" class="level3" data-number="15.3.3">
<h3 data-number="15.3.3" class="anchored" data-anchor-id="step-3-standard-deviation-calculations"><span class="header-section-number">15.3.3</span> Step 3: Standard Deviation Calculations</h3>
<p>For DM (<span class="math inline">\(X\)</span>): <span class="math inline">\(\sigma_X = \sqrt{\frac{\sum_{i=1}^n (X_i - \bar{X})^2}{n-1}}\)</span></p>
<pre><code>σx = √(82.5 ÷ 9)
   = √9.1667
   = 3.026582</code></pre>
<p>For Gallagher (<span class="math inline">\(Y\)</span>): <span class="math inline">\(\sigma_Y = \sqrt{\frac{\sum_{i=1}^n (Y_i - \bar{Y})^2}{n-1}}\)</span></p>
<pre><code>σy = √(12.8442 ÷ 9)
   = √1.4271
   = 1.194612</code></pre>
</section>
<section id="step-4-pearson-correlation-calculation" class="level3" data-number="15.3.4">
<h3 data-number="15.3.4" class="anchored" data-anchor-id="step-4-pearson-correlation-calculation"><span class="header-section-number">15.3.4</span> Step 4: Pearson Correlation Calculation</h3>
<p><span class="math inline">\(r = \frac{Cov(X,Y)}{\sigma_X \sigma_Y}\)</span></p>
<pre><code>r = -3.120556 ÷ (3.026582 × 1.194612)
  = -3.120556 ÷ 3.615752
  = -0.863044</code></pre>
</section>
<section id="step-5-spearman-rank-correlation-calculation" class="level3" data-number="15.3.5">
<h3 data-number="15.3.5" class="anchored" data-anchor-id="step-5-spearman-rank-correlation-calculation"><span class="header-section-number">15.3.5</span> Step 5: Spearman Rank Correlation Calculation</h3>
<p>Complete ranking table with all calculations:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(i\)</span></th>
<th><span class="math inline">\(X_i\)</span></th>
<th><span class="math inline">\(Y_i\)</span></th>
<th>Rank <span class="math inline">\(X_i\)</span></th>
<th>Rank <span class="math inline">\(Y_i\)</span></th>
<th><span class="math inline">\(d_i\)</span></th>
<th><span class="math inline">\(d_i^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18.2</td>
<td>1</td>
<td>10</td>
<td>-9</td>
<td>81</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16.7</td>
<td>2</td>
<td>9</td>
<td>-7</td>
<td>49</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15.8</td>
<td>3</td>
<td>8</td>
<td>-5</td>
<td>25</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15.3</td>
<td>4</td>
<td>7</td>
<td>-3</td>
<td>9</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15.0</td>
<td>5</td>
<td>6</td>
<td>-1</td>
<td>1</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14.8</td>
<td>6</td>
<td>5</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14.7</td>
<td>7</td>
<td>4</td>
<td>3</td>
<td>9</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14.6</td>
<td>8</td>
<td>3</td>
<td>5</td>
<td>25</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14.55</td>
<td>9</td>
<td>2</td>
<td>7</td>
<td>49</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14.52</td>
<td>10</td>
<td>1</td>
<td>9</td>
<td>81</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>330</td>
</tr>
</tbody>
</table>
<p>Spearman correlation calculation: <span class="math inline">\(r_s = 1 - \frac{6\sum d_i^2}{n(n^2-1)}\)</span></p>
<pre><code>rs = 1 - (6 × 330) ÷ (10(100 - 1))
   = 1 - 1980 ÷ 990
   = 1 - 2
   = -1</code></pre>
</section>
<section id="step-6-r-verification" class="level3" data-number="15.3.6">
<h3 data-number="15.3.6" class="anchored" data-anchor-id="step-6-r-verification"><span class="header-section-number">15.3.6</span> Step 6: R Verification</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create vectors</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>DM <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>GH <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">18.2</span>, <span class="fl">16.7</span>, <span class="fl">15.8</span>, <span class="fl">15.3</span>, <span class="fl">15.0</span>, <span class="fl">14.8</span>, <span class="fl">14.7</span>, <span class="fl">14.6</span>, <span class="fl">14.55</span>, <span class="fl">14.52</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate covariance</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(DM, GH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3.120556</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlations</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DM, GH, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8627742</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DM, GH, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1</code></pre>
</div>
</div>
</section>
<section id="step-7-basic-visualization" class="level3" data-number="15.3.7">
<h3 data-number="15.3.7" class="anchored" data-anchor-id="step-7-basic-visualization"><span class="header-section-number">15.3.7</span> Step 7: Basic Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggplot2'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:psych':

    %+%, alpha</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">DM =</span> DM, <span class="at">GH =</span> GH)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create scatter plot</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"District Magnitude vs Gallagher Index"</span>,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"District Magnitude (DM)"</span>,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gallagher Index (GH)"</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="appendix-a.2-ols-estimation-and-goodness-of-fit-measures" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="appendix-a.2-ols-estimation-and-goodness-of-fit-measures"><span class="header-section-number">15.4</span> Appendix A.2: OLS Estimation and Goodness-of-Fit Measures</h2>
<section id="step-1-calculate-ols-estimates" class="level3" data-number="15.4.1">
<h3 data-number="15.4.1" class="anchored" data-anchor-id="step-1-calculate-ols-estimates"><span class="header-section-number">15.4.1</span> Step 1: Calculate OLS Estimates</h3>
<p>Using previously calculated values: - <span class="math inline">\(\sum(X_i - \bar{X})(Y_i - \bar{Y}) = -28.085\)</span> - <span class="math inline">\(\sum(X_i - \bar{X})^2 = 82.5\)</span> - <span class="math inline">\(\bar{X} = 6.5\)</span> - <span class="math inline">\(\bar{Y} = 15.417\)</span></p>
<p>Calculate slope (<span class="math inline">\(\beta_1\)</span>): <span class="math inline">\(\beta_1 = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2}\)</span></p>
<pre><code>β₁ = -28.085 ÷ 82.5 = -0.3404</code></pre>
<p>Calculate intercept (<span class="math inline">\(\beta_0\)</span>): <span class="math inline">\(\beta_0 = \bar{Y} - \beta_1\bar{X}\)</span></p>
<pre><code>β₀ = 15.417 - (-0.3404 × 6.5)
   = 15.417 + 2.2126
   = 17.6296</code></pre>
<p>Therefore, the OLS regression equation is: <span class="math inline">\(\hat{Y} = 17.6296 - 0.3404X\)</span></p>
</section>
<section id="step-2-calculate-fitted-values-and-residuals" class="level3" data-number="15.4.2">
<h3 data-number="15.4.2" class="anchored" data-anchor-id="step-2-calculate-fitted-values-and-residuals"><span class="header-section-number">15.4.2</span> Step 2: Calculate Fitted Values and Residuals</h3>
<p>Complete table showing all calculations:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 21%">
<col style="width: 8%">
<col style="width: 18%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">\(i\)</span></th>
<th><span class="math inline">\(X_i\)</span></th>
<th><span class="math inline">\(Y_i\)</span></th>
<th><span class="math inline">\(\hat{Y}_i\)</span></th>
<th><span class="math inline">\(e_i = Y_i - \hat{Y}_i\)</span></th>
<th><span class="math inline">\(e_i^2\)</span></th>
<th><span class="math inline">\((Y_i - \bar{Y})^2\)</span></th>
<th><span class="math inline">\((\hat{Y}_i - \bar{Y})^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18.2</td>
<td>16.9488</td>
<td>1.2512</td>
<td>1.5655</td>
<td>7.7451</td>
<td>2.3404</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16.7</td>
<td>16.6084</td>
<td>0.0916</td>
<td>0.0084</td>
<td>1.6461</td>
<td>1.4241</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15.8</td>
<td>16.2680</td>
<td>-0.4680</td>
<td>0.2190</td>
<td>0.1467</td>
<td>0.7225</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15.3</td>
<td>15.9276</td>
<td>-0.6276</td>
<td>0.3939</td>
<td>0.0137</td>
<td>0.2601</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15.0</td>
<td>15.5872</td>
<td>-0.5872</td>
<td>0.3448</td>
<td>0.1739</td>
<td>0.0289</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14.8</td>
<td>15.2468</td>
<td>-0.4468</td>
<td>0.1996</td>
<td>0.3807</td>
<td>0.0290</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14.7</td>
<td>14.9064</td>
<td>-0.2064</td>
<td>0.0426</td>
<td>0.5141</td>
<td>0.2610</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14.6</td>
<td>14.5660</td>
<td>0.0340</td>
<td>0.0012</td>
<td>0.6675</td>
<td>0.7241</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14.55</td>
<td>14.2256</td>
<td>0.3244</td>
<td>0.1052</td>
<td>0.7517</td>
<td>1.4184</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14.52</td>
<td>13.8852</td>
<td>0.6348</td>
<td>0.4030</td>
<td>0.8047</td>
<td>2.3439</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td>65</td>
<td>154.17</td>
<td>154.17</td>
<td>0</td>
<td>3.2832</td>
<td>12.8442</td>
<td>9.5524</td>
</tr>
</tbody>
</table>
<p>Calculations for fitted values:</p>
<pre><code>For X = 2:
Ŷ = 17.6296 + (-0.3404 × 2) = 16.9488

For X = 3:
Ŷ = 17.6296 + (-0.3404 × 3) = 16.6084

[... continue for all values]</code></pre>
</section>
<section id="step-3-calculate-goodness-of-fit-measures" class="level3" data-number="15.4.3">
<h3 data-number="15.4.3" class="anchored" data-anchor-id="step-3-calculate-goodness-of-fit-measures"><span class="header-section-number">15.4.3</span> Step 3: Calculate Goodness-of-Fit Measures</h3>
<p>Sum of Squared Errors (SSE): <span class="math inline">\(SSE = \sum e_i^2\)</span></p>
<pre><code>SSE = 3.2832</code></pre>
<p>Sum of Squared Total (SST): <span class="math inline">\(SST = \sum(Y_i - \bar{Y})^2\)</span></p>
<pre><code>SST = 12.8442</code></pre>
<p>Sum of Squared Regression (SSR): <span class="math inline">\(SSR = \sum(\hat{Y}_i - \bar{Y})^2\)</span></p>
<pre><code>SSR = 9.5524</code></pre>
<p>Verify decomposition: <span class="math inline">\(SST = SSR + SSE\)</span></p>
<pre><code>12.8442 = 9.5524 + 3.2832 (within rounding error)</code></pre>
<p>R-squared calculation: <span class="math inline">\(R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}\)</span></p>
<pre><code>R² = 9.5524 ÷ 12.8442
   = 0.7438</code></pre>
</section>
<section id="step-4-r-verification" class="level3" data-number="15.4.4">
<h3 data-number="15.4.4" class="anchored" data-anchor-id="step-4-r-verification"><span class="header-section-number">15.4.4</span> Step 4: R Verification</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear model</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View summary statistics</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = GH ~ DM, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.62764 -0.46274 -0.08615  0.26624  1.25109 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 17.62976    0.50121  35.174 4.67e-10 ***
DM          -0.34042    0.07053  -4.827  0.00131 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6406 on 8 degrees of freedom
Multiple R-squared:  0.7444,    Adjusted R-squared:  0.7124 
F-statistic:  23.3 on 1 and 8 DF,  p-value: 0.00131</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate R-squared manually</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((GH <span class="sc">-</span> <span class="fu">mean</span>(GH))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(model)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> SST <span class="sc">-</span> SSE</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>R2_manual <span class="ot">&lt;-</span> SSR<span class="sc">/</span>SST</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>R2_manual</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7443793</code></pre>
</div>
</div>
</section>
<section id="step-5-residual-analysis" class="level3" data-number="15.4.5">
<h3 data-number="15.4.5" class="anchored" data-anchor-id="step-5-residual-analysis"><span class="header-section-number">15.4.5</span> Step 5: Residual Analysis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create residual plots</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-6-predicted-vs-actual-values-plot" class="level3" data-number="15.4.6">
<h3 data-number="15.4.6" class="anchored" data-anchor-id="step-6-predicted-vs-actual-values-plot"><span class="header-section-number">15.4.6</span> Step 6: Predicted vs Actual Values Plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create predicted vs actual plot</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Actual =</span> GH,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> <span class="fu">fitted</span>(model)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>), <span class="fu">aes</span>(<span class="at">x =</span> Predicted, <span class="at">y =</span> Actual)) <span class="sc">+</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predicted vs Actual Values"</span>,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Predicted Gallagher Index"</span>,</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Actual Gallagher Index"</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="appendix-a.3-log-transformed-models" class="level2" data-number="15.5">
<h2 data-number="15.5" class="anchored" data-anchor-id="appendix-a.3-log-transformed-models"><span class="header-section-number">15.5</span> Appendix A.3: Log-Transformed Models</h2>
<section id="step-1-data-transformation" class="level3" data-number="15.5.1">
<h3 data-number="15.5.1" class="anchored" data-anchor-id="step-1-data-transformation"><span class="header-section-number">15.5.1</span> Step 1: Data Transformation</h3>
<p>First, calculate natural logarithms of variables:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(i\)</span></th>
<th><span class="math inline">\(X_i\)</span></th>
<th><span class="math inline">\(Y_i\)</span></th>
<th><span class="math inline">\(\ln(X_i)\)</span></th>
<th><span class="math inline">\(\ln(Y_i)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18.2</td>
<td>0.6931</td>
<td>2.9014</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16.7</td>
<td>1.0986</td>
<td>2.8154</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15.8</td>
<td>1.3863</td>
<td>2.7600</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15.3</td>
<td>1.6094</td>
<td>2.7278</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15.0</td>
<td>1.7918</td>
<td>2.7081</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14.8</td>
<td>1.9459</td>
<td>2.6946</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14.7</td>
<td>2.0794</td>
<td>2.6878</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14.6</td>
<td>2.1972</td>
<td>2.6810</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14.55</td>
<td>2.3026</td>
<td>2.6777</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14.52</td>
<td>2.3979</td>
<td>2.6757</td>
</tr>
</tbody>
</table>
</section>
<section id="step-2-compare-different-model-specifications" class="level3" data-number="15.5.2">
<h3 data-number="15.5.2" class="anchored" data-anchor-id="step-2-compare-different-model-specifications"><span class="header-section-number">15.5.2</span> Step 2: Compare Different Model Specifications</h3>
<p>We estimate three alternative specifications:</p>
<ol type="1">
<li>Log-linear model: <span class="math inline">\(\ln(Y_i) = \beta_0 + \beta_1X_i + \epsilon_i\)</span></li>
<li>Linear-log model: <span class="math inline">\(Y_i = \beta_0 + \beta_1\ln(X_i) + \epsilon_i\)</span></li>
<li>Log-log model: <span class="math inline">\(\ln(Y_i) = \beta_0 + \beta_1\ln(X_i) + \epsilon_i\)</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create transformed variables</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log_DM <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>DM)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log_GH <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>GH)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>model_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>model_loglinear <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>model_linearlog <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> log_DM, <span class="at">data =</span> data)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>model_loglog <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_GH <span class="sc">~</span> log_DM, <span class="at">data =</span> data)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare R-squared values</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>models_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Linear"</span>, <span class="st">"Log-linear"</span>, <span class="st">"Linear-log"</span>, <span class="st">"Log-log"</span>),</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_squared =</span> <span class="fu">c</span>(</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_linear)<span class="sc">$</span>r.squared,</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_loglinear)<span class="sc">$</span>r.squared,</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_linearlog)<span class="sc">$</span>r.squared,</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_loglog)<span class="sc">$</span>r.squared</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Display comparison</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>models_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Model R_squared
1     Linear 0.7443793
2 Log-linear 0.7670346
3 Linear-log 0.9141560
4    Log-log 0.9288088</code></pre>
</div>
</div>
</section>
<section id="step-3-visual-comparison" class="level3" data-number="15.5.3">
<h3 data-number="15.5.3" class="anchored" data-anchor-id="step-3-visual-comparison"><span class="header-section-number">15.5.3</span> Step 3: Visual Comparison</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots for each model</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Linear Model"</span>) <span class="sc">+</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> log_GH)) <span class="sc">+</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log-linear Model"</span>) <span class="sc">+</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Linear-log Model"</span>) <span class="sc">+</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> log_GH)) <span class="sc">+</span></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log-log Model"</span>) <span class="sc">+</span></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange plots in a grid</span></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-4-residual-analysis-for-best-model" class="level3" data-number="15.5.4">
<h3 data-number="15.5.4" class="anchored" data-anchor-id="step-4-residual-analysis-for-best-model"><span class="header-section-number">15.5.4</span> Step 4: Residual Analysis for Best Model</h3>
<p>Based on R-squared values, analyze residuals for the best-fitting model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual plots for best model</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_linearlog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-5-interpretation-of-best-model" class="level3" data-number="15.5.5">
<h3 data-number="15.5.5" class="anchored" data-anchor-id="step-5-interpretation-of-best-model"><span class="header-section-number">15.5.5</span> Step 5: Interpretation of Best Model</h3>
<p>The linear-log model coefficients:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_linearlog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = GH ~ log_DM, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40702 -0.30207 -0.04907  0.22905  0.60549 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  19.0223     0.4079   46.64 4.94e-11 ***
log_DM       -2.0599     0.2232   -9.23 1.54e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3712 on 8 degrees of freedom
Multiple R-squared:  0.9142,    Adjusted R-squared:  0.9034 
F-statistic: 85.19 on 1 and 8 DF,  p-value: 1.539e-05</code></pre>
</div>
</div>
<p>Interpretation: - <span class="math inline">\(\beta_0\)</span> represents the expected Gallagher Index when ln(DM) = 0 (i.e., when DM = 1) - <span class="math inline">\(\beta_1\)</span> represents the change in Gallagher Index associated with a one-unit increase in ln(DM)</p>
</section>
<section id="step-6-model-predictions" class="level3" data-number="15.5.6">
<h3 data-number="15.5.6" class="anchored" data-anchor-id="step-6-model-predictions"><span class="header-section-number">15.5.6</span> Step 6: Model Predictions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction plot for best model</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Linear-log Model: Gallagher Index vs ln(District Magnitude)"</span>,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"ln(District Magnitude)"</span>,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gallagher Index"</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-7-elasticity-analysis" class="level3" data-number="15.5.7">
<h3 data-number="15.5.7" class="anchored" data-anchor-id="step-7-elasticity-analysis"><span class="header-section-number">15.5.7</span> Step 7: Elasticity Analysis</h3>
<p>For the log-log model, coefficients represent elasticities directly. Calculate average elasticity for the linear-log model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate elasticity at means</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>mean_DM <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>DM)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>mean_GH <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>GH)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_linearlog)[<span class="dv">2</span>]</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>elasticity <span class="ot">&lt;-</span> beta1 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>mean_GH)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>elasticity</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    log_DM 
-0.1336136 </code></pre>
</div>
</div>
<p>This represents the percentage change in the Gallagher Index for a 1% change in District Magnitude.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./rozdzial6.html" class="pagination-link" aria-label="Wizualizacja Danych: z przykładami w R">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Wizualizacja Danych: z przykładami w R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./correg_pl.html" class="pagination-link" aria-label="Wprowadzenie do Analizy Korelacji i Regresji">
        <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>