<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>15&nbsp; Introduction to Correlation and Regression Analysis – Social Data Analysis: An Introduction (Wprowadzenie do analizy danych społecznych)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./correg_pl.html" rel="next">
<link href="./rozdzial6.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./correg_en.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Social Data Analysis: An Introduction (Wprowadzenie do analizy danych społecznych)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Science and Statistics for Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wprowadzenie do Nauki o Danych i Statystyki dla Nauk Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Zrozumienie Typów Danych w Naukach Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">From Sample to Population - Understanding Randomness, Sampling, and Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Od Próby do Populacji - Zrozumienie Losowości, Próbkowania i Wnioskowania</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reliability and Validity in Data Science Research</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Rzetelność i Trafność w Badaniach Nauk o Danych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Research Designs: Experimental and Non-Experimental Approaches</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Projekty Badawcze: Podejścia Eksperymentalne i Nieeksperymentalne</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fundamentals of Univariate Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Podstawy Jednowymiarowej Statystyki Opisowej</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data Visualization: with examples in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Wizualizacja Danych: z przykładami w R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_en.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction to Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Wprowadzenie do Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Introduction to Statistical Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Wprowadzenie do Wnioskowania Statystycznego</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#bivariate-statistics---introduction" id="toc-bivariate-statistics---introduction" class="nav-link active" data-scroll-target="#bivariate-statistics---introduction"><span class="header-section-number">15.1</span> Bivariate Statistics - introduction</a>
  <ul class="collapse">
  <li><a href="#covariance" id="toc-covariance" class="nav-link" data-scroll-target="#covariance"><span class="header-section-number">15.1.6</span> Covariance</a></li>
  <li><a href="#pearson-correlation" id="toc-pearson-correlation" class="nav-link" data-scroll-target="#pearson-correlation"><span class="header-section-number">15.1.13</span> Pearson Correlation</a></li>
  <li><a href="#spearman-correlation" id="toc-spearman-correlation" class="nav-link" data-scroll-target="#spearman-correlation"><span class="header-section-number">15.1.14</span> Spearman Correlation</a></li>
  <li><a href="#cross-tabulation" id="toc-cross-tabulation" class="nav-link" data-scroll-target="#cross-tabulation"><span class="header-section-number">15.1.15</span> Cross-tabulation</a></li>
  <li><a href="#choosing-the-appropriate-measure" id="toc-choosing-the-appropriate-measure" class="nav-link" data-scroll-target="#choosing-the-appropriate-measure"><span class="header-section-number">15.1.16</span> Choosing the Appropriate Measure</a></li>
  <li><a href="#comparing-pearson-spearman-and-kendall-correlations" id="toc-comparing-pearson-spearman-and-kendall-correlations" class="nav-link" data-scroll-target="#comparing-pearson-spearman-and-kendall-correlations"><span class="header-section-number">15.1.17</span> Comparing Pearson, Spearman, and Kendall Correlations</a></li>
  <li><a href="#implementation-in-r" id="toc-implementation-in-r" class="nav-link" data-scroll-target="#implementation-in-r"><span class="header-section-number">15.1.18</span> Implementation in R</a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization"><span class="header-section-number">15.1.19</span> Visualization</a></li>
  <li><a href="#key-properties" id="toc-key-properties" class="nav-link" data-scroll-target="#key-properties"><span class="header-section-number">15.1.20</span> Key Properties</a></li>
  <li><a href="#when-to-use-each-measure" id="toc-when-to-use-each-measure" class="nav-link" data-scroll-target="#when-to-use-each-measure"><span class="header-section-number">15.1.21</span> When to Use Each Measure</a></li>
  <li><a href="#example-analysis" id="toc-example-analysis" class="nav-link" data-scroll-target="#example-analysis"><span class="header-section-number">15.1.22</span> Example Analysis</a></li>
  <li><a href="#practical-considerations" id="toc-practical-considerations" class="nav-link" data-scroll-target="#practical-considerations"><span class="header-section-number">15.1.23</span> Practical Considerations</a></li>
  <li><a href="#common-pitfalls" id="toc-common-pitfalls" class="nav-link" data-scroll-target="#common-pitfalls"><span class="header-section-number">15.1.24</span> Common Pitfalls</a></li>
  </ul></li>
  <li><a href="#introduction-to-elementary-multivariate-statistics" id="toc-introduction-to-elementary-multivariate-statistics" class="nav-link" data-scroll-target="#introduction-to-elementary-multivariate-statistics"><span class="header-section-number">15.2</span> Introduction to Elementary Multivariate Statistics (*)</a>
  <ul class="collapse">
  <li><a href="#correlation-matrix" id="toc-correlation-matrix" class="nav-link" data-scroll-target="#correlation-matrix"><span class="header-section-number">15.2.1</span> Correlation Matrix</a></li>
  <li><a href="#visualizing-multivariate-relationships" id="toc-visualizing-multivariate-relationships" class="nav-link" data-scroll-target="#visualizing-multivariate-relationships"><span class="header-section-number">15.2.2</span> Visualizing Multivariate Relationships</a></li>
  <li><a href="#partial-correlation" id="toc-partial-correlation" class="nav-link" data-scroll-target="#partial-correlation"><span class="header-section-number">15.2.3</span> Partial Correlation</a></li>
  <li><a href="#multiple-correlation" id="toc-multiple-correlation" class="nav-link" data-scroll-target="#multiple-correlation"><span class="header-section-number">15.2.4</span> Multiple Correlation</a></li>
  <li><a href="#factor-analysis" id="toc-factor-analysis" class="nav-link" data-scroll-target="#factor-analysis"><span class="header-section-number">15.2.5</span> Factor Analysis</a></li>
  <li><a href="#considerations-in-multivariate-analysis" id="toc-considerations-in-multivariate-analysis" class="nav-link" data-scroll-target="#considerations-in-multivariate-analysis"><span class="header-section-number">15.2.6</span> Considerations in Multivariate Analysis</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">15.2.7</span> Conclusion</a></li>
  </ul></li>
  <li><a href="#introduction-to-regression-analysis" id="toc-introduction-to-regression-analysis" class="nav-link" data-scroll-target="#introduction-to-regression-analysis"><span class="header-section-number">15.3</span> Introduction to Regression Analysis</a>
  <ul class="collapse">
  <li><a href="#why-study-regression" id="toc-why-study-regression" class="nav-link" data-scroll-target="#why-study-regression"><span class="header-section-number">15.3.1</span> Why Study Regression?</a></li>
  <li><a href="#basic-concepts-and-terminology" id="toc-basic-concepts-and-terminology" class="nav-link" data-scroll-target="#basic-concepts-and-terminology"><span class="header-section-number">15.3.7</span> Basic Concepts and Terminology</a></li>
  <li><a href="#the-core-idea" id="toc-the-core-idea" class="nav-link" data-scroll-target="#the-core-idea"><span class="header-section-number">15.3.8</span> The Core Idea</a></li>
  </ul></li>
  <li><a href="#the-linear-regression-model" id="toc-the-linear-regression-model" class="nav-link" data-scroll-target="#the-linear-regression-model"><span class="header-section-number">15.4</span> The Linear Regression Model</a>
  <ul class="collapse">
  <li><a href="#population-model-vs.-sample-estimates" id="toc-population-model-vs.-sample-estimates" class="nav-link" data-scroll-target="#population-model-vs.-sample-estimates"><span class="header-section-number">15.4.1</span> Population Model vs.&nbsp;Sample Estimates</a></li>
  </ul></li>
  <li><a href="#key-assumptions-of-linear-regression" id="toc-key-assumptions-of-linear-regression" class="nav-link" data-scroll-target="#key-assumptions-of-linear-regression"><span class="header-section-number">15.5</span> Key Assumptions of Linear Regression</a>
  <ul class="collapse">
  <li><a href="#strict-exogeneity-the-fundamental-assumption" id="toc-strict-exogeneity-the-fundamental-assumption" class="nav-link" data-scroll-target="#strict-exogeneity-the-fundamental-assumption"><span class="header-section-number">15.5.1</span> Strict Exogeneity: The Fundamental Assumption</a></li>
  <li><a href="#linearity-the-form-assumption" id="toc-linearity-the-form-assumption" class="nav-link" data-scroll-target="#linearity-the-form-assumption"><span class="header-section-number">15.5.2</span> Linearity: The Form Assumption</a></li>
  <li><a href="#understanding-violations-and-solutions" id="toc-understanding-violations-and-solutions" class="nav-link" data-scroll-target="#understanding-violations-and-solutions"><span class="header-section-number">15.5.3</span> Understanding Violations and Solutions</a></li>
  </ul></li>
  <li><a href="#estimation-methods" id="toc-estimation-methods" class="nav-link" data-scroll-target="#estimation-methods"><span class="header-section-number">15.6</span> Estimation Methods</a>
  <ul class="collapse">
  <li><a href="#ordinary-least-squares-ols" id="toc-ordinary-least-squares-ols" class="nav-link" data-scroll-target="#ordinary-least-squares-ols"><span class="header-section-number">15.6.1</span> Ordinary Least Squares (OLS)</a></li>
  </ul></li>
  <li><a href="#assessing-model-fit" id="toc-assessing-model-fit" class="nav-link" data-scroll-target="#assessing-model-fit"><span class="header-section-number">15.7</span> Assessing Model Fit</a>
  <ul class="collapse">
  <li><a href="#decomposition-of-variance" id="toc-decomposition-of-variance" class="nav-link" data-scroll-target="#decomposition-of-variance"><span class="header-section-number">15.7.1</span> Decomposition of Variance</a></li>
  <li><a href="#understanding-the-three-types-of-variation" id="toc-understanding-the-three-types-of-variation" class="nav-link" data-scroll-target="#understanding-the-three-types-of-variation"><span class="header-section-number">15.7.2</span> Understanding the Three Types of Variation</a></li>
  <li><a href="#r²-demystified" id="toc-r²-demystified" class="nav-link" data-scroll-target="#r²-demystified"><span class="header-section-number">15.7.3</span> R² Demystified</a></li>
  <li><a href="#when-to-be-cautious" id="toc-when-to-be-cautious" class="nav-link" data-scroll-target="#when-to-be-cautious"><span class="header-section-number">15.7.4</span> When to Be Cautious</a></li>
  <li><a href="#practical-tips-for-analysis" id="toc-practical-tips-for-analysis" class="nav-link" data-scroll-target="#practical-tips-for-analysis"><span class="header-section-number">15.7.5</span> Practical Tips for Analysis</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways"><span class="header-section-number">15.7.6</span> Key Takeaways</a></li>
  <li><a href="#further-reading" id="toc-further-reading" class="nav-link" data-scroll-target="#further-reading"><span class="header-section-number">15.7.7</span> Further Reading</a></li>
  <li><a href="#measures-of-fit" id="toc-measures-of-fit" class="nav-link" data-scroll-target="#measures-of-fit"><span class="header-section-number">15.7.8</span> Measures of Fit</a></li>
  </ul></li>
  <li><a href="#diagnostic-plots" id="toc-diagnostic-plots" class="nav-link" data-scroll-target="#diagnostic-plots"><span class="header-section-number">15.8</span> Diagnostic Plots</a>
  <ul class="collapse">
  <li><a href="#residual-analysis" id="toc-residual-analysis" class="nav-link" data-scroll-target="#residual-analysis"><span class="header-section-number">15.8.1</span> Residual Analysis</a></li>
  </ul></li>
  <li><a href="#multiple-regression" id="toc-multiple-regression" class="nav-link" data-scroll-target="#multiple-regression"><span class="header-section-number">15.10</span> Multiple Regression (*)</a>
  <ul class="collapse">
  <li><a href="#extending-to-multiple-predictors" id="toc-extending-to-multiple-predictors" class="nav-link" data-scroll-target="#extending-to-multiple-predictors"><span class="header-section-number">15.10.1</span> Extending to Multiple Predictors</a></li>
  <li><a href="#interpretation-of-coefficients" id="toc-interpretation-of-coefficients" class="nav-link" data-scroll-target="#interpretation-of-coefficients"><span class="header-section-number">15.10.2</span> Interpretation of Coefficients</a></li>
  <li><a href="#multicollinearity" id="toc-multicollinearity" class="nav-link" data-scroll-target="#multicollinearity"><span class="header-section-number">15.10.3</span> Multicollinearity</a></li>
  </ul></li>
  <li><a href="#advanced-topics" id="toc-advanced-topics" class="nav-link" data-scroll-target="#advanced-topics"><span class="header-section-number">15.11</span> Advanced Topics</a>
  <ul class="collapse">
  <li><a href="#interaction-terms" id="toc-interaction-terms" class="nav-link" data-scroll-target="#interaction-terms"><span class="header-section-number">15.11.1</span> Interaction Terms</a></li>
  <li><a href="#polynomial-terms" id="toc-polynomial-terms" class="nav-link" data-scroll-target="#polynomial-terms"><span class="header-section-number">15.11.2</span> Polynomial Terms</a></li>
  </ul></li>
  <li><a href="#practical-guidelines-for-regression-analysis" id="toc-practical-guidelines-for-regression-analysis" class="nav-link" data-scroll-target="#practical-guidelines-for-regression-analysis"><span class="header-section-number">15.12</span> Practical Guidelines for Regression Analysis</a>
  <ul class="collapse">
  <li><a href="#model-building-process" id="toc-model-building-process" class="nav-link" data-scroll-target="#model-building-process"><span class="header-section-number">15.12.1</span> Model Building Process</a></li>
  <li><a href="#common-pitfalls-and-solutions" id="toc-common-pitfalls-and-solutions" class="nav-link" data-scroll-target="#common-pitfalls-and-solutions"><span class="header-section-number">15.12.2</span> Common Pitfalls and Solutions</a></li>
  <li><a href="#best-practices" id="toc-best-practices" class="nav-link" data-scroll-target="#best-practices"><span class="header-section-number">15.12.3</span> Best Practices</a></li>
  </ul></li>
  <li><a href="#conclusion-1" id="toc-conclusion-1" class="nav-link" data-scroll-target="#conclusion-1"><span class="header-section-number">15.13</span> Conclusion</a>
  <ul class="collapse">
  <li><a href="#key-takeaways-2" id="toc-key-takeaways-2" class="nav-link" data-scroll-target="#key-takeaways-2"><span class="header-section-number">15.13.1</span> Key Takeaways</a></li>
  <li><a href="#further-reading-2" id="toc-further-reading-2" class="nav-link" data-scroll-target="#further-reading-2">Further Reading</a></li>
  </ul></li>
  <li><a href="#appendix-a.1-understanding-correlation-measures-a-self-study-tutorial-using-stress-level-and-cognitive-performance-data" id="toc-appendix-a.1-understanding-correlation-measures-a-self-study-tutorial-using-stress-level-and-cognitive-performance-data" class="nav-link" data-scroll-target="#appendix-a.1-understanding-correlation-measures-a-self-study-tutorial-using-stress-level-and-cognitive-performance-data"><span class="header-section-number">15.14</span> Appendix A.1: Understanding Correlation Measures: A Self-Study Tutorial (Using Stress Level and Cognitive Performance Data)</a>
  <ul class="collapse">
  <li><a href="#dataset-overview" id="toc-dataset-overview" class="nav-link" data-scroll-target="#dataset-overview"><span class="header-section-number">15.14.1</span> Dataset Overview</a></li>
  <li><a href="#covariance-calculation" id="toc-covariance-calculation" class="nav-link" data-scroll-target="#covariance-calculation"><span class="header-section-number">15.14.2</span> 1. Covariance Calculation</a></li>
  <li><a href="#pearson-correlation-coefficient-1" id="toc-pearson-correlation-coefficient-1" class="nav-link" data-scroll-target="#pearson-correlation-coefficient-1"><span class="header-section-number">15.14.3</span> 2. Pearson Correlation Coefficient</a></li>
  <li><a href="#spearman-rank-correlation" id="toc-spearman-rank-correlation" class="nav-link" data-scroll-target="#spearman-rank-correlation"><span class="header-section-number">15.14.4</span> 3. Spearman Rank Correlation</a></li>
  <li><a href="#verification-using-r" id="toc-verification-using-r" class="nav-link" data-scroll-target="#verification-using-r"><span class="header-section-number">15.14.5</span> Verification using R</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation"><span class="header-section-number">15.14.6</span> Interpretation</a></li>
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise"><span class="header-section-number">15.14.7</span> Exercise</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">15.14.8</span> References</a></li>
  </ul></li>
  <li><a href="#appendix-a.2-calculating-covariance-pearson-and-spearman-correlation---worked-example" id="toc-appendix-a.2-calculating-covariance-pearson-and-spearman-correlation---worked-example" class="nav-link" data-scroll-target="#appendix-a.2-calculating-covariance-pearson-and-spearman-correlation---worked-example"><span class="header-section-number">15.15</span> Appendix A.2: Calculating Covariance, Pearson, and Spearman Correlation - worked example</a>
  <ul class="collapse">
  <li><a href="#step-1-calculate-basic-statistics" id="toc-step-1-calculate-basic-statistics" class="nav-link" data-scroll-target="#step-1-calculate-basic-statistics"><span class="header-section-number">15.15.1</span> Step 1: Calculate Basic Statistics</a></li>
  <li><a href="#step-2-detailed-covariance-calculations" id="toc-step-2-detailed-covariance-calculations" class="nav-link" data-scroll-target="#step-2-detailed-covariance-calculations"><span class="header-section-number">15.15.2</span> Step 2: Detailed Covariance Calculations</a></li>
  <li><a href="#step-3-standard-deviation-calculations" id="toc-step-3-standard-deviation-calculations" class="nav-link" data-scroll-target="#step-3-standard-deviation-calculations"><span class="header-section-number">15.15.3</span> Step 3: Standard Deviation Calculations</a></li>
  <li><a href="#step-4-pearson-correlation-calculation" id="toc-step-4-pearson-correlation-calculation" class="nav-link" data-scroll-target="#step-4-pearson-correlation-calculation"><span class="header-section-number">15.15.4</span> Step 4: Pearson Correlation Calculation</a></li>
  <li><a href="#step-5-spearman-rank-correlation-calculation" id="toc-step-5-spearman-rank-correlation-calculation" class="nav-link" data-scroll-target="#step-5-spearman-rank-correlation-calculation"><span class="header-section-number">15.15.5</span> Step 5: Spearman Rank Correlation Calculation</a></li>
  <li><a href="#step-6-r-verification" id="toc-step-6-r-verification" class="nav-link" data-scroll-target="#step-6-r-verification"><span class="header-section-number">15.15.6</span> Step 6: R Verification</a></li>
  <li><a href="#step-7-basic-visualization" id="toc-step-7-basic-visualization" class="nav-link" data-scroll-target="#step-7-basic-visualization"><span class="header-section-number">15.15.7</span> Step 7: Basic Visualization</a></li>
  <li><a href="#ols-estimation-and-goodness-of-fit-measures" id="toc-ols-estimation-and-goodness-of-fit-measures" class="nav-link" data-scroll-target="#ols-estimation-and-goodness-of-fit-measures"><span class="header-section-number">15.15.8</span> OLS Estimation and Goodness-of-Fit Measures</a></li>
  <li><a href="#step-1-calculate-ols-estimates" id="toc-step-1-calculate-ols-estimates" class="nav-link" data-scroll-target="#step-1-calculate-ols-estimates"><span class="header-section-number">15.15.9</span> Step 1: Calculate OLS Estimates</a></li>
  <li><a href="#step-2-calculate-fitted-values-and-residuals" id="toc-step-2-calculate-fitted-values-and-residuals" class="nav-link" data-scroll-target="#step-2-calculate-fitted-values-and-residuals"><span class="header-section-number">15.15.10</span> Step 2: Calculate Fitted Values and Residuals</a></li>
  <li><a href="#step-3-calculate-goodness-of-fit-measures" id="toc-step-3-calculate-goodness-of-fit-measures" class="nav-link" data-scroll-target="#step-3-calculate-goodness-of-fit-measures"><span class="header-section-number">15.15.11</span> Step 3: Calculate Goodness-of-Fit Measures</a></li>
  <li><a href="#step-4-r-verification" id="toc-step-4-r-verification" class="nav-link" data-scroll-target="#step-4-r-verification"><span class="header-section-number">15.15.12</span> Step 4: R Verification</a></li>
  <li><a href="#step-5-residual-analysis" id="toc-step-5-residual-analysis" class="nav-link" data-scroll-target="#step-5-residual-analysis"><span class="header-section-number">15.15.13</span> Step 5: Residual Analysis</a></li>
  <li><a href="#step-6-predicted-vs-actual-values-plot" id="toc-step-6-predicted-vs-actual-values-plot" class="nav-link" data-scroll-target="#step-6-predicted-vs-actual-values-plot"><span class="header-section-number">15.15.14</span> Step 6: Predicted vs Actual Values Plot</a></li>
  <li><a href="#log-transformed-models" id="toc-log-transformed-models" class="nav-link" data-scroll-target="#log-transformed-models"><span class="header-section-number">15.15.15</span> Log-Transformed Models</a></li>
  <li><a href="#step-1-data-transformation" id="toc-step-1-data-transformation" class="nav-link" data-scroll-target="#step-1-data-transformation"><span class="header-section-number">15.15.16</span> Step 1: Data Transformation</a></li>
  <li><a href="#step-2-compare-different-model-specifications" id="toc-step-2-compare-different-model-specifications" class="nav-link" data-scroll-target="#step-2-compare-different-model-specifications"><span class="header-section-number">15.15.17</span> Step 2: Compare Different Model Specifications</a></li>
  <li><a href="#step-3-visual-comparison" id="toc-step-3-visual-comparison" class="nav-link" data-scroll-target="#step-3-visual-comparison"><span class="header-section-number">15.15.18</span> Step 3: Visual Comparison</a></li>
  <li><a href="#step-4-residual-analysis-for-best-model" id="toc-step-4-residual-analysis-for-best-model" class="nav-link" data-scroll-target="#step-4-residual-analysis-for-best-model"><span class="header-section-number">15.15.19</span> Step 4: Residual Analysis for Best Model</a></li>
  <li><a href="#step-5-interpretation-of-best-model" id="toc-step-5-interpretation-of-best-model" class="nav-link" data-scroll-target="#step-5-interpretation-of-best-model"><span class="header-section-number">15.15.20</span> Step 5: Interpretation of Best Model</a></li>
  <li><a href="#step-6-model-predictions" id="toc-step-6-model-predictions" class="nav-link" data-scroll-target="#step-6-model-predictions"><span class="header-section-number">15.15.21</span> Step 6: Model Predictions</a></li>
  <li><a href="#step-7-elasticity-analysis" id="toc-step-7-elasticity-analysis" class="nav-link" data-scroll-target="#step-7-elasticity-analysis"><span class="header-section-number">15.15.22</span> Step 7: Elasticity Analysis</a></li>
  </ul></li>
  <li><a href="#appendix-a.3-understanding-pearson-spearman-and-kendall" id="toc-appendix-a.3-understanding-pearson-spearman-and-kendall" class="nav-link" data-scroll-target="#appendix-a.3-understanding-pearson-spearman-and-kendall"><span class="header-section-number">15.16</span> Appendix A.3: Understanding Pearson, Spearman, and Kendall</a>
  <ul class="collapse">
  <li><a href="#dataset" id="toc-dataset" class="nav-link" data-scroll-target="#dataset"><span class="header-section-number">15.16.1</span> Dataset</a></li>
  <li><a href="#pearson-correlation-1" id="toc-pearson-correlation-1" class="nav-link" data-scroll-target="#pearson-correlation-1"><span class="header-section-number">15.16.2</span> Pearson Correlation</a></li>
  <li><a href="#spearman-correlation-1" id="toc-spearman-correlation-1" class="nav-link" data-scroll-target="#spearman-correlation-1"><span class="header-section-number">15.16.3</span> Spearman Correlation</a></li>
  <li><a href="#kendalls-tau-1" id="toc-kendalls-tau-1" class="nav-link" data-scroll-target="#kendalls-tau-1"><span class="header-section-number">15.16.4</span> Kendall’s Tau</a></li>
  <li><a href="#verification-in-r" id="toc-verification-in-r" class="nav-link" data-scroll-target="#verification-in-r"><span class="header-section-number">15.16.5</span> Verification in R</a></li>
  <li><a href="#interpretation-of-results" id="toc-interpretation-of-results" class="nav-link" data-scroll-target="#interpretation-of-results"><span class="header-section-number">15.16.6</span> Interpretation of Results</a></li>
  <li><a href="#comparison-of-measures" id="toc-comparison-of-measures" class="nav-link" data-scroll-target="#comparison-of-measures"><span class="header-section-number">15.16.7</span> Comparison of Measures</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">15.16.8</span> Exercises</a></li>
  <li><a href="#key-points-to-remember" id="toc-key-points-to-remember" class="nav-link" data-scroll-target="#key-points-to-remember"><span class="header-section-number">15.16.9</span> Key Points to Remember</a></li>
  </ul></li>
  <li><a href="#appendix-b-bias-in-ols-estimation-with-endogenous-regressors" id="toc-appendix-b-bias-in-ols-estimation-with-endogenous-regressors" class="nav-link" data-scroll-target="#appendix-b-bias-in-ols-estimation-with-endogenous-regressors"><span class="header-section-number">15.17</span> Appendix B: Bias in OLS Estimation with Endogenous Regressors</a></li>
  <li><a href="#theoretical-derivation" id="toc-theoretical-derivation" class="nav-link" data-scroll-target="#theoretical-derivation"><span class="header-section-number">15.18</span> Theoretical Derivation</a></li>
  <li><a href="#simulation-in-r" id="toc-simulation-in-r" class="nav-link" data-scroll-target="#simulation-in-r"><span class="header-section-number">15.19</span> Simulation in R</a></li>
  <li><a href="#conclusion-2" id="toc-conclusion-2" class="nav-link" data-scroll-target="#conclusion-2"><span class="header-section-number">15.20</span> Conclusion</a></li>
  <li><a href="#appendix-c.-worked-examples" id="toc-appendix-c.-worked-examples" class="nav-link" data-scroll-target="#appendix-c.-worked-examples"><span class="header-section-number">15.21</span> Appendix C. Worked Examples</a></li>
  <li><a href="#descriptive-statistics-and-ols-example---income-and-voter-turnout" id="toc-descriptive-statistics-and-ols-example---income-and-voter-turnout" class="nav-link" data-scroll-target="#descriptive-statistics-and-ols-example---income-and-voter-turnout"><span class="header-section-number">15.22</span> Descriptive Statistics and OLS Example - Income and Voter Turnout</a>
  <ul class="collapse">
  <li><a href="#initial-r-output-for-reference" id="toc-initial-r-output-for-reference" class="nav-link" data-scroll-target="#initial-r-output-for-reference"><span class="header-section-number">15.22.1</span> Initial R Output for Reference</a></li>
  <li><a href="#dispersion-measures" id="toc-dispersion-measures" class="nav-link" data-scroll-target="#dispersion-measures"><span class="header-section-number">15.22.2</span> Dispersion Measures</a></li>
  <li><a href="#covariance-and-correlation" id="toc-covariance-and-correlation" class="nav-link" data-scroll-target="#covariance-and-correlation"><span class="header-section-number">15.22.3</span> Covariance and Correlation</a></li>
  <li><a href="#ols-regression-haty-hatbeta_0-hatbeta_1x" id="toc-ols-regression-haty-hatbeta_0-hatbeta_1x" class="nav-link" data-scroll-target="#ols-regression-haty-hatbeta_0-hatbeta_1x"><span class="header-section-number">15.22.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></a></li>
  <li><a href="#detailed-decomposition-of-variance-and-r-squared" id="toc-detailed-decomposition-of-variance-and-r-squared" class="nav-link" data-scroll-target="#detailed-decomposition-of-variance-and-r-squared"><span class="header-section-number">15.22.5</span> Detailed Decomposition of Variance and R-squared</a></li>
  <li><a href="#visualization-1" id="toc-visualization-1" class="nav-link" data-scroll-target="#visualization-1"><span class="header-section-number">15.22.6</span> Visualization</a></li>
  <li><a href="#interpretation-1" id="toc-interpretation-1" class="nav-link" data-scroll-target="#interpretation-1"><span class="header-section-number">15.22.7</span> Interpretation</a></li>
  </ul></li>
  <li><a href="#anxiety-levels-and-cognitive-performance-a-laboratory-study" id="toc-anxiety-levels-and-cognitive-performance-a-laboratory-study" class="nav-link" data-scroll-target="#anxiety-levels-and-cognitive-performance-a-laboratory-study"><span class="header-section-number">15.23</span> Anxiety Levels and Cognitive Performance: A Laboratory Study</a>
  <ul class="collapse">
  <li><a href="#data-and-context" id="toc-data-and-context" class="nav-link" data-scroll-target="#data-and-context"><span class="header-section-number">15.23.1</span> Data and Context</a></li>
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics"><span class="header-section-number">15.23.2</span> Descriptive Statistics</a></li>
  <li><a href="#covariance-and-correlation-1" id="toc-covariance-and-correlation-1" class="nav-link" data-scroll-target="#covariance-and-correlation-1"><span class="header-section-number">15.23.3</span> Covariance and Correlation</a></li>
  <li><a href="#ols-regression-haty-hatbeta_0-hatbeta_1x-1" id="toc-ols-regression-haty-hatbeta_0-hatbeta_1x-1" class="nav-link" data-scroll-target="#ols-regression-haty-hatbeta_0-hatbeta_1x-1"><span class="header-section-number">15.23.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></a></li>
  <li><a href="#r-squared-calculation" id="toc-r-squared-calculation" class="nav-link" data-scroll-target="#r-squared-calculation"><span class="header-section-number">15.23.5</span> 4. R-squared Calculation</a></li>
  <li><a href="#visualization-2" id="toc-visualization-2" class="nav-link" data-scroll-target="#visualization-2"><span class="header-section-number">15.23.6</span> Visualization</a></li>
  <li><a href="#interpretation-2" id="toc-interpretation-2" class="nav-link" data-scroll-target="#interpretation-2"><span class="header-section-number">15.23.7</span> Interpretation</a></li>
  <li><a href="#study-limitations" id="toc-study-limitations" class="nav-link" data-scroll-target="#study-limitations"><span class="header-section-number">15.23.8</span> Study Limitations</a></li>
  </ul></li>
  <li><a href="#district-magnitude-and-electoral-disproportionality-a-comparative-analysis" id="toc-district-magnitude-and-electoral-disproportionality-a-comparative-analysis" class="nav-link" data-scroll-target="#district-magnitude-and-electoral-disproportionality-a-comparative-analysis"><span class="header-section-number">15.24</span> District Magnitude and Electoral Disproportionality: A Comparative Analysis</a>
  <ul class="collapse">
  <li><a href="#data-generating-process" id="toc-data-generating-process" class="nav-link" data-scroll-target="#data-generating-process"><span class="header-section-number">15.24.1</span> Data Generating Process</a></li>
  <li><a href="#descriptive-statistics-1" id="toc-descriptive-statistics-1" class="nav-link" data-scroll-target="#descriptive-statistics-1"><span class="header-section-number">15.24.2</span> Descriptive Statistics</a></li>
  <li><a href="#covariance-and-correlation-2" id="toc-covariance-and-correlation-2" class="nav-link" data-scroll-target="#covariance-and-correlation-2"><span class="header-section-number">15.24.3</span> Covariance and Correlation</a></li>
  <li><a href="#ols-regression-haty-hatbeta_0-hatbeta_1x-2" id="toc-ols-regression-haty-hatbeta_0-hatbeta_1x-2" class="nav-link" data-scroll-target="#ols-regression-haty-hatbeta_0-hatbeta_1x-2"><span class="header-section-number">15.24.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></a></li>
  <li><a href="#r-squared-calculation-1" id="toc-r-squared-calculation-1" class="nav-link" data-scroll-target="#r-squared-calculation-1"><span class="header-section-number">15.24.5</span> R-squared Calculation</a></li>
  <li><a href="#visualization---true-vs.-estimated-parameters" id="toc-visualization---true-vs.-estimated-parameters" class="nav-link" data-scroll-target="#visualization---true-vs.-estimated-parameters"><span class="header-section-number">15.24.6</span> Visualization - True vs.&nbsp;Estimated Parameters</a></li>
  <li><a href="#observations-about-model-fit" id="toc-observations-about-model-fit" class="nav-link" data-scroll-target="#observations-about-model-fit"><span class="header-section-number">15.24.7</span> Observations about Model Fit</a></li>
  <li><a href="#interpretation-3" id="toc-interpretation-3" class="nav-link" data-scroll-target="#interpretation-3"><span class="header-section-number">15.24.8</span> Interpretation</a></li>
  <li><a href="#study-context" id="toc-study-context" class="nav-link" data-scroll-target="#study-context"><span class="header-section-number">15.24.9</span> Study Context</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations"><span class="header-section-number">15.24.10</span> Limitations</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="bivariate-statistics---introduction" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="bivariate-statistics---introduction"><span class="header-section-number">15.1</span> Bivariate Statistics - introduction</h2>
<p>Bivariate statistics describe the relationship between two variables. We’ll explore several measures, starting with covariance.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Understanding Variable Relationships in Social Research
</div>
</div>
<div class="callout-body-container callout-body">
<p>This section examines how different social variables interact and correlate with each other. We will analyze four distinct types of relationships commonly observed in social science research, using empirical examples to illustrate key patterns and their implications for data analysis.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Analysis of Variable Relationships:</p>
<ol type="1">
<li><strong>Positive Linear Correlation</strong> (Healthcare Access and Life Expectancy)</li>
</ol>
<p>The data demonstrates a positive linear relationship between healthcare access and life expectancy. Statistical analysis indicates that a 10-percentage-point increase in healthcare access corresponds to approximately 2.5 years of additional life expectancy. This relationship maintains statistical significance across the observed range.</p>
<ol start="2" type="1">
<li><strong>Negative Linear Correlation</strong> (Digital Device Usage and Sleep Quality)</li>
</ol>
<p>The analysis reveals an inverse relationship between daily device usage and sleep quality metrics. The data indicates that each additional hour of device usage correlates with a measurable decrease in sleep quality scores, demonstrating a consistent negative linear relationship.</p>
<ol start="3" type="1">
<li><strong>Absence of Correlation</strong> (Infrastructure and Economic Indicators (e.g.&nbsp;GDP per capita in PLN))</li>
</ol>
<p>The relationship between infrastructure density and economic indicators like GDP per capita in PLN shows no statistically significant correlation. This absence of correlation suggests that these variables operate independently within the observed parameters, indicating the presence of other determining factors not captured in this analysis.</p>
<ol start="4" type="1">
<li><strong>Non-linear Relationship</strong> (Team Size and Productivity)</li>
</ol>
<p>The relationship between team size and productivity follows a curvilinear pattern. The data shows an optimal range for team size, with productivity declining both below and above this range. This demonstrates the importance of considering non-linear patterns in organizational research.</p>
<p>Methodological Considerations:</p>
<ol type="1">
<li><p><strong>Statistical Significance</strong>: Observed relationships must be evaluated for statistical significance before drawing conclusions.</p></li>
<li><p><strong>Variable Independence</strong>: The assumption of variable independence requires verification through appropriate statistical tests.</p></li>
<li><p><strong>Confounding Variables</strong>: Analyses must account for potential confounding variables that may influence observed relationships.</p></li>
<li><p><strong>Causality</strong>: Correlation patterns do not necessarily imply causal relationships; additional research methods are required to establish causation.</p></li>
</ol>
<p>Research Applications:</p>
<p>The understanding of these relationship patterns has significant implications for:</p>
<ul>
<li>Research design and methodology</li>
<li>Statistical analysis procedures</li>
<li>Policy implementation and evaluation</li>
<li>Theory development and testing</li>
</ul>
<p>Critical evaluation of these relationships enables more robust research design and more reliable conclusions in social science research.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Critical Distinction Between Correlation and Causation [See e.g.&nbsp;https://www.tylervigen.com/spurious-correlations]
</div>
</div>
<div class="callout-body-container callout-body">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/EmIodcqXEAMRW83.jpeg" class="img-fluid figure-img"></p>
<figcaption>https://x.com/EUFIC/status/1324667630238814209?prefetchTimestamp=1732463940216</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/IMG_4580.png" class="img-fluid figure-img"></p>
<figcaption>https://sitn.hms.harvard.edu/flash/2021/when-correlation-does-not-imply-causation-why-your-gut-microbes-may-not-yet-be-a-silver-bullet-to-all-your-problems/</figcaption>
</figure>
</div>
<p>Statistical relationships between variables represent one of the most frequently misinterpreted aspects of data analysis. While correlations can reveal patterns in data, they require careful interpretation to avoid drawing incorrect causal conclusions. Let us examine this concept through real-world examples.</p>
<section id="seasonal-patterns-and-spurious-correlations-a-case-study" class="level3" data-number="15.1.1">
<h3 data-number="15.1.1" class="anchored" data-anchor-id="seasonal-patterns-and-spurious-correlations-a-case-study"><span class="header-section-number">15.1.1</span> Seasonal Patterns and Spurious Correlations: A Case Study</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This visualization demonstrates a classic example of confounding in statistical analysis. The apparent correlation between ice cream sales and crime rates (r = 0.85, p &lt; 0.001) exemplifies how seasonal variation can create misleading statistical relationships. The correlation emerges from a common causal factor: seasonal temperature variations that independently influence both variables through distinct mechanisms.</p>
</section>
<section id="temporal-trends-and-spurious-associations" class="level3" data-number="15.1.2">
<h3 data-number="15.1.2" class="anchored" data-anchor-id="temporal-trends-and-spurious-associations"><span class="header-section-number">15.1.2</span> Temporal Trends and Spurious Associations</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This second analysis illustrates temporal correlation bias, where two independently declining trends create an artificial statistical association. Despite the strong correlation coefficient (r = 0.91, p &lt; 0.001), there is no plausible causal mechanism linking these variables.</p>
</section>
<section id="understanding-mechanisms-of-spurious-correlation" class="level3" data-number="15.1.3">
<h3 data-number="15.1.3" class="anchored" data-anchor-id="understanding-mechanisms-of-spurious-correlation"><span class="header-section-number">15.1.3</span> Understanding Mechanisms of Spurious Correlation</h3>
<p>Statistical analysis can be compromised by several systematic biases that create apparent but meaningless correlations. Here are the primary mechanisms:</p>
<p><strong>1. Confounding Variables</strong></p>
<p>A confounding variable creates an apparent relationship between independent variables by independently affecting each one. This statistical phenomenon requires careful experimental design and multivariate analysis to detect and control for potential confounders.</p>
<p><strong>2. Temporal Autocorrelation</strong></p>
<p>When variables exhibit strong temporal trends, they may show correlation simply because they change over time, rather than due to any meaningful relationship. This effect can be controlled for through methods such as detrending or differencing the time series.</p>
<p><strong>3. Simultaneous Causality Bias</strong></p>
<p>This occurs when the direction of causality is ambiguous or bidirectional. For example, economic growth and investment rates may exhibit simultaneous causality, as each variable potentially influences the other through complex feedback mechanisms.</p>
</section>
<section id="statistical-methods-for-causal-inference" class="level3" data-number="15.1.4">
<h3 data-number="15.1.4" class="anchored" data-anchor-id="statistical-methods-for-causal-inference"><span class="header-section-number">15.1.4</span> Statistical Methods for Causal Inference</h3>
<p>Modern statistical approaches offer several techniques for moving beyond simple correlation toward causal inference, e.g.:</p>
<p><strong>1. Experimental Design</strong></p>
<p>Randomized controlled trials represent the gold standard for causal inference, allowing researchers to isolate the effect of individual variables while controlling for confounders.</p>
<p><strong>2. Instrumental Variables</strong></p>
<p>This statistical technique uses a variable that affects the outcome only through its effect on the variable of interest, helping to establish causal relationships in observational data.</p>
<p><strong>3. Regression Discontinuity</strong></p>
<p>This quasi-experimental design exploits naturally occurring thresholds to approximate randomized experiments, providing evidence for causal relationships.</p>
</section>
<section id="critical-framework-for-correlation-analysis" class="level3" data-number="15.1.5">
<h3 data-number="15.1.5" class="anchored" data-anchor-id="critical-framework-for-correlation-analysis"><span class="header-section-number">15.1.5</span> Critical Framework for Correlation Analysis</h3>
<p>When evaluating correlational findings, consider the following analytical framework:</p>
<ol type="1">
<li><p>Theoretical Plausibility: Examine whether there exists a logical mechanism through which one variable could influence the other.</p></li>
<li><p>Temporal Precedence: Verify that the proposed cause precedes the effect in time.</p></li>
<li><p>Dose-Response Relationship: Assess whether changes in the magnitude of the proposed cause correspond to proportional changes in the effect.</p></li>
<li><p>Consistency: Evaluate whether the relationship holds across different contexts and populations.</p></li>
<li><p>Alternative Explanations: Systematically consider and test alternative explanations for the observed correlation.</p></li>
</ol>
<p>Remember: The path from correlation to causation requires careful experimental design, robust statistical methodology, and systematic consideration of alternative explanations. Statistical correlation represents a necessary but insufficient condition for establishing causality.</p>
</section>
</div>
</div>
<section id="covariance" class="level3" data-number="15.1.6">
<h3 data-number="15.1.6" class="anchored" data-anchor-id="covariance"><span class="header-section-number">15.1.6</span> Covariance</h3>
<p>Covariance measures how two variables vary together.</p>
<p><strong>Formula:</strong> <span class="math inline">cov(X,Y) = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{n - 1}</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
From Covariance to Different Correlation Measures
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate different types of relationships</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear relationship</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fl">0.8</span><span class="sc">*</span>x1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd=</span><span class="fl">0.5</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x1, <span class="at">y=</span>y1, <span class="at">type=</span><span class="st">"Linear Relationship"</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Monotonic but nonlinear</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">sign</span>(x2)<span class="sc">*</span>(x2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd=</span><span class="fl">0.5</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x2, <span class="at">y=</span>y2, <span class="at">type=</span><span class="st">"Monotonic Nonlinear"</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Non-monotonic relationship</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length.out=</span>n)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> x3<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd=</span><span class="fl">0.5</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>data3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x3, <span class="at">y=</span>y3, <span class="at">type=</span><span class="st">"Non-monotonic"</span>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine data</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data1, data2, data3)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Different Types of Relationships Between Variables"</span>,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Variable X"</span>,</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Variable Y"</span>) <span class="sc">+</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="the-concept-of-correlation" class="level3" data-number="15.1.7">
<h3 data-number="15.1.7" class="anchored" data-anchor-id="the-concept-of-correlation"><span class="header-section-number">15.1.7</span> The Concept of Correlation</h3>
<p>Correlation is a broad concept that describes how variables are related to each other. This relationship can take many forms, as shown in our plots.</p>
</section>
<section id="starting-with-covariance" class="level3" data-number="15.1.8">
<h3 data-number="15.1.8" class="anchored" data-anchor-id="starting-with-covariance"><span class="header-section-number">15.1.8</span> Starting with Covariance</h3>
<p>Covariance is the fundamental measure of how variables move together:</p>
<p><span class="math display">Cov(X,Y) = \frac{\sum(x_i - \bar{x})(y_i - \bar{y})}{n-1}</span></p>
<p>It tells us:</p>
<ul>
<li>If variables tend to move in the same direction (positive covariance)</li>
<li>If they move in opposite directions (negative covariance)</li>
<li>If they don’t have a clear linear pattern (covariance near zero)</li>
</ul>
<p>However, covariance has a limitation: its value depends on the units of measurement. For example:</p>
<ul>
<li>Height in meters vs.&nbsp;weight in kg gives one covariance value</li>
<li>Height in centimeters vs.&nbsp;weight in kg gives a different value</li>
<li>Same relationship, different scales!</li>
</ul>
</section>
<section id="standardizing-to-get-correlation-measures" class="level3" data-number="15.1.9">
<h3 data-number="15.1.9" class="anchored" data-anchor-id="standardizing-to-get-correlation-measures"><span class="header-section-number">15.1.9</span> Standardizing to Get Correlation Measures</h3>
<ol type="1">
<li>Pearson’s correlation coefficient standardizes covariance: <span class="math display">r = \frac{Cov(X,Y)}{\sqrt{Var(X)Var(Y)}}</span></li>
</ol>
<ul>
<li>Removes unit dependency</li>
<li>Always between -1 and 1</li>
<li>Measures linear relationships</li>
</ul>
<ol start="2" type="1">
<li>Spearman’s rank correlation:</li>
</ol>
<ul>
<li>Based on ranks rather than raw values</li>
<li>Captures monotonic relationships (even nonlinear ones)</li>
<li>Also ranges from -1 to 1</li>
</ul>
</section>
<section id="key-points" class="level3" data-number="15.1.10">
<h3 data-number="15.1.10" class="anchored" data-anchor-id="key-points"><span class="header-section-number">15.1.10</span> Key Points</h3>
<ol type="1">
<li>Start with covariance to understand joint movement</li>
<li>Use correlation coefficients for standardized measures</li>
<li>Choose your correlation measure based on:
<ul>
<li>Type of relationship you expect</li>
<li>Nature of your data</li>
<li>Research question</li>
</ul></li>
<li>Always visualize your data</li>
</ol>
</section>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ranks: Positions in an Ordered Sequence
</div>
</div>
<div class="callout-body-container callout-body">
<p>Ranks are simply position numbers in an ordered dataset:</p>
<section id="how-to-determine-ranks" class="level3" data-number="15.1.11">
<h3 data-number="15.1.11" class="anchored" data-anchor-id="how-to-determine-ranks"><span class="header-section-number">15.1.11</span> How to Determine Ranks?</h3>
<ol type="1">
<li><p>Order data from smallest to largest value</p></li>
<li><p>Assign consecutive natural numbers:</p>
<ul>
<li>Smallest value → rank 1</li>
<li>Subsequent values → subsequent ranks</li>
<li>Largest value → rank n (number of observations)</li>
<li>For ties → average of ranks</li>
</ul></li>
</ol>
</section>
<section id="example" class="level3" data-number="15.1.12">
<h3 data-number="15.1.12" class="anchored" data-anchor-id="example"><span class="header-section-number">15.1.12</span> Example</h3>
<p>We have 5 students with heights:</p>
<pre><code>Height:    165, 182, 170, 168, 175
Ranks:      1,   5,   3,   2,   4</code></pre>
<p>For data with ties (e.g., grades):</p>
<pre><code>Grades:     2,   3,   3,   4,   5
Ranks:      1,  2.5, 2.5,  4,   5</code></pre>
</section>
</div>
</div>
<p><strong>Manual Calculation Example:</strong></p>
<p>Let’s calculate the covariance for two variables:</p>
<ul>
<li>x: 1, 2, 3, 4, 5</li>
<li>y: 2, 4, 5, 4, 5</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 38%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Description</th>
<th>Calculation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Calculate means</td>
<td><span class="math inline">\bar{x} = 3, \bar{y} = 4</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>Calculate <span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span> for each pair</td>
<td><span class="math inline">(-2)(-2) = 4</span></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td><span class="math inline">(-1)(0) = 0</span></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td><span class="math inline">(0)(1) = 0</span></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td><span class="math inline">(1)(0) = 0</span></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td><span class="math inline">(2)(1) = 2</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Sum the results</td>
<td><span class="math inline">4 + 0 + 0 + 0 + 2 = 6</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>Divide by (n-1)</td>
<td><span class="math inline">6 / 4 = 1.5</span></td>
</tr>
</tbody>
</table>
<p><strong>R calculation:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.5</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong> - The positive covariance (1.5) indicates that x and y tend to increase together.</p>
<p><strong>Pros:</strong></p>
<ul>
<li>Provides direction of relationship (positive or negative)</li>
<li>Useful in calculating other measures like correlation</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Scale-dependent, making it difficult to compare across different variable pairs</li>
<li>Doesn’t provide information about the strength of the relationship</li>
</ul>
</section>
<section id="pearson-correlation" class="level3" data-number="15.1.13">
<h3 data-number="15.1.13" class="anchored" data-anchor-id="pearson-correlation"><span class="header-section-number">15.1.13</span> Pearson Correlation</h3>
<p>Pearson correlation measures the strength and direction of the linear relationship between two continuous variables.</p>
<p><strong>Formula:</strong> <span class="math inline">r = \frac{cov(X,Y)}{s_X s_Y} = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum (x_i - \bar{x})^2 \sum (y_i - \bar{y})^2}}</span></p>
<p><strong>Manual Calculation Example:</strong></p>
<p>Using the same data as above:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 38%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Description</th>
<th>Calculation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Calculate covariance</td>
<td>(From previous calculation) 1.5</td>
</tr>
<tr class="even">
<td>2</td>
<td>Calculate standard deviations</td>
<td><span class="math inline">s_X = \sqrt{\frac{10}{4}} = 1.58, s_Y = \sqrt{\frac{6}{4}} = 1.22</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Divide covariance by product of standard deviations</td>
<td><span class="math inline">1.5 / (1.58 * 1.22) = 0.7746</span></td>
</tr>
</tbody>
</table>
<p><strong>R calculation:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7745967</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong> - The correlation coefficient of 0.7746 indicates a strong positive linear relationship between x and y.</p>
<p><strong>Pros:</strong></p>
<ul>
<li>Scale-independent, always between -1 and 1</li>
<li>Widely understood and used</li>
<li>Tests for linear relationships</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Sensitive to outliers</li>
<li>Only measures linear relationships</li>
<li>Assumes normally distributed variables</li>
</ul>
</section>
<section id="spearman-correlation" class="level3" data-number="15.1.14">
<h3 data-number="15.1.14" class="anchored" data-anchor-id="spearman-correlation"><span class="header-section-number">15.1.14</span> Spearman Correlation</h3>
<p>Spearman correlation measures the strength and direction of the monotonic relationship between two variables, which can be continuous or ordinal.</p>
<p><strong>Formula:</strong> <span class="math inline">\rho = 1 - \frac{6 \sum d_i^2}{n(n^2 - 1)}</span>, where <span class="math inline">d_i</span> is the difference between ranks.</p>
<p><strong>Manual Calculation Example:</strong></p>
<p>Let’s use slightly different data:</p>
<ul>
<li>x: 1, 2, 3, 4, 5</li>
<li>y: 1, 3, 2, 5, 4</li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Step</th>
<th>Description</th>
<th>Calculation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Rank both variables</td>
<td>x_rank: 1, 2, 3, 4, 5</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>y_rank: 1, 3, 2, 5, 4</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Calculate differences in ranks (d)</td>
<td>0, -1, 1, -1, 1</td>
</tr>
<tr class="even">
<td>3</td>
<td>Square the differences</td>
<td>0, 1, 1, 1, 1</td>
</tr>
<tr class="odd">
<td>4</td>
<td>Sum the squared differences</td>
<td><span class="math inline">\sum d_i^2 = 4</span></td>
</tr>
<tr class="even">
<td>5</td>
<td>Apply the formula</td>
<td><span class="math inline">\rho = 1 - \frac{6(4)}{5(5^2 - 1)} = 0.8</span></td>
</tr>
</tbody>
</table>
<p><strong>R calculation:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong> - The Spearman correlation of 0.8 indicates a strong positive monotonic relationship between x and y.</p>
<p><strong>Pros:</strong></p>
<ul>
<li>Robust to outliers</li>
<li>Can detect non-linear monotonic relationships</li>
<li>Suitable for ordinal data</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Less powerful than Pearson for detecting linear relationships in normally distributed data</li>
<li>Doesn’t provide information about the shape of the relationship beyond monotonicity</li>
</ul>
</section>
<section id="cross-tabulation" class="level3" data-number="15.1.15">
<h3 data-number="15.1.15" class="anchored" data-anchor-id="cross-tabulation"><span class="header-section-number">15.1.15</span> Cross-tabulation</h3>
<p>Cross-tabulation (contingency table) shows the relationship between two categorical variables.</p>
<p><strong>Example:</strong></p>
<p>Let’s create a cross-tabulation of two variables: - Education level: High School, College, Graduate - Employment status: Employed, Unemployed</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>education <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"High School"</span>, <span class="st">"College"</span>, <span class="st">"Graduate"</span>, <span class="st">"High School"</span>, <span class="st">"College"</span>, <span class="st">"Graduate"</span>, <span class="st">"High School"</span>, <span class="st">"College"</span>, <span class="st">"Graduate"</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>employment <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Employed"</span>, <span class="st">"Employed"</span>, <span class="st">"Employed"</span>, <span class="st">"Unemployed"</span>, <span class="st">"Employed"</span>, <span class="st">"Employed"</span>, <span class="st">"Unemployed"</span>, <span class="st">"Unemployed"</span>, <span class="st">"Employed"</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(education, employment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             employment
education     Employed Unemployed
  College            2          1
  Graduate           3          0
  High School        1          2</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li>This table shows the count of individuals in each combination of education level and employment status.</li>
<li>For example, we can see how many high school graduates are employed versus unemployed.</li>
</ul>
<p><strong>Pros:</strong></p>
<ul>
<li>Provides a clear visual representation of the relationship between categorical variables</li>
<li>Easy to understand and interpret</li>
<li>Basis for many statistical tests (e.g., chi-square test of independence)</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Limited to categorical data</li>
<li>Can become unwieldy with many categories</li>
<li>Doesn’t provide a single summary statistic of association strength</li>
</ul>
</section>
<section id="choosing-the-appropriate-measure" class="level3" data-number="15.1.16">
<h3 data-number="15.1.16" class="anchored" data-anchor-id="choosing-the-appropriate-measure"><span class="header-section-number">15.1.16</span> Choosing the Appropriate Measure</h3>
<p>When deciding which bivariate statistic to use, consider:</p>
<ol type="1">
<li><p>Data type:</p>
<ul>
<li>Continuous data: Covariance, Pearson correlation</li>
<li>Ordinal data: Spearman correlation</li>
<li>Categorical data: Cross-tabulation</li>
</ul></li>
<li><p>Relationship type:</p>
<ul>
<li>Linear: Pearson correlation</li>
<li>Monotonic but potentially non-linear: Spearman correlation</li>
</ul></li>
<li><p>Presence of outliers:</p>
<ul>
<li>If outliers are a concern, Spearman correlation is more robust</li>
</ul></li>
<li><p>Distribution:</p>
<ul>
<li>For normally distributed data, Pearson correlation is most powerful</li>
<li>For non-normal distributions, consider Spearman correlation</li>
</ul></li>
<li><p>Sample size:</p>
<ul>
<li>For very small samples, non-parametric methods like Spearman correlation might be preferred</li>
</ul></li>
</ol>
<p>Remember, it’s often valuable to use multiple measures and visualizations (like scatter plots) to get a comprehensive understanding of the relationship between variables.</p>
</section>
<section id="comparing-pearson-spearman-and-kendall-correlations" class="level3" data-number="15.1.17">
<h3 data-number="15.1.17" class="anchored" data-anchor-id="comparing-pearson-spearman-and-kendall-correlations"><span class="header-section-number">15.1.17</span> Comparing Pearson, Spearman, and Kendall Correlations</h3>
<p>Correlation measures quantify the strength and direction of relationships between variables. We’ll explore three key correlation coefficients:</p>
<ul>
<li>Pearson’s product-moment correlation (r)</li>
<li>Spearman’s rank correlation (ρ)</li>
<li>Kendall’s rank correlation (τ)</li>
</ul>
<p><strong>Mathematical Foundations</strong></p>
<section id="pearson-correlation-coefficient" class="level4" data-number="15.1.17.1">
<h4 data-number="15.1.17.1" class="anchored" data-anchor-id="pearson-correlation-coefficient"><span class="header-section-number">15.1.17.1</span> Pearson Correlation Coefficient</h4>
<p>The Pearson correlation coefficient measures linear relationships between two continuous variables.</p>
<p><span class="math display"> r = \frac{\sum_{i=1}^{n} (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum_{i=1}^{n} (x_i - \bar{x})^2 \sum_{i=1}^{n} (y_i - \bar{y})^2}} </span></p>
<p>where:</p>
<ul>
<li><span class="math inline">x_i, y_i</span> are the individual observations</li>
<li><span class="math inline">\bar{x}, \bar{y}</span> are the means</li>
<li><span class="math inline">n</span> is the sample size</li>
</ul>
</section>
<section id="spearmans-rank-correlation" class="level4" data-number="15.1.17.2">
<h4 data-number="15.1.17.2" class="anchored" data-anchor-id="spearmans-rank-correlation"><span class="header-section-number">15.1.17.2</span> Spearman’s Rank Correlation</h4>
<p>Spearman’s ρ assesses monotonic relationships using ranks.</p>
<p><span class="math display"> \rho = 1 - \frac{6\sum d_i^2}{n(n^2-1)} </span></p>
<p>where:</p>
<ul>
<li><span class="math inline">d_i</span> is the difference between ranks for observation i</li>
<li><span class="math inline">n</span> is the sample size</li>
</ul>
</section>
<section id="kendalls-tau" class="level4" data-number="15.1.17.3">
<h4 data-number="15.1.17.3" class="anchored" data-anchor-id="kendalls-tau"><span class="header-section-number">15.1.17.3</span> Kendall’s Tau</h4>
<p>Kendall’s τ measures ordinal association based on concordant and discordant pairs.</p>
<p><span class="math display"> \tau = \frac{2(P - Q)}{n(n-1)} </span></p>
<p>where:</p>
<ul>
<li>P is the number of concordant pairs</li>
<li>Q is the number of discordant pairs</li>
<li>n is the sample size</li>
</ul>
</section>
</section>
<section id="implementation-in-r" class="level3" data-number="15.1.18">
<h3 data-number="15.1.18" class="anchored" data-anchor-id="implementation-in-r"><span class="header-section-number">15.1.18</span> Implementation in R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">8</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">7</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlations</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>pearson_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>spearman_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>kendall_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"kendall"</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pearson correlation:"</span>, <span class="fu">round</span>(pearson_cor, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pearson correlation: 0.917 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Spearman correlation:"</span>, <span class="fu">round</span>(spearman_cor, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spearman correlation: 0.821 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Kendall correlation:"</span>, <span class="fu">round</span>(kendall_cor, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kendall correlation: 0.738 </code></pre>
</div>
</div>
</section>
<section id="visualization" class="level3" data-number="15.1.19">
<h3 data-number="15.1.19" class="anchored" data-anchor-id="visualization"><span class="header-section-number">15.1.19</span> Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Correlation Example"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Pearson r ="</span>, <span class="fu">round</span>(pearson_cor, <span class="dv">3</span>)),</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"X variable"</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Y variable"</span>) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="key-properties" class="level3" data-number="15.1.20">
<h3 data-number="15.1.20" class="anchored" data-anchor-id="key-properties"><span class="header-section-number">15.1.20</span> Key Properties</h3>
<section id="pearson-correlation-r" class="level4" data-number="15.1.20.1">
<h4 data-number="15.1.20.1" class="anchored" data-anchor-id="pearson-correlation-r"><span class="header-section-number">15.1.20.1</span> Pearson Correlation (r)</h4>
<ol type="1">
<li><p>Range: [-1, 1]</p></li>
<li><p>Properties:</p>
<ul>
<li>r = 1: Perfect positive linear relationship</li>
<li>r = -1: Perfect negative linear relationship</li>
<li>r = 0: No linear relationship</li>
</ul></li>
</ol>
</section>
<section id="spearman-correlation-ρ" class="level4" data-number="15.1.20.2">
<h4 data-number="15.1.20.2" class="anchored" data-anchor-id="spearman-correlation-ρ"><span class="header-section-number">15.1.20.2</span> Spearman Correlation (ρ)</h4>
<ol type="1">
<li><p>Range: [-1, 1]</p></li>
<li><p>Properties:</p>
<ul>
<li>Based on ranks, not raw values</li>
<li>Resistant to outliers</li>
<li>Detects monotonic relationships</li>
</ul></li>
</ol>
</section>
<section id="kendall-correlation-τ" class="level4" data-number="15.1.20.3">
<h4 data-number="15.1.20.3" class="anchored" data-anchor-id="kendall-correlation-τ"><span class="header-section-number">15.1.20.3</span> Kendall Correlation (τ)</h4>
<ol type="1">
<li><p>Range: [-1, 1]</p></li>
<li><p>Properties:</p>
<ul>
<li>Based on concordant/discordant pairs</li>
<li>More robust than Spearman</li>
<li>Often preferred for small samples</li>
</ul></li>
</ol>
</section>
</section>
<section id="when-to-use-each-measure" class="level3" data-number="15.1.21">
<h3 data-number="15.1.21" class="anchored" data-anchor-id="when-to-use-each-measure"><span class="header-section-number">15.1.21</span> When to Use Each Measure</h3>
<ol type="1">
<li><p><strong>Use Pearson when:</strong></p>
<ul>
<li>Relationship appears linear</li>
<li>Data is continuous</li>
<li>Normal distribution assumed</li>
<li>No significant outliers</li>
</ul></li>
<li><p><strong>Use Spearman when:</strong></p>
<ul>
<li>Relationship is monotonic but not linear</li>
<li>Data is ordinal</li>
<li>Outliers present</li>
<li>Non-normal distribution</li>
</ul></li>
<li><p><strong>Use Kendall when:</strong></p>
<ul>
<li>Small sample size</li>
<li>Many tied ranks</li>
<li>Most robust measure needed</li>
<li>Ordinal data with few categories</li>
</ul></li>
</ol>
</section>
<section id="example-analysis" class="level3" data-number="15.1.22">
<h3 data-number="15.1.22" class="anchored" data-anchor-id="example-analysis"><span class="header-section-number">15.1.22</span> Example Analysis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate non-linear relationship</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">20</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> x2<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x2, <span class="at">y =</span> y2)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlations</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>cor_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">"Pearson"</span>, <span class="st">"Spearman"</span>, <span class="st">"Kendall"</span>),</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Correlation =</span> <span class="fu">c</span>(</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor</span>(x2, y2, <span class="at">method =</span> <span class="st">"pearson"</span>),</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor</span>(x2, y2, <span class="at">method =</span> <span class="st">"spearman"</span>),</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor</span>(x2, y2, <span class="at">method =</span> <span class="st">"kendall"</span>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Method Correlation
1  Pearson   0.9699718
2 Spearman   0.9849624
3  Kendall   0.9368421</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data2, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Non-linear Relationship Example"</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Compare different correlation measures"</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"X variable"</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Y variable"</span>) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="practical-considerations" class="level3" data-number="15.1.23">
<h3 data-number="15.1.23" class="anchored" data-anchor-id="practical-considerations"><span class="header-section-number">15.1.23</span> Practical Considerations</h3>
<ol type="1">
<li><strong>Sample Size</strong>
<ul>
<li>Small samples (n &lt; 10): Consider Kendall’s τ</li>
<li>Larger samples: Any method appropriate</li>
</ul></li>
<li><strong>Outliers</strong>
<ul>
<li>Present: Prefer Spearman or Kendall</li>
<li>Absent: Pearson may be more powerful</li>
</ul></li>
<li><strong>Type of Relationship</strong>
<ul>
<li>Linear: Pearson optimal</li>
<li>Monotonic: Spearman or Kendall</li>
<li>Complex: Consider other methods</li>
</ul></li>
</ol>
</section>
<section id="common-pitfalls" class="level3" data-number="15.1.24">
<h3 data-number="15.1.24" class="anchored" data-anchor-id="common-pitfalls"><span class="header-section-number">15.1.24</span> Common Pitfalls</h3>
<ol type="1">
<li><strong>Misinterpretation</strong>
<ul>
<li>Correlation ≠ causation</li>
<li>High correlation doesn’t imply good fit</li>
<li>Low correlation doesn’t mean no relationship</li>
</ul></li>
<li><strong>Technical Issues</strong>
<ul>
<li>Missing values handling</li>
<li>Tied ranks in Spearman/Kendall</li>
<li>Scale sensitivity</li>
</ul></li>
</ol>
</section>
</section>
<section id="introduction-to-elementary-multivariate-statistics" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="introduction-to-elementary-multivariate-statistics"><span class="header-section-number">15.2</span> Introduction to Elementary Multivariate Statistics (*)</h2>
<p>Multivariate statistics involve the analysis of relationships among three or more variables simultaneously. This section will introduce some basic concepts and techniques in multivariate analysis, with a focus on correlation-based methods.</p>
<section id="correlation-matrix" class="level3" data-number="15.2.1">
<h3 data-number="15.2.1" class="anchored" data-anchor-id="correlation-matrix"><span class="header-section-number">15.2.1</span> Correlation Matrix</h3>
<p>A correlation matrix is a table showing the pairwise correlations of several variables. It’s a fundamental tool in multivariate analysis.</p>
<p><strong>Example:</strong> Let’s create a correlation matrix for four variables: height, weight, age, and income.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>height <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">170</span>, <span class="dv">10</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>weight <span class="ot">&lt;-</span> height <span class="sc">*</span> <span class="fl">0.5</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">40</span>, <span class="dv">10</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> age <span class="sc">*</span> <span class="dv">1000</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">10000</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(height, weight, age, income)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(data)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           height      weight         age      income
height  1.0000000  0.66712996 -0.12917601 -0.12246786
weight  0.6671300  1.00000000 -0.06814187 -0.04579492
age    -0.1291760 -0.06814187  1.00000000  0.65654902
income -0.1224679 -0.04579492  0.65654902  1.00000000</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li>Each cell shows the correlation between two variables.</li>
<li>The diagonal is always 1 (correlation of a variable with itself).</li>
<li>Look for strong correlations (close to 1 or -1) to identify potential relationships.</li>
</ul>
</section>
<section id="visualizing-multivariate-relationships" class="level3" data-number="15.2.2">
<h3 data-number="15.2.2" class="anchored" data-anchor-id="visualizing-multivariate-relationships"><span class="header-section-number">15.2.2</span> Visualizing Multivariate Relationships</h3>
<section id="scatterplot-matrix" class="level4" data-number="15.2.2.1">
<h4 data-number="15.2.2.1" class="anchored" data-anchor-id="scatterplot-matrix"><span class="header-section-number">15.2.2.1</span> Scatterplot Matrix</h4>
<p>A scatterplot matrix shows pairwise relationships between multiple variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li>Each plot shows the relationship between two variables.</li>
<li>Diagonal elements show the distribution of each variable.</li>
<li>Look for patterns, clusters, or trends in the plots.</li>
</ul>
</section>
<section id="correlation-plot" class="level4" data-number="15.2.2.2">
<h4 data-number="15.2.2.2" class="anchored" data-anchor-id="correlation-plot"><span class="header-section-number">15.2.2.2</span> Correlation Plot</h4>
<p>A correlation plot provides a visual representation of the correlation matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.94 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix, <span class="at">method =</span> <span class="st">"color"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li>Color intensity and size of the circles indicate the strength of correlation.</li>
<li>Blue colors typically indicate positive correlations, red colors indicate negative correlations.</li>
</ul>
</section>
</section>
<section id="partial-correlation" class="level3" data-number="15.2.3">
<h3 data-number="15.2.3" class="anchored" data-anchor-id="partial-correlation"><span class="header-section-number">15.2.3</span> Partial Correlation</h3>
<p>Partial correlation measures the relationship between two variables while controlling for one or more other variables.</p>
<p><strong>Example:</strong> Let’s calculate the partial correlation between height and weight, controlling for age.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ppcor)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pcor.test</span>(data<span class="sc">$</span>height, data<span class="sc">$</span>weight, data<span class="sc">$</span>age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   estimate      p.value statistic   n gp  Method
1 0.6654367 5.758157e-14  8.779896 100  1 pearson</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li>Compare this to the simple correlation between height and weight.</li>
<li>A significant change might indicate that age plays a role in the height-weight relationship.</li>
</ul>
</section>
<section id="multiple-correlation" class="level3" data-number="15.2.4">
<h3 data-number="15.2.4" class="anchored" data-anchor-id="multiple-correlation"><span class="header-section-number">15.2.4</span> Multiple Correlation</h3>
<p>Multiple correlation measures the strength of the relationship between a dependent variable and multiple independent variables.</p>
<p><strong>Example:</strong> Let’s predict weight using height and age.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height <span class="sc">+</span> age, <span class="at">data =</span> data)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Multiple correlation coefficient:"</span>, R))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Multiple correlation coefficient: 0.667377840470434"</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li>R ranges from 0 to 1, with higher values indicating stronger relationships.</li>
<li>R² (R-squared) represents the proportion of variance in the dependent variable explained by the independent variables.</li>
</ul>
</section>
<section id="factor-analysis" class="level3" data-number="15.2.5">
<h3 data-number="15.2.5" class="anchored" data-anchor-id="factor-analysis"><span class="header-section-number">15.2.5</span> Factor Analysis</h3>
<p>Factor analysis is a technique used to reduce many variables to a smaller number of underlying factors.</p>
<p><strong>Example:</strong> Let’s perform a simple factor analysis on our dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'psych'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ggplot2':

    %+%, alpha</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>fa_result <span class="ot">&lt;-</span> <span class="fu">fa</span>(data, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_result<span class="sc">$</span>loadings, <span class="at">cutoff =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
       MR2    MR1   
height  0.798       
weight  0.836       
age            0.729
income         0.895

                 MR2   MR1
SS loadings    1.344 1.341
Proportion Var 0.336 0.335
Cumulative Var 0.336 0.671</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li>Look at which variables load highly on each factor.</li>
<li>Try to interpret what each factor might represent based on the variables that load on it.</li>
</ul>
</section>
<section id="considerations-in-multivariate-analysis" class="level3" data-number="15.2.6">
<h3 data-number="15.2.6" class="anchored" data-anchor-id="considerations-in-multivariate-analysis"><span class="header-section-number">15.2.6</span> Considerations in Multivariate Analysis</h3>
<ol type="1">
<li><p><strong>Sample Size</strong>: Multivariate techniques often require larger sample sizes for stable results.</p></li>
<li><p><strong>Multicollinearity</strong>: High correlations among independent variables can cause issues in some analyses.</p></li>
<li><p><strong>Outliers</strong>: Multivariate outliers can have a strong influence on results.</p></li>
<li><p><strong>Assumptions</strong>: Many techniques assume multivariate normality and linear relationships.</p></li>
<li><p><strong>Interpretation Complexity</strong>: As the number of variables increases, interpretation can become more challenging.</p></li>
</ol>
</section>
<section id="conclusion" class="level3" data-number="15.2.7">
<h3 data-number="15.2.7" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">15.2.7</span> Conclusion</h3>
<p>This introduction to multivariate statistics builds upon the concept of correlation to explore relationships among multiple variables. These techniques provide powerful tools for understanding complex datasets, but they also require careful consideration of assumptions and limitations. As you progress in your statistical journey, you’ll encounter more advanced multivariate techniques such as MANOVA, discriminant analysis, and structural equation modeling.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.0     ✔ readr     2.1.5
✔ lubridate 1.9.3     ✔ stringr   1.5.1
✔ purrr     1.0.2     ✔ tibble    3.2.1
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ psych::%+%()         masks ggplot2::%+%()
✖ psych::alpha()       masks ggplot2::alpha()
✖ gridExtra::combine() masks dplyr::combine()
✖ dplyr::filter()      masks stats::filter()
✖ dplyr::lag()         masks stats::lag()
✖ MASS::select()       masks dplyr::select()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="introduction-to-regression-analysis" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="introduction-to-regression-analysis"><span class="header-section-number">15.3</span> Introduction to Regression Analysis</h2>
<section id="why-study-regression" class="level3" data-number="15.3.1">
<h3 data-number="15.3.1" class="anchored" data-anchor-id="why-study-regression"><span class="header-section-number">15.3.1</span> Why Study Regression?</h3>
<p>Regression analysis is a fundamental statistical tool that helps us understand relationships between variables. Before diving into formulas and technical details, let’s understand what questions regression can help us answer:</p>
<ul>
<li>How much does each additional year of education affect someone’s salary?</li>
<li>What is the relationship between advertising spending and sales?</li>
<li>How does temperature affect energy consumption?</li>
<li>Do study hours predict exam scores?</li>
</ul>
<p>These questions share a common structure: they all explore how changes in one variable relate to changes in another.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Understanding Linear Regression (OLS): Quickstart guide
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">length.out =</span> n)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">1.5</span>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate OLS parameters</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">cov</span>(x, y) <span class="sc">/</span> <span class="fu">var</span>(x)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y) <span class="sc">-</span> beta1 <span class="sc">*</span> <span class="fu">mean</span>(x)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create alternative lines</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>lines_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept =</span> <span class="fu">c</span>(beta0, beta0 <span class="sc">+</span> <span class="dv">1</span>, beta0 <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">slope =</span> <span class="fu">c</span>(beta1, beta1 <span class="sc">+</span> <span class="fl">0.3</span>, beta1 <span class="sc">-</span> <span class="fl">0.3</span>),</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">line_type =</span> <span class="fu">c</span>(<span class="st">"Best fit (OLS)"</span>, <span class="st">"Suboptimal 1"</span>, <span class="st">"Suboptimal 2"</span>)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> lines_data,</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> intercept, </span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">slope =</span> slope,</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> line_type,</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">linetype =</span> line_type),</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Best fit (OLS)"</span> <span class="ot">=</span> <span class="st">"#FF4500"</span>,</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Suboptimal 1"</span> <span class="ot">=</span> <span class="st">"#4169E1"</span>,</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Suboptimal 2"</span> <span class="ot">=</span> <span class="st">"#228B22"</span>)) <span class="sc">+</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Finding the Best-Fitting Line"</span>,</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Orange line minimizes the sum of squared errors"</span>,</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"X Variable"</span>,</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Y Variable"</span>,</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Line Type"</span>,</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">"Line Type"</span>) <span class="sc">+</span></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="the-model-concept" class="level3" data-number="15.3.2">
<h3 data-number="15.3.2" class="anchored" data-anchor-id="the-model-concept"><span class="header-section-number">15.3.2</span> The Model Concept</h3>
<p>OLS regression is a statistical model that describes the relationship between variables. Two key assumptions define this model:</p>
<ol type="1">
<li>The relationship can be described by a straight line (linearity)</li>
<li>The errors in our predictions are not systematically related to our x-variable (strict exogeneity)</li>
</ol>
</section>
<section id="example-education-and-wages" class="level3" data-number="15.3.3">
<h3 data-number="15.3.3" class="anchored" data-anchor-id="example-education-and-wages"><span class="header-section-number">15.3.3</span> Example: Education and Wages</h3>
<p>Consider studying the effect of education (x) on wages (y). Let’s say we estimate:</p>
<p><span class="math display">wages = \beta_0 + \beta_1 \cdot education + \epsilon</span></p>
<p>The error term <span class="math inline">\epsilon</span> contains all other factors affecting wages. Strict exogeneity is violated if we omit an important variable like “ability” that affects both education and wages. Why? Because more able people tend to get more education AND higher wages, making our estimate of education’s effect biased upward.</p>
</section>
<section id="the-optimization-problem-understanding-ols" class="level3" data-number="15.3.4">
<h3 data-number="15.3.4" class="anchored" data-anchor-id="the-optimization-problem-understanding-ols"><span class="header-section-number">15.3.4</span> The Optimization Problem: Understanding OLS</h3>
<p>When we analyze relationships between variables like education and wages, we need a systematic method to find the line that best represents this relationship in our data. Ordinary Least Squares (OLS) provides this method through a clear mathematical approach.</p>
<p>Consider our plot of education levels and wages. Each point represents actual data - one person’s years of education and their corresponding wage. Our goal is to find a single line that most accurately captures the underlying relationship between these variables.</p>
<p>For any given observation <span class="math inline">i</span>, we can express this relationship as: <span class="math display">y_i = \beta_0 + \beta_1x_i + \epsilon_i</span></p>
<p>Where:</p>
<ul>
<li><span class="math display">y_i</span> is the actual observed wage</li>
<li><span class="math display">\hat{y_i} = \beta_0 + \beta_1x_i</span> is our predicted wage</li>
<li><span class="math display">\epsilon_i = y_i - \hat{y_i}</span> is the error term (or residual)</li>
</ul>
<p>OLS finds the optimal values for <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1</span> by minimizing the sum of squared errors:</p>
<p><span class="math display">\min_{\beta_0, \beta_1} \sum \epsilon_i^2 = \min_{\beta_0, \beta_1} \sum(y_i - \hat{y_i})^2 = \min_{\beta_0, \beta_1} \sum(y_i - (\beta_0 + \beta_1x_i))^2</span></p>
<p>Looking at our visualization: - The scattered points show our actual observations <span class="math inline">(x_i, y_i)</span> - The orange line represents our fitted values <span class="math inline">\hat{y_i}</span> that minimize <span class="math inline">\sum \epsilon_i^2</span> - The blue and green lines represent alternative fits with larger total squared errors - The vertical distances from each point to these lines represent the errors <span class="math inline">\epsilon_i</span></p>
<p>The OLS solution provides us with estimates <span class="math inline">\hat{\beta_0}</span> and <span class="math inline">\hat{\beta_1}</span> that minimize the total squared error, giving us the most accurate linear representation of the relationship between education and wages based on our available data.</p>
</section>
<section id="finding-the-best-line" class="level3" data-number="15.3.5">
<h3 data-number="15.3.5" class="anchored" data-anchor-id="finding-the-best-line"><span class="header-section-number">15.3.5</span> Finding the Best Line</h3>
<p>The solution to this minimization gives us:</p>
<p><span class="math display">\hat{\beta}_1 = \frac{\sum(x_i - \bar{x})(y_i - \bar{y})}{\sum(x_i - \bar{x})^2} = \frac{cov(X, Y)}{var(X)}</span></p>
<p><span class="math display">\hat{\beta}_0 = \bar{y} - \hat{\beta}_1\bar{x}</span></p>
</section>
<section id="key-points-1" class="level3" data-number="15.3.6">
<h3 data-number="15.3.6" class="anchored" data-anchor-id="key-points-1"><span class="header-section-number">15.3.6</span> Key Points</h3>
<ol type="1">
<li>OLS finds the line that minimizes squared prediction errors</li>
<li>This line is “best” in terms of fit, but might not capture true relationships if important variables are omitted</li>
<li>In the education-wages example, omitting ability means we attribute all the wage increase to education alone</li>
</ol>
</section>
</div>
</div>
</section>
<section id="basic-concepts-and-terminology" class="level3" data-number="15.3.7">
<h3 data-number="15.3.7" class="anchored" data-anchor-id="basic-concepts-and-terminology"><span class="header-section-number">15.3.7</span> Basic Concepts and Terminology</h3>
<p>Before we dive into the mathematics, let’s establish our key terms:</p>
<ul>
<li><strong>Dependent Variable (Y)</strong>:
<ul>
<li>The outcome we want to understand or predict</li>
<li>Also called: response variable, target variable</li>
<li>Examples: salary, sales, exam scores</li>
</ul></li>
<li><strong>Independent Variable (X)</strong>:
<ul>
<li>The variable we think influences Y</li>
<li>Also called: predictor, explanatory variable, regressor</li>
<li>Examples: years of education, advertising budget, study hours</li>
</ul></li>
<li><strong>Population Parameters (<span class="math inline">\beta</span>)</strong>:
<ul>
<li>The true underlying relationships we want to understand</li>
<li>Usually unknown in practice</li>
<li>Examples: <span class="math inline">\beta_0</span> (true intercept), <span class="math inline">\beta_1</span> (true slope)</li>
</ul></li>
<li><strong>Parameter Estimates (<span class="math inline">\hat{\beta}</span>)</strong>:
<ul>
<li>Our best guesses of the true parameters based on data</li>
<li>Calculated from sample data</li>
<li>Examples: <span class="math inline">\hat{\beta}_0</span> (estimated intercept), <span class="math inline">\hat{\beta}_1</span> (estimated slope)</li>
</ul></li>
</ul>
</section>
<section id="the-core-idea" class="level3" data-number="15.3.8">
<h3 data-number="15.3.8" class="anchored" data-anchor-id="the-core-idea"><span class="header-section-number">15.3.8</span> The Core Idea</h3>
<p>Let’s visualize what regression does with a simple example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate some example data</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.5</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Simple Linear Regression Example"</span>,</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Points represent data, red line shows regression fit"</span>,</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Independent Variable (X)"</span>,</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Dependent Variable (Y)"</span>) <span class="sc">+</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-basic-idea" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-basic-idea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_en_files/figure-html/fig-basic-idea-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-basic-idea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.1: Basic Idea of Regression: Fitting a Line to Data
</figcaption>
</figure>
</div>
</div>
</div>
<p>This plot shows the essence of regression: - Each point represents an observation (X, Y) - The line represents our best guess at the relationship - The spread of points around the line shows the uncertainty</p>
</section>
</section>
<section id="the-linear-regression-model" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="the-linear-regression-model"><span class="header-section-number">15.4</span> The Linear Regression Model</h2>
<section id="population-model-vs.-sample-estimates" class="level3" data-number="15.4.1">
<h3 data-number="15.4.1" class="anchored" data-anchor-id="population-model-vs.-sample-estimates"><span class="header-section-number">15.4.1</span> Population Model vs.&nbsp;Sample Estimates</h3>
<p>In theory, there exists a true population relationship:</p>
<p><span class="math display">Y = \beta_0 + \beta_1X + \varepsilon</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\beta_0</span> is the true population intercept</li>
<li><span class="math inline">\beta_1</span> is the true population slope</li>
<li><span class="math inline">\varepsilon</span> is the random error term</li>
</ul>
<p>In practice, we work with sample data to estimate this relationship:</p>
<p><span class="math display">\hat{Y} = \hat{\beta}_0 + \hat{\beta}_1X</span></p>
<p>Let’s visualize the difference between population and sample relationships:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate population data</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>x_pop <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>true_relationship <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x_pop  <span class="co"># True β₀=2, β₁=3</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>y_pop <span class="ot">&lt;-</span> true_relationship <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x_pop), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create several samples</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rep</span>(<span class="fu">sample</span>(x_pop, sample_size), <span class="dv">3</span>),</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each =</span> sample_size)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>samples<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>samples<span class="sc">$</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(samples), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models to each sample</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> samples <span class="sc">%&gt;%</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> <span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x))[<span class="dv">1</span>],</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">slope =</span> <span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x))[<span class="dv">2</span>]</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> samples, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> <span class="fu">factor</span>(sample)), </span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> models, </span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> intercept, <span class="at">slope =</span> slope, </span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> <span class="fu">factor</span>(sample)),</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_pop, <span class="at">y =</span> true_relationship), </span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Population vs. Sample Regression Lines"</span>,</span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Black line: true population relationship</span><span class="sc">\n</span><span class="st">Dashed lines: sample estimates"</span>,</span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"X"</span>, <span class="at">y =</span> <span class="st">"Y"</span>,</span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Sample"</span>) <span class="sc">+</span></span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-pop-vs-sample" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pop-vs-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_en_files/figure-html/fig-pop-vs-sample-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pop-vs-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.2: Population vs.&nbsp;Sample Regression Lines
</figcaption>
</figure>
</div>
</div>
</div>
<p>This visualization shows: - The true population line (black) we’re trying to discover - Different sample estimates (dashed lines) based on different samples - How sample estimates vary around the true relationship</p>
</section>
</section>
<section id="key-assumptions-of-linear-regression" class="level2" data-number="15.5">
<h2 data-number="15.5" class="anchored" data-anchor-id="key-assumptions-of-linear-regression"><span class="header-section-number">15.5</span> Key Assumptions of Linear Regression</h2>
<section id="strict-exogeneity-the-fundamental-assumption" class="level3" data-number="15.5.1">
<h3 data-number="15.5.1" class="anchored" data-anchor-id="strict-exogeneity-the-fundamental-assumption"><span class="header-section-number">15.5.1</span> Strict Exogeneity: The Fundamental Assumption</h3>
<p>The most crucial assumption in regression is strict exogeneity:</p>
<p><span class="math display">E[\varepsilon|X] = 0</span></p>
<p>This means:</p>
<ol type="1">
<li>The error term has zero mean conditional on X</li>
<li>X contains no information about the average error</li>
<li>There are no systematic patterns in how our predictions are wrong</li>
</ol>
<p>Let’s visualize when this assumption holds and when it doesn’t:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.2</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 1: Exogenous errors</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>y_exog <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 2: Non-exogenous errors (error variance increases with x)</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>y_nonexog <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>x<span class="sc">*</span><span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create datasets</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>data_exog <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x,</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y_exog,</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"Exogenous Errors</span><span class="sc">\n</span><span class="st">(Assumption Satisfied)"</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>data_nonexog <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x,</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y_nonexog,</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"Non-Exogenous Errors</span><span class="sc">\n</span><span class="st">(Assumption Violated)"</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_exog, data_nonexog)</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots with residuals</span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>plot_residuals <span class="ot">&lt;-</span> <span class="cf">function</span>(data, title) {</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model)</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> title)</span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(p1, p2)</span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate plots</span></span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a>plots_exog <span class="ot">&lt;-</span> <span class="fu">plot_residuals</span>(data_exog, <span class="st">"Exogenous Errors"</span>)</span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a>plots_nonexog <span class="ot">&lt;-</span> <span class="fu">plot_residuals</span>(data_nonexog, <span class="st">"Non-Exogenous Errors"</span>)</span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange plots</span></span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(</span>
<span id="cb50-53"><a href="#cb50-53" aria-hidden="true" tabindex="-1"></a>  plots_exog[[<span class="dv">1</span>]], plots_exog[[<span class="dv">2</span>]],</span>
<span id="cb50-54"><a href="#cb50-54" aria-hidden="true" tabindex="-1"></a>  plots_nonexog[[<span class="dv">1</span>]], plots_nonexog[[<span class="dv">2</span>]],</span>
<span id="cb50-55"><a href="#cb50-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span></span>
<span id="cb50-56"><a href="#cb50-56" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-exogeneity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-exogeneity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_en_files/figure-html/fig-exogeneity-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-exogeneity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.3: Exogeneity vs.&nbsp;Non-Exogeneity Examples
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="linearity-the-form-assumption" class="level3" data-number="15.5.2">
<h3 data-number="15.5.2" class="anchored" data-anchor-id="linearity-the-form-assumption"><span class="header-section-number">15.5.2</span> Linearity: The Form Assumption</h3>
<p>The relationship between X and Y should be linear in parameters:</p>
<p><span class="math display">E[Y|X] = \beta_0 + \beta_1X</span></p>
<p>Note that this doesn’t mean X and Y must have a straight-line relationship - we can transform variables. Let’s see different types of relationships:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Different relationships</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>data_relationships <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rep</span>(x, <span class="dv">3</span>),</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Linear</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Quadratic</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Exponential</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">exp</span>(<span class="fl">0.3</span><span class="sc">*</span>x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Linear"</span>, <span class="st">"Quadratic"</span>, <span class="st">"Exponential"</span>), <span class="at">each =</span> <span class="fu">length</span>(x))</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_relationships, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"Red: linear fit, Blue: true relationship"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-linearity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linearity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_en_files/figure-html/fig-linearity-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linearity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.4: Linear and Nonlinear Relationships
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="understanding-violations-and-solutions" class="level3" data-number="15.5.3">
<h3 data-number="15.5.3" class="anchored" data-anchor-id="understanding-violations-and-solutions"><span class="header-section-number">15.5.3</span> Understanding Violations and Solutions</h3>
<p>When linearity is violated:</p>
<ol type="1">
<li>Transform variables:
<ul>
<li>Log transformation: for exponential relationships</li>
<li>Square root: for moderate nonlinearity</li>
<li>Power transformations: for more complex relationships</li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate exponential data</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">102</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.2</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fl">0.3</span><span class="sc">*</span>x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create datasets</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>data_trans <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x,</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">log_y =</span> <span class="fu">log</span>(y)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in log(y): NaNs produced</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Original scale plot</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_trans, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Original Scale"</span>)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Log scale plot</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_trans, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> log_y)) <span class="sc">+</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log-Transformed Y"</span>)</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-transformations" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-transformations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_en_files/figure-html/fig-transformations-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-transformations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.5: Effect of Variable Transformations
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="estimation-methods" class="level2" data-number="15.6">
<h2 data-number="15.6" class="anchored" data-anchor-id="estimation-methods"><span class="header-section-number">15.6</span> Estimation Methods</h2>
<section id="ordinary-least-squares-ols" class="level3" data-number="15.6.1">
<h3 data-number="15.6.1" class="anchored" data-anchor-id="ordinary-least-squares-ols"><span class="header-section-number">15.6.1</span> Ordinary Least Squares (OLS)</h3>
<p>OLS finds <span class="math inline">\hat{\beta}_0</span> and <span class="math inline">\hat{\beta}_1</span> by minimizing the sum of squared residuals:</p>
<p><span class="math display">\min_{\hat{\beta}_0, \hat{\beta}_1} \sum_{i=1}^n (Y_i - \hat{\beta}_0 - \hat{\beta}_1X_i)^2</span></p>
<p>The solutions are:</p>
<p><span class="math display">\hat{\beta}_1 = \frac{\sum_{i=1}^n (X_i - \bar{X})(Y_i - \bar{Y})}{\sum_{i=1}^n (X_i - \bar{X})^2}</span></p>
<p><span class="math display">\hat{\beta}_0 = \bar{Y} - \hat{\beta}_1\bar{X}</span></p>
<p>Let’s visualize how OLS works:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">103</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>x_sample <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>y_sample <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x_sample <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x_sample), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>data_sample <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_sample, <span class="at">y =</span> y_sample)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>model_sample <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data_sample)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>data_sample<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_sample)</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_sample, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> x, <span class="at">y =</span> y, <span class="at">yend =</span> predicted), </span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"OLS Regression with Residuals"</span>,</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Blue points: data</span><span class="sc">\n</span><span class="st">Red line: OLS fit</span><span class="sc">\n</span><span class="st">Green dashed lines: residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ols" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ols-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_en_files/figure-html/fig-ols-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ols-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.6: OLS Minimizing Square Residuals
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="assessing-model-fit" class="level2" data-number="15.7">
<h2 data-number="15.7" class="anchored" data-anchor-id="assessing-model-fit"><span class="header-section-number">15.7</span> Assessing Model Fit</h2>
<section id="decomposition-of-variance" class="level3" data-number="15.7.1">
<h3 data-number="15.7.1" class="anchored" data-anchor-id="decomposition-of-variance"><span class="header-section-number">15.7.1</span> Decomposition of Variance</h3>
<p>The total variability in Y can be broken down into explained and unexplained components:</p>
<p><span class="math display">\underbrace{\sum_{i=1}^n (Y_i - \bar{Y})^2}_{SST} = \underbrace{\sum_{i=1}^n (\hat{Y}_i - \bar{Y})^2}_{SSR} + \underbrace{\sum_{i=1}^n (Y_i - \hat{Y}_i)^2}_{SSE}</span></p>
<p>where:</p>
<ul>
<li>SST (Total Sum of Squares): Total variation in Y</li>
<li>SSR (Regression Sum of Squares): Variation explained by regression</li>
<li>SSE (Error Sum of Squares): Unexplained variation</li>
</ul>
<p>Let’s visualize this decomposition:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">104</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.5</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model)</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>mean_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(df<span class="sc">$</span>y)</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate components for one point</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>point_index <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>example_point <span class="ot">&lt;-</span> df[point_index, ]</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create main plot</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>p_main <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> y), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(df<span class="sc">$</span>y), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total deviation</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> example_point,</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> mean_y, <span class="at">xend =</span> x, <span class="at">yend =</span> y),</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Explained deviation</span></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> example_point,</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> mean_y, <span class="at">xend =</span> x, <span class="at">yend =</span> predicted),</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Unexplained deviation</span></span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> example_point,</span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> predicted, <span class="at">xend =</span> x, <span class="at">yend =</span> y),</span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Decomposition of Variance"</span>,</span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Purple: Total deviation (Yi - Ȳ)</span><span class="sc">\n</span><span class="st">Green: Explained (Ŷi - Ȳ)</span><span class="sc">\n</span><span class="st">Orange: Unexplained (Yi - Ŷi)"</span>)</span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate R-squared</span></span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> <span class="fu">glance</span>(model)</span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>(summary_stats<span class="sc">$</span>r.squared, <span class="dv">3</span>)</span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Add R-squared to plot</span></span>
<span id="cb61-43"><a href="#cb61-43" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_main)</span>
<span id="cb61-44"><a href="#cb61-44" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">R² = %.3f</span><span class="sc">\n</span><span class="st">This means %.1f%% of the variance in Y is explained by X</span><span class="sc">\n</span><span class="st">"</span>, r2, r2<span class="sc">*</span><span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
R² = 0.965
This means 96.5% of the variance in Y is explained by X</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-decomposition" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-decomposition-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_en_files/figure-html/fig-decomposition-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-decomposition-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.7: Variance Decomposition in Linear Regression
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="understanding-the-three-types-of-variation" class="level3" data-number="15.7.2">
<h3 data-number="15.7.2" class="anchored" data-anchor-id="understanding-the-three-types-of-variation"><span class="header-section-number">15.7.2</span> Understanding the Three Types of Variation</h3>
<ol type="1">
<li><strong>Total Variation (SST)</strong>
<ul>
<li>Question: “How much do observations vary from the mean?”</li>
<li>Formula: <span class="math display">SST = \sum(y_i - \bar{y})^2</span></li>
<li>Visual: Purple dashed lines in the plot</li>
<li>Intuition: The “spread” of our data around its average</li>
</ul></li>
<li><strong>Explained Variation (SSR)</strong>
<ul>
<li>Question: “How much of the variation did our model explain?”</li>
<li>Formula: <span class="math display">SSR = \sum(\hat{y}_i - \bar{y})^2</span></li>
<li>Visual: Green dashed lines in the plot</li>
<li>Intuition: The improvement we gained by using X</li>
</ul></li>
<li><strong>Unexplained Variation (SSE)</strong>
<ul>
<li>Question: “What variation remains unexplained?”</li>
<li>Formula: <span class="math display">SSE = \sum(y_i - \hat{y}_i)^2</span></li>
<li>Visual: Red dashed lines in the plot</li>
<li>Intuition: The errors that remain after using X</li>
</ul></li>
</ol>
</section>
<section id="r²-demystified" class="level3" data-number="15.7.3">
<h3 data-number="15.7.3" class="anchored" data-anchor-id="r²-demystified"><span class="header-section-number">15.7.3</span> R² Demystified</h3>
<p><span class="math display">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span></p>
<p>Think of R² as answering the question: “What percentage of the original variation in Y can we explain using X?”</p>
<section id="intuitive-examples" class="level4" data-number="15.7.3.1">
<h4 data-number="15.7.3.1" class="anchored" data-anchor-id="intuitive-examples"><span class="header-section-number">15.7.3.1</span> Intuitive Examples:</h4>
<ul>
<li>R² = 0.80: Using X eliminated 80% of our prediction errors</li>
<li>R² = 0.25: Using X eliminated 25% of our prediction errors</li>
<li>R² = 0.00: Using X didn’t help at all</li>
</ul>
</section>
</section>
<section id="when-to-be-cautious" class="level3" data-number="15.7.4">
<h3 data-number="15.7.4" class="anchored" data-anchor-id="when-to-be-cautious"><span class="header-section-number">15.7.4</span> When to Be Cautious</h3>
<ol type="1">
<li><strong>High R² Isn’t Everything</strong>
<ul>
<li>A high R² might indicate overfitting</li>
<li>Always check if your model makes practical sense</li>
<li>Consider the context of your field</li>
</ul></li>
<li><strong>Low R² Isn’t Always Bad</strong>
<ul>
<li>In some fields, R² = 0.30 might be impressive</li>
<li>Social sciences often have lower R² values</li>
<li>Focus on practical significance</li>
</ul></li>
<li><strong>Sample Size Matters</strong>
<ul>
<li>Use adjusted R² for multiple regression: <span class="math display">R^2_{adj} = 1 - \frac{SSE/(n-p)}{SST/(n-1)}</span></li>
<li>Penalizes for adding unnecessary predictors</li>
</ul></li>
</ol>
</section>
<section id="practical-tips-for-analysis" class="level3" data-number="15.7.5">
<h3 data-number="15.7.5" class="anchored" data-anchor-id="practical-tips-for-analysis"><span class="header-section-number">15.7.5</span> Practical Tips for Analysis</h3>
<ol type="1">
<li><strong>Visual Inspection</strong>
<ul>
<li>Always plot your data</li>
<li>Look for patterns in residuals</li>
<li>Check for influential points</li>
</ul></li>
<li><strong>Context Consideration</strong>
<ul>
<li>What’s a “good” R² in your field?</li>
<li>What’s the practical impact of your errors?</li>
<li>Are your predictors meaningful?</li>
</ul></li>
<li><strong>Model Diagnostics</strong>
<ul>
<li>Check residual normality</li>
<li>Look for heteroscedasticity</li>
<li>Examine influential points</li>
</ul></li>
</ol>
</section>
<section id="key-takeaways" class="level3" data-number="15.7.6">
<h3 data-number="15.7.6" class="anchored" data-anchor-id="key-takeaways"><span class="header-section-number">15.7.6</span> Key Takeaways</h3>
<ol type="1">
<li>Variance decomposition helps us understand prediction improvement</li>
<li>R² quantifies the proportion of variance explained</li>
<li>Visual understanding is crucial for interpretation</li>
<li>Context matters more than absolute R² values</li>
<li>Always combine R² with other diagnostic tools</li>
</ol>
</section>
<section id="further-reading" class="level3" data-number="15.7.7">
<h3 data-number="15.7.7" class="anchored" data-anchor-id="further-reading"><span class="header-section-number">15.7.7</span> Further Reading</h3>
<ul>
<li>For deeper understanding of vector spaces and projections</li>
<li>For multiple regression extensions</li>
<li>For robust regression alternatives</li>
<li>For non-linear relationships :::</li>
</ul>
</section>
<section id="measures-of-fit" class="level3" data-number="15.7.8">
<h3 data-number="15.7.8" class="anchored" data-anchor-id="measures-of-fit"><span class="header-section-number">15.7.8</span> Measures of Fit</h3>
<ol type="1">
<li><p><strong>R-squared (<span class="math inline">R^2</span>)</strong>: <span class="math display">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span></p></li>
<li><p><strong>Root Mean Square Error (RMSE)</strong>: <span class="math display">RMSE = \sqrt{\frac{SSE}{n}}</span></p></li>
<li><p><strong>Mean Absolute Error (MAE)</strong>: <span class="math display">MAE = \frac{1}{n}\sum_{i=1}^n |Y_i - \hat{Y}_i|</span></p></li>
</ol>
<p>Let’s calculate and visualize these measures:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate measures</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">residuals</span>(model)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">residuals</span>(model)))</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create residual plot with different measures</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> predicted, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(rmse, <span class="sc">-</span>rmse), <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(mae, <span class="sc">-</span>mae), <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residual Plot with Error Measures"</span>,</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"RMSE = %.2f (blue lines)</span><span class="sc">\n</span><span class="st">MAE = %.2f (green lines)"</span>, </span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>                         rmse, mae))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fit-measures" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fit-measures-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_en_files/figure-html/fig-fit-measures-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fit-measures-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.8: Different Measures of Model Fit
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="diagnostic-plots" class="level2" data-number="15.8">
<h2 data-number="15.8" class="anchored" data-anchor-id="diagnostic-plots"><span class="header-section-number">15.8</span> Diagnostic Plots</h2>
<section id="residual-analysis" class="level3" data-number="15.8.1">
<h3 data-number="15.8.1" class="anchored"><span class="header-section-number">15.8.1</span> Residual Analysis</h3>
<p>Four key diagnostic plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create diagnostic plots</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-diagnostics" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-diagnostics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_en_files/figure-html/fig-diagnostics-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-diagnostics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.9: Key Diagnostic Plots for Linear Regression
</figcaption>
</figure>
</div>
</div>
</div>
<p>Let’s interpret each plot:</p>
<ol type="1">
<li><strong>Residuals vs.&nbsp;Fitted</strong>:
<ul>
<li>Checks linearity assumption</li>
<li>Look for patterns/trends</li>
<li>Want random scatter around zero</li>
</ul></li>
<li><strong>Normal Q-Q Plot</strong>:
<ul>
<li>Checks normality of residuals</li>
<li>Points should follow diagonal line</li>
<li>Deviations at tails often acceptable</li>
</ul></li>
<li><strong>Scale-Location</strong>:
<ul>
<li>Checks homoscedasticity</li>
<li>Want horizontal line with random scatter</li>
<li>Helps detect changing variance</li>
</ul></li>
<li><strong>Residuals vs.&nbsp;Leverage</strong>:
<ul>
<li>Identifies influential points</li>
<li>Look for points outside Cook’s distance lines</li>
<li>Helps identify problematic observations</li>
</ul></li>
</ol>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Understanding Ordinary Least Squares (OLS) Intuitively
</div>
</div>
<div class="callout-body-container callout-body">
<section id="the-basic-problem" class="level3" data-number="15.8.2">
<h3 data-number="15.8.2" class="anchored" data-anchor-id="the-basic-problem"><span class="header-section-number">15.8.2</span> The Basic Problem</h3>
<p>Let’s start with a real-world scenario: understanding how study time affects exam performance. We collect data from your class where:</p>
<ul>
<li>Each student records their study hours (<span class="math inline">x</span>)</li>
<li>And their final exam score (<span class="math inline">y</span>)</li>
<li>So student 1 might have studied <span class="math inline">x_1 = 3</span> hours and scored <span class="math inline">y_1 = 75</span> points</li>
<li>Student 2 might have studied <span class="math inline">x_2 = 5</span> hours and scored <span class="math inline">y_2 = 82</span> points</li>
<li>And so on for all <span class="math inline">n</span> students in the class</li>
</ul>
<p>Our goal is to find a straight line that best describes this relationship. We’re trying to estimate the true relationship (which we never know exactly) using our sample of data. Let’s explore this step by step.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>study_hours <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>, <span class="dv">1</span>, <span class="dv">8</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>exam_scores <span class="ot">&lt;-</span> <span class="dv">60</span> <span class="sc">+</span> <span class="dv">5</span> <span class="sc">*</span> study_hours <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(study_hours, exam_scores)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic scatter plot with multiple lines</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> study_hours, <span class="at">y =</span> exam_scores)) <span class="sc">+</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Study Hours"</span>, <span class="at">y =</span> <span class="st">"Exam Scores"</span>,</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Your Class Data: Study Hours vs. Exam Scores"</span>) <span class="sc">+</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="what-makes-a-line-good" class="level3" data-number="15.8.3">
<h3 data-number="15.8.3" class="anchored" data-anchor-id="what-makes-a-line-good"><span class="header-section-number">15.8.3</span> What Makes a Line “Good”?</h3>
<p>Any straight line can be written in the form:</p>
<p><span class="math inline">y = \hat{\beta}_0 + \hat{\beta}_1x</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\hat{\beta}_0</span> is our estimate of the y-intercept (the predicted score for zero study hours)</li>
<li><span class="math inline">\hat{\beta}_1</span> is our estimate of the slope (how many points you gain per extra hour of study)</li>
<li>The hats (^) indicate these are our estimates of the true (unknown) parameters <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1</span></li>
</ul>
<p>Let’s look at three possible lines through our data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> study_hours, <span class="at">y =</span> exam_scores)) <span class="sc">+</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">50</span>, <span class="at">slope =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">70</span>, <span class="at">slope =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Study Hours"</span>, <span class="at">y =</span> <span class="st">"Exam Scores"</span>,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Three Different Lines: Which is Best?"</span>) <span class="sc">+</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">7.5</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">label =</span> <span class="st">"Line A: Too Steep"</span>) <span class="sc">+</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">7.5</span>, <span class="at">y =</span> <span class="dv">85</span>, <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">label =</span> <span class="st">"Line B: Too Flat"</span>) <span class="sc">+</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">7.5</span>, <span class="at">y =</span> <span class="dv">100</span>, <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">label =</span> <span class="st">"Line C: Just Right"</span>) <span class="sc">+</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="understanding-prediction-errors-residuals" class="level3" data-number="15.8.4">
<h3 data-number="15.8.4" class="anchored" data-anchor-id="understanding-prediction-errors-residuals"><span class="header-section-number">15.8.4</span> Understanding Prediction Errors (Residuals)</h3>
<p>Here’s where the magic of OLS begins. For each student in our data:</p>
<ol type="1">
<li>We look at their actual exam score (<span class="math inline">y_i</span>)</li>
<li>We calculate their predicted score using our line (<span class="math inline">\hat{y}_i = \hat{\beta}_0 + \hat{\beta}_1x_i</span>)</li>
<li>The difference between these is called a residual:</li>
</ol>
<p><span class="math inline">\text{residual}_i = y_i - \hat{y}_i = y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i)</span></p>
<p>Let’s visualize these residuals for one line:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model and show residuals</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(exam_scores <span class="sc">~</span> study_hours, <span class="at">data =</span> data)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> study_hours, <span class="at">y =</span> exam_scores)) <span class="sc">+</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> study_hours, </span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">yend =</span> <span class="fu">predict</span>(model, data)),</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Study Hours"</span>, <span class="at">y =</span> <span class="st">"Exam Scores"</span>,</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Understanding Residuals: The Gaps Between Predictions and Reality"</span>) <span class="sc">+</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The orange vertical lines show how far off our predictions are for each student. Some predictions are too high (positive residuals), others too low (negative residuals).</p>
</section>
<section id="why-do-we-square-the-residuals" class="level3" data-number="15.8.5">
<h3 data-number="15.8.5" class="anchored" data-anchor-id="why-do-we-square-the-residuals"><span class="header-section-number">15.8.5</span> Why Do We Square the Residuals?</h3>
<p>This is a crucial concept! Let’s walk through it with a simple example:</p>
<p>Imagine we have just two students:</p>
<ol type="1">
<li>Alice: Predicted 80, actual score 85 (residual = +5)</li>
<li>Bob: Predicted 90, actual score 85 (residual = -5)</li>
</ol>
<p>If we just add these residuals: <span class="math inline">(+5) + (-5) = 0</span></p>
<p>This would suggest our line is perfect (total error = 0), but we know it’s not! Both predictions were off by 5 points.</p>
<p>Solution: Square the residuals before adding them:</p>
<ul>
<li>Alice’s squared residual: <span class="math inline">(+5)^2 = 25</span></li>
<li>Bob’s squared residual: <span class="math inline">(-5)^2 = 25</span></li>
<li>Total squared error: <span class="math inline">25 + 25 = 50</span></li>
</ul>
<p>This gives us a much better measure of how wrong our predictions are!</p>
</section>
<section id="the-complete-picture-sum-of-squared-residuals-ssr" class="level3" data-number="15.8.6">
<h3 data-number="15.8.6" class="anchored" data-anchor-id="the-complete-picture-sum-of-squared-residuals-ssr"><span class="header-section-number">15.8.6</span> The Complete Picture: Sum of Squared Residuals (SSR)</h3>
<p>For all students combined, we calculate:</p>
<p><span class="math inline">SSR = \sum_{i=1}^n (y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i))^2</span></p>
<p>This formula might look scary, but it just means:</p>
<ol type="1">
<li>Take each student’s residual</li>
<li>Square it</li>
<li>Add up all these squared residuals</li>
</ol>
<p>The smaller this sum, the better our line fits the data!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare good vs bad fit</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>bad_predictions <span class="ot">&lt;-</span> <span class="dv">70</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> data<span class="sc">$</span>study_hours</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>good_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, data)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>bad_sse <span class="ot">&lt;-</span> <span class="fu">sum</span>((data<span class="sc">$</span>exam_scores <span class="sc">-</span> bad_predictions)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>good_sse <span class="ot">&lt;-</span> <span class="fu">sum</span>((data<span class="sc">$</span>exam_scores <span class="sc">-</span> good_predictions)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> study_hours, <span class="at">y =</span> exam_scores)) <span class="sc">+</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">70</span>, <span class="at">slope =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">95</span>, </span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Red Line: Total Error ="</span>, <span class="fu">round</span>(bad_sse)), </span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">90</span>, </span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Purple Line: Total Error ="</span>, <span class="fu">round</span>(good_sse)), </span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Study Hours"</span>, <span class="at">y =</span> <span class="st">"Exam Scores"</span>,</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Comparing Total Prediction Errors"</span>) <span class="sc">+</span></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="why-is-this-method-ordinary-least-squares" class="level3" data-number="15.8.7">
<h3 data-number="15.8.7" class="anchored" data-anchor-id="why-is-this-method-ordinary-least-squares"><span class="header-section-number">15.8.7</span> Why Is This Method “Ordinary Least Squares”?</h3>
<p>Let’s break down the name:</p>
<ul>
<li>“Squares”: We square the residuals</li>
<li>“Least”: We want the smallest possible total</li>
<li>“Ordinary”: This is the basic version (there are fancier versions!)</li>
</ul>
<p>The OLS line has some nice properties:</p>
<ol type="1">
<li>The mean of all residuals equals zero</li>
<li>The line always passes through the point (<span class="math inline">\bar{x}</span>, <span class="math inline">\bar{y}</span>) - the average study hours and average score</li>
<li>Small changes in the data lead to small changes in the line (it’s “stable”)</li>
<li>Our estimates <span class="math inline">\hat{\beta}_0</span> and <span class="math inline">\hat{\beta}_1</span> are the best possible estimates of the true parameters <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1</span> under certain conditions</li>
</ol>
<p><strong>Experiment with different lines and see how the total squared error changes</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(manipulate)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="fu">manipulate</span>(</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    predictions <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> data<span class="sc">$</span>study_hours</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    ssr <span class="ot">&lt;-</span> <span class="fu">sum</span>((data<span class="sc">$</span>exam_scores <span class="sc">-</span> predictions)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> study_hours, <span class="at">y =</span> exam_scores)) <span class="sc">+</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_abline</span>(<span class="at">slope =</span> b1, <span class="at">intercept =</span> b0, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Total Squared Error ="</span>, <span class="fu">round</span>(ssr, <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">b0 =</span> <span class="fu">slider</span>(<span class="dv">40</span>, <span class="dv">80</span>, <span class="at">initial =</span> <span class="dv">60</span>, <span class="at">label =</span> <span class="st">"Intercept (β̂₀)"</span>),</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">b1 =</span> <span class="fu">slider</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">initial =</span> <span class="dv">5</span>, <span class="at">label =</span> <span class="st">"Slope (β̂₁)"</span>)</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Can you find the line that gives the smallest total squared error? That’s the OLS line!</p>
</section>
<section id="important-notes" class="level3" data-number="15.8.8">
<h3 data-number="15.8.8" class="anchored" data-anchor-id="important-notes"><span class="header-section-number">15.8.8</span> Important Notes</h3>
<ol type="1">
<li><p>The hat notation (<span class="math inline">\hat{\beta}_0</span>, <span class="math inline">\hat{\beta}_1</span>) reminds us that we’re estimating the true relationship from our sample. We never know the true <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1</span> - we can only estimate them from our data.</p></li>
<li><p>OLS gives us the best possible estimates when certain conditions are met (like having randomly sampled data and a truly linear relationship).</p></li>
<li><p>The interactive tool above helps you understand what OLS does automatically: it finds the values of <span class="math inline">\hat{\beta}_0</span> and <span class="math inline">\hat{\beta}_1</span> that give us the smallest possible sum of squared residuals.</p></li>
</ol>
</section>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Formal Derivation of OLS Estimators: Step-by-Step Approach
</div>
</div>
<div class="callout-body-container callout-body">
<section id="initial-setup" class="level3" data-number="15.8.9">
<h3 data-number="15.8.9" class="anchored" data-anchor-id="initial-setup"><span class="header-section-number">15.8.9</span> Initial Setup</h3>
<p>We seek to minimize the sum of squared residuals:</p>
<p><span class="math inline">SSR = \sum_{i=1}^n (y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i))^2</span></p>
<p>Let’s break this into manageable pieces:</p>
<ol type="1">
<li>Each residual is: <span class="math inline">e_i = y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i)</span></li>
<li>We square each residual: <span class="math inline">e_i^2 = (y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i))^2</span></li>
<li>Sum them all: <span class="math inline">SSR = \sum_{i=1}^n e_i^2</span></li>
</ol>
</section>
<section id="chain-rule-review" class="level3" data-number="15.8.10">
<h3 data-number="15.8.10" class="anchored" data-anchor-id="chain-rule-review"><span class="header-section-number">15.8.10</span> Chain Rule Review</h3>
<p>Before proceeding, let’s recall the chain rule. For a composite function <span class="math inline">f(g(x))</span>:</p>
<p><span class="math inline">\frac{d}{dx}[f(g(x))] = f'(g(x)) \cdot g'(x)</span></p>
<p>In our case, we’re dealing with the square function <span class="math inline">f(u) = u^2</span>, where:</p>
<ul>
<li><span class="math inline">f'(u) = 2u</span></li>
<li><span class="math inline">u = y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i)</span></li>
</ul>
</section>
<section id="step-1-finding-hatbeta_0-using-first-derivative" class="level3" data-number="15.8.11">
<h3 data-number="15.8.11" class="anchored" data-anchor-id="step-1-finding-hatbeta_0-using-first-derivative"><span class="header-section-number">15.8.11</span> Step 1: Finding <span class="math inline">\hat{\beta}_0</span> Using First Derivative</h3>
<p>Let’s take the partial derivative with respect to <span class="math inline">\hat{\beta}_0</span> step by step:</p>
<ol type="1">
<li><p>Start with one term of the sum:</p>
<p><span class="math inline">\frac{\partial}{\partial \hat{\beta}_0}(y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i))^2</span></p></li>
<li><p>Apply chain rule:</p>
<ul>
<li>Outer function: <span class="math inline">f(u) = u^2</span>, so <span class="math inline">f'(u) = 2u</span></li>
<li>Inner function: <span class="math inline">g(\hat{\beta}_0) = y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i)</span></li>
<li>Inner derivative: <span class="math inline">g'(\hat{\beta}_0) = -1</span></li>
</ul></li>
<li><p>Therefore, for each term: <span class="math inline">\frac{\partial}{\partial \hat{\beta}_0}(y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i))^2 = 2(y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i))(-1)</span></p></li>
<li><p>Now sum all terms and set to zero: <span class="math inline">\sum_{i=1}^n 2(y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i))(-1) = 0</span></p></li>
<li><p>Simplify: <span class="math inline">-2\sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1x_i) = 0</span></p></li>
<li><p>Remove the -2: <span class="math inline">\sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1x_i) = 0</span></p></li>
<li><p>Expand the sum: <span class="math inline">\sum_{i=1}^n y_i - n\hat{\beta}_0 - \hat{\beta}_1\sum_{i=1}^n x_i = 0</span></p></li>
<li><p>Solve for <span class="math inline">\hat{\beta}_0</span>: <span class="math inline">n\hat{\beta}_0 = \sum_{i=1}^n y_i - \hat{\beta}_1\sum_{i=1}^n x_i</span></p>
<p><span class="math inline">\hat{\beta}_0 = \frac{\sum_{i=1}^n y_i}{n} - \hat{\beta}_1\frac{\sum_{i=1}^n x_i}{n}</span></p>
<p><span class="math inline">\hat{\beta}_0 = \bar{y} - \hat{\beta}_1\bar{x}</span></p></li>
</ol>
</section>
<section id="step-2-finding-hatbeta_1-using-first-derivative" class="level3" data-number="15.8.12">
<h3 data-number="15.8.12" class="anchored" data-anchor-id="step-2-finding-hatbeta_1-using-first-derivative"><span class="header-section-number">15.8.12</span> Step 2: Finding <span class="math inline">\hat{\beta}_1</span> Using First Derivative</h3>
<p>Now let’s find <span class="math inline">\hat{\beta}_1</span> with the same careful approach:</p>
<ol type="1">
<li><p>For one term: <span class="math inline">\frac{\partial}{\partial \hat{\beta}_1}(y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i))^2</span></p></li>
<li><p>Apply chain rule:</p>
<ul>
<li>Outer function: <span class="math inline">f(u) = u^2</span>, so <span class="math inline">f'(u) = 2u</span></li>
<li>Inner function: <span class="math inline">g(\hat{\beta}_1) = y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i)</span></li>
<li>Inner derivative: <span class="math inline">g'(\hat{\beta}_1) = -x_i</span></li>
</ul></li>
<li><p>Therefore: <span class="math inline">\frac{\partial}{\partial \hat{\beta}_1}(y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i))^2 = 2(y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i))(-x_i)</span></p></li>
<li><p>Sum all terms and set to zero: <span class="math inline">\sum_{i=1}^n 2(y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i))(-x_i) = 0</span></p></li>
<li><p>Simplify: <span class="math inline">-2\sum_{i=1}^n x_i(y_i - \hat{\beta}_0 - \hat{\beta}_1x_i) = 0</span></p></li>
<li><p>Substitute <span class="math inline">\hat{\beta}_0 = \bar{y} - \hat{\beta}_1\bar{x}</span>: <span class="math inline">-2\sum_{i=1}^n x_i(y_i - (\bar{y} - \hat{\beta}_1\bar{x}) - \hat{\beta}_1x_i) = 0</span></p></li>
<li><p>Expand: <span class="math inline">-2\sum_{i=1}^n x_i(y_i - \bar{y} + \hat{\beta}_1\bar{x} - \hat{\beta}_1x_i) = 0</span></p></li>
<li><p>Distribute <span class="math inline">x_i</span>: <span class="math inline">-2\sum_{i=1}^n (x_iy_i - x_i\bar{y} + x_i\hat{\beta}_1\bar{x} - x_i^2\hat{\beta}_1) = 0</span></p></li>
<li><p>Collect terms with <span class="math inline">\hat{\beta}_1</span>: <span class="math inline">\sum_{i=1}^n (x_i^2\hat{\beta}_1 - x_i\hat{\beta}_1\bar{x}) = \sum_{i=1}^n (x_iy_i - x_i\bar{y})</span></p></li>
<li><p>Factor out <span class="math inline">\hat{\beta}_1</span>: <span class="math inline">\hat{\beta}_1\sum_{i=1}^n (x_i^2 - x_i\bar{x}) = \sum_{i=1}^n (x_iy_i - x_i\bar{y})</span></p></li>
<li><p>Final form: <span class="math inline">\hat{\beta}_1 = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^n (x_i - \bar{x})^2}</span></p></li>
</ol>
</section>
<section id="step-3-verifying-we-have-a-minimum" class="level3" data-number="15.8.13">
<h3 data-number="15.8.13" class="anchored" data-anchor-id="step-3-verifying-we-have-a-minimum"><span class="header-section-number">15.8.13</span> Step 3: Verifying We Have a Minimum</h3>
<p>To confirm these critical points are minima, we check the second derivatives:</p>
<ol type="1">
<li><p>Second derivative with respect to <span class="math inline">\hat{\beta}_0</span>: <span class="math inline">\frac{\partial^2 SSR}{\partial \hat{\beta}_0^2} = \frac{\partial}{\partial \hat{\beta}_0}(-2\sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1x_i)) = 2n &gt; 0</span></p></li>
<li><p>Second derivative with respect to <span class="math inline">\hat{\beta}_1</span>: <span class="math inline">\frac{\partial^2 SSR}{\partial \hat{\beta}_1^2} = \frac{\partial}{\partial \hat{\beta}_1}(-2\sum_{i=1}^n x_i(y_i - \hat{\beta}_0 - \hat{\beta}_1x_i)) = 2\sum_{i=1}^n x_i^2 &gt; 0</span></p></li>
<li><p>Cross partial derivatives: <span class="math inline">\frac{\partial^2 SSR}{\partial \hat{\beta}_0\partial \hat{\beta}_1} = \frac{\partial^2 SSR}{\partial \hat{\beta}_1\partial \hat{\beta}_0} = 2\sum_{i=1}^n x_i</span></p></li>
<li><p>The Hessian matrix is positive definite: <span class="math inline">\mathbf{H} = \begin{bmatrix} 2n &amp; 2\sum x_i \\ 2\sum x_i &amp; 2\sum x_i^2 \end{bmatrix}</span></p></li>
</ol>
<p>This confirms we have found a minimum.</p>
</section>
<section id="visualizing-the-process" class="level3" data-number="15.8.14">
<h3 data-number="15.8.14" class="anchored" data-anchor-id="visualizing-the-process"><span class="header-section-number">15.8.14</span> Visualizing the Process</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>, <span class="dv">1</span>, <span class="dv">8</span>)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate means</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>x_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>y_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualization</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> y_mean, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> x_mean, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> x, <span class="at">yend =</span> y_mean), <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">yend =</span> y, <span class="at">xend =</span> x_mean), <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Understanding the OLS Derivation"</span>,</span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Green: y deviations, Purple: x deviations</span><span class="sc">\n</span><span class="st">Their product forms the numerator of β̂₁"</span>,</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="key-insights" class="level3" data-number="15.8.15">
<h3 data-number="15.8.15" class="anchored" data-anchor-id="key-insights"><span class="header-section-number">15.8.15</span> Key Insights</h3>
<ol type="1">
<li>The chain rule is crucial in deriving both estimators</li>
<li><span class="math inline">\hat{\beta}_0</span> ensures the line goes through <span class="math inline">(\bar{x}, \bar{y})</span></li>
<li><span class="math inline">\hat{\beta}_1</span> is a ratio of covariance to variance</li>
<li>The second derivatives confirm we’ve found a minimum</li>
<li>The entire process relies on calculus to find the optimal values that minimize the sum of squared residuals</li>
</ol>
</section>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Understanding Variance Decomposition in Linear Regression
</div>
</div>
<div class="callout-body-container callout-body">
<section id="why-it-matters-improving-predictions-with-extra-information" class="level3" data-number="15.8.16">
<h3 data-number="15.8.16" class="anchored" data-anchor-id="why-it-matters-improving-predictions-with-extra-information"><span class="header-section-number">15.8.16</span> Why It Matters: Improving Predictions with Extra Information</h3>
<p>Imagine you’re trying to predict house prices. A simple way to make predictions is by using the average price of all houses. But what if you know additional details, like the size of the house? Would that help improve your predictions? <strong>Variance decomposition</strong> helps us measure exactly how much better our predictions are when we include more information, like house size.</p>
</section>
<section id="the-process-from-a-simple-guess-to-a-smarter-prediction" class="level3" data-number="15.8.17">
<h3 data-number="15.8.17" class="anchored" data-anchor-id="the-process-from-a-simple-guess-to-a-smarter-prediction"><span class="header-section-number">15.8.17</span> The Process: From a Simple Guess to a Smarter Prediction</h3>
<section id="step-1-starting-with-the-average" class="level4" data-number="15.8.17.1">
<h4 data-number="15.8.17.1" class="anchored" data-anchor-id="step-1-starting-with-the-average"><span class="header-section-number">15.8.17.1</span> Step 1: Starting with the Average</h4>
<ul>
<li><strong>What’s our first guess?</strong> The mean of all house prices (<span class="math inline">\bar{y}</span>).</li>
<li>Think of this as your “uninformed guess.”</li>
<li>For every house, we predict the same price (the average), which leads to our <strong>baseline errors</strong>.</li>
</ul>
</section>
<section id="step-2-using-extra-information" class="level4" data-number="15.8.17.2">
<h4 data-number="15.8.17.2" class="anchored" data-anchor-id="step-2-using-extra-information"><span class="header-section-number">15.8.17.2</span> Step 2: Using Extra Information</h4>
<ul>
<li>We now use additional information (like house size, <span class="math inline">X</span>) to refine our predictions.</li>
<li>This allows us to make <strong>different predictions</strong> for each house.</li>
<li>The errors we make after including this information are usually smaller.</li>
</ul>
</section>
</section>
<section id="visualizing-variance-decomposition" class="level3" data-number="15.8.18">
<h3 data-number="15.8.18" class="anchored" data-anchor-id="visualizing-variance-decomposition"><span class="header-section-number">15.8.18</span> Visualizing Variance Decomposition</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'patchwork'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    area</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data with clearer pattern</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">sd =</span> <span class="fl">0.8</span>)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model and calculations</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, data)</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>mean_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Select specific points for demonstration that are well-spaced</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>demonstration_points <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">25</span>, <span class="dv">42</span>)  <span class="co"># Changed points for better spacing</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create main plot with improved aesthetics</span></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add background grid for better readability</span></span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="at">by =</span> <span class="fl">0.5</span>), <span class="at">color =</span> <span class="st">"gray90"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.5</span>), <span class="at">color =</span> <span class="st">"gray90"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add regression line and mean line</span></span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#E41A1C"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_y, <span class="at">linetype =</span> <span class="st">"longdash"</span>, <span class="at">color =</span> <span class="st">"#377EB8"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add data points</span></span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"#4A4A4A"</span>) <span class="sc">+</span></span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add decomposition segments with improved colors and positioning</span></span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total deviation (purple)</span></span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> data[demonstration_points,],</span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> x, <span class="at">y =</span> y, <span class="at">yend =</span> mean_y),</span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#984EA3"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">1.8</span>) <span class="sc">+</span></span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Explained component (green)</span></span>
<span id="cb77-34"><a href="#cb77-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> data[demonstration_points,],</span>
<span id="cb77-35"><a href="#cb77-35" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> x, <span class="at">y =</span> mean_y, <span class="at">yend =</span> predicted),</span>
<span id="cb77-36"><a href="#cb77-36" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#4DAF4A"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb77-37"><a href="#cb77-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Unexplained component (orange)</span></span>
<span id="cb77-38"><a href="#cb77-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> data[demonstration_points,],</span>
<span id="cb77-39"><a href="#cb77-39" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> x, <span class="at">y =</span> predicted, <span class="at">yend =</span> y),</span>
<span id="cb77-40"><a href="#cb77-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#FF7F00"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb77-41"><a href="#cb77-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-42"><a href="#cb77-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add annotations for better understanding</span></span>
<span id="cb77-43"><a href="#cb77-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> data<span class="sc">$</span>x[demonstration_points[<span class="dv">2</span>]], <span class="at">y =</span> mean_y <span class="sc">-</span> <span class="fl">0.2</span>,</span>
<span id="cb77-44"><a href="#cb77-44" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Mean"</span>, <span class="at">color =</span> <span class="st">"#377EB8"</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb77-45"><a href="#cb77-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> data<span class="sc">$</span>x[demonstration_points[<span class="dv">2</span>]], </span>
<span id="cb77-46"><a href="#cb77-46" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> data<span class="sc">$</span>predicted[demonstration_points[<span class="dv">2</span>]] <span class="sc">+</span> <span class="fl">0.2</span>,</span>
<span id="cb77-47"><a href="#cb77-47" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Regression Line"</span>, <span class="at">color =</span> <span class="st">"#E41A1C"</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb77-48"><a href="#cb77-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-49"><a href="#cb77-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Improve theme and labels</span></span>
<span id="cb77-50"><a href="#cb77-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb77-51"><a href="#cb77-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb77-52"><a href="#cb77-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb77-53"><a href="#cb77-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb77-54"><a href="#cb77-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb77-55"><a href="#cb77-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb77-56"><a href="#cb77-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb77-57"><a href="#cb77-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb77-58"><a href="#cb77-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Variance Decomposition in Linear Regression"</span>,</span>
<span id="cb77-59"><a href="#cb77-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Decomposing total variance into explained and unexplained components"</span>,</span>
<span id="cb77-60"><a href="#cb77-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Predictor (X)"</span>,</span>
<span id="cb77-61"><a href="#cb77-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Response (Y)"</span></span>
<span id="cb77-62"><a href="#cb77-62" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb77-63"><a href="#cb77-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-64"><a href="#cb77-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Create error distribution plot with improved aesthetics</span></span>
<span id="cb77-65"><a href="#cb77-65" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>mean_error <span class="ot">&lt;-</span> y <span class="sc">-</span> mean_y</span>
<span id="cb77-66"><a href="#cb77-66" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>regression_error <span class="ot">&lt;-</span> y <span class="sc">-</span> data<span class="sc">$</span>predicted</span>
<span id="cb77-67"><a href="#cb77-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-68"><a href="#cb77-68" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data) <span class="sc">+</span></span>
<span id="cb77-69"><a href="#cb77-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_error, <span class="at">fill =</span> <span class="st">"Deviation from Mean"</span>), </span>
<span id="cb77-70"><a href="#cb77-70" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb77-71"><a href="#cb77-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> regression_error, <span class="at">fill =</span> <span class="st">"Regression Residuals"</span>), </span>
<span id="cb77-72"><a href="#cb77-72" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb77-73"><a href="#cb77-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb77-74"><a href="#cb77-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb77-75"><a href="#cb77-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb77-76"><a href="#cb77-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()</span>
<span id="cb77-77"><a href="#cb77-77" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb77-78"><a href="#cb77-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb77-79"><a href="#cb77-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Error Distribution Comparison"</span>,</span>
<span id="cb77-80"><a href="#cb77-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Error Magnitude"</span>,</span>
<span id="cb77-81"><a href="#cb77-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb77-82"><a href="#cb77-82" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb77-83"><a href="#cb77-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb77-84"><a href="#cb77-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#377EB8"</span>, <span class="st">"#E41A1C"</span>)</span>
<span id="cb77-85"><a href="#cb77-85" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb77-86"><a href="#cb77-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-87"><a href="#cb77-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend explaining the decomposition components</span></span>
<span id="cb77-88"><a href="#cb77-88" aria-hidden="true" tabindex="-1"></a>legend_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb77-89"><a href="#cb77-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb77-90"><a href="#cb77-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb77-91"><a href="#cb77-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb77-92"><a href="#cb77-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">"horizontal"</span></span>
<span id="cb77-93"><a href="#cb77-93" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb77-94"><a href="#cb77-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">label =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb77-95"><a href="#cb77-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb77-96"><a href="#cb77-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Variance Components"</span>,</span>
<span id="cb77-97"><a href="#cb77-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#984EA3"</span>, <span class="st">"#4DAF4A"</span>, <span class="st">"#FF7F00"</span>),</span>
<span id="cb77-98"><a href="#cb77-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Total Deviation"</span>, <span class="st">"Explained Variance"</span>, <span class="st">"Unexplained Variance"</span>)</span>
<span id="cb77-99"><a href="#cb77-99" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb77-100"><a href="#cb77-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-101"><a href="#cb77-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots with adjusted heights</span></span>
<span id="cb77-102"><a href="#cb77-102" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> (p1 <span class="sc">/</span> p2) <span class="sc">+</span></span>
<span id="cb77-103"><a href="#cb77-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb77-104"><a href="#cb77-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-105"><a href="#cb77-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb77-106"><a href="#cb77-106" aria-hidden="true" tabindex="-1"></a>combined_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="breaking-down-the-types-of-variation" class="level3" data-number="15.8.19">
<h3 data-number="15.8.19" class="anchored" data-anchor-id="breaking-down-the-types-of-variation"><span class="header-section-number">15.8.19</span> Breaking Down the Types of Variation</h3>
<ol type="1">
<li><strong>Total Variation (SST)</strong>
<ul>
<li><strong>Question:</strong> How much do the data points vary from the mean?</li>
<li><strong>Formula:</strong> <span class="math inline">SST = \sum(y_i - \bar{y})^2</span></li>
<li><strong>Visual:</strong> Purple points in the plot</li>
<li><strong>Intuition:</strong> This is the overall “spread” of the data around its average.</li>
</ul></li>
<li><strong>Explained Variation (SSR)</strong>
<ul>
<li><strong>Question:</strong> How much of the variation can our model explain?</li>
<li><strong>Formula:</strong> <span class="math inline">SSR = \sum(\hat{y}_i - \bar{y})^2</span></li>
<li><strong>Visual:</strong> Green dashed lines in the plot</li>
<li><strong>Intuition:</strong> This is the improvement we get from including additional information (like house size).</li>
</ul></li>
<li><strong>Unexplained Variation (SSE)</strong>
<ul>
<li><strong>Question:</strong> How much variation is left unexplained after using the model?</li>
<li><strong>Formula:</strong> <span class="math inline">SSE = \sum(y_i - \hat{y}_i)^2</span></li>
<li><strong>Visual:</strong> Orange dashed lines in the plot</li>
<li><strong>Intuition:</strong> These are the errors remaining after our model has made predictions.</li>
</ul></li>
</ol>
</section>
<section id="what-is-r²" class="level3" data-number="15.8.20">
<h3 data-number="15.8.20" class="anchored" data-anchor-id="what-is-r²"><span class="header-section-number">15.8.20</span> What is R²?</h3>
<p><span class="math inline">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span></p>
<p>Think of <span class="math inline">R^2</span> as answering: “What percentage of the original variation in the data can we explain using our model?”</p>
<section id="examples-of-r2-values" class="level4" data-number="15.8.20.1">
<h4 data-number="15.8.20.1" class="anchored" data-anchor-id="examples-of-r2-values"><span class="header-section-number">15.8.20.1</span> Examples of <span class="math inline">R^2</span> Values:</h4>
<ul>
<li><strong><span class="math inline">R^2 = 0.80</span></strong>: Our model explains 80% of the variation in house prices.</li>
<li><strong><span class="math inline">R^2 = 0.25</span></strong>: Our model explains 25% of the variation (a weaker model).</li>
<li><strong><span class="math inline">R^2 = 0.00</span></strong>: Our model explains none of the variation (not helpful).</li>
</ul>
</section>
</section>
<section id="important-things-to-remember-about-r²" class="level3" data-number="15.8.21">
<h3 data-number="15.8.21" class="anchored" data-anchor-id="important-things-to-remember-about-r²"><span class="header-section-number">15.8.21</span> Important Things to Remember About R²</h3>
<ol type="1">
<li><strong>High <span class="math inline">R^2</span> Isn’t Always Good</strong>
<ul>
<li>A very high <span class="math inline">R^2</span> could suggest <strong>overfitting</strong>. Your model might be too complex, capturing noise rather than real patterns.</li>
<li>Always <strong>interpret <span class="math inline">R^2</span> in the context</strong> of your data.</li>
</ul></li>
<li><strong>Low <span class="math inline">R^2</span> Isn’t Always Bad</strong>
<ul>
<li>In some fields (like social sciences), a low <span class="math inline">R^2</span> can still be useful.</li>
<li>Focus on <strong>practical significance</strong>, not just the <span class="math inline">R^2</span> value.</li>
</ul></li>
<li><strong>Consider Sample Size</strong>
<ul>
<li>For multiple regression models, use <strong>adjusted <span class="math inline">R^2</span></strong> to account for the number of predictors.</li>
<li>Formula: <span class="math inline">R^2_{adj} = 1 - \frac{SSE/(n-p)}{SST/(n-1)}</span></li>
</ul></li>
</ol>
</section>
<section id="tips-for-effective-analysis" class="level3" data-number="15.8.22">
<h3 data-number="15.8.22" class="anchored" data-anchor-id="tips-for-effective-analysis"><span class="header-section-number">15.8.22</span> Tips for Effective Analysis</h3>
<ol type="1">
<li><strong>Visualize the Data</strong>
<ul>
<li>Plot your data and residuals to spot patterns.</li>
<li><strong>Check for influential points</strong> that could skew your results.</li>
</ul></li>
<li><strong>Understand Your Field’s Context</strong>
<ul>
<li>What’s considered a good <span class="math inline">R^2</span> value in your field?</li>
<li>What’s the <strong>practical impact</strong> of the errors you’re seeing?</li>
</ul></li>
<li><strong>Run Diagnostics</strong>
<ul>
<li>Check residuals for normality.</li>
<li>Look for <strong>heteroscedasticity</strong> (changing variability of errors).</li>
<li>Watch for <strong>influential data points</strong> that affect the model’s accuracy.</li>
</ul></li>
</ol>
</section>
<section id="key-takeaways-1" class="level3" data-number="15.8.23">
<h3 data-number="15.8.23" class="anchored" data-anchor-id="key-takeaways-1"><span class="header-section-number">15.8.23</span> Key Takeaways</h3>
<ol type="1">
<li>Variance decomposition explains how prediction improves with more information.</li>
<li><span class="math inline">R^2</span> shows how much of the total variation is explained by the model.</li>
<li><strong>Visualizing data</strong> is key to understanding regression performance.</li>
<li>Context is more important than just looking at <span class="math inline">R^2</span> values.</li>
<li>Always use <strong>diagnostic tools</strong> along with <span class="math inline">R^2</span> to evaluate your model’s quality.</li>
</ol>
</section>
<section id="further-reading-1" class="level3" data-number="15.8.24">
<h3 data-number="15.8.24" class="anchored" data-anchor-id="further-reading-1"><span class="header-section-number">15.8.24</span> Further Reading</h3>
<ul>
<li>Explore advanced topics like <strong>vector spaces</strong> and <strong>projections</strong>.</li>
<li>Learn about <strong>multiple regression</strong> techniques and <strong>robust methods</strong>.</li>
<li>Understand <strong>non-linear relationships</strong> in regression models.</li>
</ul>
</section>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Understanding Endogeneity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Think of endogeneity as a “hidden relationship problem” in your analysis. It’s like trying to solve a puzzle while some pieces are affecting each other in ways you can’t see directly. In technical terms, endogeneity occurs when an explanatory variable in a regression model is correlated with the error term, but let’s understand this intuitively!</p>
<ol type="1">
<li>Omitted Variable Bias (OVB)</li>
</ol>
<p>Think of it like trying to understand why some plants grow taller than others, and you only measure the amount of water they receive. But you forgot about sunlight, which affects both how much water the plant needs AND how tall it grows!</p>
<p><strong>Real-Life Example: Education and Income</strong> * What we see: More education → Higher income * What we might miss: Natural talent/ability - Affects how long people stay in school - Affects how much they can earn * Result: We might overestimate how much education helps</p>
<p><strong>The Math Behind It</strong> (don’t worry, this helps visualize!): * True picture: <span class="math inline">y_i = \beta_0 + \beta_1x_i + \beta_2z_i + \epsilon_i</span><br>
* What we actually estimate: <span class="math inline">y_i = \beta_0 + \beta_1x_i + u_i</span><br>
* Think of it like a recipe: If you forget an important ingredient (z), your final dish (y) won’t turn out as expected!</p>
<ol start="2" type="1">
<li>Simultaneity (Reverse Causation)</li>
</ol>
<p>Remember the chicken and egg problem? Sometimes two things affect each other at the same time. Here are some examples you might encounter:</p>
<p><strong>a) The Study Hours Puzzle</strong> * Do better grades lead to studying more? * Or does studying more lead to better grades? * Actually… both! They affect each other</p>
<p><strong>b) The Social Media Effect</strong> * More followers → More posts * More posts → More followers * It’s a continuous cycle!</p>
<p><strong>c) The Exercise-Energy Cycle</strong> * More exercise → More energy * More energy → More likely to exercise * Think of it like two friends pushing each other on swings!</p>
<ol start="3" type="1">
<li>Measurement Error</li>
</ol>
<p>Imagine trying to measure your height while standing on an uneven floor - your measurements won’t be quite right! Here’s how this shows up in real life:</p>
<p><strong>Examples You’ll Recognize:</strong> * Self-Reported Study Time - “I study 5 hours a day” might really mean 3-4 hours - Makes it hard to know true impact on grades * Fitness App Tracking - App says you burned 500 calories - Actually might be 400 or 600 - Affects analysis of exercise impact</p>
<section id="how-to-spot-these-problems-in-your-own-research" class="level4" data-number="15.8.24.1">
<h4 data-number="15.8.24.1" class="anchored" data-anchor-id="how-to-spot-these-problems-in-your-own-research"><span class="header-section-number">15.8.24.1</span> How to Spot These Problems in Your Own Research?</h4>
<p><strong>1. For Omitted Variables, Ask:</strong> * What else could affect both variables? * Am I missing any obvious factors? * What would my parents/friends say influences this?</p>
<p><strong>2. For Simultaneity, Consider:</strong> * Could A cause B, or could B cause A? * Might they affect each other? * What happened first? (if you can tell)</p>
<p><strong>3. For Measurement Error, Think:</strong> * How accurate are my measurements? * Are people likely to report truthfully? * What might cause measurement problems?</p>
<p><strong>Simple Solutions</strong></p>
<p><strong>1. For Omitted Variables:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instead of:</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co"># simple_model &lt;- lm(grades ~ study_hours)</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Try:</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="co"># better_model &lt;- lm(grades ~ study_hours + sleep_hours + stress_level + prior_knowledge)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>2. For Simultaneity:</strong> * Look for “external” factors that affect only one variable * Consider time lags * Use natural experiments when possible</p>
<p><strong>3. For Measurement Error:</strong> * Use multiple measurements * Find more reliable data sources * Acknowledge uncertainty in your conclusions</p>
</section>
<section id="key-takeaways-for-students" class="level4" data-number="15.8.24.2">
<h4 data-number="15.8.24.2" class="anchored" data-anchor-id="key-takeaways-for-students"><span class="header-section-number">15.8.24.2</span> Key Takeaways for Students</h4>
<ol type="1">
<li><strong>Reality is Complex</strong>
<ul>
<li>Most relationships aren’t simple A → B</li>
<li>Look for hidden factors</li>
<li>Consider two-way relationships</li>
</ul></li>
<li><strong>Always Ask</strong>
<ul>
<li>“What am I missing?”</li>
<li>“Could these affect each other?”</li>
<li>“How well am I measuring things?”</li>
</ul></li>
<li><strong>When Writing Papers</strong>
<ul>
<li>Discuss potential endogeneity</li>
<li>Explain how you addressed it</li>
<li>Be honest about limitations</li>
</ul></li>
</ol>
</section>
<section id="recommended-reading" class="level2" data-number="15.9">
<h2 data-number="15.9" class="anchored" data-anchor-id="recommended-reading"><span class="header-section-number">15.9</span> Recommended Reading</h2>
<ol type="1">
<li>“Mastering Metrics” by Angrist &amp; Pischke</li>
<li>“Naked Statistics” by Charles Wheelan</li>
</ol>
<p>Remember: In the real world, relationships are usually more complex than they first appear. When you find a connection between A and B, always ask what else might be going on behind the scenes!</p>
</section>
</div>
</div>
</section>
</section>
<section id="multiple-regression" class="level2" data-number="15.10">
<h2 data-number="15.10" class="anchored" data-anchor-id="multiple-regression"><span class="header-section-number">15.10</span> Multiple Regression (*)</h2>
<section id="extending-to-multiple-predictors" class="level3" data-number="15.10.1">
<h3 data-number="15.10.1" class="anchored" data-anchor-id="extending-to-multiple-predictors"><span class="header-section-number">15.10.1</span> Extending to Multiple Predictors</h3>
<p>The multiple regression model extends our simple model to include several predictors:</p>
<p>Population Model: <span class="math display">Y = \beta_0 + \beta_1X_1 + \beta_2X_2 + ... + \beta_kX_k + \varepsilon</span></p>
<p>Sample Estimation: <span class="math display">\hat{Y} = \hat{\beta}_0 + \hat{\beta}_1X_1 + \hat{\beta}_2X_2 + ... + \hat{\beta}_kX_k</span></p>
<p>Let’s create an example with multiple predictors:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data with two predictors</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">105</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>X1 <span class="sc">+</span> <span class="fl">0.8</span><span class="sc">*</span>X2 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>data_multiple <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y =</span> Y, <span class="at">X1 =</span> X1, <span class="at">X2 =</span> X2)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit multiple regression model</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>model_multiple <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2, <span class="at">data =</span> data_multiple)</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 3D visualization using scatter plots</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_multiple, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Y vs X1"</span>)</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_multiple, <span class="fu">aes</span>(<span class="at">x =</span> X2, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Y vs X2"</span>)</span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_en_files/figure-html/multiple-regression-example-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Multiple Regression Example</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_multiple)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Y ~ X1 + X2, data = data_multiple)

Residuals:
     Min       1Q   Median       3Q      Max 
-10.8598  -3.6005   0.1166   3.0892  14.6102 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 11.77567    4.01351   2.934  0.00418 ** 
X1           0.45849    0.05992   7.651 1.47e-11 ***
X2           0.81639    0.11370   7.180 1.42e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.122 on 97 degrees of freedom
Multiple R-squared:  0.5062,    Adjusted R-squared:  0.4961 
F-statistic: 49.72 on 2 and 97 DF,  p-value: 1.367e-15</code></pre>
</div>
</div>
</section>
<section id="interpretation-of-coefficients" class="level3" data-number="15.10.2">
<h3 data-number="15.10.2" class="anchored" data-anchor-id="interpretation-of-coefficients"><span class="header-section-number">15.10.2</span> Interpretation of Coefficients</h3>
<p>In multiple regression, each <span class="math inline">\hat{\beta}_k</span> represents the expected change in Y for a one-unit increase in <span class="math inline">X_k</span>, holding all other variables constant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction grid for X1 (holding X2 at its mean)</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>X1_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X1), <span class="fu">max</span>(X1), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>pred_data_X1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">X1 =</span> X1_grid,</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">X2 =</span> <span class="fu">mean</span>(X2)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>pred_data_X1<span class="sc">$</span>Y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_multiple, <span class="at">newdata =</span> pred_data_X1)</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction grid for X2 (holding X1 at its mean)</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>X2_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X2), <span class="fu">max</span>(X2), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>pred_data_X2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">X1 =</span> <span class="fu">mean</span>(X1),</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">X2 =</span> X2_grid</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>pred_data_X2<span class="sc">$</span>Y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_multiple, <span class="at">newdata =</span> pred_data_X2)</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot partial effects</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_multiple, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pred_data_X1, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> Y_pred), </span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Partial Effect of X1"</span>,</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"(X2 held at mean ="</span>, <span class="fu">round</span>(<span class="fu">mean</span>(X2), <span class="dv">2</span>), <span class="st">")"</span>))</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_multiple, <span class="fu">aes</span>(<span class="at">x =</span> X2, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pred_data_X2, <span class="fu">aes</span>(<span class="at">x =</span> X2, <span class="at">y =</span> Y_pred), </span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Partial Effect of X2"</span>,</span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"(X1 held at mean ="</span>, <span class="fu">round</span>(<span class="fu">mean</span>(X1), <span class="dv">2</span>), <span class="st">")"</span>))</span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_en_files/figure-html/coefficient-interpretation-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Partial Effects in Multiple Regression</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="multicollinearity" class="level3" data-number="15.10.3">
<h3 data-number="15.10.3" class="anchored" data-anchor-id="multicollinearity"><span class="header-section-number">15.10.3</span> Multicollinearity</h3>
<p>Multicollinearity occurs when predictors are highly correlated. Let’s demonstrate its effects:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data with multicollinearity</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">106</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>X1_new <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>X2_new <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>X1_new <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)  <span class="co"># X2 highly correlated with X1</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>Y_new <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>X1_new <span class="sc">+</span> <span class="fl">0.8</span><span class="sc">*</span>X2_new <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>data_collinear <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y =</span> Y_new, <span class="at">X1 =</span> X1_new, <span class="at">X2 =</span> X2_new)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model with multicollinearity</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>model_collinear <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2, <span class="at">data =</span> data_collinear)</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate VIF</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    some</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:psych':

    logit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>vif_results <span class="ot">&lt;-</span> <span class="fu">vif</span>(model_collinear)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot correlation</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_collinear, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2)) <span class="sc">+</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Correlation between Predictors"</span>,</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Correlation ="</span>, </span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">round</span>(<span class="fu">cor</span>(X1_new, X2_new), <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_en_files/figure-html/multicollinearity-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Effects of Multicollinearity</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="advanced-topics" class="level2" data-number="15.11">
<h2 data-number="15.11" class="anchored" data-anchor-id="advanced-topics"><span class="header-section-number">15.11</span> Advanced Topics</h2>
<section id="interaction-terms" class="level3" data-number="15.11.1">
<h3 data-number="15.11.1" class="anchored" data-anchor-id="interaction-terms"><span class="header-section-number">15.11.1</span> Interaction Terms</h3>
<p>Interaction terms allow the effect of one predictor to depend on another:</p>
<p><span class="math display">Y = \beta_0 + \beta_1X_1 + \beta_2X_2 + \beta_3(X_1 \times X_2) + \varepsilon</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data with interaction</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">107</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>X1_int <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>X2_int <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>Y_int <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>X1_int <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>X2_int <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>X1_int<span class="sc">*</span>X2_int <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>data_int <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X1 =</span> X1_int, <span class="at">X2 =</span> X2_int, <span class="at">Y =</span> Y_int)</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>model_int <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">*</span> X2, <span class="at">data =</span> data_int)</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create interaction plot</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>X1_levels <span class="ot">&lt;-</span> <span class="fu">quantile</span>(X1_int, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>X2_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X2_int), <span class="fu">max</span>(X2_int), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">X1 =</span> X1_levels,</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">X2 =</span> X2_seq</span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>pred_data<span class="sc">$</span>Y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_int, <span class="at">newdata =</span> pred_data)</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>pred_data<span class="sc">$</span>X1_level <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_data<span class="sc">$</span>X1, </span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low X1"</span>, <span class="st">"High X1"</span>))</span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_data, <span class="fu">aes</span>(<span class="at">x =</span> X2, <span class="at">y =</span> Y_pred, <span class="at">color =</span> X1_level)) <span class="sc">+</span></span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Interaction Effect"</span>,</span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Effect of X2 depends on level of X1"</span>,</span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"X1 Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_en_files/figure-html/interactions-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Visualization of Interaction Effects</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="polynomial-terms" class="level3" data-number="15.11.2">
<h3 data-number="15.11.2" class="anchored" data-anchor-id="polynomial-terms"><span class="header-section-number">15.11.2</span> Polynomial Terms</h3>
<p>When relationships are non-linear, we can add polynomial terms:</p>
<p><span class="math display">Y = \beta_0 + \beta_1X + \beta_2X^2 + \varepsilon</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data with quadratic relationship</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">108</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>X_poly <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>Y_poly <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>X_poly <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>X_poly<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(X_poly), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>data_poly <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> X_poly, <span class="at">Y =</span> Y_poly)</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear and quadratic models</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>model_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> data_poly)</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>model_quad <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X <span class="sc">+</span> <span class="fu">I</span>(X<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> data_poly)</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Add predictions</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>data_poly<span class="sc">$</span>pred_linear <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_linear)</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>data_poly<span class="sc">$</span>pred_quad <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_quad)</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_poly, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_linear, <span class="at">color =</span> <span class="st">"Linear"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_quad, <span class="at">color =</span> <span class="st">"Quadratic"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Linear vs. Quadratic Fit"</span>,</span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Model Type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_en_files/figure-html/polynomial-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Polynomial Regression Example</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="practical-guidelines-for-regression-analysis" class="level2" data-number="15.12">
<h2 data-number="15.12" class="anchored" data-anchor-id="practical-guidelines-for-regression-analysis"><span class="header-section-number">15.12</span> Practical Guidelines for Regression Analysis</h2>
<section id="model-building-process" class="level3" data-number="15.12.1">
<h3 data-number="15.12.1" class="anchored" data-anchor-id="model-building-process"><span class="header-section-number">15.12.1</span> Model Building Process</h3>
<ol type="1">
<li><strong>Data Exploration</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate example dataset</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">109</span>)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>data_example <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x1 =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">x2 =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">x3 =</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>data_example<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>data_example<span class="sc">$</span>x1 <span class="sc">+</span> <span class="fl">0.8</span><span class="sc">*</span>data_example<span class="sc">$</span>x2 <span class="sc">-</span> </span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>                 <span class="fl">0.3</span><span class="sc">*</span>data_example<span class="sc">$</span>x3 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation matrix plot</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(data_example) <span class="sc">+</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Exploratory Data Analysis"</span>,</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Correlation matrix and distributions"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_en_files/figure-html/data-exploration-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Data Exploration Example</figcaption>
</figure>
</div>
</div>
</div>
<ol start="2" type="1">
<li><strong>Variable Selection</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models with different variables</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1, <span class="at">data =</span> data_example)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> data_example)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">data =</span> data_example)</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare models</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>models_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"y ~ x1"</span>, <span class="st">"y ~ x1 + x2"</span>, <span class="st">"y ~ x1 + x2 + x3"</span>),</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_squared =</span> <span class="fu">c</span>(<span class="fu">summary</span>(model1)<span class="sc">$</span>r.squared,</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">summary</span>(model2)<span class="sc">$</span>r.squared,</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">summary</span>(model3)<span class="sc">$</span>r.squared),</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Adj_R_squared =</span> <span class="fu">c</span>(<span class="fu">summary</span>(model1)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">summary</span>(model2)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">summary</span>(model3)<span class="sc">$</span>adj.r.squared)</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(models_comparison, <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Model Comparison Summary"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Model Comparison Summary</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">R_squared</th>
<th style="text-align: right;">Adj_R_squared</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">y ~ x1</td>
<td style="text-align: right;">0.323</td>
<td style="text-align: right;">0.316</td>
</tr>
<tr class="even">
<td style="text-align: left;">y ~ x1 + x2</td>
<td style="text-align: right;">0.433</td>
<td style="text-align: right;">0.421</td>
</tr>
<tr class="odd">
<td style="text-align: left;">y ~ x1 + x2 + x3</td>
<td style="text-align: right;">0.893</td>
<td style="text-align: right;">0.890</td>
</tr>
</tbody>
</table>
<p>Variable Selection Process</p>
</div>
</div>
</section>
<section id="common-pitfalls-and-solutions" class="level3" data-number="15.12.2">
<h3 data-number="15.12.2" class="anchored" data-anchor-id="common-pitfalls-and-solutions"><span class="header-section-number">15.12.2</span> Common Pitfalls and Solutions</h3>
<ol type="1">
<li><strong>Outliers and Influential Points</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data with outlier</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">110</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>x_clean <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>y_clean <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x_clean <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>data_clean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_clean, <span class="at">y =</span> y_clean)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add outlier</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>data_outlier <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_clean,</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">10</span>))</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>model_clean <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data_clean)</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>model_outlier <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data_outlier)</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_clean, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_outlier[<span class="dv">51</span>,], <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), </span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> data_clean, </span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">predict</span>(model_clean), </span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"Without Outlier"</span>)) <span class="sc">+</span></span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> data_outlier, </span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">predict</span>(model_outlier), </span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"With Outlier"</span>)) <span class="sc">+</span></span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effect of Outliers on Regression"</span>,</span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Model"</span>) <span class="sc">+</span></span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_en_files/figure-html/outliers-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Identifying and Handling Outliers</figcaption>
</figure>
</div>
</div>
</div>
<ol start="2" type="1">
<li><strong>Missing Data Patterns</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data with missing values</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>data_missing <span class="ot">&lt;-</span> data_example</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>data_missing<span class="sc">$</span>x1[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">10</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>data_missing<span class="sc">$</span>x2[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">15</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>data_missing<span class="sc">$</span>x3[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">20</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize missing patterns</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(data_missing) <span class="sc">+</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Missing Data Patterns"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_en_files/figure-html/missing-data-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Missing Data Patterns</figcaption>
</figure>
</div>
</div>
</div>
<ol start="3" type="1">
<li><strong>Heteroscedasticity</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate heteroscedastic data</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">112</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>x_hetero <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>y_hetero <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span>x_hetero <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="fu">abs</span>(x_hetero)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>data_hetero <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_hetero, <span class="at">y =</span> y_hetero)</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>model_hetero <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data_hetero)</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_hetero, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heteroscedastic Data"</span>)</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_hetero, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fitted</span>(model_hetero), </span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> <span class="fu">residuals</span>(model_hetero))) <span class="sc">+</span></span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residual Plot"</span>,</span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Fitted values"</span>,</span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_en_files/figure-html/heteroscedasticity-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Detecting and Visualizing Heteroscedasticity</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="best-practices" class="level3" data-number="15.12.3">
<h3 data-number="15.12.3" class="anchored" data-anchor-id="best-practices"><span class="header-section-number">15.12.3</span> Best Practices</h3>
<ol type="1">
<li><strong>Model Validation</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple cross-validation example</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">113</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create training and test sets</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data_example), <span class="fl">0.7</span><span class="sc">*</span><span class="fu">nrow</span>(data_example))</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> data_example[train_index, ]</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> data_example[<span class="sc">-</span>train_index, ]</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model on training data</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>model_train <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">data =</span> train_data)</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on test data</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_train, <span class="at">newdata =</span> test_data)</span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>actual <span class="ot">&lt;-</span> test_data<span class="sc">$</span>y</span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate performance metrics</span></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((predictions <span class="sc">-</span> actual)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predictions <span class="sc">-</span> actual))</span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">cor</span>(predictions, actual)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot predictions vs actual</span></span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a>data_validation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> predictions,</span>
<span id="cb103-24"><a href="#cb103-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Actual =</span> actual</span>
<span id="cb103-25"><a href="#cb103-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb103-26"><a href="#cb103-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-27"><a href="#cb103-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_validation, <span class="fu">aes</span>(<span class="at">x =</span> Actual, <span class="at">y =</span> Predicted)) <span class="sc">+</span></span>
<span id="cb103-28"><a href="#cb103-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb103-29"><a href="#cb103-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb103-30"><a href="#cb103-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb103-31"><a href="#cb103-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Validation: Predicted vs Actual"</span>,</span>
<span id="cb103-32"><a href="#cb103-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"RMSE = %.2f, MAE = %.2f, R² = %.2f"</span>, </span>
<span id="cb103-33"><a href="#cb103-33" aria-hidden="true" tabindex="-1"></a>                         rmse, mae, r2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_en_files/figure-html/model-validation-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Cross-Validation Example</figcaption>
</figure>
</div>
</div>
</div>
<ol start="2" type="1">
<li><strong>Reporting Results</strong></li>
</ol>
<p>Example of a professional regression results table:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create regression results table</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kableExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>model_final <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">data =</span> data_example)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">tidy</span>(model_final, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(results, <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Regression Results Summary"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Regression Results Summary</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">9.116</td>
<td style="text-align: right;">2.835</td>
<td style="text-align: right;">3.216</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">3.489</td>
<td style="text-align: right;">14.743</td>
</tr>
<tr class="even">
<td style="text-align: left;">x1</td>
<td style="text-align: right;">0.497</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">12.756</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.419</td>
<td style="text-align: right;">0.574</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x2</td>
<td style="text-align: right;">0.905</td>
<td style="text-align: right;">0.086</td>
<td style="text-align: right;">10.468</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.734</td>
<td style="text-align: right;">1.077</td>
</tr>
<tr class="even">
<td style="text-align: left;">x3</td>
<td style="text-align: right;">-0.324</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">-20.322</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">-0.356</td>
<td style="text-align: right;">-0.292</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="conclusion-1" class="level2" data-number="15.13">
<h2 data-number="15.13" class="anchored" data-anchor-id="conclusion-1"><span class="header-section-number">15.13</span> Conclusion</h2>
<section id="key-takeaways-2" class="level3" data-number="15.13.1">
<h3 data-number="15.13.1" class="anchored" data-anchor-id="key-takeaways-2"><span class="header-section-number">15.13.1</span> Key Takeaways</h3>
<ol type="1">
<li>Always start with exploratory data analysis</li>
<li>Check assumptions before interpreting results</li>
<li>Be aware of common pitfalls:
<ul>
<li>Outliers</li>
<li>Missing data</li>
<li>Multicollinearity</li>
<li>Heteroscedasticity</li>
</ul></li>
<li>Validate your model using:
<ul>
<li>Diagnostic plots</li>
<li>Cross-validation</li>
<li>Residual analysis</li>
</ul></li>
<li>Report results clearly and completely</li>
</ol>
</section>
<section id="further-reading-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="further-reading-2">Further Reading</h3>
<p>For deeper understanding:</p>
<ul>
<li>Wooldridge, J.M. “Introductory Econometrics: A Modern Approach”</li>
<li>Fox, J. “Applied Regression Analysis and Generalized Linear Models”</li>
<li>Angrist, J.D. and Pischke, J.S. “Mostly Harmless Econometrics”</li>
<li>Stock &amp; Watson “Introduction to Econometrics”</li>
</ul>
</section>
</section>
<section id="appendix-a.1-understanding-correlation-measures-a-self-study-tutorial-using-stress-level-and-cognitive-performance-data" class="level2" data-number="15.14">
<h2 data-number="15.14" class="anchored" data-anchor-id="appendix-a.1-understanding-correlation-measures-a-self-study-tutorial-using-stress-level-and-cognitive-performance-data"><span class="header-section-number">15.14</span> Appendix A.1: Understanding Correlation Measures: A Self-Study Tutorial (Using Stress Level and Cognitive Performance Data)</h2>
<section id="dataset-overview" class="level3" data-number="15.14.1">
<h3 data-number="15.14.1" class="anchored" data-anchor-id="dataset-overview"><span class="header-section-number">15.14.1</span> Dataset Overview</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">anxiety_level =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">7</span>, <span class="dv">10</span>),</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cognitive_performance =</span> <span class="fu">c</span>(<span class="dv">85</span>, <span class="dv">90</span>, <span class="dv">62</span>, <span class="dv">55</span>, <span class="dv">80</span>, <span class="dv">65</span>)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="covariance-calculation" class="level3" data-number="15.14.2">
<h3 data-number="15.14.2" class="anchored" data-anchor-id="covariance-calculation"><span class="header-section-number">15.14.2</span> 1. Covariance Calculation</h3>
<section id="step-1-calculate-means" class="level4" data-number="15.14.2.1">
<h4 data-number="15.14.2.1" class="anchored" data-anchor-id="step-1-calculate-means"><span class="header-section-number">15.14.2.1</span> Step 1: Calculate Means</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 50%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Calculation</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mean Anxiety (<span class="math inline">\bar{x}</span>)</td>
<td><span class="math inline">(8 + 5 + 11 + 14 + 7 + 10) ÷ 6</span></td>
<td>9.17</td>
</tr>
<tr class="even">
<td>Mean Cognitive (<span class="math inline">\bar{y}</span>)</td>
<td><span class="math inline">(85 + 90 + 62 + 55 + 80 + 65) ÷ 6</span></td>
<td>72.83</td>
</tr>
</tbody>
</table>
</section>
<section id="step-2-calculate-deviations-and-products" class="level4" data-number="15.14.2.2">
<h4 data-number="15.14.2.2" class="anchored" data-anchor-id="step-2-calculate-deviations-and-products"><span class="header-section-number">15.14.2.2</span> Step 2: Calculate Deviations and Products</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">x_i</span></th>
<th><span class="math inline">y_i</span></th>
<th><span class="math inline">(x_i - \bar{x})</span></th>
<th><span class="math inline">(y_i - \bar{y})</span></th>
<th><span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>8</td>
<td>85</td>
<td>-1.17</td>
<td>12.17</td>
<td>-14.24</td>
</tr>
<tr class="even">
<td>2</td>
<td>5</td>
<td>90</td>
<td>-4.17</td>
<td>17.17</td>
<td>-71.60</td>
</tr>
<tr class="odd">
<td>3</td>
<td>11</td>
<td>62</td>
<td>1.83</td>
<td>-10.83</td>
<td>-19.82</td>
</tr>
<tr class="even">
<td>4</td>
<td>14</td>
<td>55</td>
<td>4.83</td>
<td>-17.83</td>
<td>-86.12</td>
</tr>
<tr class="odd">
<td>5</td>
<td>7</td>
<td>80</td>
<td>-2.17</td>
<td>7.17</td>
<td>-15.56</td>
</tr>
<tr class="even">
<td>6</td>
<td>10</td>
<td>65</td>
<td>0.83</td>
<td>-7.83</td>
<td>-6.50</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td>55</td>
<td>437</td>
<td>0.00</td>
<td>0.00</td>
<td>-213.84</td>
</tr>
</tbody>
</table>
</section>
<section id="step-3-calculate-covariance" class="level4" data-number="15.14.2.3">
<h4 data-number="15.14.2.3" class="anchored" data-anchor-id="step-3-calculate-covariance"><span class="header-section-number">15.14.2.3</span> Step 3: Calculate Covariance</h4>
<p><span class="math display"> \text{Cov}(X,Y) = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{n-1} = \frac{-213.84}{5} = -42.77 </span></p>
</section>
</section>
<section id="pearson-correlation-coefficient-1" class="level3" data-number="15.14.3">
<h3 data-number="15.14.3" class="anchored" data-anchor-id="pearson-correlation-coefficient-1"><span class="header-section-number">15.14.3</span> 2. Pearson Correlation Coefficient</h3>
<section id="step-1-calculate-squared-deviations" class="level4" data-number="15.14.3.1">
<h4 data-number="15.14.3.1" class="anchored" data-anchor-id="step-1-calculate-squared-deviations"><span class="header-section-number">15.14.3.1</span> Step 1: Calculate Squared Deviations</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">(x_i - \bar{x})</span></th>
<th><span class="math inline">(y_i - \bar{y})</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>-1.17</td>
<td>12.17</td>
<td>1.37</td>
<td>148.11</td>
</tr>
<tr class="even">
<td>2</td>
<td>-4.17</td>
<td>17.17</td>
<td>17.39</td>
<td>294.81</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1.83</td>
<td>-10.83</td>
<td>3.35</td>
<td>117.29</td>
</tr>
<tr class="even">
<td>4</td>
<td>4.83</td>
<td>-17.83</td>
<td>23.33</td>
<td>317.91</td>
</tr>
<tr class="odd">
<td>5</td>
<td>-2.17</td>
<td>7.17</td>
<td>4.71</td>
<td>51.41</td>
</tr>
<tr class="even">
<td>6</td>
<td>0.83</td>
<td>-7.83</td>
<td>0.69</td>
<td>61.31</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td>0.00</td>
<td>0.00</td>
<td>50.84</td>
<td>990.84</td>
</tr>
</tbody>
</table>
</section>
<section id="step-2-calculate-standard-deviations" class="level4" data-number="15.14.3.2">
<h4 data-number="15.14.3.2" class="anchored" data-anchor-id="step-2-calculate-standard-deviations"><span class="header-section-number">15.14.3.2</span> Step 2: Calculate Standard Deviations</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 30%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Measure</th>
<th>Formula</th>
<th>Calculation</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">s_x</span></td>
<td><span class="math inline">\sqrt{\frac{\sum (x_i - \bar{x})^2}{n-1}}</span></td>
<td><span class="math inline">\sqrt{\frac{50.84}{5}}</span></td>
<td>3.19</td>
</tr>
<tr class="even">
<td><span class="math inline">s_y</span></td>
<td><span class="math inline">\sqrt{\frac{\sum (y_i - \bar{y})^2}{n-1}}</span></td>
<td><span class="math inline">\sqrt{\frac{990.84}{5}}</span></td>
<td>14.08</td>
</tr>
</tbody>
</table>
</section>
<section id="step-3-calculate-pearson-correlation" class="level4" data-number="15.14.3.3">
<h4 data-number="15.14.3.3" class="anchored" data-anchor-id="step-3-calculate-pearson-correlation"><span class="header-section-number">15.14.3.3</span> Step 3: Calculate Pearson Correlation</h4>
<p><span class="math display"> r = \frac{\text{Cov}(X,Y)}{s_x s_y} = \frac{-42.77}{3.19 \times 14.08} = -0.95 </span></p>
</section>
</section>
<section id="spearman-rank-correlation" class="level3" data-number="15.14.4">
<h3 data-number="15.14.4" class="anchored" data-anchor-id="spearman-rank-correlation"><span class="header-section-number">15.14.4</span> 3. Spearman Rank Correlation</h3>
<section id="step-1-assign-ranks" class="level4" data-number="15.14.4.1">
<h4 data-number="15.14.4.1" class="anchored" data-anchor-id="step-1-assign-ranks"><span class="header-section-number">15.14.4.1</span> Step 1: Assign Ranks</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">x_i</span></th>
<th><span class="math inline">y_i</span></th>
<th>Rank <span class="math inline">x_i</span></th>
<th>Rank <span class="math inline">y_i</span></th>
<th><span class="math inline">d_i</span></th>
<th><span class="math inline">d_i^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>8</td>
<td>85</td>
<td>3</td>
<td>2</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>2</td>
<td>5</td>
<td>90</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>3</td>
<td>11</td>
<td>62</td>
<td>5</td>
<td>5</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>4</td>
<td>14</td>
<td>55</td>
<td>6</td>
<td>6</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>5</td>
<td>7</td>
<td>80</td>
<td>2</td>
<td>3</td>
<td>-1</td>
<td>1</td>
</tr>
<tr class="even">
<td>6</td>
<td>10</td>
<td>65</td>
<td>4</td>
<td>4</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>2</td>
</tr>
</tbody>
</table>
</section>
<section id="step-2-calculate-spearman-correlation" class="level4" data-number="15.14.4.2">
<h4 data-number="15.14.4.2" class="anchored" data-anchor-id="step-2-calculate-spearman-correlation"><span class="header-section-number">15.14.4.2</span> Step 2: Calculate Spearman Correlation</h4>
<p><span class="math display"> \rho = 1 - \frac{6\sum d_i^2}{n(n^2-1)} = 1 - \frac{6(2)}{6(36-1)} = 1 - \frac{12}{210} = 0.94 </span></p>
</section>
</section>
<section id="verification-using-r" class="level3" data-number="15.14.5">
<h3 data-number="15.14.5" class="anchored" data-anchor-id="verification-using-r"><span class="header-section-number">15.14.5</span> Verification using R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlations using R</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(data<span class="sc">$</span>anxiety_level, data<span class="sc">$</span>cognitive_performance, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9527979</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(data<span class="sc">$</span>anxiety_level, data<span class="sc">$</span>cognitive_performance, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9428571</code></pre>
</div>
</div>
</section>
<section id="interpretation" class="level3" data-number="15.14.6">
<h3 data-number="15.14.6" class="anchored" data-anchor-id="interpretation"><span class="header-section-number">15.14.6</span> Interpretation</h3>
<ol type="1">
<li><p>The strong negative Pearson correlation (r = -0.95) indicates a very strong negative linear relationship between anxiety level and cognitive performance.</p></li>
<li><p>The strong positive Spearman correlation (ρ = 0.94) shows that the relationship is also strongly monotonic.</p></li>
<li><p>The difference between Pearson and Spearman correlations suggests that while there is a strong relationship, it might not be perfectly linear.</p></li>
</ol>
</section>
<section id="exercise" class="level3" data-number="15.14.7">
<h3 data-number="15.14.7" class="anchored" data-anchor-id="exercise"><span class="header-section-number">15.14.7</span> Exercise</h3>
<ol type="1">
<li>Verify each calculation step in the tables above.</li>
<li>Try calculating these measures with a modified dataset:
<ul>
<li>Add one outlier and observe how it affects both correlation coefficients</li>
<li>Change one pair of values and recalculate</li>
</ul></li>
</ol>
</section>
<section id="references" class="level3" data-number="15.14.8">
<h3 data-number="15.14.8" class="anchored" data-anchor-id="references"><span class="header-section-number">15.14.8</span> References</h3>
<ol type="1">
<li>Understanding Correlation:
<ul>
<li>Pearson, K. (1895). “Notes on regression and inheritance in the case of two parents.”</li>
<li>Spearman, C. (1904). “The proof and measurement of association between two things.”</li>
</ul></li>
</ol>
</section>
</section>
<section id="appendix-a.2-calculating-covariance-pearson-and-spearman-correlation---worked-example" class="level2" data-number="15.15">
<h2 data-number="15.15" class="anchored" data-anchor-id="appendix-a.2-calculating-covariance-pearson-and-spearman-correlation---worked-example"><span class="header-section-number">15.15</span> Appendix A.2: Calculating Covariance, Pearson, and Spearman Correlation - worked example</h2>
<p>Given data on Electoral District Magnitude (<span class="math inline">\text{DM}</span>) and Gallagher index:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\text{DM}</span> (<span class="math inline">X</span>)</th>
<th>Gallagher (<span class="math inline">Y</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>18.2</td>
</tr>
<tr class="even">
<td>3</td>
<td>16.7</td>
</tr>
<tr class="odd">
<td>4</td>
<td>15.8</td>
</tr>
<tr class="even">
<td>5</td>
<td>15.3</td>
</tr>
<tr class="odd">
<td>6</td>
<td>15.0</td>
</tr>
<tr class="even">
<td>7</td>
<td>14.8</td>
</tr>
<tr class="odd">
<td>8</td>
<td>14.7</td>
</tr>
<tr class="even">
<td>9</td>
<td>14.6</td>
</tr>
<tr class="odd">
<td>10</td>
<td>14.55</td>
</tr>
<tr class="even">
<td>11</td>
<td>14.52</td>
</tr>
</tbody>
</table>
<section id="step-1-calculate-basic-statistics" class="level3" data-number="15.15.1">
<h3 data-number="15.15.1" class="anchored" data-anchor-id="step-1-calculate-basic-statistics"><span class="header-section-number">15.15.1</span> Step 1: Calculate Basic Statistics</h3>
<p>Calculation of means:</p>
<p>For <span class="math inline">\text{DM}</span> (<span class="math inline">X</span>): <span class="math display">\bar{X} = \frac{\sum_{i=1}^n X_i}{n}</span></p>
<p>Detailed calculation:</p>
<p><span class="math display">2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 + 10 + 11 = 65</span> <span class="math display">\bar{x} = \frac{65}{10} = 6.5</span></p>
<p>For Gallagher index (<span class="math inline">Y</span>): <span class="math display">\bar{Y} = \frac{\sum_{i=1}^n Y_i}{n}</span></p>
<p>Detailed calculation:</p>
<p><span class="math display">18.2 + 16.7 + 15.8 + 15.3 + 15.0 + 14.8 + 14.7 + 14.6 + 14.55 + 14.52 = 154.17</span> <span class="math display">\bar{y} = \frac{154.17}{10} = 15.417</span></p>
</section>
<section id="step-2-detailed-covariance-calculations" class="level3" data-number="15.15.2">
<h3 data-number="15.15.2" class="anchored" data-anchor-id="step-2-detailed-covariance-calculations"><span class="header-section-number">15.15.2</span> Step 2: Detailed Covariance Calculations</h3>
<p>Complete working table showing all calculations:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 26%">
<col style="width: 15%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">(X_i - \bar{X})</span></th>
<th><span class="math inline">(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})^2</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18.2</td>
<td><span class="math inline">-4.5</span></td>
<td>2.783</td>
<td><span class="math inline">-12.5235</span></td>
<td>20.25</td>
<td>7.7451</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16.7</td>
<td><span class="math inline">-3.5</span></td>
<td>1.283</td>
<td><span class="math inline">-4.4905</span></td>
<td>12.25</td>
<td>1.6461</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15.8</td>
<td><span class="math inline">-2.5</span></td>
<td>0.383</td>
<td><span class="math inline">-0.9575</span></td>
<td>6.25</td>
<td>0.1467</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15.3</td>
<td><span class="math inline">-1.5</span></td>
<td><span class="math inline">-0.117</span></td>
<td>0.1755</td>
<td>2.25</td>
<td>0.0137</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15.0</td>
<td><span class="math inline">-0.5</span></td>
<td><span class="math inline">-0.417</span></td>
<td>0.2085</td>
<td>0.25</td>
<td>0.1739</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14.8</td>
<td>0.5</td>
<td><span class="math inline">-0.617</span></td>
<td><span class="math inline">-0.3085</span></td>
<td>0.25</td>
<td>0.3807</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14.7</td>
<td>1.5</td>
<td><span class="math inline">-0.717</span></td>
<td><span class="math inline">-1.0755</span></td>
<td>2.25</td>
<td>0.5141</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14.6</td>
<td>2.5</td>
<td><span class="math inline">-0.817</span></td>
<td><span class="math inline">-2.0425</span></td>
<td>6.25</td>
<td>0.6675</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14.55</td>
<td>3.5</td>
<td><span class="math inline">-0.867</span></td>
<td><span class="math inline">-3.0345</span></td>
<td>12.25</td>
<td>0.7517</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14.52</td>
<td>4.5</td>
<td><span class="math inline">-0.897</span></td>
<td><span class="math inline">-4.0365</span></td>
<td>20.25</td>
<td>0.8047</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td>65</td>
<td>154.17</td>
<td>0</td>
<td>0</td>
<td><span class="math inline">-28.085</span></td>
<td>82.5</td>
<td>12.8442</td>
</tr>
</tbody>
</table>
<p>Covariance calculation: <span class="math display">\text{Cov}(X,Y) = \frac{\sum_{i=1}^n (X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p><span class="math display">\text{Cov}(X,Y) = \frac{-28.085}{9} = -3.120556</span></p>
</section>
<section id="step-3-standard-deviation-calculations" class="level3" data-number="15.15.3">
<h3 data-number="15.15.3" class="anchored" data-anchor-id="step-3-standard-deviation-calculations"><span class="header-section-number">15.15.3</span> Step 3: Standard Deviation Calculations</h3>
<p>For <span class="math inline">\text{DM}</span> (<span class="math inline">X</span>): <span class="math display">\sigma_X = \sqrt{\frac{\sum_{i=1}^n (X_i - \bar{X})^2}{n-1}}</span></p>
<p><span class="math display">\sigma_x = \sqrt{\frac{82.5}{9}} = \sqrt{9.1667} = 3.026582</span></p>
<p>For Gallagher (<span class="math inline">Y</span>): <span class="math display">\sigma_Y = \sqrt{\frac{\sum_{i=1}^n (Y_i - \bar{Y})^2}{n-1}}</span></p>
<p><span class="math display">\sigma_y = \sqrt{\frac{12.8442}{9}} = \sqrt{1.4271} = 1.194612</span></p>
</section>
<section id="step-4-pearson-correlation-calculation" class="level3" data-number="15.15.4">
<h3 data-number="15.15.4" class="anchored" data-anchor-id="step-4-pearson-correlation-calculation"><span class="header-section-number">15.15.4</span> Step 4: Pearson Correlation Calculation</h3>
<p><span class="math display">r = \frac{\text{Cov}(X,Y)}{\sigma_X \sigma_Y}</span></p>
<p><span class="math display">r = \frac{-3.120556}{3.026582 \times 1.194612} = \frac{-3.120556}{3.615752} = -0.863044</span></p>
</section>
<section id="step-5-spearman-rank-correlation-calculation" class="level3" data-number="15.15.5">
<h3 data-number="15.15.5" class="anchored" data-anchor-id="step-5-spearman-rank-correlation-calculation"><span class="header-section-number">15.15.5</span> Step 5: Spearman Rank Correlation Calculation</h3>
<p>Complete ranking table with all calculations:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th>Rank <span class="math inline">X_i</span></th>
<th>Rank <span class="math inline">Y_i</span></th>
<th><span class="math inline">d_i</span></th>
<th><span class="math inline">d_i^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18.2</td>
<td>1</td>
<td>10</td>
<td><span class="math inline">-9</span></td>
<td>81</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16.7</td>
<td>2</td>
<td>9</td>
<td><span class="math inline">-7</span></td>
<td>49</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15.8</td>
<td>3</td>
<td>8</td>
<td><span class="math inline">-5</span></td>
<td>25</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15.3</td>
<td>4</td>
<td>7</td>
<td><span class="math inline">-3</span></td>
<td>9</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15.0</td>
<td>5</td>
<td>6</td>
<td><span class="math inline">-1</span></td>
<td>1</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14.8</td>
<td>6</td>
<td>5</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14.7</td>
<td>7</td>
<td>4</td>
<td>3</td>
<td>9</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14.6</td>
<td>8</td>
<td>3</td>
<td>5</td>
<td>25</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14.55</td>
<td>9</td>
<td>2</td>
<td>7</td>
<td>49</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14.52</td>
<td>10</td>
<td>1</td>
<td>9</td>
<td>81</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>330</td>
</tr>
</tbody>
</table>
<p>Spearman correlation calculation: <span class="math display">\rho = 1 - \frac{6\sum d_i^2}{n(n^2-1)}</span></p>
<p><span class="math display">\rho = 1 - \frac{6 \times 330}{10(100 - 1)} = 1 - \frac{1980}{990} = 1 - 2 = -1</span></p>
</section>
<section id="step-6-r-verification" class="level3" data-number="15.15.6">
<h3 data-number="15.15.6" class="anchored" data-anchor-id="step-6-r-verification"><span class="header-section-number">15.15.6</span> Step 6: R Verification</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create vectors</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>DM <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>GH <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">18.2</span>, <span class="fl">16.7</span>, <span class="fl">15.8</span>, <span class="fl">15.3</span>, <span class="fl">15.0</span>, <span class="fl">14.8</span>, <span class="fl">14.7</span>, <span class="fl">14.6</span>, <span class="fl">14.55</span>, <span class="fl">14.52</span>)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate covariance</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(DM, GH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3.120556</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlations</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DM, GH, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8627742</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DM, GH, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1</code></pre>
</div>
</div>
</section>
<section id="step-7-basic-visualization" class="level3" data-number="15.15.7">
<h3 data-number="15.15.7" class="anchored" data-anchor-id="step-7-basic-visualization"><span class="header-section-number">15.15.7</span> Step 7: Basic Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">DM =</span> DM, <span class="at">GH =</span> GH)</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create scatter plot</span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"District Magnitude vs Gallagher Index"</span>,</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"District Magnitude (DM)"</span>,</span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gallagher Index (GH)"</span></span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ols-estimation-and-goodness-of-fit-measures" class="level3" data-number="15.15.8">
<h3 data-number="15.15.8" class="anchored" data-anchor-id="ols-estimation-and-goodness-of-fit-measures"><span class="header-section-number">15.15.8</span> OLS Estimation and Goodness-of-Fit Measures</h3>
</section>
<section id="step-1-calculate-ols-estimates" class="level3" data-number="15.15.9">
<h3 data-number="15.15.9" class="anchored" data-anchor-id="step-1-calculate-ols-estimates"><span class="header-section-number">15.15.9</span> Step 1: Calculate OLS Estimates</h3>
<p>Using previously calculated values: - <span class="math inline">\sum(X_i - \bar{X})(Y_i - \bar{Y}) = -28.085</span> - <span class="math inline">\sum(X_i - \bar{X})^2 = 82.5</span> - <span class="math inline">\bar{X} = 6.5</span> - <span class="math inline">\bar{Y} = 15.417</span></p>
<p>Calculate slope (<span class="math inline">\hat{\beta_1}</span>): <span class="math inline">\hat{\beta_1} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2}</span></p>
<p><span class="math display">\hat{\beta_1} = -28,085 ÷ 82,5 = -0,3404</span></p>
<p>Calculate intercept (<span class="math inline">\hat{\beta_0}</span>): <span class="math inline">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span></p>
<p><span class="math display">\hat{\beta_0} = 15,417 - (-0,3404 × 6,5)
   = 15,417 + 2,2126
   = 17,6296</span></p>
<p>Therefore, the OLS regression equation is: <span class="math inline">\hat{Y} = 17.6296 - 0.3404X</span></p>
</section>
<section id="step-2-calculate-fitted-values-and-residuals" class="level3" data-number="15.15.10">
<h3 data-number="15.15.10" class="anchored" data-anchor-id="step-2-calculate-fitted-values-and-residuals"><span class="header-section-number">15.15.10</span> Step 2: Calculate Fitted Values and Residuals</h3>
<p>Complete table showing all calculations:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i</span></th>
<th><span class="math inline">e_i = Y_i - \hat{Y}_i</span></th>
<th><span class="math inline">e_i^2</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
<th><span class="math inline">(\hat{Y}_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18.2</td>
<td>16.9488</td>
<td>1.2512</td>
<td>1.5655</td>
<td>7.7451</td>
<td>2.3404</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16.7</td>
<td>16.6084</td>
<td>0.0916</td>
<td>0.0084</td>
<td>1.6461</td>
<td>1.4241</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15.8</td>
<td>16.2680</td>
<td>-0.4680</td>
<td>0.2190</td>
<td>0.1467</td>
<td>0.7225</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15.3</td>
<td>15.9276</td>
<td>-0.6276</td>
<td>0.3939</td>
<td>0.0137</td>
<td>0.2601</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15.0</td>
<td>15.5872</td>
<td>-0.5872</td>
<td>0.3448</td>
<td>0.1739</td>
<td>0.0289</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14.8</td>
<td>15.2468</td>
<td>-0.4468</td>
<td>0.1996</td>
<td>0.3807</td>
<td>0.0290</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14.7</td>
<td>14.9064</td>
<td>-0.2064</td>
<td>0.0426</td>
<td>0.5141</td>
<td>0.2610</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14.6</td>
<td>14.5660</td>
<td>0.0340</td>
<td>0.0012</td>
<td>0.6675</td>
<td>0.7241</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14.55</td>
<td>14.2256</td>
<td>0.3244</td>
<td>0.1052</td>
<td>0.7517</td>
<td>1.4184</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14.52</td>
<td>13.8852</td>
<td>0.6348</td>
<td>0.4030</td>
<td>0.8047</td>
<td>2.3439</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td>65</td>
<td>154.17</td>
<td>154.17</td>
<td>0</td>
<td>3.2832</td>
<td>12.8442</td>
<td>9.5524</td>
</tr>
</tbody>
</table>
<p>Calculations for fitted values:</p>
<pre><code>For X = 2:
Ŷ = 17.6296 + (-0.3404 × 2) = 16.9488

For X = 3:
Ŷ = 17.6296 + (-0.3404 × 3) = 16.6084

[... continue for all values]</code></pre>
</section>
<section id="step-3-calculate-goodness-of-fit-measures" class="level3" data-number="15.15.11">
<h3 data-number="15.15.11" class="anchored" data-anchor-id="step-3-calculate-goodness-of-fit-measures"><span class="header-section-number">15.15.11</span> Step 3: Calculate Goodness-of-Fit Measures</h3>
<p>Sum of Squared Errors (SSE): <span class="math inline">SSE = \sum e_i^2</span></p>
<pre><code>SSE = 3.2832</code></pre>
<p>Sum of Squared Total (SST): <span class="math inline">SST = \sum(Y_i - \bar{Y})^2</span></p>
<pre><code>SST = 12.8442</code></pre>
<p>Sum of Squared Regression (SSR): <span class="math inline">SSR = \sum(\hat{Y}_i - \bar{Y})^2</span></p>
<pre><code>SSR = 9.5524</code></pre>
<p>Verify decomposition: <span class="math inline">SST = SSR + SSE</span></p>
<pre><code>12.8442 = 9.5524 + 3.2832 (within rounding error)</code></pre>
<p>R-squared calculation: <span class="math inline">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span></p>
<pre><code>R² = 9.5524 ÷ 12.8442
   = 0.7438</code></pre>
</section>
<section id="step-4-r-verification" class="level3" data-number="15.15.12">
<h3 data-number="15.15.12" class="anchored" data-anchor-id="step-4-r-verification"><span class="header-section-number">15.15.12</span> Step 4: R Verification</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear model</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View summary statistics</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = GH ~ DM, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.62764 -0.46274 -0.08615  0.26624  1.25109 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 17.62976    0.50121  35.174 4.67e-10 ***
DM          -0.34042    0.07053  -4.827  0.00131 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6406 on 8 degrees of freedom
Multiple R-squared:  0.7444,    Adjusted R-squared:  0.7124 
F-statistic:  23.3 on 1 and 8 DF,  p-value: 0.00131</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate R-squared manually</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((GH <span class="sc">-</span> <span class="fu">mean</span>(GH))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(model)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> SST <span class="sc">-</span> SSE</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>R2_manual <span class="ot">&lt;-</span> SSR<span class="sc">/</span>SST</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>R2_manual</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7443793</code></pre>
</div>
</div>
</section>
<section id="step-5-residual-analysis" class="level3" data-number="15.15.13">
<h3 data-number="15.15.13" class="anchored" data-anchor-id="step-5-residual-analysis"><span class="header-section-number">15.15.13</span> Step 5: Residual Analysis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create residual plots</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-6-predicted-vs-actual-values-plot" class="level3" data-number="15.15.14">
<h3 data-number="15.15.14" class="anchored" data-anchor-id="step-6-predicted-vs-actual-values-plot"><span class="header-section-number">15.15.14</span> Step 6: Predicted vs Actual Values Plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create predicted vs actual plot</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Actual =</span> GH,</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> <span class="fu">fitted</span>(model)</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>), <span class="fu">aes</span>(<span class="at">x =</span> Predicted, <span class="at">y =</span> Actual)) <span class="sc">+</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predicted vs Actual Values"</span>,</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Predicted Gallagher Index"</span>,</span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Actual Gallagher Index"</span></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="log-transformed-models" class="level3" data-number="15.15.15">
<h3 data-number="15.15.15" class="anchored" data-anchor-id="log-transformed-models"><span class="header-section-number">15.15.15</span> Log-Transformed Models</h3>
</section>
<section id="step-1-data-transformation" class="level3" data-number="15.15.16">
<h3 data-number="15.15.16" class="anchored" data-anchor-id="step-1-data-transformation"><span class="header-section-number">15.15.16</span> Step 1: Data Transformation</h3>
<p>First, calculate natural logarithms of variables:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\ln(X_i)</span></th>
<th><span class="math inline">\ln(Y_i)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18.2</td>
<td>0.6931</td>
<td>2.9014</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16.7</td>
<td>1.0986</td>
<td>2.8154</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15.8</td>
<td>1.3863</td>
<td>2.7600</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15.3</td>
<td>1.6094</td>
<td>2.7278</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15.0</td>
<td>1.7918</td>
<td>2.7081</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14.8</td>
<td>1.9459</td>
<td>2.6946</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14.7</td>
<td>2.0794</td>
<td>2.6878</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14.6</td>
<td>2.1972</td>
<td>2.6810</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14.55</td>
<td>2.3026</td>
<td>2.6777</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14.52</td>
<td>2.3979</td>
<td>2.6757</td>
</tr>
</tbody>
</table>
</section>
<section id="step-2-compare-different-model-specifications" class="level3" data-number="15.15.17">
<h3 data-number="15.15.17" class="anchored" data-anchor-id="step-2-compare-different-model-specifications"><span class="header-section-number">15.15.17</span> Step 2: Compare Different Model Specifications</h3>
<p>We estimate three alternative specifications:</p>
<ol type="1">
<li>Log-linear model: <span class="math inline">\ln(Y_i) = \beta_0 + \beta_1 X_i + \epsilon_i</span></li>
<li>Linear-log model: <span class="math inline">Y_i = \beta_0 + \beta_1\ln(X_i) + \epsilon_i</span></li>
<li>Log-log model: <span class="math inline">\ln(Y_i) = \beta_0 + \beta_1\ln(X_i) + \epsilon_i</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create transformed variables</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log_DM <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>DM)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log_GH <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>GH)</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>model_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>model_loglinear <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>model_linearlog <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> log_DM, <span class="at">data =</span> data)</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>model_loglog <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_GH <span class="sc">~</span> log_DM, <span class="at">data =</span> data)</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare R-squared values</span></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>models_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Linear"</span>, <span class="st">"Log-linear"</span>, <span class="st">"Linear-log"</span>, <span class="st">"Log-log"</span>),</span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_squared =</span> <span class="fu">c</span>(</span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_linear)<span class="sc">$</span>r.squared,</span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_loglinear)<span class="sc">$</span>r.squared,</span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_linearlog)<span class="sc">$</span>r.squared,</span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_loglog)<span class="sc">$</span>r.squared</span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Display comparison</span></span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a>models_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Model R_squared
1     Linear 0.7443793
2 Log-linear 0.7670346
3 Linear-log 0.9141560
4    Log-log 0.9288088</code></pre>
</div>
</div>
</section>
<section id="step-3-visual-comparison" class="level3" data-number="15.15.18">
<h3 data-number="15.15.18" class="anchored" data-anchor-id="step-3-visual-comparison"><span class="header-section-number">15.15.18</span> Step 3: Visual Comparison</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots for each model</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Linear Model"</span>) <span class="sc">+</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> log_GH)) <span class="sc">+</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log-linear Model"</span>) <span class="sc">+</span></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Linear-log Model"</span>) <span class="sc">+</span></span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> log_GH)) <span class="sc">+</span></span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log-log Model"</span>) <span class="sc">+</span></span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb135-25"><a href="#cb135-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-26"><a href="#cb135-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange plots in a grid</span></span>
<span id="cb135-27"><a href="#cb135-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb135-28"><a href="#cb135-28" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-4-residual-analysis-for-best-model" class="level3" data-number="15.15.19">
<h3 data-number="15.15.19" class="anchored" data-anchor-id="step-4-residual-analysis-for-best-model"><span class="header-section-number">15.15.19</span> Step 4: Residual Analysis for Best Model</h3>
<p>Based on R-squared values, analyze residuals for the best-fitting model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual plots for best model</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_linearlog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-5-interpretation-of-best-model" class="level3" data-number="15.15.20">
<h3 data-number="15.15.20" class="anchored" data-anchor-id="step-5-interpretation-of-best-model"><span class="header-section-number">15.15.20</span> Step 5: Interpretation of Best Model</h3>
<p>The linear-log model coefficients:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_linearlog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = GH ~ log_DM, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40702 -0.30207 -0.04907  0.22905  0.60549 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  19.0223     0.4079   46.64 4.94e-11 ***
log_DM       -2.0599     0.2232   -9.23 1.54e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3712 on 8 degrees of freedom
Multiple R-squared:  0.9142,    Adjusted R-squared:  0.9034 
F-statistic: 85.19 on 1 and 8 DF,  p-value: 1.539e-05</code></pre>
</div>
</div>
<p>Interpretation: - <span class="math inline">\hat{\beta_0}</span> represents the expected Gallagher Index when ln(DM) = 0 (i.e., when DM = 1) - <span class="math inline">\hat{\beta_1}</span> represents the change in Gallagher Index associated with a one-unit increase in ln(DM)</p>
</section>
<section id="step-6-model-predictions" class="level3" data-number="15.15.21">
<h3 data-number="15.15.21" class="anchored" data-anchor-id="step-6-model-predictions"><span class="header-section-number">15.15.21</span> Step 6: Model Predictions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction plot for best model</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Linear-log Model: Gallagher Index vs ln(District Magnitude)"</span>,</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"ln(District Magnitude)"</span>,</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gallagher Index"</span></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-7-elasticity-analysis" class="level3" data-number="15.15.22">
<h3 data-number="15.15.22" class="anchored" data-anchor-id="step-7-elasticity-analysis"><span class="header-section-number">15.15.22</span> Step 7: Elasticity Analysis</h3>
<p>For the log-log model, coefficients represent elasticities directly. Calculate average elasticity for the linear-log model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate elasticity at means</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>mean_DM <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>DM)</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>mean_GH <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>GH)</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_linearlog)[<span class="dv">2</span>]</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>elasticity <span class="ot">&lt;-</span> beta1 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>mean_GH)</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>elasticity</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    log_DM 
-0.1336136 </code></pre>
</div>
</div>
<p>This represents the percentage change in the Gallagher Index for a 1% change in District Magnitude.</p>
</section>
</section>
<section id="appendix-a.3-understanding-pearson-spearman-and-kendall" class="level2" data-number="15.16">
<h2 data-number="15.16" class="anchored" data-anchor-id="appendix-a.3-understanding-pearson-spearman-and-kendall"><span class="header-section-number">15.16</span> Appendix A.3: Understanding Pearson, Spearman, and Kendall</h2>
<section id="dataset" class="level3" data-number="15.16.1">
<h3 data-number="15.16.1" class="anchored" data-anchor-id="dataset"><span class="header-section-number">15.16.1</span> Dataset</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">8</span>),</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">7</span>)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pearson-correlation-1" class="level3" data-number="15.16.2">
<h3 data-number="15.16.2" class="anchored" data-anchor-id="pearson-correlation-1"><span class="header-section-number">15.16.2</span> Pearson Correlation</h3>
<p><span class="math display"> r = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum (x_i - \bar{x})^2 \sum (y_i - \bar{y})^2}} </span></p>
<section id="step-by-step-calculations" class="level4" data-number="15.16.2.1">
<h4 data-number="15.16.2.1" class="anchored" data-anchor-id="step-by-step-calculations"><span class="header-section-number">15.16.2.1</span> Step-by-Step Calculations:</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">x_i</span></th>
<th><span class="math inline">y_i</span></th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>3</td>
<td>-2.4</td>
<td>-1.6</td>
<td>3.84</td>
<td>5.76</td>
<td>2.56</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>5</td>
<td>-0.4</td>
<td>0.4</td>
<td>-0.16</td>
<td>0.16</td>
<td>0.16</td>
</tr>
<tr class="odd">
<td>3</td>
<td>5</td>
<td>4</td>
<td>0.6</td>
<td>-0.6</td>
<td>-0.36</td>
<td>0.36</td>
<td>0.36</td>
</tr>
<tr class="even">
<td>4</td>
<td>3</td>
<td>4</td>
<td>-1.4</td>
<td>-0.6</td>
<td>0.84</td>
<td>1.96</td>
<td>0.36</td>
</tr>
<tr class="odd">
<td>5</td>
<td>8</td>
<td>7</td>
<td>3.6</td>
<td>2.4</td>
<td>8.64</td>
<td>12.96</td>
<td>5.76</td>
</tr>
<tr class="even">
<td>Sum</td>
<td>22</td>
<td>23</td>
<td>0</td>
<td>0</td>
<td>12.8</td>
<td>21.2</td>
<td>9.2</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\bar{x} = 4.4</span> <span class="math inline">\bar{y} = 4.6</span></p>
<p><span class="math display"> r = \frac{12.8}{\sqrt{21.2 \times 9.2}} = \frac{12.8}{\sqrt{195.04}} = \frac{12.8}{13.97} = 0.92 </span></p>
</section>
</section>
<section id="spearman-correlation-1" class="level3" data-number="15.16.3">
<h3 data-number="15.16.3" class="anchored" data-anchor-id="spearman-correlation-1"><span class="header-section-number">15.16.3</span> Spearman Correlation</h3>
<p><span class="math display"> \rho = 1 - \frac{6\sum d_i^2}{n(n^2-1)} </span></p>
<section id="step-by-step-calculations-1" class="level4" data-number="15.16.3.1">
<h4 data-number="15.16.3.1" class="anchored" data-anchor-id="step-by-step-calculations-1"><span class="header-section-number">15.16.3.1</span> Step-by-Step Calculations:</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">x_i</span></th>
<th><span class="math inline">y_i</span></th>
<th>Rank <span class="math inline">x_i</span></th>
<th>Rank <span class="math inline">y_i</span></th>
<th><span class="math inline">d_i</span></th>
<th><span class="math inline">d_i^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>5</td>
<td>3</td>
<td>5</td>
<td>-2</td>
<td>4</td>
</tr>
<tr class="odd">
<td>3</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>2.5</td>
<td>1.5</td>
<td>2.25</td>
</tr>
<tr class="even">
<td>4</td>
<td>3</td>
<td>4</td>
<td>2</td>
<td>2.5</td>
<td>-0.5</td>
<td>0.25</td>
</tr>
<tr class="odd">
<td>5</td>
<td>8</td>
<td>7</td>
<td>5</td>
<td>4</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>Sum</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>7.5</td>
</tr>
</tbody>
</table>
<p><span class="math display"> \rho = 1 - \frac{6(7.5)}{5(25-1)} = 1 - \frac{45}{120} = 0.82 </span></p>
</section>
</section>
<section id="kendalls-tau-1" class="level3" data-number="15.16.4">
<h3 data-number="15.16.4" class="anchored" data-anchor-id="kendalls-tau-1"><span class="header-section-number">15.16.4</span> Kendall’s Tau</h3>
<p><span class="math display"> \tau = \frac{\text{number of concordant pairs} - \text{number of discordant pairs}}{\frac{1}{2}n(n-1)} </span></p>
<section id="step-by-step-calculations-2" class="level4" data-number="15.16.4.1">
<h4 data-number="15.16.4.1" class="anchored" data-anchor-id="step-by-step-calculations-2"><span class="header-section-number">15.16.4.1</span> Step-by-Step Calculations:</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Pair (i,j)</th>
<th><span class="math inline">x_i,x_j</span></th>
<th><span class="math inline">y_i,y_j</span></th>
<th><span class="math inline">x_j-x_i</span></th>
<th><span class="math inline">y_j-y_i</span></th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(1,2)</td>
<td>2,4</td>
<td>3,5</td>
<td>+2</td>
<td>+2</td>
<td>C</td>
</tr>
<tr class="even">
<td>(1,3)</td>
<td>2,5</td>
<td>3,4</td>
<td>+3</td>
<td>+1</td>
<td>C</td>
</tr>
<tr class="odd">
<td>(1,4)</td>
<td>2,3</td>
<td>3,4</td>
<td>+1</td>
<td>+1</td>
<td>C</td>
</tr>
<tr class="even">
<td>(1,5)</td>
<td>2,8</td>
<td>3,7</td>
<td>+6</td>
<td>+4</td>
<td>C</td>
</tr>
<tr class="odd">
<td>(2,3)</td>
<td>4,5</td>
<td>5,4</td>
<td>+1</td>
<td>-1</td>
<td>D</td>
</tr>
<tr class="even">
<td>(2,4)</td>
<td>4,3</td>
<td>5,4</td>
<td>-1</td>
<td>-1</td>
<td>C</td>
</tr>
<tr class="odd">
<td>(2,5)</td>
<td>4,8</td>
<td>5,7</td>
<td>+4</td>
<td>+2</td>
<td>C</td>
</tr>
<tr class="even">
<td>(3,4)</td>
<td>5,3</td>
<td>4,4</td>
<td>-2</td>
<td>0</td>
<td>D</td>
</tr>
<tr class="odd">
<td>(3,5)</td>
<td>5,8</td>
<td>4,7</td>
<td>+3</td>
<td>+3</td>
<td>C</td>
</tr>
<tr class="even">
<td>(4,5)</td>
<td>3,8</td>
<td>4,7</td>
<td>+5</td>
<td>+3</td>
<td>C</td>
</tr>
</tbody>
</table>
<p>Number of concordant pairs = 8 Number of discordant pairs = 2 <span class="math display"> \tau = \frac{8-2}{10} = 0.74 </span></p>
</section>
</section>
<section id="verification-in-r" class="level3" data-number="15.16.5">
<h3 data-number="15.16.5" class="anchored" data-anchor-id="verification-in-r"><span class="header-section-number">15.16.5</span> Verification in R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pearson:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(data<span class="sc">$</span>x, data<span class="sc">$</span>y, <span class="at">method=</span><span class="st">"pearson"</span>), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pearson: 0.92 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Spearman:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(data<span class="sc">$</span>x, data<span class="sc">$</span>y, <span class="at">method=</span><span class="st">"spearman"</span>), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spearman: 0.82 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Kendall:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(data<span class="sc">$</span>x, data<span class="sc">$</span>y, <span class="at">method=</span><span class="st">"kendall"</span>), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kendall: 0.74 </code></pre>
</div>
</div>
</section>
<section id="interpretation-of-results" class="level3" data-number="15.16.6">
<h3 data-number="15.16.6" class="anchored" data-anchor-id="interpretation-of-results"><span class="header-section-number">15.16.6</span> Interpretation of Results</h3>
<ol type="1">
<li><strong>Pearson Correlation (r = 0.92)</strong>
<ul>
<li>Strong positive linear correlation</li>
<li>Indicates a very strong linear relationship between variables</li>
</ul></li>
<li><strong>Spearman Correlation (ρ = 0.82)</strong>
<ul>
<li>Also strong positive correlation</li>
<li>Slightly lower than Pearson’s, suggesting some deviations from monotonicity</li>
</ul></li>
<li><strong>Kendall’s Tau (τ = 0.74)</strong>
<ul>
<li>Lowest of the three values, but still indicates strong association</li>
<li>More robust to outliers</li>
</ul></li>
</ol>
</section>
<section id="comparison-of-measures" class="level3" data-number="15.16.7">
<h3 data-number="15.16.7" class="anchored" data-anchor-id="comparison-of-measures"><span class="header-section-number">15.16.7</span> Comparison of Measures</h3>
<ol type="1">
<li><strong>Differences in Values:</strong>
<ul>
<li>Pearson (0.92) - highest value, strong linearity</li>
<li>Spearman (0.82) - considers only ranking</li>
<li>Kendall (0.74) - most conservative measure</li>
</ul></li>
<li><strong>Practical Application:</strong>
<ul>
<li>All measures confirm strong positive association</li>
<li>Differences between measures indicate slight deviations from perfect linearity</li>
<li>Kendall provides the most conservative estimate of relationship strength</li>
</ul></li>
</ol>
</section>
<section id="exercises" class="level3" data-number="15.16.8">
<h3 data-number="15.16.8" class="anchored" data-anchor-id="exercises"><span class="header-section-number">15.16.8</span> Exercises</h3>
<ol type="1">
<li>Change y[3] from 4 to 6 and recalculate all three correlations</li>
<li>Add an outlier (x=10, y=2) and recalculate correlations</li>
<li>Compare which measure is most sensitive to changes in the data</li>
</ol>
</section>
<section id="key-points-to-remember" class="level3" data-number="15.16.9">
<h3 data-number="15.16.9" class="anchored" data-anchor-id="key-points-to-remember"><span class="header-section-number">15.16.9</span> Key Points to Remember</h3>
<ol type="1">
<li><strong>Pearson Correlation:</strong>
<ul>
<li>Measures linear relationship</li>
<li>Most sensitive to outliers</li>
<li>Requires interval or ratio data</li>
</ul></li>
<li><strong>Spearman Correlation:</strong>
<ul>
<li>Measures monotonic relationship</li>
<li>Less sensitive to outliers</li>
<li>Works with ordinal data</li>
</ul></li>
<li><strong>Kendall’s Tau:</strong>
<ul>
<li>Measures ordinal association</li>
<li>Most robust to outliers</li>
<li>Best for small samples and tied ranks</li>
</ul></li>
</ol>
</section>
</section>
<section id="appendix-b-bias-in-ols-estimation-with-endogenous-regressors" class="level2" data-number="15.17">
<h2 data-number="15.17" class="anchored" data-anchor-id="appendix-b-bias-in-ols-estimation-with-endogenous-regressors"><span class="header-section-number">15.17</span> Appendix B: Bias in OLS Estimation with Endogenous Regressors</h2>
<p>In this tutorial, we will explore the bias in Ordinary Least Squares (OLS) estimation when the error term is correlated with the explanatory variable, a situation known as endogeneity. We will first derive the bias mathematically and then illustrate it using a simulated dataset in R.</p>
</section>
<section id="theoretical-derivation" class="level2" data-number="15.18">
<h2 data-number="15.18" class="anchored" data-anchor-id="theoretical-derivation"><span class="header-section-number">15.18</span> Theoretical Derivation</h2>
<p>Consider a data generating process (DGP) where the true relationship between <span class="math inline">x</span> and <span class="math inline">y</span> is:</p>
<p><span class="math display"> y = 2x + e </span></p>
<p>However, there is an endogeneity problem because the error term <span class="math inline">e</span> is correlated with <span class="math inline">x</span> in the following way:</p>
<p><span class="math display"> e = 1x + u </span></p>
<p>where <span class="math inline">u</span> is an independent error term.</p>
<p>If we estimate the simple linear model <span class="math inline">y = \hat{\beta_0} + \hat{\beta_1}x + \varepsilon</span> using OLS, the OLS estimator of <span class="math inline">\hat{\beta_1}</span> will be biased due to the endogeneity issue.</p>
<p>To understand the bias, let’s derive the expected value of the OLS estimator <span class="math inline">\hat{\beta}_1</span>:</p>
<p><span class="math display">\begin{align*}
E[\hat{\beta}_1] &amp;= E[(X'X)^{-1}X'y] \\
                 &amp;= E[(X'X)^{-1}X'(2x + 1x + u)] \\
                 &amp;= E[(X'X)^{-1}X'(3x + u)] \\
                 &amp;= 3 + E[(X'X)^{-1}X'u]
\end{align*}</span></p>
<p>If the error term <span class="math inline">u</span> is uncorrelated with <span class="math inline">x</span>, then <span class="math inline">E[(X'X)^{-1}X'u] = 0</span>, and the OLS estimator would be unbiased: <span class="math inline">E[\hat{\beta}_1] = 3</span>. However, in this case, the original error term <span class="math inline">e</span> is correlated with <span class="math inline">x</span>, so <span class="math inline">u</span> is also likely to be correlated with <span class="math inline">x</span>.</p>
<p>Assuming <span class="math inline">E[(X'X)^{-1}X'u] \neq 0</span>, the OLS estimator will be biased:</p>
<p><span class="math display">\begin{align*}
\text{Bias}(\hat{\beta}_1) &amp;= E[\hat{\beta}_1] - \beta_{1,\text{true}} \\
                           &amp;= 3 + E[(X'X)^{-1}X'u] - 2 \\
                           &amp;= 1 + E[(X'X)^{-1}X'u]
\end{align*}</span></p>
<p>The direction and magnitude of the bias will depend on the correlation between <span class="math inline">x</span> and <span class="math inline">u</span>. If <span class="math inline">x</span> and <span class="math inline">u</span> are positively correlated, the bias will be positive, and the OLS estimator will overestimate the true coefficient. Conversely, if <span class="math inline">x</span> and <span class="math inline">u</span> are negatively correlated, the bias will be negative, and the OLS estimator will underestimate the true coefficient.</p>
</section>
<section id="simulation-in-r" class="level2" data-number="15.19">
<h2 data-number="15.19" class="anchored" data-anchor-id="simulation-in-r"><span class="header-section-number">15.19</span> Simulation in R</h2>
<p>Let’s create a simple dataset with 10 observations where <span class="math inline">x</span> is in the interval 1:10, and generate <span class="math inline">y</span> values based on the given DGP: <span class="math inline">y = 2x + e</span>, where <span class="math inline">e = 1x + u</span>, and <span class="math inline">u</span> is a random error term.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span>x <span class="sc">+</span> u</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="co"># e &lt;- 1*x</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>x <span class="sc">+</span> e</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the data frame</span></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate the OLS model</span></span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model summary</span></span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.1348 -0.5624 -0.1393  0.3854  1.6814 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.5255     0.6673   0.787    0.454    
x             2.9180     0.1075  27.134 3.67e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9768 on 8 degrees of freedom
Multiple R-squared:  0.9893,    Adjusted R-squared:  0.9879 
F-statistic: 736.3 on 1 and 8 DF,  p-value: 3.666e-09</code></pre>
</div>
</div>
<p>In this example, the true relationship is <span class="math inline">y = 2x + e</span>, where <span class="math inline">e = 1x + u</span>. However, when we estimate the OLS model, we get:</p>
<p><span class="math display"> \hat{y} = 0.18376 + 3.05874x </span></p>
<p>The estimated coefficient for <span class="math inline">x</span> is 3.05874, which is biased upward from the true value of 2. This bias is due to the correlation between the error term <span class="math inline">e</span> and the explanatory variable <span class="math inline">x</span>.</p>
<p>To visualize the bias using ggplot2, we can plot the true relationship (<span class="math inline">y = 2x</span>) and the estimated OLS relationship:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">coef</span>(model)[<span class="dv">1</span>], <span class="at">slope =</span> <span class="fu">coef</span>(model)[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"True vs. Estimated Relationship"</span>, <span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Lines"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>), </span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"True"</span>, <span class="st">"OLS"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The plot will show that the estimated OLS line (red) is steeper than the true relationship line (blue), illustrating the upward bias in the estimated coefficient.</p>
</section>
<section id="conclusion-2" class="level2" data-number="15.20">
<h2 data-number="15.20" class="anchored" data-anchor-id="conclusion-2"><span class="header-section-number">15.20</span> Conclusion</h2>
<p>In summary, when the error term is correlated with the explanatory variable (endogeneity), the OLS estimator will be biased. The direction and magnitude of the bias depend on the nature of the correlation between the error term and the explanatory variable. This tutorial demonstrated the bias both mathematically and through a simulated example in R, using ggplot2 for visualization.</p>
</section>
<section id="appendix-c.-worked-examples" class="level2" data-number="15.21">
<h2 data-number="15.21" class="anchored" data-anchor-id="appendix-c.-worked-examples"><span class="header-section-number">15.21</span> Appendix C. Worked Examples</h2>
</section>
<section id="descriptive-statistics-and-ols-example---income-and-voter-turnout" class="level2" data-number="15.22">
<h2 data-number="15.22" class="anchored" data-anchor-id="descriptive-statistics-and-ols-example---income-and-voter-turnout"><span class="header-section-number">15.22</span> Descriptive Statistics and OLS Example - Income and Voter Turnout</h2>
<p><strong>Background</strong></p>
<p>In preparation for the 2024 municipal elections, the Amsterdam Electoral Commission conducted research on voter participation patterns across different city neighborhoods. A key question emerged:</p>
<p>Does economic prosperity of a neighborhood correlate with civic engagement, specifically voter turnout?</p>
<p><strong>Data Collection</strong></p>
<p>Sample: 5 representative neighborhoods in Amsterdam</p>
<p>Time Period: Data from the 2022 municipal elections</p>
<p>Variables:</p>
<ul>
<li>Income: Average annual household income per capita (thousands €)</li>
<li>Turnout: Percentage of registered voters who voted in the election</li>
</ul>
<section id="initial-r-output-for-reference" class="level3" data-number="15.22.1">
<h3 data-number="15.22.1" class="anchored" data-anchor-id="initial-r-output-for-reference"><span class="header-section-number">15.22.1</span> Initial R Output for Reference</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">45</span>, <span class="dv">56</span>, <span class="dv">40</span>, <span class="dv">60</span>)  <span class="co"># thousands €</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>turnout <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">56</span>, <span class="dv">70</span>, <span class="dv">50</span>, <span class="dv">75</span>) <span class="co"># %</span></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Full model check</span></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(turnout <span class="sc">~</span> income)</span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = turnout ~ income)

Residuals:
      1       2       3       4       5 
-1.9486  0.3359  0.5100  0.6204  0.4824 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.89647    3.96731  -0.226 0.835748    
income       1.25690    0.07822  16.068 0.000524 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.263 on 3 degrees of freedom
Multiple R-squared:  0.9885,    Adjusted R-squared:  0.9847 
F-statistic: 258.2 on 1 and 3 DF,  p-value: 0.0005243</code></pre>
</div>
</div>
</section>
<section id="dispersion-measures" class="level3" data-number="15.22.2">
<h3 data-number="15.22.2" class="anchored" data-anchor-id="dispersion-measures"><span class="header-section-number">15.22.2</span> Dispersion Measures</h3>
<p><strong>Means:</strong></p>
<p><span class="math display">\bar{X} = \frac{\sum_{i=1}^n X_i}{n} = \frac{50 + 45 + 56 + 40 + 60}{5} = \frac{251}{5} = 50.2</span></p>
<p><span class="math display">\bar{Y} = \frac{\sum_{i=1}^n Y_i}{n} = \frac{60 + 56 + 70 + 50 + 75}{5} = \frac{311}{5} = 62.2</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(income)  <span class="co"># 50.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(turnout) <span class="co"># 62.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 62.2</code></pre>
</div>
</div>
<p><strong>Variances:</strong></p>
<p><span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}</span></p>
<p>Deviations for X: <span class="math inline">(-0.2, -5.2, 5.8, -10.2, 9.8)</span></p>
<p><span class="math display">s^2_X = \frac{0.04 + 27.04 + 33.64 + 104.04 + 96.04}{4} = \frac{260.8}{4} = 65.2</span></p>
<p>Deviations for Y: <span class="math inline">(-2.2, -6.2, 7.8, -12.2, 12.8)</span></p>
<p><span class="math display">s^2_Y = \frac{4.84 + 38.44 + 60.84 + 148.84 + 163.84}{4} = \frac{416.8}{4} = 104.2</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(income)  <span class="co"># 65.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 65.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(turnout) <span class="co"># 104.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 104.2</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation" class="level3" data-number="15.22.3">
<h3 data-number="15.22.3" class="anchored" data-anchor-id="covariance-and-correlation"><span class="header-section-number">15.22.3</span> Covariance and Correlation</h3>
<p><strong>Covariance:</strong></p>
<p><span class="math display">s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Products of deviations:</p>
<p><span class="math display">(-0.2 \times -2.2) = 0.44</span> <span class="math display">(-5.2 \times -6.2) = 32.24</span> <span class="math display">(5.8 \times 7.8) = 45.24</span> <span class="math display">(-10.2 \times -12.2) = 124.44</span> <span class="math display">(9.8 \times 12.8) = 125.44</span></p>
<p><span class="math display">s_{XY} = \frac{327.8}{4} = 81.95</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(income, turnout) <span class="co"># 81.95</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 81.95</code></pre>
</div>
</div>
<p><strong>Correlation:</strong></p>
<p><span class="math display">r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{81.95}{\sqrt{65.2}\sqrt{104.2}} = 0.994</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(income, turnout) <span class="co"># 0.994</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9942402</code></pre>
</div>
</div>
</section>
<section id="ols-regression-haty-hatbeta_0-hatbeta_1x" class="level3" data-number="15.22.4">
<h3 data-number="15.22.4" class="anchored" data-anchor-id="ols-regression-haty-hatbeta_0-hatbeta_1x"><span class="header-section-number">15.22.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></h3>
<p><strong>Slope coefficient:</strong></p>
<p><span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{81.95}{65.2} = 1.2571429</span></p>
<p><strong>Intercept:</strong></p>
<p><span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span></p>
<p>Step by step:</p>
<ol type="1">
<li><span class="math display">1.2571429 \times 50.2 = 63.1085714</span></li>
<li><span class="math display">\hat{\beta_0} = 62.2 - 63.1085714 = -0.9085714</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)  <span class="co"># Exact coefficients from R</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      income 
 -0.8964724   1.2569018 </code></pre>
</div>
</div>
</section>
<section id="detailed-decomposition-of-variance-and-r-squared" class="level3" data-number="15.22.5">
<h3 data-number="15.22.5" class="anchored" data-anchor-id="detailed-decomposition-of-variance-and-r-squared"><span class="header-section-number">15.22.5</span> Detailed Decomposition of Variance and R-squared</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">(\hat{Y})</span>:</p>
<p><span class="math display"> \hat{Y} = -0.9085714 + 1.2571429X</span></p>
<p>The predicted values <span class="math inline">\hat{Y}</span> for each <span class="math inline">X</span> value:</p>
<p>For <span class="math inline">X = 50</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (50)
</span> <span class="math display">\hat{Y} = -0.9085714 + 62.857145</span> <span class="math display">\hat{Y} = 61.9485736</span></p>
<p>For <span class="math inline">X = 45</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (45)
</span> <span class="math display">\hat{Y} = -0.9085714 + 56.5714305</span> <span class="math display">\hat{Y} = 55.6535591</span></p>
<p>For <span class="math inline">X = 56</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (56)
</span> <span class="math display">\hat{Y} = -0.9085714 + 70.4200024</span> <span class="math display">\hat{Y} = 69.5114310</span></p>
<p>For <span class="math inline">X = 40</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (40)
</span> <span class="math display">\hat{Y} = -0.9085714 + 50.2657160</span> <span class="math display">\hat{Y} = 49.3571446</span></p>
<p>For <span class="math inline">X = 60</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (60)
</span> <span class="math display">\hat{Y} = -0.9085714 + 75.4285740</span> <span class="math display">\hat{Y} = 74.5200026</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification of predicted values</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.9085714</span> <span class="sc">+</span> <span class="fl">1.2571429</span> <span class="sc">*</span> income</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> income,</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> turnout,</span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y_hat =</span> y_hat,</span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X  Y    Y_hat
1 50 60 61.94857
2 45 56 55.66286
3 56 70 69.49143
4 40 50 49.37714
5 60 75 74.52000</code></pre>
</div>
</div>
<p><strong>Step 2: Calculate SST (Total Sum of Squares)</strong></p>
<p><span class="math display">SST = \sum(Y_i - \bar{Y})^2 \text{ where } \bar{Y} = 62.2</span></p>
<p><span class="math display">(60 - 62.2)^2 = (-2.2)^2 = 4.84</span> <span class="math display">(56 - 62.2)^2 = (-6.2)^2 = 38.44</span> <span class="math display">(70 - 62.2)^2 = (7.8)^2 = 60.84</span> <span class="math display">(50 - 62.2)^2 = (-12.2)^2 = 148.84</span> <span class="math display">(75 - 62.2)^2 = (12.8)^2 = 163.84</span></p>
<p><span class="math display">SST = 4.84 + 38.44 + 60.84 + 148.84 + 163.84 = 416.8</span></p>
<p><strong>Step 3: Calculate SSR (Regression Sum of Squares)</strong></p>
<p><span class="math display">SSR = \sum(\hat{Y}_i - \bar{Y})^2</span></p>
<p><span class="math display">(61.9485736 - 62.2)^2 = (-0.2514264)^2 = 0.0632151</span> <span class="math display">(55.6535591 - 62.2)^2 = (-6.5464409)^2 = 42.8558689</span> <span class="math display">(69.5114310 - 62.2)^2 = (7.3114310)^2 = 53.4570178</span> <span class="math display">(49.3571446 - 62.2)^2 = (-12.8428554)^2 = 164.9389370</span> <span class="math display">(74.5200026 - 62.2)^2 = (12.3200026)^2 = 151.7824640</span></p>
<p><span class="math display">SSR = 413.0975028</span></p>
<p><strong>Step 4: Calculate SSE (Error Sum of Squares)</strong></p>
<p><span class="math display">SSE = \sum(Y_i - \hat{Y}_i)^2</span></p>
<p><span class="math display">(60 - 61.9485736)^2 = (-1.9485736)^2 = 3.7969384</span> <span class="math display">(56 - 55.6535591)^2 = (0.3464409)^2 = 0.1200212</span> <span class="math display">(70 - 69.5114310)^2 = (0.4885690)^2 = 0.2387198</span> <span class="math display">(50 - 49.3571446)^2 = (0.6428554)^2 = 0.4132631</span> <span class="math display">(75 - 74.5200026)^2 = (0.4799974)^2 = 0.2303975</span></p>
<p><span class="math display">SSE = 4.7024972</span></p>
<p><strong>Step 5: Verify decomposition</strong></p>
<p><span class="math display">SST = SSR + SSE</span> <span class="math display">416.8 = 413.0975028 + 4.7024972</span></p>
<p><strong>Step 6: Calculate R-squared</strong></p>
<p><span class="math display">R^2 = \frac{SSR}{SST} = \frac{413.0975028}{416.8} = 0.9916</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared  <span class="co"># Should match our calculation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9885135</code></pre>
</div>
</div>
</section>
<section id="visualization-1" class="level3" data-number="15.22.6">
<h3 data-number="15.22.6" class="anchored" data-anchor-id="visualization-1"><span class="header-section-number">15.22.6</span> Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">income =</span> income, <span class="at">turnout =</span> turnout)</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> turnout)) <span class="sc">+</span></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Voter Turnout vs Income per Capita"</span>,</span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Income per Capita (thousands €)"</span>,</span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Voter Turnout (%)"</span></span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb174-13"><a href="#cb174-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb174-14"><a href="#cb174-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb174-15"><a href="#cb174-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb174-16"><a href="#cb174-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation-1" class="level3" data-number="15.22.7">
<h3 data-number="15.22.7" class="anchored" data-anchor-id="interpretation-1"><span class="header-section-number">15.22.7</span> Interpretation</h3>
<p>The analysis shows:</p>
<ol type="1">
<li><p>A very strong positive correlation (<span class="math inline">r = 0.994</span>) between income and voter turnout</p></li>
<li><p>The regression equation <span class="math display">\hat{Y} = -0.9085714 + 1.2571429X</span> indicates that:</p>
<ul>
<li>For each €1,000 increase in income, turnout increases by about 1.26 percentage points</li>
<li>The intercept (<span class="math inline">-0.9086</span>) has little practical meaning as income is never zero</li>
</ul></li>
<li><p>The R-squared of 0.9916 indicates that 99.16% of the variance in turnout is explained by income</p></li>
</ol>
</section>
</section>
<section id="anxiety-levels-and-cognitive-performance-a-laboratory-study" class="level2" data-number="15.23">
<h2 data-number="15.23" class="anchored" data-anchor-id="anxiety-levels-and-cognitive-performance-a-laboratory-study"><span class="header-section-number">15.23</span> Anxiety Levels and Cognitive Performance: A Laboratory Study</h2>
<section id="data-and-context" class="level3" data-number="15.23.1">
<h3 data-number="15.23.1" class="anchored" data-anchor-id="data-and-context"><span class="header-section-number">15.23.1</span> Data and Context</h3>
<p>In a psychology experiment, researchers measured the relationship between anxiety levels (measured by galvanic skin response, GSR) and cognitive performance (score on a working memory task).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>anxiety <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">3.4</span>, <span class="fl">4.2</span>, <span class="fl">5.1</span>, <span class="fl">5.8</span>, <span class="fl">6.4</span>, <span class="fl">7.2</span>, <span class="fl">8.0</span>)  <span class="co"># GSR readings</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>performance <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">92</span>, <span class="dv">88</span>, <span class="dv">84</span>, <span class="dv">78</span>, <span class="dv">74</span>, <span class="dv">70</span>, <span class="dv">65</span>, <span class="dv">62</span>)      <span class="co"># Working memory scores</span></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial model check</span></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(performance <span class="sc">~</span> anxiety)</span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = performance ~ anxiety)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8993 -0.6660  0.2162  0.6106  1.5262 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 105.3248     1.3189   79.86 2.60e-10 ***
anxiety      -5.4407     0.2359  -23.06 4.35e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.236 on 6 degrees of freedom
Multiple R-squared:  0.9888,    Adjusted R-squared:  0.987 
F-statistic: 531.9 on 1 and 6 DF,  p-value: 4.355e-07</code></pre>
</div>
</div>
</section>
<section id="descriptive-statistics" class="level3" data-number="15.23.2">
<h3 data-number="15.23.2" class="anchored" data-anchor-id="descriptive-statistics"><span class="header-section-number">15.23.2</span> Descriptive Statistics</h3>
<p><strong>Means:</strong> <span class="math display">\bar{X} = \frac{2.1 + 3.4 + 4.2 + 5.1 + 5.8 + 6.4 + 7.2 + 8.0}{8} = \frac{42.2}{8} = 5.275</span></p>
<p><span class="math display">\bar{Y} = \frac{92 + 88 + 84 + 78 + 74 + 70 + 65 + 62}{8} = \frac{613}{8} = 76.625</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(anxiety)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.275</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76.625</code></pre>
</div>
</div>
<p><strong>Variances:</strong> <span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}</span></p>
<p>Deviations for X:</p>
<ul>
<li><span class="math inline">(2.1 - 5.275) = -3.175</span></li>
<li><span class="math inline">(3.4 - 5.275) = -1.875</span></li>
<li><span class="math inline">(4.2 - 5.275) = -1.075</span></li>
<li><span class="math inline">(5.1 - 5.275) = -0.175</span></li>
<li><span class="math inline">(5.8 - 5.275) = 0.525</span></li>
<li><span class="math inline">(6.4 - 5.275) = 1.125</span></li>
<li><span class="math inline">(7.2 - 5.275) = 1.925</span></li>
<li><span class="math inline">(8.0 - 5.275) = 2.725</span></li>
</ul>
<p>Squared deviations:</p>
<p><span class="math display">10.08063 + 3.51563 + 1.15563 + 0.03063 + 0.27563 + 1.26563 + 3.70563 +
7.42563 = 27.45500</span></p>
<p><span class="math display">s^2_X = \frac{27.45500}{7} = 3.922143</span></p>
<p>Similarly for Y: Deviations:</p>
<p><span class="math display">15.375, 11.375, 7.375, 1.375, -2.625, -6.625, -11.625, -14.625</span></p>
<p><span class="math display">s^2_Y = \frac{236.875 + 129.391 + 54.391 + 1.891 + 6.891 + 43.891 + 135.141 + 213.891}{7} = \frac{822.362}{7} = 117.4803</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(anxiety)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.922143</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 117.4107</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation-1" class="level3" data-number="15.23.3">
<h3 data-number="15.23.3" class="anchored" data-anchor-id="covariance-and-correlation-1"><span class="header-section-number">15.23.3</span> Covariance and Correlation</h3>
<p><strong>Covariance:</strong> <span class="math display">s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Products of deviations:</p>
<p><span class="math display">(-3.175 × 15.375) = -48.815625</span></p>
<p><span class="math display">(-1.875 × 11.375) = -21.328125</span></p>
<p><span class="math display">(-1.075 × 7.375) = -7.928125</span></p>
<p><span class="math display">(-0.175 × 1.375) = -0.240625</span></p>
<p><span class="math display">(0.525 × -2.625) = -1.378125</span></p>
<p><span class="math display">(1.125 × -6.625) = -7.453125</span></p>
<p><span class="math display">(1.925 × -11.625) = -22.378125</span></p>
<p><span class="math display">(2.725 × -14.625) = -39.853125</span></p>
<p>Sum <span class="math inline">= -149.375</span></p>
<p><span class="math display">s_{XY} = \frac{-149.375}{7} = -21.33929</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(anxiety, performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -21.33929</code></pre>
</div>
</div>
<p><strong>Correlation:</strong> <span class="math display">r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{-21.33929}{\sqrt{3.922143}\sqrt{117.4803}} = -0.9932</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(anxiety, performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9944073</code></pre>
</div>
</div>
</section>
<section id="ols-regression-haty-hatbeta_0-hatbeta_1x-1" class="level3" data-number="15.23.4">
<h3 data-number="15.23.4" class="anchored" data-anchor-id="ols-regression-haty-hatbeta_0-hatbeta_1x-1"><span class="header-section-number">15.23.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></h3>
<p><strong>Slope coefficient:</strong> <span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{-21.33929}{3.922143} = -5.4407</span></p>
<p><strong>Intercept:</strong> <span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span> Steps:</p>
<ol type="1">
<li><span class="math inline">-5.4407 × 5.275 = -28.6997</span></li>
<li><span class="math inline">\hat{\beta_0} = 76.625 - (-28.6997) = 105.3247</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     anxiety 
 105.324804   -5.440721 </code></pre>
</div>
</div>
</section>
<section id="r-squared-calculation" class="level3" data-number="15.23.5">
<h3 data-number="15.23.5" class="anchored" data-anchor-id="r-squared-calculation"><span class="header-section-number">15.23.5</span> 4. R-squared Calculation</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">(\hat{Y})</span>: <span class="math display">\hat{Y} = 105.3247 - 5.4407X</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted values</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="fl">105.3247</span> <span class="sc">-</span> <span class="fl">5.4407</span> <span class="sc">*</span> anxiety</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Anxiety =</span> anxiety,</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Performance =</span> performance,</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> y_hat,</span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Anxiety Performance Predicted
1     2.1          92  93.89923
2     3.4          88  86.82632
3     4.2          84  82.47376
4     5.1          78  77.57713
5     5.8          74  73.76864
6     6.4          70  70.50422
7     7.2          65  66.15166
8     8.0          62  61.79910</code></pre>
</div>
</div>
<p><strong>Step 2: Sum of Squares</strong></p>
<p><span class="math inline">SST = \sum(Y_i - \bar{Y})^2 = 822.362</span></p>
<p><span class="math inline">SSR = \sum(\hat{Y}_i - \bar{Y})^2 = 816.3094</span></p>
<p><span class="math inline">SSE = \sum(Y_i - \hat{Y}_i)^2 = 6.0526</span></p>
<p><strong>R-squared:</strong> <span class="math display">R^2 = \frac{SSR}{SST} = \frac{816.3094}{822.362} = 0.9926</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9888459</code></pre>
</div>
</div>
</section>
<section id="visualization-2" class="level3" data-number="15.23.6">
<h3 data-number="15.23.6" class="anchored" data-anchor-id="visualization-2"><span class="header-section-number">15.23.6</span> Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(anxiety, performance), <span class="fu">aes</span>(<span class="at">x =</span> anxiety, <span class="at">y =</span> performance)) <span class="sc">+</span></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cognitive Performance vs. Anxiety Levels"</span>,</span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Anxiety (GSR)"</span>,</span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Performance Score"</span></span>
<span id="cb195-10"><a href="#cb195-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb195-11"><a href="#cb195-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation-2" class="level3" data-number="15.23.7">
<h3 data-number="15.23.7" class="anchored" data-anchor-id="interpretation-2"><span class="header-section-number">15.23.7</span> Interpretation</h3>
<ol type="1">
<li>Strong negative correlation (r = -0.993) between anxiety and cognitive performance</li>
<li>For each unit increase in GSR (anxiety), performance decreases by approximately 5.44 points</li>
<li>The model explains 99.26% of the variance in performance scores</li>
<li>The relationship appears to be strongly linear, suggesting a reliable anxiety-performance relationship</li>
<li>The high intercept (105.32) represents the theoretical maximum performance at zero anxiety</li>
</ol>
</section>
<section id="study-limitations" class="level3" data-number="15.23.8">
<h3 data-number="15.23.8" class="anchored" data-anchor-id="study-limitations"><span class="header-section-number">15.23.8</span> Study Limitations</h3>
<ol type="1">
<li>Small sample size (n=8)</li>
<li>Possible other confounding variables</li>
<li>Limited range of anxiety levels</li>
<li>Cross-sectional rather than longitudinal data</li>
</ol>
</section>
</section>
<section id="district-magnitude-and-electoral-disproportionality-a-comparative-analysis" class="level2" data-number="15.24">
<h2 data-number="15.24" class="anchored" data-anchor-id="district-magnitude-and-electoral-disproportionality-a-comparative-analysis"><span class="header-section-number">15.24</span> District Magnitude and Electoral Disproportionality: A Comparative Analysis</h2>
<section id="data-generating-process" class="level3" data-number="15.24.1">
<h3 data-number="15.24.1" class="anchored" data-anchor-id="data-generating-process"><span class="header-section-number">15.24.1</span> Data Generating Process</h3>
<p>Let’s set up a DGP where:</p>
<p><span class="math display">\begin{aligned}
&amp; Y_{\text{Gallagher}} = 12 - 0.8X_{\text{DM}} + \varepsilon \\
&amp; \varepsilon \sim \mathcal{N}(0, 1) \\
&amp; X_{\text{DM}} \in \{3, 5, 7, 10, 12, 15\}
\end{aligned}</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DGP</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>magnitude <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">15</span>)</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>gallagher <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">-</span> <span class="fl">0.8</span> <span class="sc">*</span> magnitude <span class="sc">+</span> epsilon</span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Round (sampled from the DGP) Gallagher indices to one decimal place</span></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>gallagher <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fl">9.0</span>, <span class="fl">7.8</span>, <span class="fl">9.2</span>, <span class="fl">4.1</span>, <span class="fl">2.5</span>, <span class="fl">1.7</span>), <span class="dv">1</span>)</span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Show data</span></span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">District_Magnitude =</span> magnitude,</span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gallagher_Index =</span> gallagher</span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  District_Magnitude Gallagher_Index
1                  3             9.0
2                  5             7.8
3                  7             9.2
4                 10             4.1
5                 12             2.5
6                 15             1.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial model check</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(gallagher <span class="sc">~</span> magnitude)</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = gallagher ~ magnitude)

Residuals:
      1       2       3       4       5       6 
-0.6516 -0.4628  2.3260 -0.6908 -0.9020  0.3813 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  11.7349     1.3034   9.003 0.000843 ***
magnitude    -0.6944     0.1359  -5.110 0.006934 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.368 on 4 degrees of freedom
Multiple R-squared:  0.8672,    Adjusted R-squared:  0.834 
F-statistic: 26.11 on 1 and 4 DF,  p-value: 0.006934</code></pre>
</div>
</div>
</section>
<section id="descriptive-statistics-1" class="level3" data-number="15.24.2">
<h3 data-number="15.24.2" class="anchored" data-anchor-id="descriptive-statistics-1"><span class="header-section-number">15.24.2</span> Descriptive Statistics</h3>
<p><strong>Means:</strong> <span class="math display">\bar{X} = \frac{3 + 5 + 7 + 10 + 12 + 15}{6} = \frac{52}{6} = 8.6667</span></p>
<p><span class="math display">\bar{Y} = \frac{9.0 + 7.8 + 9.2 + 4.1 + 2.5 + 1.7}{6} = \frac{34.3}{6} = 5.7167</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(magnitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.666667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.716667</code></pre>
</div>
</div>
<p><strong>Variances:</strong> <span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}</span></p>
<p>Deviations for X:</p>
<ul>
<li>(3 - 8.6667) = -5.6667</li>
<li>(5 - 8.6667) = -3.6667</li>
<li>(7 - 8.6667) = -1.6667</li>
<li>(10 - 8.6667) = 1.3333</li>
<li>(12 - 8.6667) = 3.3333</li>
<li>(15 - 8.6667) = 6.3333</li>
</ul>
<p>Squared deviations:</p>
<p><span class="math display">
32.1115 + 13.4445 + 2.7779 + 1.7777 + 11.1109 + 40.1107 = 101.3332
</span></p>
<p><span class="math display">s^2_X = \frac{101.3332}{5} = 20.2666</span></p>
<p>For Y: Deviations: 3.2833, 2.0833, 3.4833, -1.6167, -3.2167, -4.0167</p>
<p><span class="math display">s^2_Y = \frac{56.3483}{5} = 11.2697</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(magnitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.26667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.26967</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation-2" class="level3" data-number="15.24.3">
<h3 data-number="15.24.3" class="anchored" data-anchor-id="covariance-and-correlation-2"><span class="header-section-number">15.24.3</span> Covariance and Correlation</h3>
<p><strong>Covariance:</strong> <span class="math display">s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Products of deviations:</p>
<ul>
<li>(-5.6667 × 3.2833) = -18.6057</li>
<li>(-3.6667 × 2.0833) = -7.6387</li>
<li>(-1.6667 × 3.4833) = -5.8056</li>
<li>(1.3333 × -1.6167) = -2.1556</li>
<li>(3.3333 × -3.2167) = -10.7223</li>
<li>(6.3333 × -4.0167) = -25.4391</li>
</ul>
<p>Sum = -70.3670</p>
<p><span class="math display">s_{XY} = \frac{-70.3670}{5} = -14.0734</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(magnitude, gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -14.07333</code></pre>
</div>
</div>
<p><strong>Correlation:</strong> <span class="math display">r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{-14.0734}{\sqrt{20.2666}\sqrt{11.2697}} = -0.9279</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(magnitude, gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9312157</code></pre>
</div>
</div>
</section>
<section id="ols-regression-haty-hatbeta_0-hatbeta_1x-2" class="level3" data-number="15.24.4">
<h3 data-number="15.24.4" class="anchored" data-anchor-id="ols-regression-haty-hatbeta_0-hatbeta_1x-2"><span class="header-section-number">15.24.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></h3>
<p><strong>Slope coefficient:</strong> <span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{-14.0734}{20.2666} = -0.6944</span></p>
<p><strong>Intercept:</strong> <span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span> Steps:</p>
<ol type="1">
<li><span class="math inline">-0.6944 × 8.6667 = -6.0181</span></li>
<li><span class="math inline">\hat{\beta_0} = 5.7167 - (-6.0181) = 11.7348</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)   magnitude 
 11.7348684  -0.6944079 </code></pre>
</div>
</div>
</section>
<section id="r-squared-calculation-1" class="level3" data-number="15.24.5">
<h3 data-number="15.24.5" class="anchored" data-anchor-id="r-squared-calculation-1"><span class="header-section-number">15.24.5</span> R-squared Calculation</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">(\hat{Y})</span>:</p>
<p><span class="math display">\hat{Y} = 11.7348 - 0.6944X</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted values</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="fl">11.7348</span> <span class="sc">-</span> <span class="fl">0.6944</span> <span class="sc">*</span> magnitude</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Magnitude =</span> magnitude,</span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gallagher =</span> gallagher,</span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> y_hat,</span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Magnitude Gallagher Predicted
1         3       9.0    9.6516
2         5       7.8    8.2628
3         7       9.2    6.8740
4        10       4.1    4.7908
5        12       2.5    3.4020
6        15       1.7    1.3188</code></pre>
</div>
</div>
<p><strong>Step 2: Sum of Squares</strong> <span class="math inline">SST = \sum(Y_i - \bar{Y})^2 = 56.3483</span> <span class="math inline">SSR = \sum(\hat{Y}_i - \bar{Y})^2 = 48.5271</span> <span class="math inline">SSE = \sum(Y_i - \hat{Y}_i)^2 = 7.8212</span></p>
<p><strong>R-squared:</strong> <span class="math display">R^2 = \frac{SSR}{SST} = \frac{48.5271}{56.3483} = 0.8612</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8671626</code></pre>
</div>
</div>
</section>
<section id="visualization---true-vs.-estimated-parameters" class="level3" data-number="15.24.6">
<h3 data-number="15.24.6" class="anchored" data-anchor-id="visualization---true-vs.-estimated-parameters"><span class="header-section-number">15.24.6</span> Visualization - True vs.&nbsp;Estimated Parameters</h3>
<ul>
<li>True DGP: Y = 12 - 0.8X + ε</li>
<li>Estimated Model: Y = 11.7348 - 0.6944X</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame with original data</span></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">magnitude =</span> magnitude,</span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">gallagher =</span> gallagher</span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sequence for smooth lines</span></span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a>x_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(magnitude), <span class="fu">max</span>(magnitude), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-12"><a href="#cb218-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate predicted values for both lines</span></span>
<span id="cb218-13"><a href="#cb218-13" aria-hidden="true" tabindex="-1"></a>true_dgp <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">-</span> <span class="fl">0.8</span> <span class="sc">*</span> x_seq</span>
<span id="cb218-14"><a href="#cb218-14" aria-hidden="true" tabindex="-1"></a>estimated <span class="ot">&lt;-</span> <span class="fl">11.7348</span> <span class="sc">-</span> <span class="fl">0.6944</span> <span class="sc">*</span> x_seq</span>
<span id="cb218-15"><a href="#cb218-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-16"><a href="#cb218-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine into a data frame for plotting</span></span>
<span id="cb218-17"><a href="#cb218-17" aria-hidden="true" tabindex="-1"></a>lines_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb218-18"><a href="#cb218-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">magnitude =</span> <span class="fu">rep</span>(x_seq, <span class="dv">2</span>),</span>
<span id="cb218-19"><a href="#cb218-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(true_dgp, estimated),</span>
<span id="cb218-20"><a href="#cb218-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"True DGP"</span>, <span class="st">"Estimated"</span>), <span class="at">each =</span> <span class="fu">length</span>(x_seq))</span>
<span id="cb218-21"><a href="#cb218-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb218-22"><a href="#cb218-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-23"><a href="#cb218-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb218-24"><a href="#cb218-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb218-25"><a href="#cb218-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> lines_df, </span>
<span id="cb218-26"><a href="#cb218-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> magnitude, <span class="at">y =</span> value, <span class="at">color =</span> Model, <span class="at">linetype =</span> Model),</span>
<span id="cb218-27"><a href="#cb218-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb218-28"><a href="#cb218-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df, </span>
<span id="cb218-29"><a href="#cb218-29" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> magnitude, <span class="at">y =</span> gallagher),</span>
<span id="cb218-30"><a href="#cb218-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb218-31"><a href="#cb218-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb218-32"><a href="#cb218-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb218-33"><a href="#cb218-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"dashed"</span>, <span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb218-34"><a href="#cb218-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb218-35"><a href="#cb218-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"True DGP vs. Estimated Regression Line"</span>,</span>
<span id="cb218-36"><a href="#cb218-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Black points show observed data with random noise"</span>,</span>
<span id="cb218-37"><a href="#cb218-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"District Magnitude"</span>,</span>
<span id="cb218-38"><a href="#cb218-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gallagher Index"</span>,</span>
<span id="cb218-39"><a href="#cb218-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"True DGP: Y = 12 - 0.8X + ε</span><span class="sc">\n</span><span class="st">Estimated: Y = 11.73 - 0.69X"</span></span>
<span id="cb218-40"><a href="#cb218-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb218-41"><a href="#cb218-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb218-42"><a href="#cb218-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb218-43"><a href="#cb218-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb218-44"><a href="#cb218-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb218-45"><a href="#cb218-45" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="observations-about-model-fit" class="level3" data-number="15.24.7">
<h3 data-number="15.24.7" class="anchored" data-anchor-id="observations-about-model-fit"><span class="header-section-number">15.24.7</span> Observations about Model Fit</h3>
<ol type="1">
<li><strong>Slope Comparison</strong>
<ul>
<li>True slope: -0.8</li>
<li>Estimated slope: -0.69</li>
<li>The estimated slope is reasonably close to the true parameter</li>
</ul></li>
<li><strong>Intercept Comparison</strong>
<ul>
<li>True intercept: 12</li>
<li>Estimated intercept: 11.73</li>
<li>The estimated intercept very closely approximates the true value</li>
</ul></li>
<li><strong>Visual Patterns</strong>
<ul>
<li>The lines are nearly parallel, showing good slope recovery</li>
<li>Points scatter around both lines due to the random error term (ε)</li>
<li>The small sample size (n=6) leads to some imprecision in estimation</li>
<li>The estimated line (blue) provides a good approximation of the true DGP (red dashed)</li>
</ul></li>
<li><strong>Impact of Random Error</strong>
<ul>
<li>The scatter of points around the true DGP line reflects the N(0,1) error term</li>
<li>This noise leads to the slight differences in estimated parameters</li>
<li>With a larger sample, we would expect even closer convergence to true parameters</li>
</ul></li>
</ol>
</section>
<section id="interpretation-3" class="level3" data-number="15.24.8">
<h3 data-number="15.24.8" class="anchored" data-anchor-id="interpretation-3"><span class="header-section-number">15.24.8</span> Interpretation</h3>
<ol type="1">
<li>Strong negative correlation (r = -0.93) between district magnitude and electoral disproportionality</li>
<li>For each unit increase in district magnitude, the Gallagher index decreases by approximately 0.69 points</li>
<li>The model explains 86.12% of the variance in disproportionality</li>
<li>The relationship appears strongly linear with moderate scatter</li>
<li>The intercept (11.73) represents the expected disproportionality in a hypothetical single-member district system</li>
</ol>
</section>
<section id="study-context" class="level3" data-number="15.24.9">
<h3 data-number="15.24.9" class="anchored" data-anchor-id="study-context"><span class="header-section-number">15.24.9</span> Study Context</h3>
<ul>
<li>Data represents simulated observations from a DGP with moderate noise</li>
<li>Sample shows how increasing district magnitude tends to reduce disproportionality</li>
<li>Random component reflects other institutional and political factors affecting disproportionality</li>
</ul>
</section>
<section id="limitations" class="level3" data-number="15.24.10">
<h3 data-number="15.24.10" class="anchored" data-anchor-id="limitations"><span class="header-section-number">15.24.10</span> Limitations</h3>
<ol type="1">
<li>Small sample size (n=6)</li>
<li>Simulated rather than real-world data</li>
<li>Assumes linear relationship</li>
<li>Does not account for other institutional features</li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./rozdzial6.html" class="pagination-link" aria-label="Wizualizacja Danych: z przykładami w R">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Wizualizacja Danych: z przykładami w R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./correg_pl.html" class="pagination-link" aria-label="Wprowadzenie do Analizy Korelacji i Regresji">
        <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>